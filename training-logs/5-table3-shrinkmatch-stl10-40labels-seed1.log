[2023-07-29 13:13:18,205 WARNING] USE GPU: 0 for training
[2023-07-29 13:13:18,365 INFO] Number of Trainable Params: 5955284
[2023-07-29 13:13:21,710 INFO] model_arch: <models.shrinkmatch.shrinkmatch.ShrinkMatch object at 0x7fe4cd74c040>
[2023-07-29 13:13:21,711 INFO] Arguments: Namespace(T=0.5, alg='shrinkmatch', amp=False, batch_size=64, bn_momentum=0.0010000000000000009, c='config/shrinkmatch_stl10_40labels_seed1.yaml', clip=0, data_dir='./data', dataset='stl10', depth=28, dist_backend='nccl', dist_url='tcp://127.0.0.1:26327', distributed=True, dropout=0.0, ema_m=0.999, epoch=1, eval_batch_size=1024, gpu=0, hard_label=True, leaky_slope=0.1, load_path='None', lr=0.03, momentum=0.9, multiprocessing_distributed=True, net='WideResNetVar', net_from_name=False, num_classes=10, num_eval_iter=5000, num_labels=40, num_train_iter=1048576, num_workers=1, optim='SGD', overwrite=False, p_cutoff=0.95, rank=0, resume=False, save_dir='./exp', save_name='shrinkmatch_stl10_40labels_seed1', seed=1, train_sampler='RandomSampler', ulb_loss_ratio=1.0, uratio=7, use_da=True, use_tensorboard=True, weight_decay=0.0005, widen_factor=2, world_size=1)
[2023-07-29 13:13:49,125 INFO] [!] data loader keys: dict_keys(['train_lb', 'train_ulb', 'eval'])
[2023-07-29 13:13:59,520 INFO] confusion matrix:
[[0.00125 0.      0.9975  0.      0.      0.      0.      0.      0.00125
  0.     ]
 [0.00125 0.      0.995   0.      0.      0.      0.      0.      0.00375
  0.     ]
 [0.      0.      0.99875 0.      0.      0.      0.      0.      0.00125
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      0.99375 0.      0.005   0.      0.      0.      0.00125
  0.     ]
 [0.      0.      0.99875 0.      0.00125 0.      0.      0.      0.
  0.     ]]
[2023-07-29 13:17:54,485 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 13:18:04,468 INFO] confusion matrix:
[[0.00125 0.      0.9975  0.      0.      0.      0.      0.      0.00125
  0.     ]
 [0.00125 0.      0.995   0.      0.      0.      0.      0.      0.00375
  0.     ]
 [0.      0.      0.99875 0.      0.      0.      0.      0.      0.00125
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      0.99875 0.      0.00125 0.      0.      0.      0.
  0.     ]
 [0.      0.      0.99875 0.      0.00125 0.      0.      0.      0.
  0.     ]
 [0.      0.      1.      0.      0.      0.      0.      0.      0.
  0.     ]
 [0.      0.      0.99375 0.      0.005   0.      0.      0.      0.00125
  0.     ]
 [0.      0.      0.9975  0.      0.0025  0.      0.      0.      0.
  0.     ]]
[2023-07-29 13:18:04,474 INFO] 0 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.3781, device='cuda:0'), 'train/certain_loss': tensor(0., device='cuda:0'), 'train/shrink_loss': tensor(0.0003, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0., device='cuda:0'), 'train/removed_class_idx': 8.999999799107147, 'train/uncertainty_avg': 0.1414297373462505, 'train/certain_ratio_ema': 0.0, 'train/total_loss': tensor(2.3781, device='cuda:0'), 'train/mask_ratio': tensor(0., device='cuda:0'), 'lr': 0.029999999999974228, 'train/prefecth_time': 234.51646875, 'train/run_time': 10.448189453125, 'eval/loss': tensor(38.8210, device='cuda:0'), 'eval/top-1-acc': 0.100125, 'eval/top-5-acc': 0.49925, 'eval/precision': 0.07667418169672678, 'eval/recall': 0.10012499999999999, 'eval/F1': 0.01868968309383335, 'eval/AUC': 0.5289267708333333}, BEST_EVAL_ACC: 0.100125, at 0 iters
[2023-07-29 13:18:04,803 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 14:19:14,669 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 14:19:25,348 INFO] confusion matrix:
[[0.7375  0.00875 0.0075  0.0475  0.00875 0.00625 0.03125 0.05    0.08125
  0.02125]
 [0.0575  0.235   0.00125 0.32375 0.08375 0.0975  0.0525  0.12625 0.02
  0.0025 ]
 [0.13    0.0025  0.1575  0.08125 0.02625 0.015   0.06375 0.0225  0.07
  0.43125]
 [0.005   0.16125 0.      0.5175  0.125   0.095   0.0325  0.05875 0.00375
  0.00125]
 [0.0175  0.2575  0.      0.40125 0.11625 0.12875 0.0575  0.01625 0.00375
  0.00125]
 [0.00375 0.17625 0.      0.39625 0.09875 0.1625  0.045   0.115   0.0025
  0.     ]
 [0.00375 0.09875 0.00125 0.3525  0.1475  0.275   0.05375 0.0575  0.00125
  0.00875]
 [0.00125 0.28125 0.      0.31875 0.08375 0.1175  0.0975  0.09625 0.00375
  0.     ]
 [0.42375 0.01125 0.0175  0.055   0.01875 0.00875 0.01625 0.01    0.35125
  0.0875 ]
 [0.205   0.01    0.0875  0.125   0.0275  0.02875 0.0725  0.0225  0.09
  0.33125]]
[2023-07-29 14:19:25,355 INFO] 5000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0014, device='cuda:0'), 'train/certain_loss': tensor(0.2093, device='cuda:0'), 'train/shrink_loss': tensor(0.1781, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0724, device='cuda:0'), 'train/removed_class_idx': 3.2313724222991205, 'train/uncertainty_avg': 0.6865157140988405, 'train/certain_ratio_ema': 0.40656585561911107, 'train/total_loss': tensor(0.2831, device='cuda:0'), 'train/mask_ratio': tensor(0.4308, device='cuda:0'), 'lr': 0.029999355445794247, 'train/prefecth_time': 0.01997043228149414, 'train/run_time': 0.6379583740234375, 'eval/loss': tensor(4.0884, device='cuda:0'), 'eval/top-1-acc': 0.275875, 'eval/top-5-acc': 0.826875, 'eval/precision': 0.2966037897443927, 'eval/recall': 0.275875, 'eval/F1': 0.2591541924414468, 'eval/AUC': 0.7189119791666667}, BEST_EVAL_ACC: 0.275875, at 5000 iters
[2023-07-29 14:19:25,596 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 15:16:23,584 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 15:16:47,401 INFO] confusion matrix:
[[0.8475  0.00625 0.025   0.00625 0.00125 0.00125 0.00875 0.      0.04125
  0.0625 ]
 [0.0975  0.37    0.      0.2225  0.025   0.0275  0.12625 0.025   0.105
  0.00125]
 [0.05    0.0025  0.42    0.0025  0.00875 0.      0.01125 0.00125 0.03125
  0.4725 ]
 [0.00875 0.2275  0.00375 0.47375 0.08125 0.04875 0.10375 0.0275  0.0175
  0.0075 ]
 [0.01    0.02    0.00125 0.48375 0.11875 0.20375 0.1325  0.00125 0.0275
  0.00125]
 [0.0075  0.1675  0.00125 0.2925  0.1225  0.27125 0.06125 0.03875 0.03625
  0.00125]
 [0.      0.02625 0.015   0.15875 0.29625 0.36    0.05125 0.015   0.04875
  0.02875]
 [0.0025  0.135   0.0025  0.31375 0.0575  0.10375 0.1775  0.18875 0.0175
  0.00125]
 [0.565   0.00875 0.07375 0.0125  0.0025  0.      0.00125 0.      0.26875
  0.0675 ]
 [0.12125 0.0075  0.3675  0.01875 0.02125 0.      0.0125  0.00125 0.09625
  0.35375]]
[2023-07-29 15:16:47,408 INFO] 10000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0020, device='cuda:0'), 'train/certain_loss': tensor(0.1476, device='cuda:0'), 'train/shrink_loss': tensor(0.1432, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0765, device='cuda:0'), 'train/removed_class_idx': 2.913461398391279, 'train/uncertainty_avg': 0.7203452169167671, 'train/certain_ratio_ema': 0.5340196275963782, 'train/total_loss': tensor(0.2261, device='cuda:0'), 'train/mask_ratio': tensor(0.5357, device='cuda:0'), 'lr': 0.02999742232637523, 'train/prefecth_time': 0.019727104187011717, 'train/run_time': 0.6141331176757813, 'eval/loss': tensor(4.7384, device='cuda:0'), 'eval/top-1-acc': 0.336375, 'eval/top-5-acc': 0.886125, 'eval/precision': 0.34558569068586015, 'eval/recall': 0.336375, 'eval/F1': 0.3187709997943586, 'eval/AUC': 0.759826171875}, BEST_EVAL_ACC: 0.336375, at 10000 iters
[2023-07-29 15:16:47,626 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 16:11:33,120 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 16:11:54,029 INFO] confusion matrix:
[[0.80375 0.      0.03375 0.0025  0.00375 0.      0.0025  0.      0.03375
  0.12   ]
 [0.20125 0.365   0.      0.1675  0.04375 0.05375 0.03875 0.08375 0.04375
  0.0025 ]
 [0.02    0.      0.5075  0.00125 0.00125 0.0025  0.00625 0.00125 0.03125
  0.42875]
 [0.00625 0.28375 0.0075  0.355   0.09875 0.08875 0.06    0.05375 0.0375
  0.00875]
 [0.00875 0.0125  0.00125 0.3525  0.44625 0.06625 0.05    0.01375 0.0475
  0.00125]
 [0.015   0.175   0.00125 0.11875 0.26125 0.24875 0.025   0.0875  0.06625
  0.00125]
 [0.0075  0.01875 0.01625 0.0425  0.68375 0.11375 0.0275  0.04    0.04
  0.01   ]
 [0.0075  0.15875 0.00375 0.20375 0.0625  0.21    0.0575  0.27125 0.025
  0.     ]
 [0.445   0.0025  0.0725  0.0025  0.00125 0.      0.      0.00375 0.41625
  0.05625]
 [0.06375 0.0025  0.36625 0.005   0.0075  0.      0.00875 0.00375 0.0825
  0.46   ]]
[2023-07-29 16:11:54,036 INFO] 15000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0022, device='cuda:0'), 'train/certain_loss': tensor(0.1516, device='cuda:0'), 'train/shrink_loss': tensor(0.1271, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0740, device='cuda:0'), 'train/removed_class_idx': 2.873563053243503, 'train/uncertainty_avg': 0.7206246620277029, 'train/certain_ratio_ema': 0.5820707809296579, 'train/total_loss': tensor(0.2277, device='cuda:0'), 'train/mask_ratio': tensor(0.6116, device='cuda:0'), 'lr': 0.029994200724750647, 'train/prefecth_time': 0.019841695785522463, 'train/run_time': 0.5970667114257813, 'eval/loss': tensor(4.5519, device='cuda:0'), 'eval/top-1-acc': 0.390125, 'eval/top-5-acc': 0.910125, 'eval/precision': 0.37609573996608486, 'eval/recall': 0.390125, 'eval/F1': 0.37142523753023027, 'eval/AUC': 0.7968059809027777}, BEST_EVAL_ACC: 0.390125, at 15000 iters
[2023-07-29 16:11:54,264 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 17:05:09,900 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 17:05:20,098 INFO] confusion matrix:
[[0.8525  0.      0.05375 0.00625 0.00125 0.      0.015   0.      0.0375
  0.03375]
 [0.25    0.35875 0.      0.12125 0.05875 0.04875 0.035   0.08625 0.03875
  0.0025 ]
 [0.015   0.      0.86    0.00125 0.      0.      0.01625 0.0025  0.00625
  0.09875]
 [0.0075  0.28625 0.00125 0.31125 0.14375 0.11625 0.0525  0.05125 0.01875
  0.01125]
 [0.01125 0.01125 0.00125 0.07375 0.7425  0.045   0.05375 0.01375 0.045
  0.0025 ]
 [0.01875 0.1675  0.      0.0525  0.2575  0.255   0.165   0.035   0.04375
  0.005  ]
 [0.00625 0.0175  0.00125 0.005   0.32    0.09375 0.51375 0.01125 0.02125
  0.01   ]
 [0.01    0.16    0.      0.095   0.08625 0.2925  0.05    0.27875 0.02
  0.0075 ]
 [0.275   0.00125 0.045   0.      0.      0.      0.00125 0.0025  0.63875
  0.03625]
 [0.07875 0.0025  0.505   0.0025  0.      0.      0.01875 0.005   0.045
  0.3425 ]]
[2023-07-29 17:05:20,104 INFO] 20000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0014, device='cuda:0'), 'train/certain_loss': tensor(0.1025, device='cuda:0'), 'train/shrink_loss': tensor(0.1038, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0651, device='cuda:0'), 'train/removed_class_idx': 2.5384613882567226, 'train/uncertainty_avg': 0.7620248756300911, 'train/certain_ratio_ema': 0.6273815047086867, 'train/total_loss': tensor(0.1690, device='cuda:0'), 'train/mask_ratio': tensor(0.6228, device='cuda:0'), 'lr': 0.02998969077929826, 'train/prefecth_time': 0.02290480041503906, 'train/run_time': 0.5857392578125, 'eval/loss': tensor(3.4515, device='cuda:0'), 'eval/top-1-acc': 0.515375, 'eval/top-5-acc': 0.9365, 'eval/precision': 0.5179918088599008, 'eval/recall': 0.515375, 'eval/F1': 0.4966603958571535, 'eval/AUC': 0.8718012239583333}, BEST_EVAL_ACC: 0.515375, at 20000 iters
[2023-07-29 17:05:20,324 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 17:57:26,624 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 17:57:37,086 INFO] confusion matrix:
[[0.80125 0.00125 0.03375 0.0075  0.0025  0.      0.00625 0.      0.11
  0.0375 ]
 [0.2075  0.41    0.      0.10875 0.04875 0.0525  0.04    0.11125 0.01875
  0.0025 ]
 [0.02875 0.      0.89375 0.      0.      0.      0.0075  0.00375 0.005
  0.06125]
 [0.02    0.2925  0.005   0.28    0.125   0.10375 0.0725  0.07625 0.00125
  0.02375]
 [0.01125 0.025   0.      0.02    0.77875 0.025   0.1075  0.02375 0.00375
  0.005  ]
 [0.01625 0.135   0.      0.0475  0.22    0.205   0.2675  0.1     0.00375
  0.005  ]
 [0.00875 0.0125  0.00375 0.00125 0.25125 0.065   0.62    0.025   0.00375
  0.00875]
 [0.01125 0.16375 0.      0.0875  0.09375 0.25    0.03875 0.34125 0.
  0.01375]
 [0.02125 0.      0.0075  0.00125 0.      0.      0.00125 0.00375 0.92
  0.045  ]
 [0.05875 0.00125 0.49875 0.0025  0.      0.      0.005   0.005   0.03625
  0.3925 ]]
[2023-07-29 17:57:37,092 INFO] 25000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0034, device='cuda:0'), 'train/certain_loss': tensor(0.1545, device='cuda:0'), 'train/shrink_loss': tensor(0.0985, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0649, device='cuda:0'), 'train/removed_class_idx': 2.5975608172219014, 'train/uncertainty_avg': 0.7534509875759483, 'train/certain_ratio_ema': 0.6584383527659509, 'train/total_loss': tensor(0.2227, device='cuda:0'), 'train/mask_ratio': tensor(0.6339, device='cuda:0'), 'lr': 0.0299838926837342, 'train/prefecth_time': 0.021943935394287108, 'train/run_time': 0.6044671630859375, 'eval/loss': tensor(3.3201, device='cuda:0'), 'eval/top-1-acc': 0.56425, 'eval/top-5-acc': 0.945, 'eval/precision': 0.5517857962984729, 'eval/recall': 0.56425, 'eval/F1': 0.5429426132536352, 'eval/AUC': 0.8894527604166665}, BEST_EVAL_ACC: 0.56425, at 25000 iters
[2023-07-29 17:57:37,307 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 18:49:04,698 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 18:49:14,825 INFO] confusion matrix:
[[0.80875 0.00125 0.03125 0.005   0.      0.      0.0075  0.00125 0.10625
  0.03875]
 [0.19625 0.415   0.      0.08375 0.05625 0.04375 0.04    0.13    0.0325
  0.0025 ]
 [0.0325  0.      0.90875 0.      0.      0.      0.00375 0.0025  0.0025
  0.05   ]
 [0.0125  0.30875 0.00125 0.25    0.125   0.1025  0.07625 0.09875 0.0025
  0.0225 ]
 [0.01    0.0275  0.00125 0.015   0.76875 0.025   0.10875 0.035   0.005
  0.00375]
 [0.01125 0.14375 0.      0.04    0.1925  0.2275  0.28125 0.09125 0.00625
  0.00625]
 [0.01    0.01375 0.0025  0.0025  0.165   0.0625  0.70375 0.03    0.00375
  0.00625]
 [0.015   0.1675  0.      0.06375 0.08125 0.25    0.03625 0.36875 0.00125
  0.01625]
 [0.01875 0.      0.00875 0.00125 0.      0.      0.00125 0.0025  0.9225
  0.045  ]
 [0.0525  0.00125 0.52625 0.0025  0.      0.      0.0025  0.0025  0.025
  0.3875 ]]
[2023-07-29 18:49:14,832 INFO] 30000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1245, device='cuda:0'), 'train/shrink_loss': tensor(0.0875, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0594, device='cuda:0'), 'train/removed_class_idx': 2.5632909770069, 'train/uncertainty_avg': 0.7408786150855333, 'train/certain_ratio_ema': 0.6790557278675241, 'train/total_loss': tensor(0.1843, device='cuda:0'), 'train/mask_ratio': tensor(0.6473, device='cuda:0'), 'lr': 0.029976806687104632, 'train/prefecth_time': 0.028680479049682617, 'train/run_time': 0.5821243896484375, 'eval/loss': tensor(3.2836, device='cuda:0'), 'eval/top-1-acc': 0.576125, 'eval/top-5-acc': 0.9455, 'eval/precision': 0.5648030891924007, 'eval/recall': 0.576125, 'eval/F1': 0.553673331502681, 'eval/AUC': 0.8959393576388888}, BEST_EVAL_ACC: 0.576125, at 30000 iters
[2023-07-29 18:49:15,048 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 19:40:24,835 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 19:40:35,784 INFO] confusion matrix:
[[0.8075  0.00125 0.02125 0.005   0.00125 0.      0.00375 0.      0.115
  0.045  ]
 [0.235   0.38375 0.      0.07375 0.0675  0.035   0.03125 0.12625 0.045
  0.0025 ]
 [0.035   0.      0.88625 0.      0.      0.      0.00375 0.00375 0.00375
  0.0675 ]
 [0.02625 0.3125  0.      0.25375 0.1275  0.10375 0.06875 0.08    0.005
  0.0225 ]
 [0.00875 0.01875 0.      0.015   0.775   0.0175  0.1275  0.0275  0.005
  0.005  ]
 [0.02    0.16375 0.      0.03875 0.19375 0.19625 0.3125  0.0575  0.01125
  0.00625]
 [0.02125 0.01125 0.0025  0.00375 0.11375 0.04375 0.77375 0.01875 0.0025
  0.00875]
 [0.0175  0.16875 0.      0.0575  0.1     0.24    0.03875 0.35625 0.00375
  0.0175 ]
 [0.0175  0.      0.00875 0.      0.00125 0.      0.      0.00125 0.92875
  0.0425 ]
 [0.03875 0.      0.5225  0.0025  0.      0.      0.      0.00375 0.02375
  0.40875]]
[2023-07-29 19:40:35,791 INFO] 35000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1807, device='cuda:0'), 'train/shrink_loss': tensor(0.0875, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0607, device='cuda:0'), 'train/removed_class_idx': 2.6279067730304826, 'train/uncertainty_avg': 0.7447916613737253, 'train/certain_ratio_ema': 0.6927805896408135, 'train/total_loss': tensor(0.2418, device='cuda:0'), 'train/mask_ratio': tensor(0.7121, device='cuda:0'), 'lr': 0.029968433093775056, 'train/prefecth_time': 0.022478080749511718, 'train/run_time': 0.5702755737304688, 'eval/loss': tensor(3.4105, device='cuda:0'), 'eval/top-1-acc': 0.577, 'eval/top-5-acc': 0.942375, 'eval/precision': 0.5630146147589103, 'eval/recall': 0.5770000000000001, 'eval/F1': 0.5515057630181193, 'eval/AUC': 0.8934885156250001}, BEST_EVAL_ACC: 0.577, at 35000 iters
[2023-07-29 19:40:36,017 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 20:31:39,630 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 20:31:49,574 INFO] confusion matrix:
[[0.8325  0.00125 0.02625 0.005   0.0025  0.      0.0025  0.      0.09625
  0.03375]
 [0.21125 0.4175  0.      0.07125 0.05    0.02875 0.02375 0.1475  0.0475
  0.0025 ]
 [0.04    0.      0.89375 0.      0.      0.      0.0025  0.00375 0.00375
  0.05625]
 [0.0175  0.3425  0.00125 0.24875 0.1125  0.085   0.05125 0.12125 0.00125
  0.01875]
 [0.00625 0.02    0.      0.0075  0.815   0.02375 0.07125 0.04625 0.005
  0.005  ]
 [0.015   0.2025  0.      0.04375 0.18625 0.23625 0.2375  0.05625 0.01375
  0.00875]
 [0.01875 0.01875 0.0025  0.0025  0.13625 0.08625 0.705   0.01875 0.0025
  0.00875]
 [0.01625 0.2     0.      0.05    0.07375 0.175   0.02625 0.43125 0.01
  0.0175 ]
 [0.01625 0.      0.01    0.00125 0.      0.      0.      0.      0.93
  0.0425 ]
 [0.02    0.00125 0.535   0.0025  0.      0.      0.      0.0025  0.0225
  0.41625]]
[2023-07-29 20:31:49,581 INFO] 40000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.5934e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1303, device='cuda:0'), 'train/shrink_loss': tensor(0.0883, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0617, device='cuda:0'), 'train/removed_class_idx': 2.456521561121626, 'train/uncertainty_avg': 0.7564212075582363, 'train/certain_ratio_ema': 0.6989618848742832, 'train/total_loss': tensor(0.1921, device='cuda:0'), 'train/mask_ratio': tensor(0.6920, device='cuda:0'), 'lr': 0.029958772263417244, 'train/prefecth_time': 0.019710527420043946, 'train/run_time': 0.5719183959960937, 'eval/loss': tensor(3.2302, device='cuda:0'), 'eval/top-1-acc': 0.592625, 'eval/top-5-acc': 0.9495, 'eval/precision': 0.5846287747431212, 'eval/recall': 0.592625, 'eval/F1': 0.5710512138669499, 'eval/AUC': 0.9009899218750002}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-29 20:31:49,816 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-29 21:22:42,973 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 21:23:04,245 INFO] confusion matrix:
[[0.795   0.0025  0.03125 0.005   0.0025  0.      0.00375 0.      0.12375
  0.03625]
 [0.25375 0.38    0.      0.06875 0.07    0.035   0.02    0.115   0.0525
  0.005  ]
 [0.035   0.      0.90375 0.      0.      0.      0.00375 0.0025  0.00375
  0.05125]
 [0.0225  0.35875 0.      0.23125 0.1175  0.095   0.0775  0.07125 0.0075
  0.01875]
 [0.00375 0.025   0.      0.00875 0.83    0.02375 0.07375 0.02625 0.00375
  0.005  ]
 [0.0125  0.2     0.      0.0425  0.19625 0.235   0.2675  0.02875 0.0125
  0.005  ]
 [0.01625 0.0175  0.00375 0.005   0.1175  0.075   0.74875 0.0075  0.0025
  0.00625]
 [0.02125 0.19875 0.      0.03875 0.1025  0.2475  0.0325  0.335   0.0075
  0.01625]
 [0.01125 0.      0.0075  0.00125 0.      0.      0.      0.      0.94375
  0.03625]
 [0.0125  0.00125 0.53375 0.0025  0.      0.      0.      0.00375 0.025
  0.42125]]
[2023-07-29 21:23:04,251 INFO] 45000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1653, device='cuda:0'), 'train/shrink_loss': tensor(0.0650, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0458, device='cuda:0'), 'train/removed_class_idx': 2.6015035637967245, 'train/uncertainty_avg': 0.7286020509555197, 'train/certain_ratio_ema': 0.7042126606147053, 'train/total_loss': tensor(0.2113, device='cuda:0'), 'train/mask_ratio': tensor(0.7031, device='cuda:0'), 'lr': 0.029947824610993785, 'train/prefecth_time': 0.01851705551147461, 'train/run_time': 0.5747627563476563, 'eval/loss': tensor(3.3883, device='cuda:0'), 'eval/top-1-acc': 0.582375, 'eval/top-5-acc': 0.94825, 'eval/precision': 0.5760800780804867, 'eval/recall': 0.582375, 'eval/F1': 0.5575111208699715, 'eval/AUC': 0.8963015798611111}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-29 22:13:34,659 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 22:13:44,831 INFO] confusion matrix:
[[0.7375  0.00125 0.0225  0.0025  0.00125 0.      0.005   0.      0.105
  0.125  ]
 [0.27125 0.3525  0.      0.06875 0.0725  0.0475  0.01375 0.11125 0.06125
  0.00125]
 [0.0275  0.      0.915   0.      0.      0.      0.0025  0.00375 0.0025
  0.04875]
 [0.02625 0.355   0.00125 0.23375 0.11625 0.11125 0.07875 0.07    0.005
  0.0025 ]
 [0.005   0.02    0.00125 0.01    0.85    0.015   0.07    0.025   0.00375
  0.     ]
 [0.0375  0.1775  0.      0.03375 0.15    0.195   0.3125  0.06875 0.025
  0.     ]
 [0.02125 0.01125 0.00375 0.00375 0.07625 0.05    0.8     0.02375 0.005
  0.005  ]
 [0.01875 0.20875 0.      0.04375 0.09    0.29125 0.0375  0.30125 0.00875
  0.     ]
 [0.005   0.      0.0025  0.00125 0.00125 0.      0.      0.      0.945
  0.045  ]
 [0.01125 0.00125 0.53875 0.0025  0.      0.      0.0025  0.00375 0.0225
  0.4175 ]]
[2023-07-29 22:13:44,843 INFO] 50000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1851, device='cuda:0'), 'train/shrink_loss': tensor(0.0781, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0550, device='cuda:0'), 'train/removed_class_idx': 2.547445069529557, 'train/uncertainty_avg': 0.7564080038191608, 'train/certain_ratio_ema': 0.7041320454668796, 'train/total_loss': tensor(0.2406, device='cuda:0'), 'train/mask_ratio': tensor(0.6942, device='cuda:0'), 'lr': 0.029935590606740264, 'train/prefecth_time': 0.030683744430541993, 'train/run_time': 0.5883152465820313, 'eval/loss': tensor(3.5356, device='cuda:0'), 'eval/top-1-acc': 0.57475, 'eval/top-5-acc': 0.942625, 'eval/precision': 0.5595462576811553, 'eval/recall': 0.5747500000000001, 'eval/F1': 0.5470171272309936, 'eval/AUC': 0.8892339322916666}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-29 23:04:21,459 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 23:04:31,662 INFO] confusion matrix:
[[0.6325  0.00125 0.01625 0.00125 0.00125 0.      0.00375 0.      0.08125
  0.2625 ]
 [0.24625 0.37375 0.      0.075   0.0675  0.0425  0.01375 0.1275  0.0525
  0.00125]
 [0.03125 0.      0.92875 0.      0.      0.      0.      0.00375 0.0025
  0.03375]
 [0.03375 0.29375 0.00125 0.26875 0.09375 0.11125 0.075   0.11375 0.005
  0.00375]
 [0.00375 0.0175  0.00125 0.0175  0.85125 0.01625 0.0675  0.0225  0.0025
  0.     ]
 [0.03125 0.12    0.      0.04375 0.15625 0.23125 0.2675  0.13625 0.01375
  0.     ]
 [0.02    0.00875 0.00375 0.0125  0.08    0.0675  0.77375 0.0275  0.00375
  0.0025 ]
 [0.0175  0.18375 0.      0.05625 0.08125 0.2925  0.05125 0.315   0.0025
  0.     ]
 [0.01    0.      0.00375 0.00375 0.      0.      0.      0.      0.94
  0.0425 ]
 [0.01625 0.00125 0.57    0.00625 0.      0.      0.00125 0.0025  0.02
  0.3825 ]]
[2023-07-29 23:04:31,669 INFO] 55000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.2044, device='cuda:0'), 'train/shrink_loss': tensor(0.0869, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0616, device='cuda:0'), 'train/removed_class_idx': 2.6099288929128446, 'train/uncertainty_avg': 0.7390058281638926, 'train/certain_ratio_ema': 0.7091356148851913, 'train/total_loss': tensor(0.2661, device='cuda:0'), 'train/mask_ratio': tensor(0.6853, device='cuda:0'), 'lr': 0.02992207077614505, 'train/prefecth_time': 0.03701430511474609, 'train/run_time': 0.5751015014648437, 'eval/loss': tensor(3.6604, device='cuda:0'), 'eval/top-1-acc': 0.56975, 'eval/top-5-acc': 0.94325, 'eval/precision': 0.5486024097211704, 'eval/recall': 0.56975, 'eval/F1': 0.5458211553027714, 'eval/AUC': 0.8847558854166668}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-29 23:54:57,307 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-29 23:55:07,153 INFO] confusion matrix:
[[0.6275  0.00125 0.015   0.0025  0.0025  0.      0.00375 0.      0.08
  0.2675 ]
 [0.2425  0.4075  0.      0.0825  0.07625 0.04625 0.01125 0.0775  0.055
  0.00125]
 [0.0325  0.      0.91375 0.0025  0.      0.      0.      0.00125 0.0025
  0.0475 ]
 [0.02375 0.3125  0.      0.2375  0.1125  0.15    0.07875 0.08    0.0025
  0.0025 ]
 [0.00375 0.01375 0.00125 0.0225  0.86125 0.015   0.06375 0.015   0.00375
  0.     ]
 [0.025   0.125   0.      0.03625 0.18625 0.1925  0.265   0.16    0.01
  0.     ]
 [0.02    0.01125 0.005   0.015   0.10375 0.04875 0.77    0.0225  0.0025
  0.00125]
 [0.02125 0.1975  0.      0.09125 0.08625 0.30125 0.045   0.25625 0.00125
  0.     ]
 [0.00875 0.      0.0025  0.00375 0.00125 0.      0.      0.      0.94875
  0.035  ]
 [0.015   0.00125 0.585   0.00625 0.      0.      0.00125 0.00125 0.0225
  0.3675 ]]
[2023-07-29 23:55:07,161 INFO] 60000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1133, device='cuda:0'), 'train/shrink_loss': tensor(0.1045, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0748, device='cuda:0'), 'train/removed_class_idx': 2.428571255102053, 'train/uncertainty_avg': 0.7473662779215171, 'train/certain_ratio_ema': 0.7163536991435855, 'train/total_loss': tensor(0.1886, device='cuda:0'), 'train/mask_ratio': tensor(0.6875, device='cuda:0'), 'lr': 0.029907265699926754, 'train/prefecth_time': 0.02176233673095703, 'train/run_time': 0.56804638671875, 'eval/loss': tensor(3.8883, device='cuda:0'), 'eval/top-1-acc': 0.55825, 'eval/top-5-acc': 0.942875, 'eval/precision': 0.5317155553472491, 'eval/recall': 0.5582499999999999, 'eval/F1': 0.5308071277554876, 'eval/AUC': 0.8774029427083332}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-30 00:45:26,903 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 00:45:36,628 INFO] confusion matrix:
[[0.6225  0.      0.01125 0.00375 0.0025  0.      0.0025  0.      0.07375
  0.28375]
 [0.24625 0.40375 0.      0.1025  0.07375 0.0325  0.01    0.07625 0.05375
  0.00125]
 [0.03125 0.      0.9225  0.0025  0.      0.      0.      0.00125 0.00375
  0.03875]
 [0.03    0.33    0.00125 0.2675  0.135   0.1225  0.05875 0.04875 0.0025
  0.00375]
 [0.005   0.01125 0.      0.03    0.87375 0.015   0.0475  0.01125 0.005
  0.00125]
 [0.04    0.165   0.      0.04125 0.1875  0.20875 0.255   0.0925  0.01
  0.     ]
 [0.02    0.01375 0.00375 0.01375 0.0825  0.055   0.78875 0.01875 0.0025
  0.00125]
 [0.025   0.19375 0.      0.08125 0.11    0.265   0.03125 0.29125 0.0025
  0.     ]
 [0.005   0.      0.00125 0.00375 0.      0.      0.      0.      0.945
  0.045  ]
 [0.01375 0.00125 0.5625  0.0075  0.      0.      0.00125 0.0025  0.0225
  0.38875]]
[2023-07-30 00:45:36,634 INFO] 65000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1224, device='cuda:0'), 'train/shrink_loss': tensor(0.0647, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0462, device='cuda:0'), 'train/removed_class_idx': 2.634146127305193, 'train/uncertainty_avg': 0.735567079129414, 'train/certain_ratio_ema': 0.7149895924795956, 'train/total_loss': tensor(0.1689, device='cuda:0'), 'train/mask_ratio': tensor(0.7254, device='cuda:0'), 'lr': 0.029891176014009247, 'train/prefecth_time': 0.021114784240722655, 'train/run_time': 0.5877227172851562, 'eval/loss': tensor(3.6921, device='cuda:0'), 'eval/top-1-acc': 0.57125, 'eval/top-5-acc': 0.94575, 'eval/precision': 0.5501101863782936, 'eval/recall': 0.57125, 'eval/F1': 0.5456192846594471, 'eval/AUC': 0.8831624131944443}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-30 01:35:51,990 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 01:36:02,337 INFO] confusion matrix:
[[0.61875 0.      0.00875 0.0025  0.0025  0.      0.00125 0.      0.07625
  0.29   ]
 [0.285   0.34875 0.      0.06625 0.055   0.05125 0.01    0.13    0.0525
  0.00125]
 [0.02875 0.      0.905   0.0025  0.      0.      0.00125 0.00125 0.0025
  0.05875]
 [0.0125  0.34625 0.      0.2325  0.10375 0.16875 0.06375 0.06625 0.00375
  0.0025 ]
 [0.005   0.01375 0.      0.02375 0.87125 0.01625 0.0475  0.0175  0.005
  0.     ]
 [0.0175  0.2075  0.      0.0475  0.16125 0.22875 0.2875  0.0375  0.01125
  0.00125]
 [0.01875 0.01375 0.0025  0.01375 0.09125 0.05    0.7925  0.01125 0.005
  0.00125]
 [0.015   0.1975  0.      0.0625  0.0775  0.25375 0.04    0.34875 0.005
  0.     ]
 [0.005   0.      0.0025  0.00375 0.      0.      0.      0.      0.9525
  0.03625]
 [0.01125 0.00125 0.58875 0.00875 0.      0.      0.00125 0.00125 0.02125
  0.36625]]
[2023-07-30 01:36:02,343 INFO] 70000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0012, device='cuda:0'), 'train/certain_loss': tensor(0.1340, device='cuda:0'), 'train/shrink_loss': tensor(0.0834, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0604, device='cuda:0'), 'train/removed_class_idx': 2.4596772209937723, 'train/uncertainty_avg': 0.7513562731412798, 'train/certain_ratio_ema': 0.7232660120890952, 'train/total_loss': tensor(0.1956, device='cuda:0'), 'train/mask_ratio': tensor(0.7232, device='cuda:0'), 'lr': 0.02987380240949439, 'train/prefecth_time': 0.01936502456665039, 'train/run_time': 0.568907958984375, 'eval/loss': tensor(3.8292, device='cuda:0'), 'eval/top-1-acc': 0.5665, 'eval/top-5-acc': 0.954125, 'eval/precision': 0.5483247797461864, 'eval/recall': 0.5664999999999999, 'eval/F1': 0.5424068367177826, 'eval/AUC': 0.8800406684027777}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-30 02:26:31,108 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 02:26:41,175 INFO] confusion matrix:
[[0.595   0.00125 0.01625 0.      0.0025  0.      0.0025  0.      0.1075
  0.275  ]
 [0.3125  0.32875 0.      0.08125 0.04875 0.05875 0.01    0.09375 0.065
  0.00125]
 [0.0325  0.      0.92375 0.0025  0.      0.      0.      0.00125 0.0025
  0.0375 ]
 [0.02625 0.37125 0.00125 0.2025  0.10125 0.19125 0.05875 0.04125 0.00375
  0.0025 ]
 [0.005   0.015   0.      0.04375 0.86875 0.01375 0.03875 0.01    0.005
  0.     ]
 [0.03    0.22125 0.      0.105   0.215   0.16625 0.23375 0.0175  0.01125
  0.     ]
 [0.02625 0.0125  0.005   0.02125 0.15    0.04875 0.7225  0.00625 0.005
  0.0025 ]
 [0.0275  0.19    0.      0.20375 0.07125 0.2     0.02625 0.27    0.01
  0.00125]
 [0.00375 0.      0.0075  0.00375 0.      0.      0.      0.      0.9525
  0.0325 ]
 [0.01875 0.00125 0.59375 0.005   0.      0.      0.00125 0.00125 0.02125
  0.3575 ]]
[2023-07-30 02:26:41,182 INFO] 75000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0015, device='cuda:0'), 'train/certain_loss': tensor(0.1518, device='cuda:0'), 'train/shrink_loss': tensor(0.0838, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0600, device='cuda:0'), 'train/removed_class_idx': 2.5042732902330522, 'train/uncertainty_avg': 0.7488935344527492, 'train/certain_ratio_ema': 0.7159639280721467, 'train/total_loss': tensor(0.2133, device='cuda:0'), 'train/mask_ratio': tensor(0.7388, device='cuda:0'), 'lr': 0.029855145632632304, 'train/prefecth_time': 0.02009017562866211, 'train/run_time': 0.55759423828125, 'eval/loss': tensor(3.9830, device='cuda:0'), 'eval/top-1-acc': 0.53875, 'eval/top-5-acc': 0.942625, 'eval/precision': 0.5161627039458824, 'eval/recall': 0.5387500000000001, 'eval/F1': 0.5108173554748301, 'eval/AUC': 0.8710503645833332}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-30 03:16:59,682 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 03:17:09,320 INFO] confusion matrix:
[[0.64625 0.00125 0.00875 0.      0.0025  0.      0.0025  0.      0.0575
  0.28125]
 [0.25625 0.42375 0.      0.05625 0.05125 0.05125 0.01375 0.0925  0.05375
  0.00125]
 [0.0125  0.      0.905   0.0025  0.      0.      0.      0.00125 0.0025
  0.07625]
 [0.0575  0.33125 0.00125 0.175   0.12    0.18875 0.07    0.05125 0.00125
  0.00375]
 [0.0075  0.0125  0.      0.02    0.8775  0.01375 0.05    0.01375 0.00375
  0.00125]
 [0.0975  0.15625 0.00125 0.025   0.1725  0.2     0.295   0.03875 0.01375
  0.     ]
 [0.02625 0.01375 0.0075  0.01    0.09875 0.05    0.77375 0.01125 0.00375
  0.005  ]
 [0.02875 0.20375 0.      0.06875 0.07    0.235   0.045   0.34375 0.005
  0.     ]
 [0.005   0.      0.0025  0.00375 0.      0.      0.      0.      0.945
  0.04375]
 [0.01    0.00125 0.5825  0.0025  0.      0.      0.      0.00125 0.0175
  0.385  ]]
[2023-07-30 03:17:09,328 INFO] 80000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.7932e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1092, device='cuda:0'), 'train/shrink_loss': tensor(0.0909, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0654, device='cuda:0'), 'train/removed_class_idx': 2.463235112997418, 'train/uncertainty_avg': 0.7643106806672435, 'train/certain_ratio_ema': 0.720346491882436, 'train/total_loss': tensor(0.1747, device='cuda:0'), 'train/mask_ratio': tensor(0.6964, device='cuda:0'), 'lr': 0.029835206484789344, 'train/prefecth_time': 0.025445215225219725, 'train/run_time': 0.5761818237304688, 'eval/loss': tensor(3.8045, device='cuda:0'), 'eval/top-1-acc': 0.5675, 'eval/top-5-acc': 0.9355, 'eval/precision': 0.5494194003181132, 'eval/recall': 0.5675000000000001, 'eval/F1': 0.5395934784544114, 'eval/AUC': 0.8793954427083334}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-30 04:07:18,423 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 04:07:27,961 INFO] confusion matrix:
[[0.665   0.00125 0.00875 0.      0.0025  0.      0.0025  0.      0.0525
  0.2675 ]
 [0.2275  0.455   0.      0.08    0.0425  0.03625 0.0125  0.09125 0.05375
  0.00125]
 [0.025   0.      0.86375 0.00125 0.      0.      0.      0.00125 0.0025
  0.10625]
 [0.03375 0.35    0.00375 0.2575  0.08125 0.15625 0.06    0.04875 0.005
  0.00375]
 [0.00625 0.02    0.      0.0425  0.865   0.01    0.03625 0.01625 0.00375
  0.     ]
 [0.05375 0.18    0.00125 0.0625  0.15375 0.23625 0.265   0.03625 0.01125
  0.     ]
 [0.02375 0.0175  0.005   0.0125  0.09875 0.045   0.79    0.0025  0.0025
  0.0025 ]
 [0.035   0.21375 0.      0.10875 0.0575  0.1625  0.03875 0.3775  0.00625
  0.     ]
 [0.0025  0.      0.0025  0.00375 0.      0.      0.      0.      0.95125
  0.04   ]
 [0.01125 0.00125 0.5725  0.00125 0.      0.      0.      0.00125 0.01625
  0.39625]]
[2023-07-30 04:07:27,967 INFO] 85000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1719, device='cuda:0'), 'train/shrink_loss': tensor(0.0590, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0426, device='cuda:0'), 'train/removed_class_idx': 2.3584903435386466, 'train/uncertainty_avg': 0.7661327199352568, 'train/certain_ratio_ema': 0.7222675044210076, 'train/total_loss': tensor(0.2146, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.029813985822413673, 'train/prefecth_time': 0.020992544174194334, 'train/run_time': 0.5529627075195312, 'eval/loss': tensor(3.4726, device='cuda:0'), 'eval/top-1-acc': 0.58575, 'eval/top-5-acc': 0.946875, 'eval/precision': 0.5713303288651904, 'eval/recall': 0.58575, 'eval/F1': 0.5650263451520152, 'eval/AUC': 0.8905419270833334}, BEST_EVAL_ACC: 0.592625, at 40000 iters
[2023-07-30 04:57:42,572 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 04:57:52,500 INFO] confusion matrix:
[[0.66875 0.      0.01    0.0025  0.0025  0.      0.00125 0.      0.04875
  0.26625]
 [0.22875 0.46    0.      0.0875  0.04125 0.02125 0.00875 0.0975  0.05375
  0.00125]
 [0.03    0.      0.81375 0.00125 0.      0.      0.00125 0.00125 0.0025
  0.15   ]
 [0.04875 0.33125 0.00125 0.23125 0.0925  0.16125 0.06625 0.06125 0.0025
  0.00375]
 [0.005   0.01625 0.      0.02    0.88875 0.0125  0.03375 0.02    0.00375
  0.     ]
 [0.04    0.1175  0.00125 0.035   0.1425  0.34875 0.265   0.03875 0.01125
  0.     ]
 [0.02375 0.01375 0.00625 0.00625 0.09875 0.0475  0.7925  0.00875 0.00125
  0.00125]
 [0.03375 0.215   0.      0.0525  0.05875 0.085   0.04375 0.50625 0.005
  0.     ]
 [0.00625 0.      0.0025  0.00375 0.      0.      0.      0.      0.95625
  0.03125]
 [0.01375 0.00125 0.5525  0.00125 0.      0.      0.      0.00125 0.01875
  0.41125]]
[2023-07-30 04:57:52,507 INFO] 90000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1432, device='cuda:0'), 'train/shrink_loss': tensor(0.0760, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0549, device='cuda:0'), 'train/removed_class_idx': 2.508196515721597, 'train/uncertainty_avg': 0.7412603840169086, 'train/certain_ratio_ema': 0.7229286602705683, 'train/total_loss': tensor(0.1983, device='cuda:0'), 'train/mask_ratio': tensor(0.7277, device='cuda:0'), 'lr': 0.02979148455699847, 'train/prefecth_time': 0.01840470314025879, 'train/run_time': 0.5684840087890625, 'eval/loss': tensor(3.2624, device='cuda:0'), 'eval/top-1-acc': 0.60775, 'eval/top-5-acc': 0.959625, 'eval/precision': 0.5988128705351949, 'eval/recall': 0.60775, 'eval/F1': 0.5897466493527976, 'eval/AUC': 0.8990226649305554}, BEST_EVAL_ACC: 0.60775, at 90000 iters
[2023-07-30 04:57:54,396 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 05:48:06,691 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 05:48:18,076 INFO] confusion matrix:
[[0.67625 0.      0.01125 0.00125 0.0025  0.      0.00125 0.      0.03875
  0.26875]
 [0.2225  0.45625 0.      0.08875 0.03375 0.04125 0.00875 0.09875 0.0475
  0.0025 ]
 [0.035   0.      0.895   0.00125 0.      0.      0.      0.00125 0.0025
  0.065  ]
 [0.02875 0.34625 0.      0.245   0.08875 0.15875 0.07    0.055   0.00375
  0.00375]
 [0.00625 0.02    0.      0.0225  0.8825  0.0075  0.045   0.015   0.00125
  0.     ]
 [0.01625 0.12125 0.      0.035   0.135   0.39875 0.25625 0.0275  0.01
  0.     ]
 [0.01875 0.01625 0.00375 0.00625 0.10875 0.05375 0.78125 0.0075  0.0025
  0.00125]
 [0.0125  0.23125 0.      0.07625 0.0625  0.16625 0.035   0.4125  0.00375
  0.     ]
 [0.00375 0.      0.0025  0.00375 0.      0.      0.      0.      0.95375
  0.03625]
 [0.0125  0.00125 0.56375 0.00125 0.      0.      0.00125 0.00125 0.02
  0.39875]]
[2023-07-30 05:48:18,088 INFO] 95000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1374, device='cuda:0'), 'train/shrink_loss': tensor(0.0720, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0524, device='cuda:0'), 'train/removed_class_idx': 2.4239998060800154, 'train/uncertainty_avg': 0.7645652249942974, 'train/certain_ratio_ema': 0.7277144740267139, 'train/total_loss': tensor(0.1900, device='cuda:0'), 'train/mask_ratio': tensor(0.7210, device='cuda:0'), 'lr': 0.029767703655042783, 'train/prefecth_time': 0.018645824432373045, 'train/run_time': 0.5634100341796875, 'eval/loss': tensor(3.3076, device='cuda:0'), 'eval/top-1-acc': 0.61, 'eval/top-5-acc': 0.965375, 'eval/precision': 0.6019384309072093, 'eval/recall': 0.6100000000000001, 'eval/F1': 0.591949530427458, 'eval/AUC': 0.8980652517361111}, BEST_EVAL_ACC: 0.61, at 95000 iters
[2023-07-30 05:48:19,699 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 06:38:12,967 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 06:38:23,880 INFO] confusion matrix:
[[0.68125 0.      0.0075  0.00125 0.0025  0.00125 0.0025  0.      0.03625
  0.2675 ]
 [0.23375 0.46    0.      0.08625 0.02625 0.02625 0.01125 0.10625 0.04875
  0.00125]
 [0.0325  0.      0.91375 0.      0.      0.      0.      0.0025  0.0025
  0.04875]
 [0.02    0.2325  0.      0.265   0.0825  0.24125 0.06875 0.085   0.0025
  0.0025 ]
 [0.00375 0.01875 0.      0.01875 0.87125 0.01375 0.0475  0.025   0.00125
  0.     ]
 [0.01125 0.05    0.      0.03875 0.13375 0.4525  0.2675  0.0375  0.00875
  0.     ]
 [0.02    0.01125 0.0025  0.00625 0.0925  0.04375 0.81375 0.0075  0.0025
  0.     ]
 [0.0225  0.23    0.      0.075   0.045   0.09375 0.04375 0.48875 0.00125
  0.     ]
 [0.0025  0.      0.0025  0.00375 0.      0.      0.      0.      0.9625
  0.02875]
 [0.01375 0.00125 0.58875 0.0025  0.      0.      0.      0.00125 0.02125
  0.37125]]
[2023-07-30 06:38:23,887 INFO] 100000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.5613e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1314, device='cuda:0'), 'train/shrink_loss': tensor(0.0851, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0625, device='cuda:0'), 'train/removed_class_idx': 2.5041320244518985, 'train/uncertainty_avg': 0.75063949875772, 'train/certain_ratio_ema': 0.733583321885086, 'train/total_loss': tensor(0.1939, device='cuda:0'), 'train/mask_ratio': tensor(0.7299, device='cuda:0'), 'lr': 0.029742644138010012, 'train/prefecth_time': 0.018488767623901368, 'train/run_time': 0.5632349853515625, 'eval/loss': tensor(3.2450, device='cuda:0'), 'eval/top-1-acc': 0.628, 'eval/top-5-acc': 0.965625, 'eval/precision': 0.6159395065163346, 'eval/recall': 0.628, 'eval/F1': 0.60966008455151, 'eval/AUC': 0.9020616840277778}, BEST_EVAL_ACC: 0.628, at 100000 iters
[2023-07-30 06:38:25,600 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 07:28:28,757 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 07:28:39,087 INFO] confusion matrix:
[[0.68625 0.      0.0075  0.0025  0.00125 0.00125 0.0025  0.      0.04
  0.25875]
 [0.2325  0.46125 0.      0.0975  0.02875 0.0375  0.00625 0.08125 0.05375
  0.00125]
 [0.0275  0.      0.9075  0.0025  0.      0.      0.      0.00125 0.0025
  0.05875]
 [0.0175  0.2625  0.      0.25    0.0775  0.2775  0.0575  0.05    0.005
  0.0025 ]
 [0.00125 0.015   0.      0.0225  0.885   0.01875 0.045   0.01    0.0025
  0.     ]
 [0.0075  0.0625  0.      0.02625 0.14625 0.4775  0.2325  0.0325  0.015
  0.     ]
 [0.01375 0.0125  0.0025  0.0075  0.11    0.05    0.79375 0.00875 0.00125
  0.     ]
 [0.01125 0.22375 0.      0.08    0.05375 0.0675  0.02875 0.53    0.005
  0.     ]
 [0.0025  0.      0.0025  0.00375 0.      0.      0.      0.      0.9625
  0.02875]
 [0.01    0.00125 0.5775  0.00125 0.      0.      0.      0.00125 0.01875
  0.39   ]]
[2023-07-30 07:28:39,093 INFO] 105000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.2350e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1239, device='cuda:0'), 'train/shrink_loss': tensor(0.0941, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0691, device='cuda:0'), 'train/removed_class_idx': 2.355932003734576, 'train/uncertainty_avg': 0.7429394221181831, 'train/certain_ratio_ema': 0.7345446663953572, 'train/total_loss': tensor(0.1930, device='cuda:0'), 'train/mask_ratio': tensor(0.7366, device='cuda:0'), 'lr': 0.02971630708228403, 'train/prefecth_time': 0.018398719787597655, 'train/run_time': 0.5811676025390625, 'eval/loss': tensor(3.1827, device='cuda:0'), 'eval/top-1-acc': 0.634375, 'eval/top-5-acc': 0.96525, 'eval/precision': 0.6247683809477939, 'eval/recall': 0.634375, 'eval/F1': 0.6173453503333344, 'eval/AUC': 0.9046184288194445}, BEST_EVAL_ACC: 0.634375, at 105000 iters
[2023-07-30 07:28:41,163 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 08:18:39,551 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 08:18:49,597 INFO] confusion matrix:
[[0.88    0.      0.00875 0.00375 0.00125 0.00125 0.00125 0.      0.04
  0.06375]
 [0.22875 0.4575  0.      0.08125 0.035   0.03875 0.00875 0.105   0.045
  0.     ]
 [0.0225  0.      0.91875 0.00125 0.      0.      0.      0.00125 0.0025
  0.05375]
 [0.01    0.26    0.      0.24875 0.0975  0.2375  0.06375 0.07625 0.00375
  0.0025 ]
 [0.00125 0.01625 0.      0.01875 0.88625 0.02    0.04375 0.0125  0.00125
  0.     ]
 [0.0075  0.055   0.      0.0225  0.12625 0.50125 0.2425  0.035   0.01
  0.     ]
 [0.0125  0.0125  0.0025  0.00875 0.11    0.05    0.79375 0.0075  0.00125
  0.00125]
 [0.01375 0.2225  0.      0.05375 0.06125 0.07375 0.0275  0.54375 0.00375
  0.     ]
 [0.00375 0.      0.00125 0.00375 0.      0.      0.      0.      0.97875
  0.0125 ]
 [0.00875 0.00125 0.58375 0.00125 0.      0.      0.00375 0.00125 0.01625
  0.38375]]
[2023-07-30 08:18:49,604 INFO] 110000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.0916, device='cuda:0'), 'train/shrink_loss': tensor(0.0753, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0554, device='cuda:0'), 'train/removed_class_idx': 2.4319998054400154, 'train/uncertainty_avg': 0.746084339774999, 'train/certain_ratio_ema': 0.7360761269516662, 'train/total_loss': tensor(0.1472, device='cuda:0'), 'train/mask_ratio': tensor(0.7210, device='cuda:0'), 'lr': 0.029688693619122967, 'train/prefecth_time': 0.020235071182250975, 'train/run_time': 0.5653318481445313, 'eval/loss': tensor(2.9545, device='cuda:0'), 'eval/top-1-acc': 0.65925, 'eval/top-5-acc': 0.96725, 'eval/precision': 0.6563670237414517, 'eval/recall': 0.6592499999999999, 'eval/F1': 0.6390901410059421, 'eval/AUC': 0.9125054427083336}, BEST_EVAL_ACC: 0.65925, at 110000 iters
[2023-07-30 08:18:52,027 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 09:08:43,807 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 09:08:54,723 INFO] confusion matrix:
[[0.92125 0.      0.01    0.00125 0.00125 0.      0.00125 0.      0.03625
  0.02875]
 [0.2475  0.44125 0.      0.11375 0.02625 0.0375  0.01375 0.08625 0.03375
  0.     ]
 [0.0225  0.      0.92    0.0025  0.      0.      0.      0.00125 0.0025
  0.05125]
 [0.0125  0.26875 0.      0.28    0.06375 0.25    0.06375 0.05625 0.
  0.005  ]
 [0.00125 0.015   0.      0.0225  0.875   0.02375 0.0525  0.00875 0.00125
  0.     ]
 [0.0075  0.05375 0.      0.0225  0.13    0.4925  0.25625 0.03    0.00625
  0.00125]
 [0.00875 0.01    0.0025  0.00375 0.1175  0.06    0.78375 0.0075  0.00125
  0.005  ]
 [0.02375 0.22    0.      0.0425  0.05125 0.0875  0.0375  0.5375  0.
  0.     ]
 [0.0075  0.      0.0025  0.0025  0.      0.00125 0.      0.      0.9775
  0.00875]
 [0.00875 0.00125 0.60625 0.00125 0.      0.      0.      0.00125 0.02
  0.36125]]
[2023-07-30 09:08:54,729 INFO] 115000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0008, device='cuda:0'), 'train/certain_loss': tensor(0.2000, device='cuda:0'), 'train/shrink_loss': tensor(0.0445, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0330, device='cuda:0'), 'train/removed_class_idx': 2.4117644694348557, 'train/uncertainty_avg': 0.7486918737434565, 'train/certain_ratio_ema': 0.7410047241670905, 'train/total_loss': tensor(0.2337, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.029659804934610595, 'train/prefecth_time': 0.019582719802856446, 'train/run_time': 0.5519791870117188, 'eval/loss': tensor(2.9302, device='cuda:0'), 'eval/top-1-acc': 0.659, 'eval/top-5-acc': 0.97225, 'eval/precision': 0.6616813955804532, 'eval/recall': 0.659, 'eval/F1': 0.6396663140905434, 'eval/AUC': 0.9109803559027777}, BEST_EVAL_ACC: 0.65925, at 110000 iters
[2023-07-30 09:59:04,196 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 09:59:14,389 INFO] confusion matrix:
[[0.93125 0.00125 0.0075  0.      0.00125 0.00125 0.00125 0.      0.035
  0.02125]
 [0.1975  0.50125 0.00125 0.09125 0.04125 0.0325  0.01875 0.08375 0.0325
  0.     ]
 [0.01375 0.      0.81    0.0025  0.      0.      0.      0.00125 0.0025
  0.17   ]
 [0.00625 0.21    0.00125 0.385   0.09625 0.1975  0.06375 0.03375 0.
  0.00625]
 [0.      0.01875 0.      0.025   0.885   0.01625 0.045   0.00875 0.00125
  0.     ]
 [0.00625 0.06375 0.00125 0.01875 0.13375 0.4925  0.24625 0.035   0.0025
  0.     ]
 [0.01    0.01125 0.005   0.00625 0.1     0.0525  0.80625 0.005   0.0025
  0.00125]
 [0.00875 0.21625 0.      0.08875 0.06625 0.04625 0.03    0.54375 0.
  0.     ]
 [0.00625 0.      0.00125 0.00375 0.      0.      0.      0.      0.97625
  0.0125 ]
 [0.01125 0.00125 0.5275  0.00125 0.      0.      0.      0.00125 0.01875
  0.43875]]
[2023-07-30 09:59:14,395 INFO] 120000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1814, device='cuda:0'), 'train/shrink_loss': tensor(0.0930, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0683, device='cuda:0'), 'train/removed_class_idx': 2.6846151781065246, 'train/uncertainty_avg': 0.7359739205122295, 'train/certain_ratio_ema': 0.7347152796725108, 'train/total_loss': tensor(0.2499, device='cuda:0'), 'train/mask_ratio': tensor(0.7098, device='cuda:0'), 'lr': 0.029629642269605395, 'train/prefecth_time': 0.024390720367431642, 'train/run_time': 0.5661446533203125, 'eval/loss': tensor(2.5038, device='cuda:0'), 'eval/top-1-acc': 0.677, 'eval/top-5-acc': 0.968, 'eval/precision': 0.6758472902889147, 'eval/recall': 0.677, 'eval/F1': 0.6643950894716898, 'eval/AUC': 0.9305665451388887}, BEST_EVAL_ACC: 0.677, at 120000 iters
[2023-07-30 09:59:16,190 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 10:49:18,375 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 10:49:28,188 INFO] confusion matrix:
[[0.94125 0.00125 0.0075  0.      0.00125 0.      0.00125 0.      0.035
  0.0125 ]
 [0.21375 0.47625 0.      0.095   0.0375  0.0375  0.0175  0.08125 0.03625
  0.005  ]
 [0.005   0.      0.81625 0.00125 0.      0.      0.      0.00125 0.005
  0.17125]
 [0.01    0.29875 0.      0.265   0.07625 0.22125 0.0625  0.04875 0.
  0.0175 ]
 [0.00125 0.015   0.      0.02625 0.89125 0.01875 0.03875 0.0075  0.00125
  0.     ]
 [0.005   0.06125 0.00125 0.0225  0.115   0.5275  0.23375 0.0275  0.00625
  0.     ]
 [0.0075  0.0075  0.0025  0.00625 0.11875 0.065   0.7775  0.00625 0.0025
  0.00625]
 [0.005   0.22375 0.      0.105   0.04625 0.0575  0.01875 0.5275  0.0025
  0.01375]
 [0.0075  0.      0.00125 0.00375 0.      0.      0.      0.      0.975
  0.0125 ]
 [0.00875 0.00125 0.56625 0.00125 0.      0.      0.00375 0.00125 0.02125
  0.39625]]
[2023-07-30 10:49:28,195 INFO] 125000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1807, device='cuda:0'), 'train/shrink_loss': tensor(0.0683, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0501, device='cuda:0'), 'train/removed_class_idx': 2.6542053594200596, 'train/uncertainty_avg': 0.738920364719537, 'train/certain_ratio_ema': 0.7343714953895218, 'train/total_loss': tensor(0.2311, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.02959820691968726, 'train/prefecth_time': 0.019461023330688478, 'train/run_time': 0.5673208618164063, 'eval/loss': tensor(2.7995, device='cuda:0'), 'eval/top-1-acc': 0.659375, 'eval/top-5-acc': 0.956125, 'eval/precision': 0.6519138619209828, 'eval/recall': 0.659375, 'eval/F1': 0.6428552953176584, 'eval/AUC': 0.9156846180555553}, BEST_EVAL_ACC: 0.677, at 120000 iters
[2023-07-30 11:39:19,976 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 11:39:29,920 INFO] confusion matrix:
[[0.9525  0.      0.01    0.00125 0.00125 0.      0.00125 0.      0.02625
  0.0075 ]
 [0.255   0.43125 0.      0.095   0.03375 0.045   0.02125 0.08375 0.02875
  0.00625]
 [0.00875 0.      0.90125 0.0025  0.      0.      0.      0.00125 0.0025
  0.08375]
 [0.00875 0.28    0.      0.27875 0.08375 0.2375  0.05125 0.055   0.00125
  0.00375]
 [0.00375 0.01    0.      0.0225  0.90125 0.01625 0.0375  0.0075  0.00125
  0.     ]
 [0.0075  0.055   0.      0.01625 0.125   0.52875 0.23125 0.03125 0.0025
  0.0025 ]
 [0.005   0.0075  0.00375 0.00875 0.11625 0.055   0.7925  0.00625 0.00125
  0.00375]
 [0.01625 0.21875 0.      0.07875 0.05125 0.05875 0.015   0.56125 0.
  0.     ]
 [0.0075  0.      0.00125 0.00125 0.      0.00125 0.      0.      0.975
  0.01375]
 [0.01125 0.00125 0.5525  0.00125 0.      0.      0.0025  0.00125 0.02
  0.41   ]]
[2023-07-30 11:39:29,930 INFO] 130000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.1525e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1508, device='cuda:0'), 'train/shrink_loss': tensor(0.0523, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0387, device='cuda:0'), 'train/removed_class_idx': 2.3428569197279123, 'train/uncertainty_avg': 0.7419561542331681, 'train/certain_ratio_ema': 0.7404152739022412, 'train/total_loss': tensor(0.1896, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.029565500235101835, 'train/prefecth_time': 0.022378976821899415, 'train/run_time': 0.57471484375, 'eval/loss': tensor(2.7882, device='cuda:0'), 'eval/top-1-acc': 0.67325, 'eval/top-5-acc': 0.96275, 'eval/precision': 0.6719008599669045, 'eval/recall': 0.67325, 'eval/F1': 0.6552843963301694, 'eval/AUC': 0.9174953906250001}, BEST_EVAL_ACC: 0.677, at 120000 iters
[2023-07-30 12:29:39,541 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 12:29:49,336 INFO] confusion matrix:
[[0.95    0.      0.00625 0.00125 0.00125 0.      0.00125 0.      0.03125
  0.00875]
 [0.21    0.4575  0.      0.1375  0.02125 0.0325  0.01    0.08125 0.045
  0.005  ]
 [0.01    0.00125 0.92    0.0025  0.      0.      0.      0.      0.0025
  0.06375]
 [0.00375 0.2375  0.00125 0.3725  0.045   0.19625 0.06625 0.055   0.00125
  0.02125]
 [0.00125 0.01375 0.      0.06125 0.85625 0.0225  0.0325  0.01    0.0025
  0.     ]
 [0.00625 0.05875 0.      0.04875 0.08125 0.50875 0.2525  0.0325  0.0075
  0.00375]
 [0.0075  0.0125  0.00375 0.00375 0.0875  0.05375 0.82    0.005   0.0025
  0.00375]
 [0.01125 0.21    0.      0.065   0.02875 0.0475  0.02875 0.5925  0.00125
  0.015  ]
 [0.00875 0.      0.00125 0.00375 0.      0.      0.      0.      0.97875
  0.0075 ]
 [0.01    0.      0.58375 0.00375 0.      0.      0.00375 0.00125 0.02125
  0.37625]]
[2023-07-30 12:29:49,343 INFO] 135000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0008, device='cuda:0'), 'train/certain_loss': tensor(0.1724, device='cuda:0'), 'train/shrink_loss': tensor(0.0887, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0654, device='cuda:0'), 'train/removed_class_idx': 2.839160640618137, 'train/uncertainty_avg': 0.7114261216394147, 'train/certain_ratio_ema': 0.7372088483885917, 'train/total_loss': tensor(0.2386, device='cuda:0'), 'train/mask_ratio': tensor(0.6808, device='cuda:0'), 'lr': 0.029531523620702535, 'train/prefecth_time': 0.021695487976074217, 'train/run_time': 0.5745460205078124, 'eval/loss': tensor(2.6177, device='cuda:0'), 'eval/top-1-acc': 0.68325, 'eval/top-5-acc': 0.961125, 'eval/precision': 0.6811158050898168, 'eval/recall': 0.6832499999999999, 'eval/F1': 0.6681311569223258, 'eval/AUC': 0.9211287065972225}, BEST_EVAL_ACC: 0.68325, at 135000 iters
[2023-07-30 12:29:51,638 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 13:19:43,070 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 13:20:03,656 INFO] confusion matrix:
[[0.95125 0.      0.00625 0.00125 0.00125 0.      0.0025  0.      0.02625
  0.01125]
 [0.22875 0.455   0.      0.11125 0.035   0.02875 0.015   0.08625 0.03625
  0.00375]
 [0.00875 0.      0.925   0.      0.      0.      0.      0.00375 0.0025
  0.06   ]
 [0.0025  0.2575  0.      0.345   0.0775  0.16125 0.05625 0.095   0.00125
  0.00375]
 [0.      0.01625 0.      0.02125 0.89375 0.0175  0.03125 0.01875 0.00125
  0.     ]
 [0.0025  0.06625 0.      0.02375 0.11125 0.505   0.2475  0.035   0.00625
  0.0025 ]
 [0.005   0.00875 0.0025  0.0025  0.095   0.05875 0.80875 0.0125  0.00125
  0.005  ]
 [0.01    0.2375  0.      0.02375 0.05125 0.0525  0.0175  0.60375 0.0025
  0.00125]
 [0.00875 0.      0.0025  0.      0.00125 0.      0.      0.0025  0.9775
  0.0075 ]
 [0.01    0.      0.575   0.0025  0.      0.      0.00375 0.0025  0.0225
  0.38375]]
[2023-07-30 13:20:03,663 INFO] 140000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1542, device='cuda:0'), 'train/shrink_loss': tensor(0.0835, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0620, device='cuda:0'), 'train/removed_class_idx': 2.5614032840874312, 'train/uncertainty_avg': 0.7482103310505217, 'train/certain_ratio_ema': 0.7426039210000168, 'train/total_loss': tensor(0.2163, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.02949627853589019, 'train/prefecth_time': 0.019320032119750977, 'train/run_time': 0.5688773803710937, 'eval/loss': tensor(2.6679, device='cuda:0'), 'eval/top-1-acc': 0.684875, 'eval/top-5-acc': 0.965125, 'eval/precision': 0.6887012479733021, 'eval/recall': 0.6848750000000001, 'eval/F1': 0.6680121310904161, 'eval/AUC': 0.9210384461805555}, BEST_EVAL_ACC: 0.684875, at 140000 iters
[2023-07-30 13:20:06,722 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 14:09:51,423 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 14:10:01,229 INFO] confusion matrix:
[[0.95625 0.00125 0.0075  0.      0.00125 0.      0.00125 0.      0.02125
  0.01125]
 [0.26375 0.415   0.      0.14625 0.02125 0.03375 0.0125  0.06875 0.03375
  0.005  ]
 [0.01    0.      0.925   0.0025  0.      0.      0.      0.00125 0.0025
  0.05875]
 [0.00875 0.2275  0.      0.41125 0.04875 0.18    0.05625 0.05875 0.00125
  0.0075 ]
 [0.0025  0.00875 0.      0.04875 0.88375 0.01625 0.03    0.00875 0.00125
  0.     ]
 [0.0075  0.0475  0.      0.05375 0.09125 0.525   0.2375  0.03125 0.00375
  0.0025 ]
 [0.0075  0.0125  0.0025  0.005   0.11375 0.06625 0.7775  0.00875 0.0025
  0.00375]
 [0.01375 0.2125  0.      0.085   0.03375 0.04625 0.0175  0.58875 0.
  0.0025 ]
 [0.00875 0.      0.00125 0.00375 0.      0.      0.      0.      0.97875
  0.0075 ]
 [0.01125 0.      0.585   0.00125 0.      0.      0.00125 0.00125 0.0225
  0.3775 ]]
[2023-07-30 14:10:01,235 INFO] 145000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0060, device='cuda:0'), 'train/certain_loss': tensor(0.1707, device='cuda:0'), 'train/shrink_loss': tensor(0.0803, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0593, device='cuda:0'), 'train/removed_class_idx': 2.7343747863769696, 'train/uncertainty_avg': 0.7375784405762664, 'train/certain_ratio_ema': 0.7388484421899763, 'train/total_loss': tensor(0.2361, device='cuda:0'), 'train/mask_ratio': tensor(0.7143, device='cuda:0'), 'lr': 0.02945976649455036, 'train/prefecth_time': 0.018580671310424804, 'train/run_time': 0.58216650390625, 'eval/loss': tensor(2.5605, device='cuda:0'), 'eval/top-1-acc': 0.683875, 'eval/top-5-acc': 0.972625, 'eval/precision': 0.684877706348109, 'eval/recall': 0.683875, 'eval/F1': 0.6689211737604358, 'eval/AUC': 0.9253858767361114}, BEST_EVAL_ACC: 0.684875, at 140000 iters
[2023-07-30 14:59:52,313 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 15:00:02,014 INFO] confusion matrix:
[[0.9525  0.      0.00625 0.00125 0.00125 0.      0.00125 0.      0.03
  0.0075 ]
 [0.2575  0.4275  0.      0.1575  0.02625 0.025   0.015   0.045   0.04
  0.00625]
 [0.01125 0.      0.9225  0.0025  0.      0.      0.      0.00125 0.0025
  0.06   ]
 [0.0125  0.3175  0.      0.33625 0.05875 0.16    0.0575  0.04875 0.00125
  0.0075 ]
 [0.00125 0.0175  0.      0.035   0.89625 0.0125  0.0325  0.00375 0.00125
  0.     ]
 [0.00625 0.07    0.      0.04    0.09875 0.4825  0.25625 0.03875 0.005
  0.0025 ]
 [0.005   0.0125  0.0025  0.00625 0.105   0.05375 0.8025  0.005   0.0025
  0.005  ]
 [0.01375 0.21375 0.      0.1225  0.04125 0.0375  0.015   0.555   0.
  0.00125]
 [0.00625 0.      0.00125 0.0025  0.      0.      0.      0.      0.98125
  0.00875]
 [0.00875 0.      0.59625 0.00125 0.      0.      0.00375 0.00125 0.0275
  0.36125]]
[2023-07-30 15:00:02,021 INFO] 150000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.9896e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1616, device='cuda:0'), 'train/shrink_loss': tensor(0.0768, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0575, device='cuda:0'), 'train/removed_class_idx': 2.5499997875000178, 'train/uncertainty_avg': 0.7540295749877043, 'train/certain_ratio_ema': 0.74946390958954, 'train/total_loss': tensor(0.2192, device='cuda:0'), 'train/mask_ratio': tensor(0.7321, device='cuda:0'), 'lr': 0.029421989064988326, 'train/prefecth_time': 0.03396470260620117, 'train/run_time': 0.578135986328125, 'eval/loss': tensor(2.8138, device='cuda:0'), 'eval/top-1-acc': 0.67175, 'eval/top-5-acc': 0.96325, 'eval/precision': 0.6743701794677311, 'eval/recall': 0.6717500000000001, 'eval/F1': 0.6547920456848243, 'eval/AUC': 0.9168371006944447}, BEST_EVAL_ACC: 0.684875, at 140000 iters
[2023-07-30 15:49:43,750 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 15:49:54,181 INFO] confusion matrix:
[[0.96    0.00125 0.00625 0.      0.00125 0.      0.      0.      0.02125
  0.01   ]
 [0.22625 0.45875 0.      0.16875 0.02875 0.025   0.0075  0.0425  0.03875
  0.00375]
 [0.01125 0.      0.9275  0.00375 0.      0.      0.      0.00125 0.0025
  0.05375]
 [0.005   0.29125 0.      0.375   0.07125 0.17    0.04125 0.03875 0.00125
  0.00625]
 [0.      0.0125  0.      0.045   0.8975  0.015   0.025   0.0025  0.0025
  0.     ]
 [0.00625 0.0675  0.      0.03875 0.07625 0.5425  0.22375 0.0375  0.005
  0.0025 ]
 [0.00625 0.01375 0.0025  0.0125  0.09375 0.055   0.8075  0.00375 0.00125
  0.00375]
 [0.015   0.2075  0.      0.18    0.0325  0.04    0.01    0.51375 0.
  0.00125]
 [0.0075  0.      0.00125 0.0025  0.      0.      0.      0.      0.98125
  0.0075 ]
 [0.00875 0.      0.59125 0.00125 0.      0.      0.0025  0.00125 0.01875
  0.37625]]
[2023-07-30 15:49:54,187 INFO] 155000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.0304e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1647, device='cuda:0'), 'train/shrink_loss': tensor(0.0776, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0582, device='cuda:0'), 'train/removed_class_idx': 2.5666664527777954, 'train/uncertainty_avg': 0.7687552161635344, 'train/certain_ratio_ema': 0.7508120725953762, 'train/total_loss': tensor(0.2230, device='cuda:0'), 'train/mask_ratio': tensor(0.7321, device='cuda:0'), 'lr': 0.029382947869861693, 'train/prefecth_time': 0.018909503936767578, 'train/run_time': 0.5619345703125, 'eval/loss': tensor(2.5956, device='cuda:0'), 'eval/top-1-acc': 0.684, 'eval/top-5-acc': 0.96875, 'eval/precision': 0.6901134206222762, 'eval/recall': 0.6839999999999999, 'eval/F1': 0.6697775328267931, 'eval/AUC': 0.9245384288194444}, BEST_EVAL_ACC: 0.684875, at 140000 iters
[2023-07-30 16:39:43,588 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 16:39:53,976 INFO] confusion matrix:
[[0.965   0.00125 0.00625 0.      0.00125 0.      0.00125 0.      0.01625
  0.00875]
 [0.2525  0.43375 0.      0.155   0.03375 0.03125 0.015   0.0375  0.0375
  0.00375]
 [0.00875 0.      0.93875 0.0025  0.      0.      0.      0.00125 0.0025
  0.04625]
 [0.01375 0.27    0.      0.34625 0.0675  0.205   0.04875 0.0375  0.0025
  0.00875]
 [0.00125 0.01    0.      0.0325  0.90625 0.0175  0.0275  0.00375 0.00125
  0.     ]
 [0.00625 0.055   0.      0.03375 0.07125 0.555   0.23875 0.03    0.0075
  0.0025 ]
 [0.00625 0.00875 0.0025  0.00875 0.08875 0.05375 0.815   0.01    0.0025
  0.00375]
 [0.015   0.21375 0.      0.13375 0.0325  0.05125 0.01125 0.54125 0.
  0.00125]
 [0.00875 0.      0.00125 0.00375 0.      0.      0.      0.      0.97875
  0.0075 ]
 [0.01    0.      0.59375 0.0025  0.      0.      0.      0.00125 0.01875
  0.37375]]
[2023-07-30 16:39:53,999 INFO] 160000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.4690e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1248, device='cuda:0'), 'train/shrink_loss': tensor(0.0739, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0555, device='cuda:0'), 'train/removed_class_idx': 2.353982092567956, 'train/uncertainty_avg': 0.758226548829276, 'train/certain_ratio_ema': 0.7507459409590523, 'train/total_loss': tensor(0.1804, device='cuda:0'), 'train/mask_ratio': tensor(0.7478, device='cuda:0'), 'lr': 0.02934264458611073, 'train/prefecth_time': 0.01808768081665039, 'train/run_time': 0.563211669921875, 'eval/loss': tensor(2.6500, device='cuda:0'), 'eval/top-1-acc': 0.685375, 'eval/top-5-acc': 0.9655, 'eval/precision': 0.6895805682888947, 'eval/recall': 0.685375, 'eval/F1': 0.6690595138300248, 'eval/AUC': 0.9234069010416668}, BEST_EVAL_ACC: 0.685375, at 160000 iters
[2023-07-30 16:39:55,965 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 17:29:33,844 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 17:29:54,270 INFO] confusion matrix:
[[0.96125 0.      0.0075  0.00125 0.00125 0.      0.0025  0.      0.0175
  0.00875]
 [0.24125 0.4325  0.      0.185   0.01875 0.0325  0.0125  0.03375 0.04125
  0.0025 ]
 [0.00625 0.      0.93375 0.00375 0.      0.      0.00625 0.00125 0.00375
  0.045  ]
 [0.0125  0.27875 0.      0.36375 0.07375 0.21125 0.03375 0.0175  0.0025
  0.00625]
 [0.00125 0.0125  0.      0.045   0.905   0.015   0.0175  0.0025  0.00125
  0.     ]
 [0.00625 0.06    0.      0.0425  0.0825  0.5675  0.21875 0.015   0.0075
  0.     ]
 [0.00625 0.01125 0.00375 0.01125 0.11625 0.06    0.78375 0.00375 0.00125
  0.0025 ]
 [0.015   0.2125  0.      0.19875 0.03625 0.055   0.0125  0.46875 0.00125
  0.     ]
 [0.00375 0.      0.0025  0.0025  0.      0.      0.      0.      0.98125
  0.01   ]
 [0.01125 0.      0.545   0.00125 0.      0.      0.0025  0.00125 0.025
  0.41375]]
[2023-07-30 17:29:54,277 INFO] 165000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.2225e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1372, device='cuda:0'), 'train/shrink_loss': tensor(0.0377, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0282, device='cuda:0'), 'train/removed_class_idx': 2.3360653822897226, 'train/uncertainty_avg': 0.776058618064283, 'train/certain_ratio_ema': 0.7479833580203022, 'train/total_loss': tensor(0.1655, device='cuda:0'), 'train/mask_ratio': tensor(0.7277, device='cuda:0'), 'lr': 0.0293010809448863, 'train/prefecth_time': 0.019627071380615233, 'train/run_time': 0.564318603515625, 'eval/loss': tensor(2.6660, device='cuda:0'), 'eval/top-1-acc': 0.681125, 'eval/top-5-acc': 0.9665, 'eval/precision': 0.691080566151188, 'eval/recall': 0.681125, 'eval/F1': 0.6671572329876805, 'eval/AUC': 0.9235754861111111}, BEST_EVAL_ACC: 0.685375, at 160000 iters
[2023-07-30 18:19:39,600 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 18:19:49,547 INFO] confusion matrix:
[[0.9575  0.00125 0.00875 0.      0.00125 0.      0.00125 0.      0.0225
  0.0075 ]
 [0.235   0.44625 0.      0.16875 0.0275  0.0325  0.00625 0.0375  0.04375
  0.0025 ]
 [0.01    0.      0.9575  0.00375 0.      0.      0.0025  0.      0.00375
  0.0225 ]
 [0.005   0.30375 0.      0.3325  0.07375 0.19875 0.03375 0.0425  0.0025
  0.0075 ]
 [0.00125 0.01125 0.      0.04    0.9025  0.01375 0.025   0.00375 0.0025
  0.     ]
 [0.00375 0.05125 0.      0.0325  0.0825  0.575   0.20625 0.04125 0.00625
  0.00125]
 [0.005   0.0125  0.00375 0.0075  0.1325  0.05375 0.7725  0.0075  0.005
  0.     ]
 [0.015   0.205   0.      0.1175  0.04    0.04875 0.00875 0.5625  0.00125
  0.00125]
 [0.00625 0.      0.00125 0.00375 0.      0.      0.      0.      0.98
  0.00875]
 [0.0075  0.00125 0.2875  0.00125 0.      0.      0.      0.00125 0.025
  0.67625]]
[2023-07-30 18:19:49,554 INFO] 170000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0012, device='cuda:0'), 'train/certain_loss': tensor(0.0895, device='cuda:0'), 'train/shrink_loss': tensor(0.0626, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0467, device='cuda:0'), 'train/removed_class_idx': 2.3795618701049728, 'train/uncertainty_avg': 0.775690846138919, 'train/certain_ratio_ema': 0.7458552738928778, 'train/total_loss': tensor(0.1375, device='cuda:0'), 'train/mask_ratio': tensor(0.6942, device='cuda:0'), 'lr': 0.029258258731475556, 'train/prefecth_time': 0.021767168045043944, 'train/run_time': 0.5673971557617188, 'eval/loss': tensor(2.1399, device='cuda:0'), 'eval/top-1-acc': 0.71625, 'eval/top-5-acc': 0.9735, 'eval/precision': 0.7136563160681695, 'eval/recall': 0.7162499999999999, 'eval/F1': 0.7059968140899565, 'eval/AUC': 0.9436859722222221}, BEST_EVAL_ACC: 0.71625, at 170000 iters
[2023-07-30 18:19:51,820 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 19:09:45,814 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 19:09:55,965 INFO] confusion matrix:
[[0.95375 0.      0.0075  0.00125 0.00125 0.      0.0025  0.      0.02375
  0.01   ]
 [0.2675  0.43    0.      0.16625 0.0175  0.03    0.005   0.035   0.04875
  0.     ]
 [0.0075  0.00125 0.94    0.0025  0.      0.      0.      0.      0.00375
  0.045  ]
 [0.0125  0.2525  0.00125 0.395   0.05875 0.18    0.045   0.04625 0.00125
  0.0075 ]
 [0.      0.00875 0.      0.03    0.91375 0.01625 0.02375 0.00625 0.00125
  0.     ]
 [0.0075  0.0525  0.00125 0.035   0.07625 0.56    0.21375 0.04375 0.01
  0.     ]
 [0.0075  0.01125 0.005   0.005   0.09625 0.05875 0.80875 0.005   0.0025
  0.     ]
 [0.01625 0.20125 0.      0.11375 0.03375 0.04625 0.0175  0.57125 0.
  0.     ]
 [0.00875 0.      0.      0.0025  0.      0.      0.      0.      0.97625
  0.0125 ]
 [0.00625 0.      0.18125 0.00125 0.      0.      0.00125 0.00125 0.01375
  0.795  ]]
[2023-07-30 19:09:55,972 INFO] 175000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.3272e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1086, device='cuda:0'), 'train/shrink_loss': tensor(0.0473, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0355, device='cuda:0'), 'train/removed_class_idx': 2.3867922276611107, 'train/uncertainty_avg': 0.7634693122197459, 'train/certain_ratio_ema': 0.7495239857764505, 'train/total_loss': tensor(0.1441, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.029214179785225187, 'train/prefecth_time': 0.019256607055664062, 'train/run_time': 0.554869384765625, 'eval/loss': tensor(1.8800, device='cuda:0'), 'eval/top-1-acc': 0.734375, 'eval/top-5-acc': 0.977375, 'eval/precision': 0.727983494125159, 'eval/recall': 0.734375, 'eval/F1': 0.7248770266826898, 'eval/AUC': 0.9520735850694445}, BEST_EVAL_ACC: 0.734375, at 175000 iters
[2023-07-30 19:09:57,752 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-30 19:59:36,985 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 19:59:58,284 INFO] confusion matrix:
[[0.95    0.      0.01125 0.00125 0.00125 0.      0.00125 0.      0.02375
  0.01125]
 [0.21125 0.49375 0.      0.14125 0.0175  0.02375 0.015   0.0575  0.03875
  0.00125]
 [0.      0.      0.96625 0.00125 0.      0.      0.      0.00125 0.00375
  0.0275 ]
 [0.005   0.30625 0.      0.3175  0.0725  0.15875 0.08125 0.045   0.00375
  0.01   ]
 [0.      0.01125 0.      0.01875 0.92    0.015   0.025   0.00625 0.00375
  0.     ]
 [0.0025  0.06625 0.      0.02    0.06    0.55875 0.24875 0.0325  0.01
  0.00125]
 [0.005   0.015   0.00375 0.0025  0.0825  0.0425  0.83375 0.00625 0.0025
  0.00625]
 [0.00875 0.23    0.      0.06    0.0375  0.035   0.01875 0.60125 0.00125
  0.0075 ]
 [0.00625 0.      0.      0.00125 0.      0.      0.      0.      0.98375
  0.00875]
 [0.0075  0.00125 0.32375 0.      0.      0.      0.      0.00125 0.01875
  0.6475 ]]
[2023-07-30 19:59:58,291 INFO] 180000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.6885e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1054, device='cuda:0'), 'train/shrink_loss': tensor(0.0537, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0402, device='cuda:0'), 'train/removed_class_idx': 2.510638030783188, 'train/uncertainty_avg': 0.7723542933264006, 'train/certain_ratio_ema': 0.7491159679669178, 'train/total_loss': tensor(0.1457, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.029168845999462473, 'train/prefecth_time': 0.01865910339355469, 'train/run_time': 0.5725621337890625, 'eval/loss': tensor(2.0502, device='cuda:0'), 'eval/top-1-acc': 0.72725, 'eval/top-5-acc': 0.97275, 'eval/precision': 0.7261512888579545, 'eval/recall': 0.72725, 'eval/F1': 0.7153930262629844, 'eval/AUC': 0.9465941927083333}, BEST_EVAL_ACC: 0.734375, at 175000 iters
[2023-07-30 20:49:33,883 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 20:49:44,734 INFO] confusion matrix:
[[0.9675  0.      0.00875 0.00125 0.00125 0.      0.00125 0.      0.015
  0.005  ]
 [0.25875 0.43875 0.      0.15125 0.03125 0.0275  0.01375 0.035   0.04125
  0.0025 ]
 [0.0025  0.00125 0.9675  0.0025  0.      0.      0.      0.      0.005
  0.02125]
 [0.0075  0.275   0.      0.34375 0.0675  0.185   0.07375 0.04    0.0025
  0.005  ]
 [0.00125 0.01    0.      0.0225  0.92125 0.01    0.02875 0.00375 0.0025
  0.     ]
 [0.00625 0.0525  0.      0.03    0.06625 0.56875 0.24375 0.02375 0.00875
  0.     ]
 [0.0075  0.015   0.00375 0.0025  0.06375 0.04625 0.85    0.00375 0.00375
  0.00375]
 [0.01625 0.2075  0.      0.085   0.0325  0.0475  0.0375  0.57125 0.
  0.0025 ]
 [0.01    0.      0.00375 0.00125 0.      0.      0.00125 0.      0.97625
  0.0075 ]
 [0.0075  0.00125 0.5125  0.      0.      0.      0.00375 0.00125 0.03375
  0.44   ]]
[2023-07-30 20:49:44,741 INFO] 185000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1341, device='cuda:0'), 'train/shrink_loss': tensor(0.1009, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0759, device='cuda:0'), 'train/removed_class_idx': 2.5263155678670555, 'train/uncertainty_avg': 0.7729040101056688, 'train/certain_ratio_ema': 0.7521316874098183, 'train/total_loss': tensor(0.2104, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.02912225932141394, 'train/prefecth_time': 0.02540617561340332, 'train/run_time': 0.5569993896484375, 'eval/loss': tensor(2.3204, device='cuda:0'), 'eval/top-1-acc': 0.7045, 'eval/top-5-acc': 0.973375, 'eval/precision': 0.7114570238902151, 'eval/recall': 0.7045000000000001, 'eval/F1': 0.6888084061765156, 'eval/AUC': 0.9385917534722223}, BEST_EVAL_ACC: 0.734375, at 175000 iters
[2023-07-30 21:39:31,106 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 21:39:41,053 INFO] confusion matrix:
[[0.96    0.      0.0075  0.00125 0.00125 0.      0.00125 0.      0.0175
  0.01125]
 [0.26875 0.45375 0.      0.13375 0.03125 0.03    0.01375 0.02875 0.03625
  0.00375]
 [0.00375 0.00125 0.9675  0.0025  0.      0.      0.      0.      0.005
  0.02   ]
 [0.00875 0.3175  0.      0.31    0.07    0.175   0.075   0.035   0.00375
  0.005  ]
 [0.      0.01    0.      0.02    0.92375 0.0125  0.02875 0.00375 0.00125
  0.     ]
 [0.00625 0.06375 0.      0.02625 0.06125 0.5775  0.2275  0.03125 0.005
  0.00125]
 [0.00625 0.01625 0.00375 0.0025  0.07375 0.0475  0.83125 0.00875 0.00125
  0.00875]
 [0.015   0.2325  0.      0.105   0.03    0.0375  0.04375 0.535   0.
  0.00125]
 [0.01375 0.      0.00125 0.00125 0.      0.      0.      0.      0.97375
  0.01   ]
 [0.01    0.      0.36375 0.      0.      0.      0.00375 0.00125 0.02875
  0.5925 ]]
[2023-07-30 21:39:41,060 INFO] 190000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.1144e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1364, device='cuda:0'), 'train/shrink_loss': tensor(0.0794, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0598, device='cuda:0'), 'train/removed_class_idx': 2.5371898729595146, 'train/uncertainty_avg': 0.7332482763959124, 'train/certain_ratio_ema': 0.7535193454656717, 'train/total_loss': tensor(0.1963, device='cuda:0'), 'train/mask_ratio': tensor(0.7299, device='cuda:0'), 'lr': 0.029074421752121708, 'train/prefecth_time': 0.018414911270141603, 'train/run_time': 0.5615761108398437, 'eval/loss': tensor(2.2758, device='cuda:0'), 'eval/top-1-acc': 0.7125, 'eval/top-5-acc': 0.9735, 'eval/precision': 0.7147223507529478, 'eval/recall': 0.7125, 'eval/F1': 0.6995052341971549, 'eval/AUC': 0.9396505468749999}, BEST_EVAL_ACC: 0.734375, at 175000 iters
[2023-07-30 22:29:22,726 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 22:29:32,535 INFO] confusion matrix:
[[0.955   0.      0.00875 0.0025  0.00125 0.      0.00125 0.      0.02125
  0.01   ]
 [0.275   0.44625 0.      0.12    0.03375 0.0375  0.01125 0.04625 0.03
  0.     ]
 [0.00875 0.      0.95625 0.0025  0.      0.      0.      0.00125 0.00625
  0.025  ]
 [0.00875 0.28    0.      0.35    0.06875 0.1975  0.04625 0.04125 0.0025
  0.005  ]
 [0.00125 0.01125 0.      0.0325  0.9175  0.0125  0.02    0.00375 0.00125
  0.     ]
 [0.0025  0.06625 0.      0.0225  0.07    0.56875 0.2325  0.0325  0.005
  0.     ]
 [0.0075  0.01375 0.005   0.005   0.06375 0.03625 0.85625 0.01    0.0025
  0.     ]
 [0.01375 0.225   0.      0.09625 0.03    0.04625 0.00625 0.5825  0.
  0.     ]
 [0.0075  0.      0.      0.0025  0.      0.      0.      0.      0.98
  0.01   ]
 [0.00625 0.00125 0.23625 0.00125 0.      0.      0.0025  0.00125 0.0275
  0.72375]]
[2023-07-30 22:29:32,542 INFO] 195000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.4168e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1066, device='cuda:0'), 'train/shrink_loss': tensor(0.0886, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0662, device='cuda:0'), 'train/removed_class_idx': 2.4310342731867007, 'train/uncertainty_avg': 0.7396250284496625, 'train/certain_ratio_ema': 0.7474952289846758, 'train/total_loss': tensor(0.1729, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.02902533534635755, 'train/prefecth_time': 0.021856576919555663, 'train/run_time': 0.5593259887695312, 'eval/loss': tensor(2.0186, device='cuda:0'), 'eval/top-1-acc': 0.733625, 'eval/top-5-acc': 0.97625, 'eval/precision': 0.7305358034954131, 'eval/recall': 0.7336249999999999, 'eval/F1': 0.7230811345257574, 'eval/AUC': 0.9456175260416668}, BEST_EVAL_ACC: 0.734375, at 175000 iters
[2023-07-30 23:19:22,385 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-30 23:19:32,343 INFO] confusion matrix:
[[0.96    0.      0.00875 0.00125 0.00125 0.      0.00125 0.      0.01625
  0.01125]
 [0.2525  0.435   0.      0.16    0.02375 0.03125 0.01625 0.0425  0.03875
  0.     ]
 [0.0075  0.00125 0.9525  0.0025  0.      0.      0.      0.      0.0025
  0.03375]
 [0.01125 0.195   0.      0.37125 0.06875 0.18875 0.085   0.0725  0.00125
  0.00625]
 [0.00125 0.01125 0.      0.02375 0.92125 0.01625 0.0225  0.0025  0.00125
  0.     ]
 [0.00375 0.0525  0.      0.0275  0.05875 0.59875 0.23    0.0225  0.00625
  0.     ]
 [0.00625 0.01125 0.005   0.00375 0.065   0.025   0.875   0.00625 0.0025
  0.     ]
 [0.02    0.2025  0.      0.06125 0.03    0.0475  0.04375 0.595   0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.      0.      0.98
  0.01125]
 [0.00625 0.      0.16    0.      0.      0.      0.0025  0.00125 0.01875
  0.81125]]
[2023-07-30 23:19:32,349 INFO] 200000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.3006e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1060, device='cuda:0'), 'train/shrink_loss': tensor(0.0638, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0479, device='cuda:0'), 'train/removed_class_idx': 2.3620687618906238, 'train/uncertainty_avg': 0.7630071244304789, 'train/certain_ratio_ema': 0.7510339001713574, 'train/total_loss': tensor(0.1540, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.028975002212534642, 'train/prefecth_time': 0.024794815063476562, 'train/run_time': 0.5779345092773438, 'eval/loss': tensor(1.7808, device='cuda:0'), 'eval/top-1-acc': 0.75, 'eval/top-5-acc': 0.97375, 'eval/precision': 0.742704180301567, 'eval/recall': 0.7500000000000001, 'eval/F1': 0.7387554442695696, 'eval/AUC': 0.9560384027777776}, BEST_EVAL_ACC: 0.75, at 200000 iters
[2023-07-30 23:19:32,583 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-31 00:09:06,542 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 00:09:16,426 INFO] confusion matrix:
[[0.9575  0.      0.00625 0.00125 0.00125 0.      0.      0.      0.02
  0.01375]
 [0.23625 0.4575  0.      0.14875 0.02625 0.02625 0.01375 0.0475  0.04375
  0.     ]
 [0.0125  0.00125 0.95625 0.00125 0.      0.      0.      0.      0.0025
  0.02625]
 [0.005   0.29375 0.      0.33625 0.0675  0.1725  0.075   0.03875 0.00125
  0.01   ]
 [0.00125 0.0125  0.      0.02    0.92375 0.0125  0.0225  0.005   0.0025
  0.     ]
 [0.0025  0.06    0.      0.02375 0.05625 0.60375 0.22125 0.0275  0.005
  0.     ]
 [0.01    0.01125 0.00625 0.0025  0.06    0.01625 0.88625 0.005   0.0025
  0.     ]
 [0.01625 0.21125 0.      0.065   0.0275  0.04125 0.04625 0.5925  0.
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.      0.      0.98
  0.01   ]
 [0.005   0.      0.11625 0.00125 0.      0.      0.00125 0.00125 0.015
  0.86   ]]
[2023-07-31 00:09:16,433 INFO] 205000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.8725e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1314, device='cuda:0'), 'train/shrink_loss': tensor(0.0448, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0339, device='cuda:0'), 'train/removed_class_idx': 2.36363612488524, 'train/uncertainty_avg': 0.7429126373806036, 'train/certain_ratio_ema': 0.7570537319248788, 'train/total_loss': tensor(0.1653, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.028923424512616994, 'train/prefecth_time': 0.024661407470703126, 'train/run_time': 0.5494482421875, 'eval/loss': tensor(1.8542, device='cuda:0'), 'eval/top-1-acc': 0.755375, 'eval/top-5-acc': 0.974875, 'eval/precision': 0.7501111859732564, 'eval/recall': 0.755375, 'eval/F1': 0.7446192506380844, 'eval/AUC': 0.9533617534722222}, BEST_EVAL_ACC: 0.755375, at 205000 iters
[2023-07-31 00:09:29,250 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-31 00:59:00,670 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 00:59:10,607 INFO] confusion matrix:
[[0.95875 0.      0.00625 0.0025  0.00125 0.      0.00375 0.      0.01625
  0.01125]
 [0.2425  0.45    0.      0.1575  0.01375 0.02625 0.015   0.0475  0.0475
  0.     ]
 [0.00875 0.      0.9675  0.00125 0.      0.      0.      0.00125 0.0025
  0.01875]
 [0.00875 0.22125 0.      0.4325  0.0575  0.17375 0.05375 0.0425  0.00375
  0.00625]
 [0.00125 0.01    0.00125 0.0425  0.91125 0.0125  0.01625 0.0025  0.0025
  0.     ]
 [0.00625 0.05125 0.00125 0.0375  0.04875 0.5875  0.23125 0.025   0.01125
  0.     ]
 [0.0075  0.0075  0.00625 0.00375 0.0425  0.01625 0.90875 0.00375 0.0025
  0.00125]
 [0.02625 0.185   0.      0.085   0.02875 0.04375 0.0125  0.61875 0.
  0.     ]
 [0.0125  0.      0.      0.00125 0.      0.      0.      0.      0.97875
  0.0075 ]
 [0.0075  0.      0.1175  0.00125 0.      0.      0.      0.00125 0.0175
  0.855  ]]
[2023-07-31 00:59:10,614 INFO] 210000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1102, device='cuda:0'), 'train/shrink_loss': tensor(0.0762, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0577, device='cuda:0'), 'train/removed_class_idx': 2.4953268695956194, 'train/uncertainty_avg': 0.7370712263227446, 'train/certain_ratio_ema': 0.7578996035810907, 'train/total_loss': tensor(0.1681, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.028870604462026567, 'train/prefecth_time': 0.03085247993469238, 'train/run_time': 0.6128275146484375, 'eval/loss': tensor(1.7216, device='cuda:0'), 'eval/top-1-acc': 0.766875, 'eval/top-5-acc': 0.9755, 'eval/precision': 0.7608764205858327, 'eval/recall': 0.766875, 'eval/F1': 0.7579179291176349, 'eval/AUC': 0.9577216145833332}, BEST_EVAL_ACC: 0.766875, at 210000 iters
[2023-07-31 00:59:12,679 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-31 01:48:54,896 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 01:49:05,116 INFO] confusion matrix:
[[0.9575  0.      0.00625 0.00125 0.00125 0.      0.00125 0.      0.02
  0.0125 ]
 [0.255   0.44875 0.      0.14    0.025   0.0325  0.015   0.04375 0.03875
  0.00125]
 [0.00875 0.0025  0.96125 0.0025  0.      0.      0.      0.      0.0025
  0.0225 ]
 [0.00875 0.245   0.      0.35    0.07125 0.22375 0.04625 0.04375 0.0025
  0.00875]
 [0.00125 0.01125 0.      0.02    0.92    0.0175  0.0225  0.00625 0.00125
  0.     ]
 [0.005   0.0525  0.00125 0.03375 0.0575  0.58875 0.23    0.025   0.00625
  0.     ]
 [0.00625 0.00875 0.00625 0.00375 0.04875 0.01375 0.90625 0.005   0.00125
  0.     ]
 [0.01625 0.20625 0.      0.04875 0.0275  0.06625 0.02625 0.60875 0.
  0.     ]
 [0.01125 0.      0.      0.00125 0.      0.      0.      0.      0.9775
  0.01   ]
 [0.01    0.      0.0675  0.      0.      0.      0.00125 0.00125 0.015
  0.905  ]]
[2023-07-31 01:49:05,128 INFO] 215000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.4407e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1605, device='cuda:0'), 'train/shrink_loss': tensor(0.0604, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0460, device='cuda:0'), 'train/removed_class_idx': 2.3999997473684473, 'train/uncertainty_avg': 0.7650801417958435, 'train/certain_ratio_ema': 0.7628569694408688, 'train/total_loss': tensor(0.2066, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.028816544329548152, 'train/prefecth_time': 0.01952886390686035, 'train/run_time': 0.5491834716796875, 'eval/loss': tensor(1.8318, device='cuda:0'), 'eval/top-1-acc': 0.762375, 'eval/top-5-acc': 0.975875, 'eval/precision': 0.7552202714814329, 'eval/recall': 0.7623750000000001, 'eval/F1': 0.7512682880396825, 'eval/AUC': 0.9541774131944446}, BEST_EVAL_ACC: 0.766875, at 210000 iters
[2023-07-31 02:38:30,941 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 02:38:51,314 INFO] confusion matrix:
[[0.955   0.      0.00625 0.00125 0.0025  0.      0.00125 0.      0.0225
  0.01125]
 [0.245   0.45375 0.      0.16625 0.02875 0.03    0.015   0.0225  0.03875
  0.     ]
 [0.00625 0.00125 0.97125 0.0025  0.      0.      0.      0.      0.0025
  0.01625]
 [0.00375 0.28625 0.      0.33125 0.07875 0.1825  0.0325  0.07625 0.00125
  0.0075 ]
 [0.00125 0.00625 0.      0.02375 0.92375 0.01625 0.01625 0.01125 0.00125
  0.     ]
 [0.00375 0.04625 0.      0.02875 0.06125 0.59125 0.225   0.04    0.00375
  0.     ]
 [0.0075  0.00875 0.005   0.00375 0.0425  0.0125  0.91    0.0075  0.
  0.0025 ]
 [0.01625 0.205   0.      0.10625 0.03125 0.0475  0.0075  0.58625 0.
  0.     ]
 [0.01125 0.      0.      0.00125 0.      0.      0.      0.00125 0.97125
  0.015  ]
 [0.00625 0.      0.10875 0.      0.      0.      0.      0.00375 0.015
  0.86625]]
[2023-07-31 02:38:51,320 INFO] 220000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1502, device='cuda:0'), 'train/shrink_loss': tensor(0.0821, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0622, device='cuda:0'), 'train/removed_class_idx': 2.327102586252095, 'train/uncertainty_avg': 0.783873253051305, 'train/certain_ratio_ema': 0.7575240136760615, 'train/total_loss': tensor(0.2126, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.028761246437231887, 'train/prefecth_time': 0.02078563117980957, 'train/run_time': 0.567841552734375, 'eval/loss': tensor(1.8305, device='cuda:0'), 'eval/top-1-acc': 0.756, 'eval/top-5-acc': 0.978, 'eval/precision': 0.7459953787823184, 'eval/recall': 0.756, 'eval/F1': 0.7448776363796588, 'eval/AUC': 0.9528354947916668}, BEST_EVAL_ACC: 0.766875, at 210000 iters
[2023-07-31 03:28:14,204 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 03:28:24,170 INFO] confusion matrix:
[[0.96    0.      0.00625 0.0025  0.00125 0.      0.00125 0.      0.01875
  0.01   ]
 [0.22375 0.47    0.00125 0.12125 0.03375 0.0275  0.015   0.06125 0.04625
  0.     ]
 [0.00625 0.      0.9675  0.00125 0.      0.      0.      0.00125 0.0025
  0.02125]
 [0.00375 0.2625  0.00125 0.35875 0.0925  0.14875 0.0725  0.05125 0.00125
  0.0075 ]
 [0.00125 0.00875 0.      0.01625 0.9325  0.01375 0.02125 0.00375 0.0025
  0.     ]
 [0.00375 0.055   0.      0.02125 0.06625 0.5725  0.23875 0.035   0.0075
  0.     ]
 [0.00625 0.00875 0.005   0.0025  0.0525  0.00875 0.9075  0.00625 0.00125
  0.00125]
 [0.0125  0.21    0.      0.02375 0.03375 0.03875 0.04125 0.64    0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00125 0.      0.9775
  0.0125 ]
 [0.0125  0.      0.06125 0.00125 0.      0.      0.00125 0.00125 0.01375
  0.90875]]
[2023-07-31 03:28:24,177 INFO] 225000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.3423e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1612, device='cuda:0'), 'train/shrink_loss': tensor(0.0512, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0391, device='cuda:0'), 'train/removed_class_idx': 2.3823527076124797, 'train/uncertainty_avg': 0.7503688543503171, 'train/certain_ratio_ema': 0.7640152909599096, 'train/total_loss': tensor(0.2003, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.028704713160293528, 'train/prefecth_time': 0.021643135070800783, 'train/run_time': 0.5532748413085937, 'eval/loss': tensor(1.7878, device='cuda:0'), 'eval/top-1-acc': 0.7695, 'eval/top-5-acc': 0.978875, 'eval/precision': 0.7650950284981655, 'eval/recall': 0.7695000000000001, 'eval/F1': 0.7581228909818712, 'eval/AUC': 0.9559646180555555}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 03:28:26,444 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-31 04:18:01,768 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 04:18:11,425 INFO] confusion matrix:
[[0.96125 0.      0.00625 0.00125 0.00125 0.      0.      0.      0.01875
  0.01125]
 [0.24    0.4575  0.00125 0.12    0.03125 0.03625 0.01    0.06    0.04375
  0.     ]
 [0.00625 0.      0.96875 0.0025  0.      0.      0.      0.00125 0.0025
  0.01875]
 [0.0175  0.27625 0.00125 0.3475  0.0975  0.165   0.04375 0.04125 0.0025
  0.0075 ]
 [0.00125 0.00875 0.      0.01375 0.9325  0.0175  0.02    0.00375 0.0025
  0.     ]
 [0.005   0.05125 0.      0.02125 0.06125 0.59125 0.2325  0.02875 0.00875
  0.     ]
 [0.00625 0.0075  0.00625 0.005   0.03875 0.0125  0.9175  0.00375 0.00125
  0.00125]
 [0.02625 0.20625 0.      0.03125 0.03125 0.04375 0.02875 0.6325  0.
  0.     ]
 [0.01125 0.      0.      0.00125 0.      0.      0.0025  0.      0.97625
  0.00875]
 [0.01    0.      0.09875 0.      0.      0.      0.      0.00125 0.01875
  0.87125]]
[2023-07-31 04:18:11,432 INFO] 230000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1257, device='cuda:0'), 'train/shrink_loss': tensor(0.0837, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0636, device='cuda:0'), 'train/removed_class_idx': 2.410447581309882, 'train/uncertainty_avg': 0.756733691087923, 'train/certain_ratio_ema': 0.759471192868387, 'train/total_loss': tensor(0.1895, device='cuda:0'), 'train/mask_ratio': tensor(0.7009, device='cuda:0'), 'lr': 0.028646946927012435, 'train/prefecth_time': 0.019172576904296874, 'train/run_time': 0.5675095825195312, 'eval/loss': tensor(1.8211, device='cuda:0'), 'eval/top-1-acc': 0.765625, 'eval/top-5-acc': 0.976875, 'eval/precision': 0.760612468923388, 'eval/recall': 0.765625, 'eval/F1': 0.7538023710824936, 'eval/AUC': 0.9541791232638888}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 05:08:01,375 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 05:08:25,038 INFO] confusion matrix:
[[0.96625 0.      0.005   0.0025  0.00125 0.      0.      0.      0.01625
  0.00875]
 [0.2475  0.44875 0.      0.1375  0.03    0.03    0.0125  0.0425  0.05125
  0.     ]
 [0.01125 0.00125 0.965   0.0025  0.      0.      0.      0.      0.00375
  0.01625]
 [0.00625 0.23    0.      0.39625 0.0925  0.15875 0.0325  0.0725  0.005
  0.00625]
 [0.00125 0.01    0.      0.02375 0.93375 0.0125  0.01375 0.00375 0.00125
  0.     ]
 [0.005   0.04875 0.00125 0.02125 0.055   0.59375 0.2225  0.04625 0.00625
  0.     ]
 [0.005   0.0075  0.005   0.00875 0.05125 0.015   0.89875 0.005   0.0025
  0.00125]
 [0.015   0.225   0.      0.07375 0.035   0.04375 0.005   0.6025  0.
  0.     ]
 [0.01125 0.      0.      0.0025  0.      0.      0.      0.      0.9775
  0.00875]
 [0.01375 0.      0.10625 0.00125 0.      0.      0.00125 0.00125 0.01125
  0.865  ]]
[2023-07-31 05:08:25,045 INFO] 235000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1588e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1302, device='cuda:0'), 'train/shrink_loss': tensor(0.0687, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0523, device='cuda:0'), 'train/removed_class_idx': 2.85849029636884, 'train/uncertainty_avg': 0.6868487870726356, 'train/certain_ratio_ema': 0.762047125123201, 'train/total_loss': tensor(0.1826, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.02858795021862726, 'train/prefecth_time': 0.021951007843017577, 'train/run_time': 0.5563902587890625, 'eval/loss': tensor(1.7520, device='cuda:0'), 'eval/top-1-acc': 0.76475, 'eval/top-5-acc': 0.977375, 'eval/precision': 0.7572815224112264, 'eval/recall': 0.76475, 'eval/F1': 0.7544460865704211, 'eval/AUC': 0.9566144444444444}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 05:57:52,292 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 05:58:02,045 INFO] confusion matrix:
[[0.96375 0.      0.00375 0.00125 0.00125 0.      0.      0.      0.01875
  0.01125]
 [0.25375 0.43875 0.      0.12875 0.0175  0.035   0.01625 0.0575  0.0525
  0.     ]
 [0.00875 0.      0.9625  0.00125 0.      0.      0.      0.00125 0.00375
  0.0225 ]
 [0.00375 0.27625 0.00125 0.32625 0.085   0.18    0.07    0.04375 0.00375
  0.01   ]
 [0.00125 0.01125 0.      0.015   0.92125 0.0175  0.025   0.00625 0.0025
  0.     ]
 [0.00375 0.05875 0.00125 0.02    0.05125 0.615   0.2     0.0375  0.0125
  0.     ]
 [0.005   0.0075  0.005   0.00375 0.04375 0.02125 0.9075  0.00375 0.00125
  0.00125]
 [0.01375 0.235   0.      0.02625 0.02375 0.04375 0.0425  0.615   0.
  0.     ]
 [0.01125 0.      0.      0.00125 0.      0.      0.0025  0.      0.975
  0.01   ]
 [0.01    0.      0.08875 0.      0.      0.      0.00125 0.00125 0.0125
  0.88625]]
[2023-07-31 05:58:02,051 INFO] 240000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.9396e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1497, device='cuda:0'), 'train/shrink_loss': tensor(0.0775, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0589, device='cuda:0'), 'train/removed_class_idx': 2.355932003734576, 'train/uncertainty_avg': 0.767379348942339, 'train/certain_ratio_ema': 0.7600668357010085, 'train/total_loss': tensor(0.2086, device='cuda:0'), 'train/mask_ratio': tensor(0.7366, device='cuda:0'), 'lr': 0.028527725569229362, 'train/prefecth_time': 0.021059392929077148, 'train/run_time': 0.5738814086914062, 'eval/loss': tensor(1.8335, device='cuda:0'), 'eval/top-1-acc': 0.761125, 'eval/top-5-acc': 0.976625, 'eval/precision': 0.7553382107537223, 'eval/recall': 0.761125, 'eval/F1': 0.7491378605919058, 'eval/AUC': 0.9536663628472223}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 06:47:42,128 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 06:47:53,102 INFO] confusion matrix:
[[0.94875 0.      0.00375 0.00125 0.0025  0.      0.0025  0.      0.0325
  0.00875]
 [0.23    0.5025  0.      0.1225  0.02    0.03    0.01125 0.0325  0.05125
  0.     ]
 [0.01125 0.00125 0.965   0.00125 0.      0.      0.      0.      0.00375
  0.0175 ]
 [0.005   0.2875  0.00125 0.36375 0.075   0.18375 0.03125 0.04375 0.00375
  0.005  ]
 [0.00125 0.0125  0.      0.025   0.92625 0.01625 0.0125  0.00375 0.0025
  0.     ]
 [0.0025  0.0525  0.      0.04    0.065   0.595   0.19875 0.04    0.00625
  0.     ]
 [0.00875 0.00875 0.      0.0075  0.05625 0.01875 0.89125 0.005   0.0025
  0.00125]
 [0.01625 0.24125 0.      0.0675  0.0275  0.04    0.00375 0.60375 0.
  0.     ]
 [0.00625 0.      0.      0.00375 0.      0.      0.      0.      0.9775
  0.0125 ]
 [0.00875 0.      0.11125 0.00125 0.      0.      0.0025  0.00125 0.01625
  0.85875]]
[2023-07-31 06:47:53,109 INFO] 245000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0008, device='cuda:0'), 'train/certain_loss': tensor(0.1791, device='cuda:0'), 'train/shrink_loss': tensor(0.0788, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0599, device='cuda:0'), 'train/removed_class_idx': 2.4824559225915857, 'train/uncertainty_avg': 0.7480434537452219, 'train/certain_ratio_ema': 0.760172113520979, 'train/total_loss': tensor(0.2399, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.028466275565653988, 'train/prefecth_time': 0.018596927642822267, 'train/run_time': 0.5673519897460938, 'eval/loss': tensor(1.8129, device='cuda:0'), 'eval/top-1-acc': 0.76325, 'eval/top-5-acc': 0.977875, 'eval/precision': 0.7591245848661055, 'eval/recall': 0.76325, 'eval/F1': 0.7542154981569265, 'eval/AUC': 0.9539315364583333}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 07:37:15,697 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 07:37:25,452 INFO] confusion matrix:
[[0.94875 0.      0.0075  0.00375 0.00125 0.      0.00125 0.      0.0275
  0.01   ]
 [0.17    0.5125  0.      0.1575  0.02375 0.0275  0.015   0.045   0.04875
  0.     ]
 [0.01125 0.00125 0.965   0.00125 0.      0.      0.      0.      0.005
  0.01625]
 [0.0025  0.19375 0.      0.37625 0.08875 0.22125 0.06875 0.0375  0.0025
  0.00875]
 [0.00125 0.01    0.      0.0175  0.92875 0.015   0.02    0.005   0.0025
  0.     ]
 [0.00125 0.0525  0.      0.035   0.06125 0.585   0.21875 0.03875 0.0075
  0.     ]
 [0.01125 0.01    0.00375 0.0025  0.0375  0.0125  0.91375 0.00625 0.00125
  0.00125]
 [0.00625 0.19625 0.      0.08375 0.03    0.04375 0.04375 0.59625 0.
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.00125 0.      0.97625
  0.0125 ]
 [0.00875 0.      0.14    0.      0.      0.      0.0025  0.00125 0.015
  0.8325 ]]
[2023-07-31 07:37:25,459 INFO] 250000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.7841e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1627, device='cuda:0'), 'train/shrink_loss': tensor(0.0736, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0564, device='cuda:0'), 'train/removed_class_idx': 2.461538224852094, 'train/uncertainty_avg': 0.7883130800512042, 'train/certain_ratio_ema': 0.7662895949357477, 'train/total_loss': tensor(0.2192, device='cuda:0'), 'train/mask_ratio': tensor(0.7679, device='cuda:0'), 'lr': 0.02840360284736912, 'train/prefecth_time': 0.020322303771972656, 'train/run_time': 0.5618474731445312, 'eval/loss': tensor(1.7639, device='cuda:0'), 'eval/top-1-acc': 0.7635, 'eval/top-5-acc': 0.97875, 'eval/precision': 0.756534534132589, 'eval/recall': 0.7635, 'eval/F1': 0.7533022116748462, 'eval/AUC': 0.9579171180555555}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 08:27:04,176 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 08:27:14,101 INFO] confusion matrix:
[[0.955   0.      0.00875 0.00125 0.00125 0.      0.0025  0.      0.01875
  0.0125 ]
 [0.22875 0.455   0.      0.16625 0.0225  0.0275  0.01375 0.03625 0.04875
  0.00125]
 [0.01    0.00125 0.975   0.0025  0.      0.      0.      0.      0.0025
  0.00875]
 [0.00375 0.25375 0.      0.375   0.0775  0.16625 0.06    0.055   0.00375
  0.005  ]
 [0.00125 0.01125 0.      0.02    0.9275  0.0125  0.02125 0.005   0.00125
  0.     ]
 [0.00375 0.04625 0.      0.05125 0.04625 0.59875 0.20625 0.045   0.0025
  0.     ]
 [0.005   0.005   0.00375 0.005   0.03125 0.01375 0.925   0.00875 0.00125
  0.00125]
 [0.01125 0.20625 0.      0.0625  0.02625 0.0375  0.04625 0.61    0.
  0.     ]
 [0.00625 0.      0.      0.      0.00125 0.      0.00125 0.      0.98125
  0.01   ]
 [0.01375 0.      0.18125 0.      0.      0.      0.0025  0.00125 0.01875
  0.7825 ]]
[2023-07-31 08:27:14,108 INFO] 255000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.0960, device='cuda:0'), 'train/shrink_loss': tensor(0.0769, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0580, device='cuda:0'), 'train/removed_class_idx': 2.7981648809023043, 'train/uncertainty_avg': 0.723467550760172, 'train/certain_ratio_ema': 0.754356508738923, 'train/total_loss': tensor(0.1542, device='cuda:0'), 'train/mask_ratio': tensor(0.7567, device='cuda:0'), 'lr': 0.028339710106362145, 'train/prefecth_time': 0.0194715518951416, 'train/run_time': 0.5575682983398438, 'eval/loss': tensor(1.8022, device='cuda:0'), 'eval/top-1-acc': 0.7585, 'eval/top-5-acc': 0.978, 'eval/precision': 0.7522949177086475, 'eval/recall': 0.7585, 'eval/F1': 0.748000535000003, 'eval/AUC': 0.9547076649305555}, BEST_EVAL_ACC: 0.7695, at 225000 iters
[2023-07-31 09:16:54,571 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 09:17:04,349 INFO] confusion matrix:
[[0.95125 0.      0.00875 0.00125 0.00125 0.      0.00125 0.      0.02375
  0.0125 ]
 [0.2     0.485   0.      0.14625 0.0275  0.02875 0.00875 0.055   0.04875
  0.     ]
 [0.00625 0.00125 0.96125 0.      0.      0.      0.00125 0.0025  0.005
  0.0225 ]
 [0.005   0.22625 0.      0.4175  0.0775  0.1525  0.025   0.08875 0.0025
  0.005  ]
 [0.00125 0.00875 0.      0.02    0.92875 0.01125 0.015   0.0125  0.0025
  0.     ]
 [0.0025  0.045   0.      0.0575  0.0525  0.57875 0.215   0.03875 0.01
  0.     ]
 [0.00625 0.0075  0.005   0.0075  0.035   0.01375 0.9125  0.01125 0.00125
  0.     ]
 [0.005   0.23    0.      0.04375 0.02875 0.0375  0.005   0.65    0.
  0.     ]
 [0.005   0.      0.      0.00125 0.      0.      0.      0.00125 0.98
  0.0125 ]
 [0.00625 0.      0.07    0.      0.      0.      0.      0.00375 0.01625
  0.90375]]
[2023-07-31 09:17:04,355 INFO] 260000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1157, device='cuda:0'), 'train/shrink_loss': tensor(0.0288, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0219, device='cuda:0'), 'train/removed_class_idx': 2.4939756031354694, 'train/uncertainty_avg': 0.7518378304878941, 'train/certain_ratio_ema': 0.7596098062561547, 'train/total_loss': tensor(0.1378, device='cuda:0'), 'train/mask_ratio': tensor(0.8147, device='cuda:0'), 'lr': 0.02827460008702419, 'train/prefecth_time': 0.01966192054748535, 'train/run_time': 0.5426455688476562, 'eval/loss': tensor(1.6018, device='cuda:0'), 'eval/top-1-acc': 0.776875, 'eval/top-5-acc': 0.98075, 'eval/precision': 0.7681921965381915, 'eval/recall': 0.7768750000000001, 'eval/F1': 0.7679598687611913, 'eval/AUC': 0.959122300347222}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 09:17:06,619 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-31 10:06:37,352 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 10:06:47,796 INFO] confusion matrix:
[[0.9525  0.      0.0075  0.00375 0.00125 0.      0.00125 0.      0.02125
  0.0125 ]
 [0.18625 0.5     0.      0.1725  0.0175  0.0325  0.0075  0.03875 0.045
  0.     ]
 [0.01    0.      0.96875 0.00125 0.      0.      0.      0.00125 0.00375
  0.015  ]
 [0.01    0.22125 0.00125 0.4875  0.06375 0.16375 0.02    0.0225  0.005
  0.005  ]
 [0.00125 0.01125 0.      0.04875 0.9075  0.01375 0.01375 0.0025  0.00125
  0.     ]
 [0.0025  0.05    0.      0.1     0.04375 0.57875 0.19875 0.01625 0.01
  0.     ]
 [0.005   0.01    0.005   0.00875 0.0375  0.015   0.9125  0.0025  0.00125
  0.0025 ]
 [0.01625 0.22    0.      0.13    0.02625 0.04375 0.0075  0.55625 0.
  0.     ]
 [0.01    0.      0.      0.0025  0.      0.      0.      0.      0.975
  0.0125 ]
 [0.00625 0.00125 0.125   0.      0.      0.      0.      0.00125 0.01875
  0.8475 ]]
[2023-07-31 10:06:47,802 INFO] 265000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1053, device='cuda:0'), 'train/shrink_loss': tensor(0.0899, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0682, device='cuda:0'), 'train/removed_class_idx': 2.6229506046761797, 'train/uncertainty_avg': 0.7653325579198187, 'train/certain_ratio_ema': 0.7576686578348613, 'train/total_loss': tensor(0.1737, device='cuda:0'), 'train/mask_ratio': tensor(0.7277, device='cuda:0'), 'lr': 0.02820827558603227, 'train/prefecth_time': 0.02068943977355957, 'train/run_time': 0.5734531860351563, 'eval/loss': tensor(1.6622, device='cuda:0'), 'eval/top-1-acc': 0.768625, 'eval/top-5-acc': 0.981375, 'eval/precision': 0.7683826458163381, 'eval/recall': 0.768625, 'eval/F1': 0.7626041968929587, 'eval/AUC': 0.9581637934027776}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 10:56:31,199 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 10:56:41,083 INFO] confusion matrix:
[[0.94    0.      0.00875 0.00125 0.00125 0.      0.00125 0.      0.02375
  0.02375]
 [0.175   0.5225  0.      0.15375 0.02875 0.02625 0.01625 0.0325  0.045
  0.     ]
 [0.01125 0.00125 0.97375 0.00125 0.      0.      0.      0.      0.0025
  0.01   ]
 [0.0125  0.17375 0.00125 0.455   0.08125 0.1925  0.03125 0.04    0.005
  0.0075 ]
 [0.0025  0.00875 0.      0.0275  0.9275  0.01375 0.015   0.00375 0.00125
  0.     ]
 [0.00125 0.04125 0.      0.0675  0.06875 0.585   0.19    0.035   0.01125
  0.     ]
 [0.01    0.01125 0.00375 0.00625 0.03875 0.0125  0.9075  0.0075  0.00125
  0.00125]
 [0.02375 0.215   0.      0.09    0.0325  0.03875 0.01875 0.58125 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.      0.      0.9825
  0.00875]
 [0.01    0.00125 0.1525  0.      0.      0.      0.      0.00125 0.0175
  0.8175 ]]
[2023-07-31 10:56:41,090 INFO] 270000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1406, device='cuda:0'), 'train/shrink_loss': tensor(0.0944, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0711, device='cuda:0'), 'train/removed_class_idx': 2.475727914977872, 'train/uncertainty_avg': 0.7276466008072675, 'train/certain_ratio_ema': 0.7529875176563758, 'train/total_loss': tensor(0.2119, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.028140739452229138, 'train/prefecth_time': 0.020042367935180664, 'train/run_time': 0.5530526733398438, 'eval/loss': tensor(1.5790, device='cuda:0'), 'eval/top-1-acc': 0.76925, 'eval/top-5-acc': 0.979875, 'eval/precision': 0.7644154995710843, 'eval/recall': 0.76925, 'eval/F1': 0.7609135463813688, 'eval/AUC': 0.9624897569444444}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 11:46:06,357 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 11:46:16,504 INFO] confusion matrix:
[[0.95625 0.      0.0075  0.00125 0.00125 0.      0.00125 0.      0.02
  0.0125 ]
 [0.2     0.51    0.      0.15875 0.0175  0.02625 0.00625 0.04375 0.0375
  0.     ]
 [0.00625 0.00125 0.9675  0.0025  0.      0.      0.      0.      0.00375
  0.01875]
 [0.00125 0.20875 0.00125 0.45    0.06625 0.185   0.03125 0.04875 0.00125
  0.00625]
 [0.00125 0.0125  0.      0.02875 0.9225  0.0125  0.0175  0.00375 0.00125
  0.     ]
 [0.0025  0.05125 0.00125 0.05375 0.045   0.5925  0.21125 0.04    0.0025
  0.     ]
 [0.0075  0.00875 0.005   0.0075  0.035   0.00875 0.9175  0.00625 0.0025
  0.00125]
 [0.0075  0.215   0.      0.12    0.025   0.03125 0.00625 0.595   0.
  0.     ]
 [0.01    0.      0.      0.00375 0.      0.      0.      0.      0.975
  0.01125]
 [0.0075  0.00125 0.16625 0.      0.      0.      0.00125 0.00125 0.01625
  0.80625]]
[2023-07-31 11:46:16,511 INFO] 275000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.2053, device='cuda:0'), 'train/shrink_loss': tensor(0.0791, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0603, device='cuda:0'), 'train/removed_class_idx': 2.339805598077126, 'train/uncertainty_avg': 0.7461672398152343, 'train/certain_ratio_ema': 0.7620774813119614, 'train/total_loss': tensor(0.2660, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.028071994586500938, 'train/prefecth_time': 0.03894976043701172, 'train/run_time': 0.5518683471679687, 'eval/loss': tensor(1.7164, device='cuda:0'), 'eval/top-1-acc': 0.76925, 'eval/top-5-acc': 0.979125, 'eval/precision': 0.764670839317084, 'eval/recall': 0.76925, 'eval/F1': 0.7618822622937206, 'eval/AUC': 0.9576938541666666}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 12:36:06,909 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 12:36:17,177 INFO] confusion matrix:
[[0.9525  0.      0.005   0.0025  0.00125 0.      0.00125 0.      0.02625
  0.01125]
 [0.185   0.535   0.      0.11    0.02625 0.02375 0.01125 0.06625 0.0425
  0.     ]
 [0.01125 0.00125 0.9725  0.00125 0.      0.      0.00125 0.      0.00375
  0.00875]
 [0.00875 0.20625 0.      0.40375 0.08875 0.21    0.025   0.0525  0.00375
  0.00125]
 [0.00125 0.01    0.      0.035   0.9225  0.00875 0.01625 0.005   0.00125
  0.     ]
 [0.0025  0.04625 0.      0.09625 0.06875 0.555   0.19375 0.02875 0.00875
  0.     ]
 [0.01125 0.00875 0.0025  0.02    0.045   0.0075  0.8975  0.00375 0.00125
  0.0025 ]
 [0.02125 0.24375 0.      0.075   0.03    0.03375 0.00375 0.59125 0.00125
  0.     ]
 [0.00875 0.      0.      0.0025  0.      0.      0.      0.      0.98
  0.00875]
 [0.0075  0.00125 0.1725  0.00125 0.      0.      0.      0.0025  0.01625
  0.79875]]
[2023-07-31 12:36:17,185 INFO] 280000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1750, device='cuda:0'), 'train/shrink_loss': tensor(0.0913, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0681, device='cuda:0'), 'train/removed_class_idx': 2.4434780483932133, 'train/uncertainty_avg': 0.7504885891670291, 'train/certain_ratio_ema': 0.7464176971966741, 'train/total_loss': tensor(0.2433, device='cuda:0'), 'train/mask_ratio': tensor(0.7433, device='cuda:0'), 'lr': 0.028002043941652583, 'train/prefecth_time': 0.0198984317779541, 'train/run_time': 0.5813946533203125, 'eval/loss': tensor(1.7304, device='cuda:0'), 'eval/top-1-acc': 0.760875, 'eval/top-5-acc': 0.978875, 'eval/precision': 0.7554177173227852, 'eval/recall': 0.7608750000000001, 'eval/F1': 0.7521028295833583, 'eval/AUC': 0.9551493750000001}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 13:26:01,353 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 13:26:11,454 INFO] confusion matrix:
[[0.96125 0.      0.005   0.0025  0.0025  0.      0.00125 0.      0.015
  0.0125 ]
 [0.175   0.51125 0.      0.15125 0.02375 0.0275  0.02    0.0425  0.04875
  0.     ]
 [0.00625 0.00125 0.965   0.00125 0.      0.      0.      0.      0.00375
  0.0225 ]
 [0.01875 0.2175  0.00125 0.39375 0.08125 0.1625  0.0725  0.0425  0.00375
  0.00625]
 [0.00125 0.01    0.      0.025   0.92625 0.01375 0.01875 0.00375 0.00125
  0.     ]
 [0.00375 0.0425  0.00125 0.0575  0.05625 0.58375 0.21625 0.0325  0.00625
  0.     ]
 [0.00375 0.01125 0.00375 0.0025  0.03625 0.015   0.91375 0.00875 0.0025
  0.0025 ]
 [0.02625 0.18875 0.      0.08    0.02375 0.03375 0.02875 0.6175  0.00125
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.0025  0.      0.98
  0.00875]
 [0.0075  0.      0.07125 0.      0.      0.      0.00125 0.00125 0.01625
  0.9025 ]]
[2023-07-31 13:26:11,461 INFO] 285000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1074, device='cuda:0'), 'train/shrink_loss': tensor(0.0436, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0331, device='cuda:0'), 'train/removed_class_idx': 2.333333090277803, 'train/uncertainty_avg': 0.7669760959364248, 'train/certain_ratio_ema': 0.7586729945060335, 'train/total_loss': tensor(0.1407, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.02793089052228094, 'train/prefecth_time': 0.021166080474853514, 'train/run_time': 0.570778564453125, 'eval/loss': tensor(1.6226, device='cuda:0'), 'eval/top-1-acc': 0.7755, 'eval/top-5-acc': 0.97575, 'eval/precision': 0.7684249375420867, 'eval/recall': 0.7754999999999999, 'eval/F1': 0.7660075281764338, 'eval/AUC': 0.9599149565972221}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 14:15:36,806 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 14:15:46,804 INFO] confusion matrix:
[[0.95875 0.00125 0.00625 0.      0.0025  0.      0.00125 0.      0.0175
  0.0125 ]
 [0.19125 0.535   0.      0.09625 0.02625 0.03375 0.0075  0.065   0.045
  0.     ]
 [0.00875 0.00125 0.96625 0.0025  0.      0.      0.      0.      0.00375
  0.0175 ]
 [0.01375 0.21625 0.00125 0.29125 0.0925  0.2725  0.0475  0.0575  0.00375
  0.00375]
 [0.0025  0.00875 0.      0.02    0.935   0.0125  0.01375 0.00375 0.00375
  0.     ]
 [0.00125 0.05    0.00125 0.025   0.05125 0.6075  0.21125 0.0425  0.01
  0.     ]
 [0.0075  0.0075  0.00375 0.00625 0.035   0.01375 0.91375 0.0075  0.0025
  0.0025 ]
 [0.02625 0.20875 0.      0.0525  0.02375 0.04375 0.0075  0.6375  0.
  0.     ]
 [0.01    0.      0.      0.0025  0.      0.      0.      0.      0.97625
  0.01125]
 [0.00875 0.      0.06    0.00125 0.      0.      0.00125 0.00125 0.01875
  0.90875]]
[2023-07-31 14:15:46,811 INFO] 290000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1247, device='cuda:0'), 'train/shrink_loss': tensor(0.0492, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0374, device='cuda:0'), 'train/removed_class_idx': 2.5166664569444617, 'train/uncertainty_avg': 0.733646968958012, 'train/certain_ratio_ema': 0.7594776546187937, 'train/total_loss': tensor(0.1623, device='cuda:0'), 'train/mask_ratio': tensor(0.7321, device='cuda:0'), 'lr': 0.027858537384645773, 'train/prefecth_time': 0.05432217788696289, 'train/run_time': 0.572564453125, 'eval/loss': tensor(1.6960, device='cuda:0'), 'eval/top-1-acc': 0.773, 'eval/top-5-acc': 0.974625, 'eval/precision': 0.7629706397339432, 'eval/recall': 0.773, 'eval/F1': 0.7599311012895218, 'eval/AUC': 0.9588046093749999}, BEST_EVAL_ACC: 0.776875, at 260000 iters
[2023-07-31 15:05:25,013 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 15:05:35,009 INFO] confusion matrix:
[[0.9675  0.      0.00375 0.00125 0.00125 0.      0.      0.      0.015
  0.01125]
 [0.12625 0.56875 0.      0.12625 0.02625 0.03    0.0175  0.07375 0.03125
  0.     ]
 [0.00625 0.      0.95875 0.00125 0.      0.      0.      0.00125 0.005
  0.0275 ]
 [0.0025  0.19    0.      0.38    0.11875 0.22    0.04375 0.03875 0.0025
  0.00375]
 [0.      0.01125 0.      0.0175  0.935   0.01375 0.0175  0.00375 0.00125
  0.     ]
 [0.0025  0.04625 0.      0.05625 0.05375 0.55625 0.25    0.03125 0.00375
  0.     ]
 [0.005   0.01125 0.00375 0.0075  0.03    0.0125  0.92125 0.005   0.0025
  0.00125]
 [0.0025  0.2125  0.      0.07375 0.04875 0.0375  0.01125 0.61375 0.
  0.     ]
 [0.01125 0.      0.      0.0025  0.      0.      0.      0.      0.97625
  0.01   ]
 [0.005   0.00125 0.03375 0.      0.      0.      0.      0.00125 0.015
  0.94375]]
[2023-07-31 15:05:35,016 INFO] 295000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.6151e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1329, device='cuda:0'), 'train/shrink_loss': tensor(0.0765, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0581, device='cuda:0'), 'train/removed_class_idx': 2.436974585128186, 'train/uncertainty_avg': 0.744680179299125, 'train/certain_ratio_ema': 0.7601757891738281, 'train/total_loss': tensor(0.1911, device='cuda:0'), 'train/mask_ratio': tensor(0.7344, device='cuda:0'), 'lr': 0.02778498763653845, 'train/prefecth_time': 0.022225568771362305, 'train/run_time': 0.5650131225585937, 'eval/loss': tensor(1.6107, device='cuda:0'), 'eval/top-1-acc': 0.782125, 'eval/top-5-acc': 0.978, 'eval/precision': 0.7744644369904247, 'eval/recall': 0.782125, 'eval/F1': 0.7725762879867646, 'eval/AUC': 0.9602543229166667}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 15:05:36,940 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-07-31 15:55:16,491 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 15:55:37,358 INFO] confusion matrix:
[[0.94625 0.00125 0.005   0.      0.0025  0.00125 0.00375 0.      0.0275
  0.0125 ]
 [0.11625 0.585   0.      0.0625  0.0375  0.04625 0.0125  0.1     0.04
  0.     ]
 [0.00375 0.00125 0.97625 0.00125 0.      0.      0.      0.      0.00375
  0.01375]
 [0.01625 0.23375 0.      0.24125 0.07125 0.305   0.03125 0.09125 0.005
  0.005  ]
 [0.00125 0.01375 0.      0.02625 0.90375 0.02    0.01625 0.015   0.00375
  0.     ]
 [0.00375 0.05125 0.      0.02    0.04875 0.62625 0.205   0.04    0.005
  0.     ]
 [0.0025  0.0125  0.005   0.00625 0.02375 0.015   0.92875 0.005   0.00125
  0.     ]
 [0.02125 0.20875 0.      0.03625 0.02125 0.05125 0.005   0.655   0.00125
  0.     ]
 [0.0075  0.      0.      0.0025  0.00125 0.      0.      0.      0.97875
  0.01   ]
 [0.005   0.00125 0.125   0.00125 0.      0.      0.      0.00125 0.0175
  0.84875]]
[2023-07-31 15:55:37,365 INFO] 300000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1465, device='cuda:0'), 'train/shrink_loss': tensor(0.0605, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0458, device='cuda:0'), 'train/removed_class_idx': 2.4727270479339047, 'train/uncertainty_avg': 0.7396821007955813, 'train/certain_ratio_ema': 0.7574049580492772, 'train/total_loss': tensor(0.1924, device='cuda:0'), 'train/mask_ratio': tensor(0.7545, device='cuda:0'), 'lr': 0.027710244437148483, 'train/prefecth_time': 0.01980316734313965, 'train/run_time': 0.56080126953125, 'eval/loss': tensor(1.7170, device='cuda:0'), 'eval/top-1-acc': 0.769, 'eval/top-5-acc': 0.978, 'eval/precision': 0.7608196926407629, 'eval/recall': 0.769, 'eval/F1': 0.7546865914320091, 'eval/AUC': 0.9560135243055556}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 16:45:10,352 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 16:45:21,001 INFO] confusion matrix:
[[0.95625 0.00125 0.00375 0.0025  0.0025  0.      0.00125 0.      0.02125
  0.01125]
 [0.23625 0.46125 0.      0.15    0.02875 0.02375 0.01375 0.035   0.05125
  0.     ]
 [0.005   0.      0.97125 0.00375 0.      0.      0.      0.      0.00375
  0.01625]
 [0.00625 0.2125  0.      0.37    0.09375 0.21125 0.0525  0.04375 0.0025
  0.0075 ]
 [0.00125 0.00875 0.      0.025   0.92875 0.0125  0.0175  0.00375 0.0025
  0.     ]
 [0.005   0.045   0.      0.03125 0.05375 0.61125 0.21625 0.0325  0.005
  0.     ]
 [0.005   0.00875 0.00375 0.0075  0.03125 0.00875 0.9275  0.00625 0.00125
  0.     ]
 [0.0175  0.1975  0.      0.14125 0.02625 0.0325  0.0075  0.5775  0.
  0.     ]
 [0.01125 0.      0.      0.0025  0.      0.      0.      0.      0.97875
  0.0075 ]
 [0.00875 0.      0.0925  0.00125 0.      0.      0.00125 0.00125 0.015
  0.88   ]]
[2023-07-31 16:45:21,008 INFO] 305000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.7700e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1016, device='cuda:0'), 'train/shrink_loss': tensor(0.0670, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0511, device='cuda:0'), 'train/removed_class_idx': 2.464912064481398, 'train/uncertainty_avg': 0.7284923178999415, 'train/certain_ratio_ema': 0.761627819034951, 'train/total_loss': tensor(0.1527, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.02763431099692779, 'train/prefecth_time': 0.019885087966918947, 'train/run_time': 0.5794744262695313, 'eval/loss': tensor(1.7800, device='cuda:0'), 'eval/top-1-acc': 0.76625, 'eval/top-5-acc': 0.974625, 'eval/precision': 0.7576844799000831, 'eval/recall': 0.76625, 'eval/F1': 0.7556019174076362, 'eval/AUC': 0.9571630902777778}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 17:35:00,440 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 17:35:10,407 INFO] confusion matrix:
[[0.95875 0.00125 0.0075  0.00125 0.00125 0.      0.00125 0.      0.01875
  0.01   ]
 [0.17125 0.56375 0.      0.10625 0.0375  0.0325  0.015   0.02625 0.0475
  0.     ]
 [0.00625 0.00125 0.97125 0.00125 0.      0.      0.      0.      0.00375
  0.01625]
 [0.0075  0.22875 0.      0.30875 0.105   0.23375 0.0575  0.04875 0.00375
  0.00625]
 [0.00125 0.01    0.      0.0125  0.94375 0.01125 0.01625 0.0025  0.0025
  0.     ]
 [0.00375 0.04625 0.00125 0.02125 0.0525  0.6375  0.20625 0.02625 0.005
  0.     ]
 [0.005   0.01125 0.00625 0.0025  0.03375 0.0125  0.92    0.00625 0.0025
  0.     ]
 [0.015   0.23    0.      0.05125 0.03375 0.03875 0.02375 0.6075  0.
  0.     ]
 [0.0075  0.      0.00125 0.00125 0.      0.      0.      0.      0.98125
  0.00875]
 [0.0075  0.      0.10375 0.      0.      0.      0.      0.0025  0.0175
  0.86875]]
[2023-07-31 17:35:10,414 INFO] 310000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1746, device='cuda:0'), 'train/shrink_loss': tensor(0.0654, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0501, device='cuda:0'), 'train/removed_class_idx': 2.409523580045373, 'train/uncertainty_avg': 0.7733091651032374, 'train/certain_ratio_ema': 0.7666159525630188, 'train/total_loss': tensor(0.2249, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.027557190577452838, 'train/prefecth_time': 0.01932604789733887, 'train/run_time': 0.553954345703125, 'eval/loss': tensor(1.7099, device='cuda:0'), 'eval/top-1-acc': 0.776125, 'eval/top-5-acc': 0.978875, 'eval/precision': 0.7714018262689799, 'eval/recall': 0.7761250000000001, 'eval/F1': 0.763910349290658, 'eval/AUC': 0.9589715885416666}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 18:24:28,184 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 18:24:38,176 INFO] confusion matrix:
[[0.9675  0.      0.005   0.0025  0.00125 0.      0.00125 0.      0.01375
  0.00875]
 [0.22125 0.5     0.      0.16125 0.01375 0.03    0.0125  0.02    0.04125
  0.     ]
 [0.0075  0.00125 0.97    0.00125 0.      0.      0.      0.      0.0025
  0.0175 ]
 [0.01875 0.25875 0.      0.325   0.06875 0.22375 0.0475  0.025   0.025
  0.0075 ]
 [0.0025  0.01    0.      0.0275  0.92625 0.0125  0.01375 0.0025  0.005
  0.     ]
 [0.005   0.04    0.00125 0.04    0.03875 0.62875 0.20625 0.02625 0.01375
  0.     ]
 [0.0075  0.0075  0.00625 0.00375 0.03125 0.015   0.91875 0.005   0.0025
  0.0025 ]
 [0.02875 0.21    0.      0.10125 0.02    0.0475  0.00875 0.56625 0.0175
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.      0.      0.98375
  0.00625]
 [0.005   0.      0.0925  0.      0.      0.      0.      0.0025  0.0175
  0.8825 ]]
[2023-07-31 18:24:38,183 INFO] 315000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1736, device='cuda:0'), 'train/shrink_loss': tensor(0.0725, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0555, device='cuda:0'), 'train/removed_class_idx': 2.471153608542922, 'train/uncertainty_avg': 0.7446521942249243, 'train/certain_ratio_ema': 0.7659520705339863, 'train/total_loss': tensor(0.2293, device='cuda:0'), 'train/mask_ratio': tensor(0.7679, device='cuda:0'), 'lr': 0.02747888649128452, 'train/prefecth_time': 0.021252288818359374, 'train/run_time': 0.5545413208007812, 'eval/loss': tensor(1.7691, device='cuda:0'), 'eval/top-1-acc': 0.766875, 'eval/top-5-acc': 0.972625, 'eval/precision': 0.7602649671504784, 'eval/recall': 0.766875, 'eval/F1': 0.7558050423412034, 'eval/AUC': 0.955521875}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 19:14:10,709 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 19:14:20,855 INFO] confusion matrix:
[[0.95625 0.      0.00375 0.00375 0.00125 0.00125 0.00125 0.      0.02375
  0.00875]
 [0.22125 0.47375 0.      0.16125 0.0275  0.0275  0.01625 0.02625 0.04625
  0.     ]
 [0.015   0.      0.965   0.00125 0.      0.      0.      0.      0.00375
  0.015  ]
 [0.02    0.23875 0.0025  0.39    0.09    0.1825  0.0325  0.035   0.00125
  0.0075 ]
 [0.00125 0.005   0.00125 0.0275  0.93625 0.01    0.0125  0.00375 0.0025
  0.     ]
 [0.005   0.04    0.      0.0475  0.03875 0.61625 0.21125 0.035   0.00625
  0.     ]
 [0.0075  0.0075  0.00375 0.0075  0.03    0.0075  0.92875 0.0025  0.00125
  0.00375]
 [0.02625 0.19375 0.      0.09375 0.025   0.04    0.00625 0.615   0.
  0.     ]
 [0.0125  0.      0.      0.00375 0.      0.      0.      0.      0.975
  0.00875]
 [0.0075  0.      0.0925  0.0025  0.      0.      0.      0.00125 0.0175
  0.87875]]
[2023-07-31 19:14:20,862 INFO] 320000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.9202e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2092, device='cuda:0'), 'train/shrink_loss': tensor(0.0334, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0256, device='cuda:0'), 'train/removed_class_idx': 2.3222219641975594, 'train/uncertainty_avg': 0.7725032689806209, 'train/certain_ratio_ema': 0.7644131813676226, 'train/total_loss': tensor(0.2348, device='cuda:0'), 'train/mask_ratio': tensor(0.7991, device='cuda:0'), 'lr': 0.027399402101825884, 'train/prefecth_time': 0.02367500877380371, 'train/run_time': 0.5728856811523437, 'eval/loss': tensor(1.6912, device='cuda:0'), 'eval/top-1-acc': 0.7735, 'eval/top-5-acc': 0.978, 'eval/precision': 0.7669248055953902, 'eval/recall': 0.7735, 'eval/F1': 0.7641534881232352, 'eval/AUC': 0.9588826215277778}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 20:03:51,849 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 20:04:01,650 INFO] confusion matrix:
[[0.9525  0.00125 0.00625 0.00125 0.00125 0.00125 0.      0.      0.025
  0.01125]
 [0.1825  0.52875 0.      0.1325  0.03125 0.03    0.01125 0.03625 0.0475
  0.     ]
 [0.0175  0.      0.96375 0.00125 0.      0.      0.      0.      0.00375
  0.01375]
 [0.0225  0.25375 0.      0.36125 0.085   0.21125 0.01875 0.03625 0.0025
  0.00875]
 [0.00125 0.01    0.00125 0.0275  0.9325  0.0125  0.01    0.0025  0.0025
  0.     ]
 [0.00375 0.045   0.      0.04    0.06625 0.6725  0.13625 0.025   0.01125
  0.     ]
 [0.01125 0.0075  0.0025  0.0075  0.045   0.01375 0.90125 0.00625 0.00375
  0.00125]
 [0.02375 0.18875 0.      0.08    0.03125 0.03875 0.00375 0.6325  0.00125
  0.     ]
 [0.0075  0.      0.      0.0025  0.      0.      0.      0.      0.98125
  0.00875]
 [0.00625 0.      0.12125 0.00125 0.      0.      0.00125 0.00125 0.015
  0.85375]]
[2023-07-31 20:04:01,657 INFO] 325000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.7822e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1390, device='cuda:0'), 'train/shrink_loss': tensor(0.0679, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0519, device='cuda:0'), 'train/removed_class_idx': 2.399999791304366, 'train/uncertainty_avg': 0.7741985311254419, 'train/certain_ratio_ema': 0.7637108192368508, 'train/total_loss': tensor(0.1909, device='cuda:0'), 'train/mask_ratio': tensor(0.7433, device='cuda:0'), 'lr': 0.027318740823177663, 'train/prefecth_time': 0.02098601531982422, 'train/run_time': 0.5569652709960937, 'eval/loss': tensor(1.5503, device='cuda:0'), 'eval/top-1-acc': 0.778, 'eval/top-5-acc': 0.98025, 'eval/precision': 0.77215960143761, 'eval/recall': 0.778, 'eval/F1': 0.7690658307714751, 'eval/AUC': 0.9636659201388889}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 20:53:21,869 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 20:53:32,153 INFO] confusion matrix:
[[0.94875 0.00125 0.0075  0.0025  0.0025  0.      0.      0.      0.02625
  0.01125]
 [0.15    0.57875 0.      0.13875 0.01875 0.035   0.02    0.02875 0.03
  0.     ]
 [0.01125 0.      0.97    0.0025  0.      0.      0.      0.      0.00375
  0.0125 ]
 [0.0025  0.24    0.      0.33625 0.0925  0.1925  0.0775  0.04875 0.00125
  0.00875]
 [0.      0.0125  0.      0.0125  0.93125 0.0125  0.02625 0.0025  0.0025
  0.     ]
 [0.00375 0.04625 0.      0.02125 0.055   0.61875 0.205   0.0425  0.0075
  0.     ]
 [0.01    0.0075  0.00375 0.0025  0.0275  0.01    0.92875 0.00625 0.0025
  0.00125]
 [0.00625 0.21875 0.      0.07625 0.02625 0.03625 0.045   0.59125 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00125 0.      0.98
  0.01   ]
 [0.0075  0.      0.13    0.      0.      0.      0.0025  0.00125 0.015
  0.84375]]
[2023-07-31 20:53:32,166 INFO] 330000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.9360e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1607, device='cuda:0'), 'train/shrink_loss': tensor(0.0639, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0491, device='cuda:0'), 'train/removed_class_idx': 2.3563215682389003, 'train/uncertainty_avg': 0.752845715992374, 'train/certain_ratio_ema': 0.7680696062653919, 'train/total_loss': tensor(0.2099, device='cuda:0'), 'train/mask_ratio': tensor(0.8058, device='cuda:0'), 'lr': 0.027236906119991612, 'train/prefecth_time': 0.018073951721191406, 'train/run_time': 0.5626621704101562, 'eval/loss': tensor(1.7476, device='cuda:0'), 'eval/top-1-acc': 0.77275, 'eval/top-5-acc': 0.98025, 'eval/precision': 0.767903741323684, 'eval/recall': 0.77275, 'eval/F1': 0.7622584087004862, 'eval/AUC': 0.9574279340277777}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 21:43:10,706 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 21:43:21,241 INFO] confusion matrix:
[[0.95875 0.00125 0.00375 0.00125 0.00125 0.      0.00125 0.      0.01875
  0.01375]
 [0.16875 0.56875 0.      0.12    0.035   0.03125 0.0175  0.0375  0.02125
  0.     ]
 [0.01    0.      0.96625 0.0025  0.      0.      0.      0.      0.0025
  0.01875]
 [0.0075  0.23375 0.      0.3525  0.11375 0.205   0.04    0.0375  0.0025
  0.0075 ]
 [0.00125 0.01    0.      0.01875 0.94125 0.01    0.015   0.0025  0.00125
  0.     ]
 [0.0025  0.04875 0.      0.02    0.0525  0.6525  0.2     0.02125 0.0025
  0.     ]
 [0.01    0.00875 0.0025  0.0025  0.03875 0.01125 0.92    0.00375 0.
  0.0025 ]
 [0.0075  0.21    0.      0.0875  0.02625 0.04125 0.0075  0.62    0.
  0.     ]
 [0.01125 0.      0.      0.0025  0.      0.      0.      0.      0.97625
  0.01   ]
 [0.00625 0.      0.12125 0.      0.      0.      0.      0.00125 0.0125
  0.85875]]
[2023-07-31 21:43:21,248 INFO] 335000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0034, device='cuda:0'), 'train/certain_loss': tensor(0.1468, device='cuda:0'), 'train/shrink_loss': tensor(0.0848, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0652, device='cuda:0'), 'train/removed_class_idx': 2.552083067491347, 'train/uncertainty_avg': 0.7598179811758896, 'train/certain_ratio_ema': 0.7685496093537841, 'train/total_loss': tensor(0.2154, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.027153901507321727, 'train/prefecth_time': 0.022341920852661134, 'train/run_time': 0.5600235595703125, 'eval/loss': tensor(1.6229, device='cuda:0'), 'eval/top-1-acc': 0.7815, 'eval/top-5-acc': 0.979625, 'eval/precision': 0.7770118651104787, 'eval/recall': 0.7815000000000001, 'eval/F1': 0.7719430919189072, 'eval/AUC': 0.9613792013888889}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 22:32:43,247 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 22:33:05,263 INFO] confusion matrix:
[[0.9625  0.00125 0.0025  0.      0.00125 0.      0.00125 0.      0.02125
  0.01   ]
 [0.19    0.56625 0.      0.1425  0.0175  0.02125 0.015   0.02375 0.02375
  0.     ]
 [0.015   0.      0.96125 0.0025  0.      0.      0.      0.      0.005
  0.01625]
 [0.0225  0.225   0.      0.40125 0.07375 0.1575  0.06625 0.0425  0.00125
  0.01   ]
 [0.00375 0.01125 0.      0.0175  0.93    0.01    0.0225  0.00375 0.00125
  0.     ]
 [0.00375 0.0475  0.      0.0325  0.04625 0.61125 0.21    0.0425  0.00625
  0.     ]
 [0.01    0.00625 0.00375 0.0025  0.03625 0.00875 0.92375 0.00625 0.00125
  0.00125]
 [0.02375 0.21    0.      0.08    0.02375 0.02875 0.02625 0.6075  0.
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.00125 0.      0.98
  0.0075 ]
 [0.0075  0.      0.10875 0.      0.      0.      0.00125 0.00125 0.01125
  0.87   ]]
[2023-07-31 22:33:05,276 INFO] 340000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1585, device='cuda:0'), 'train/shrink_loss': tensor(0.0709, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0545, device='cuda:0'), 'train/removed_class_idx': 2.5728152841926906, 'train/uncertainty_avg': 0.7550155065183602, 'train/certain_ratio_ema': 0.7677081432861035, 'train/total_loss': tensor(0.2131, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.02706973055047322, 'train/prefecth_time': 0.02034454345703125, 'train/run_time': 0.5554733276367188, 'eval/loss': tensor(1.6492, device='cuda:0'), 'eval/top-1-acc': 0.781375, 'eval/top-5-acc': 0.9805, 'eval/precision': 0.778509938611179, 'eval/recall': 0.7813749999999999, 'eval/F1': 0.7728712854502324, 'eval/AUC': 0.9603264149305555}, BEST_EVAL_ACC: 0.782125, at 295000 iters
[2023-07-31 23:22:31,791 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-07-31 23:22:41,663 INFO] confusion matrix:
[[0.96125 0.      0.005   0.0025  0.0025  0.      0.      0.      0.02
  0.00875]
 [0.16    0.6     0.      0.13875 0.015   0.025   0.01375 0.02875 0.01875
  0.     ]
 [0.01    0.00125 0.96625 0.00125 0.      0.      0.      0.      0.00375
  0.0175 ]
 [0.00375 0.18125 0.      0.39375 0.08125 0.23    0.06375 0.03625 0.00375
  0.00625]
 [0.00125 0.0075  0.      0.025   0.93    0.01375 0.0175  0.00375 0.00125
  0.     ]
 [0.00375 0.03875 0.      0.03875 0.05125 0.6425  0.18625 0.0325  0.00625
  0.     ]
 [0.00875 0.005   0.00625 0.00375 0.035   0.01375 0.91625 0.0075  0.0025
  0.00125]
 [0.0075  0.1975  0.      0.0775  0.0225  0.04    0.04125 0.61375 0.
  0.     ]
 [0.01125 0.      0.      0.00125 0.      0.      0.0025  0.      0.97625
  0.00875]
 [0.0075  0.      0.08375 0.      0.      0.      0.00125 0.0025  0.01875
  0.88625]]
[2023-07-31 23:22:41,672 INFO] 345000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1579e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1446, device='cuda:0'), 'train/shrink_loss': tensor(0.1005, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0772, device='cuda:0'), 'train/removed_class_idx': 2.5049502470346288, 'train/uncertainty_avg': 0.7377687148073812, 'train/certain_ratio_ema': 0.7681912517835028, 'train/total_loss': tensor(0.2219, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.026984396864849405, 'train/prefecth_time': 0.02251532745361328, 'train/run_time': 0.57687060546875, 'eval/loss': tensor(1.4744, device='cuda:0'), 'eval/top-1-acc': 0.788625, 'eval/top-5-acc': 0.984875, 'eval/precision': 0.7837567014808234, 'eval/recall': 0.788625, 'eval/F1': 0.7803998276383868, 'eval/AUC': 0.9659549479166669}, BEST_EVAL_ACC: 0.788625, at 345000 iters
[2023-07-31 23:22:43,656 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 00:12:13,153 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 00:12:23,054 INFO] confusion matrix:
[[0.96375 0.0025  0.00625 0.      0.00125 0.      0.      0.      0.01875
  0.0075 ]
 [0.0825  0.7125  0.      0.105   0.01    0.02    0.01625 0.0325  0.02125
  0.     ]
 [0.0125  0.00125 0.9675  0.00125 0.      0.      0.      0.      0.0025
  0.015  ]
 [0.00125 0.20125 0.      0.3425  0.085   0.23625 0.08375 0.04125 0.00125
  0.0075 ]
 [0.      0.01375 0.      0.02    0.92375 0.01375 0.02375 0.00375 0.00125
  0.     ]
 [0.00375 0.04625 0.      0.025   0.045   0.64125 0.20125 0.0325  0.005
  0.     ]
 [0.0075  0.005   0.00375 0.0025  0.0325  0.01125 0.9275  0.0075  0.00125
  0.00125]
 [0.00125 0.2     0.      0.0625  0.0225  0.03875 0.04375 0.63125 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.0025  0.      0.9825
  0.00625]
 [0.01    0.00125 0.1     0.      0.      0.      0.00125 0.0025  0.02
  0.865  ]]
[2023-08-01 00:12:23,063 INFO] 350000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.9318e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1274, device='cuda:0'), 'train/shrink_loss': tensor(0.0759, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0585, device='cuda:0'), 'train/removed_class_idx': 2.4017854998405803, 'train/uncertainty_avg': 0.7599478095247887, 'train/certain_ratio_ema': 0.7700700824024522, 'train/total_loss': tensor(0.1860, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.026897904115796407, 'train/prefecth_time': 0.01944406318664551, 'train/run_time': 0.5781283569335938, 'eval/loss': tensor(1.5165, device='cuda:0'), 'eval/top-1-acc': 0.79575, 'eval/top-5-acc': 0.982375, 'eval/precision': 0.7932031799182911, 'eval/recall': 0.79575, 'eval/F1': 0.7864240060029133, 'eval/AUC': 0.9649525694444443}, BEST_EVAL_ACC: 0.79575, at 350000 iters
[2023-08-01 00:12:25,349 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 01:01:39,897 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 01:01:49,987 INFO] confusion matrix:
[[0.96125 0.00125 0.00375 0.      0.0025  0.      0.00125 0.      0.02
  0.01   ]
 [0.07375 0.7475  0.      0.095   0.01375 0.02    0.015   0.015   0.01875
  0.00125]
 [0.01375 0.      0.96625 0.0025  0.      0.      0.      0.      0.005
  0.0125 ]
 [0.00125 0.18875 0.      0.355   0.10375 0.2375  0.07125 0.0325  0.00125
  0.00875]
 [0.      0.01125 0.00125 0.0175  0.9325  0.0125  0.01875 0.00375 0.0025
  0.     ]
 [0.0025  0.0475  0.      0.02375 0.05125 0.63625 0.2075  0.02375 0.0075
  0.     ]
 [0.0075  0.01    0.00375 0.0025  0.03125 0.00875 0.92625 0.0075  0.00125
  0.00125]
 [0.00375 0.225   0.      0.0875  0.03125 0.045   0.03375 0.57375 0.
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.00125 0.      0.97875
  0.01   ]
 [0.00625 0.00125 0.10375 0.      0.      0.      0.00125 0.00125 0.01
  0.87625]]
[2023-08-01 01:01:49,994 INFO] 355000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.6008e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1505, device='cuda:0'), 'train/shrink_loss': tensor(0.0720, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0554, device='cuda:0'), 'train/removed_class_idx': 2.446428352997468, 'train/uncertainty_avg': 0.7425331108397757, 'train/certain_ratio_ema': 0.7695745786124992, 'train/total_loss': tensor(0.2059, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.026810256018445704, 'train/prefecth_time': 0.022897344589233398, 'train/run_time': 0.5575889282226563, 'eval/loss': tensor(1.5059, device='cuda:0'), 'eval/top-1-acc': 0.795375, 'eval/top-5-acc': 0.983625, 'eval/precision': 0.7949881594560059, 'eval/recall': 0.795375, 'eval/F1': 0.7858371100227866, 'eval/AUC': 0.9639568836805554}, BEST_EVAL_ACC: 0.79575, at 350000 iters
[2023-08-01 01:51:24,827 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 01:51:35,097 INFO] confusion matrix:
[[0.96375 0.0025  0.00375 0.00125 0.00125 0.      0.00125 0.      0.015
  0.01125]
 [0.06875 0.75875 0.      0.105   0.01125 0.01875 0.005   0.01625 0.01625
  0.     ]
 [0.005   0.00125 0.97625 0.00125 0.      0.      0.      0.      0.00375
  0.0125 ]
 [0.      0.14    0.      0.4675  0.09375 0.2425  0.01875 0.03    0.00125
  0.00625]
 [0.      0.0075  0.      0.03875 0.93125 0.0075  0.0125  0.00125 0.00125
  0.     ]
 [0.0025  0.04125 0.      0.06    0.0575  0.62125 0.1825  0.0325  0.0025
  0.     ]
 [0.0075  0.01    0.00375 0.01    0.04    0.01125 0.9075  0.0075  0.00125
  0.00125]
 [0.00125 0.1925  0.      0.1225  0.01875 0.0375  0.00625 0.62125 0.
  0.     ]
 [0.00875 0.      0.      0.00375 0.      0.      0.      0.      0.97875
  0.00875]
 [0.0075  0.00125 0.1     0.00125 0.      0.      0.      0.0025  0.0175
  0.87   ]]
[2023-08-01 01:51:35,107 INFO] 360000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.8368e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1418, device='cuda:0'), 'train/shrink_loss': tensor(0.0756, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0579, device='cuda:0'), 'train/removed_class_idx': 2.4017854998405803, 'train/uncertainty_avg': 0.7593413280608745, 'train/certain_ratio_ema': 0.7661070282770418, 'train/total_loss': tensor(0.1998, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.026721456337554565, 'train/prefecth_time': 0.020836448669433592, 'train/run_time': 0.5568505859375, 'eval/loss': tensor(1.2586, device='cuda:0'), 'eval/top-1-acc': 0.809625, 'eval/top-5-acc': 0.988, 'eval/precision': 0.8081190114871688, 'eval/recall': 0.8096249999999999, 'eval/F1': 0.8044892162675747, 'eval/AUC': 0.9722457812499998}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 01:51:36,827 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 02:41:01,159 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 02:41:11,017 INFO] confusion matrix:
[[0.96375 0.      0.00625 0.00125 0.00125 0.      0.00125 0.      0.01875
  0.0075 ]
 [0.06625 0.76625 0.      0.09875 0.01    0.01875 0.01    0.0125  0.0175
  0.     ]
 [0.01375 0.00125 0.9725  0.00125 0.      0.      0.      0.      0.0025
  0.00875]
 [0.0025  0.18625 0.      0.44375 0.06875 0.22375 0.02875 0.0375  0.00375
  0.005  ]
 [0.00125 0.01    0.      0.035   0.92625 0.01    0.01375 0.0025  0.00125
  0.     ]
 [0.00375 0.0475  0.      0.04875 0.04375 0.61875 0.19875 0.0325  0.00625
  0.     ]
 [0.0075  0.00875 0.00375 0.00875 0.03125 0.00875 0.92375 0.00625 0.00125
  0.     ]
 [0.00625 0.22125 0.      0.16125 0.02125 0.04    0.00875 0.54    0.00125
  0.     ]
 [0.01    0.      0.      0.00375 0.      0.      0.      0.      0.9775
  0.00875]
 [0.0075  0.00125 0.13125 0.00125 0.      0.      0.      0.00125 0.0175
  0.84   ]]
[2023-08-01 02:41:11,024 INFO] 365000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.4130e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1632, device='cuda:0'), 'train/shrink_loss': tensor(0.0750, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0580, device='cuda:0'), 'train/removed_class_idx': 2.3039213427528096, 'train/uncertainty_avg': 0.7568597603779231, 'train/certain_ratio_ema': 0.7740900834059717, 'train/total_loss': tensor(0.2213, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.026631508887344345, 'train/prefecth_time': 0.021140960693359374, 'train/run_time': 0.5934761352539063, 'eval/loss': tensor(1.4478, device='cuda:0'), 'eval/top-1-acc': 0.79725, 'eval/top-5-acc': 0.984125, 'eval/precision': 0.7976948845761886, 'eval/recall': 0.79725, 'eval/F1': 0.7907099018726111, 'eval/AUC': 0.9658215711805554}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 03:30:28,017 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 03:30:38,119 INFO] confusion matrix:
[[0.96125 0.      0.00625 0.00125 0.0025  0.      0.00125 0.      0.0175
  0.01   ]
 [0.0675  0.7625  0.      0.09875 0.01    0.015   0.0125  0.02375 0.01
  0.     ]
 [0.01125 0.00125 0.9775  0.00125 0.      0.      0.      0.      0.0025
  0.00625]
 [0.00375 0.23625 0.      0.41125 0.0875  0.17875 0.035   0.03625 0.00375
  0.0075 ]
 [0.00125 0.01    0.      0.03125 0.9275  0.00875 0.01625 0.00375 0.00125
  0.     ]
 [0.005   0.04625 0.      0.04    0.0525  0.60125 0.22625 0.02625 0.0025
  0.     ]
 [0.01    0.01    0.005   0.00875 0.02875 0.005   0.925   0.00625 0.00125
  0.     ]
 [0.00625 0.1875  0.      0.105   0.02625 0.03    0.00875 0.63625 0.
  0.     ]
 [0.0125  0.      0.      0.0025  0.      0.      0.      0.      0.97125
  0.01375]
 [0.0075  0.00125 0.18    0.00125 0.      0.      0.      0.00125 0.015
  0.79375]]
[2023-08-01 03:30:38,125 INFO] 370000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1236, device='cuda:0'), 'train/shrink_loss': tensor(0.0758, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0584, device='cuda:0'), 'train/removed_class_idx': 2.4036695042505043, 'train/uncertainty_avg': 0.7765964489512138, 'train/certain_ratio_ema': 0.7695645361055461, 'train/total_loss': tensor(0.1821, device='cuda:0'), 'train/mask_ratio': tensor(0.7567, device='cuda:0'), 'lr': 0.02654041753133663, 'train/prefecth_time': 0.02652729606628418, 'train/run_time': 0.5580736694335937, 'eval/loss': tensor(1.4866, device='cuda:0'), 'eval/top-1-acc': 0.79675, 'eval/top-5-acc': 0.984125, 'eval/precision': 0.7974003663510781, 'eval/recall': 0.7967500000000001, 'eval/F1': 0.7897095451110424, 'eval/AUC': 0.9653882812500001}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 04:20:04,883 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 04:20:14,976 INFO] confusion matrix:
[[0.96    0.      0.0075  0.0025  0.00125 0.      0.00125 0.      0.01625
  0.01125]
 [0.07625 0.75875 0.      0.08875 0.0125  0.01625 0.01125 0.02    0.01625
  0.     ]
 [0.00375 0.00125 0.97625 0.0025  0.      0.      0.00125 0.      0.0075
  0.0075 ]
 [0.0075  0.195   0.      0.39875 0.08125 0.20625 0.05875 0.04125 0.005
  0.00625]
 [0.      0.01    0.      0.02375 0.93625 0.01125 0.01375 0.00375 0.00125
  0.     ]
 [0.0025  0.04375 0.      0.03375 0.06375 0.6425  0.17625 0.0325  0.005
  0.     ]
 [0.005   0.00875 0.005   0.0025  0.02875 0.01    0.92875 0.00625 0.00375
  0.00125]
 [0.01    0.1775  0.      0.095   0.02625 0.03625 0.02875 0.625   0.00125
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00125 0.      0.98
  0.01   ]
 [0.005   0.00125 0.145   0.      0.      0.      0.00125 0.0025  0.01625
  0.82875]]
[2023-08-01 04:20:14,983 INFO] 375000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.1928e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1095, device='cuda:0'), 'train/shrink_loss': tensor(0.0598, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0458, device='cuda:0'), 'train/removed_class_idx': 2.3523807283446923, 'train/uncertainty_avg': 0.7576760217593155, 'train/certain_ratio_ema': 0.7666465984061985, 'train/total_loss': tensor(0.1555, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.02644818618218733, 'train/prefecth_time': 0.018928447723388673, 'train/run_time': 0.5661663208007812, 'eval/loss': tensor(1.3511, device='cuda:0'), 'eval/top-1-acc': 0.8035, 'eval/top-5-acc': 0.98625, 'eval/precision': 0.8015179909484473, 'eval/recall': 0.8035, 'eval/F1': 0.7954689532113444, 'eval/AUC': 0.9715263194444447}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 05:09:52,898 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 05:10:02,709 INFO] confusion matrix:
[[0.96625 0.00125 0.00375 0.      0.00125 0.      0.00125 0.      0.0175
  0.00875]
 [0.0825  0.7675  0.      0.0775  0.015   0.01875 0.01    0.015   0.01375
  0.     ]
 [0.0125  0.00125 0.97125 0.00125 0.      0.      0.      0.      0.005
  0.00875]
 [0.005   0.195   0.      0.335   0.095   0.2575  0.06125 0.0275  0.01625
  0.0075 ]
 [0.      0.0125  0.      0.01375 0.93    0.01375 0.025   0.00375 0.00125
  0.     ]
 [0.0025  0.045   0.      0.02625 0.05125 0.64125 0.20375 0.02875 0.00125
  0.     ]
 [0.005   0.01    0.00375 0.0025  0.02875 0.01125 0.92875 0.005   0.00375
  0.00125]
 [0.00625 0.1925  0.      0.095   0.02875 0.0425  0.02625 0.59625 0.0125
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.00125 0.      0.97375
  0.01375]
 [0.0075  0.00125 0.1475  0.      0.      0.      0.00375 0.0025  0.01
  0.8275 ]]
[2023-08-01 05:10:02,715 INFO] 380000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0007, device='cuda:0'), 'train/certain_loss': tensor(0.1470, device='cuda:0'), 'train/shrink_loss': tensor(0.0920, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0700, device='cuda:0'), 'train/removed_class_idx': 2.4536079944734026, 'train/uncertainty_avg': 0.7503772569118006, 'train/certain_ratio_ema': 0.7614720626722897, 'train/total_loss': tensor(0.2177, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.02635481880151857, 'train/prefecth_time': 0.03307619094848633, 'train/run_time': 0.5646725463867187, 'eval/loss': tensor(1.4789, device='cuda:0'), 'eval/top-1-acc': 0.79375, 'eval/top-5-acc': 0.981625, 'eval/precision': 0.7926424787498354, 'eval/recall': 0.79375, 'eval/F1': 0.783288779786481, 'eval/AUC': 0.9666109375000002}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 05:59:14,402 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 05:59:24,229 INFO] confusion matrix:
[[0.96125 0.00125 0.00625 0.00125 0.00125 0.      0.00125 0.      0.0175
  0.01   ]
 [0.07375 0.77875 0.      0.075   0.01    0.0125  0.01125 0.025   0.01375
  0.     ]
 [0.015   0.00125 0.9725  0.00125 0.      0.      0.      0.      0.0025
  0.0075 ]
 [0.00125 0.18625 0.      0.41625 0.075   0.19625 0.065   0.04625 0.00625
  0.0075 ]
 [0.      0.01    0.      0.02    0.94    0.00625 0.02    0.0025  0.00125
  0.     ]
 [0.0025  0.03875 0.      0.035   0.05375 0.62125 0.21125 0.02875 0.00875
  0.     ]
 [0.01    0.00375 0.00375 0.0025  0.02875 0.01125 0.92875 0.01    0.00125
  0.     ]
 [0.0025  0.185   0.      0.07    0.02    0.03125 0.04125 0.65    0.
  0.     ]
 [0.01    0.      0.00125 0.00125 0.      0.      0.0025  0.      0.975
  0.01   ]
 [0.005   0.00125 0.1975  0.      0.      0.      0.      0.00125 0.0125
  0.7825 ]]
[2023-08-01 05:59:24,235 INFO] 385000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1791, device='cuda:0'), 'train/shrink_loss': tensor(0.0448, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0346, device='cuda:0'), 'train/removed_class_idx': 2.573332990222268, 'train/uncertainty_avg': 0.7348837003763312, 'train/certain_ratio_ema': 0.7720784538513266, 'train/total_loss': tensor(0.2139, device='cuda:0'), 'train/mask_ratio': tensor(0.8326, device='cuda:0'), 'lr': 0.02626031939974855, 'train/prefecth_time': 0.019926528930664062, 'train/run_time': 0.5636055297851562, 'eval/loss': tensor(1.3564, device='cuda:0'), 'eval/top-1-acc': 0.802625, 'eval/top-5-acc': 0.986875, 'eval/precision': 0.8038074651293398, 'eval/recall': 0.8026249999999999, 'eval/F1': 0.7947805527389507, 'eval/AUC': 0.9720246354166666}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 06:48:49,320 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 06:48:59,699 INFO] confusion matrix:
[[0.96    0.00125 0.00625 0.      0.0025  0.      0.00125 0.      0.01875
  0.01   ]
 [0.0725  0.80875 0.      0.02625 0.01375 0.01875 0.01    0.03375 0.01625
  0.     ]
 [0.01125 0.00125 0.9725  0.00125 0.      0.      0.      0.      0.0025
  0.01125]
 [0.01625 0.18375 0.      0.3175  0.07375 0.25875 0.05875 0.07625 0.00625
  0.00875]
 [0.      0.0075  0.      0.015   0.9325  0.00875 0.025   0.01    0.00125
  0.     ]
 [0.0025  0.03125 0.      0.01875 0.05    0.64875 0.19625 0.0475  0.005
  0.     ]
 [0.005   0.0125  0.00375 0.0025  0.02625 0.01375 0.92875 0.005   0.00125
  0.00125]
 [0.01625 0.2     0.      0.035   0.015   0.0425  0.0275  0.6625  0.00125
  0.     ]
 [0.01    0.      0.00125 0.00125 0.      0.      0.00125 0.      0.975
  0.01125]
 [0.005   0.00125 0.17875 0.      0.      0.      0.0025  0.00125 0.015
  0.79625]]
[2023-08-01 06:48:59,707 INFO] 390000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.7127e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1133, device='cuda:0'), 'train/shrink_loss': tensor(0.0645, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0494, device='cuda:0'), 'train/removed_class_idx': 2.575757315580069, 'train/uncertainty_avg': 0.747575944467969, 'train/certain_ratio_ema': 0.7656089915735893, 'train/total_loss': tensor(0.1628, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.02616469203591929, 'train/prefecth_time': 0.03511859130859375, 'train/run_time': 0.5687034301757813, 'eval/loss': tensor(1.4191, device='cuda:0'), 'eval/top-1-acc': 0.80025, 'eval/top-5-acc': 0.980625, 'eval/precision': 0.8029859190972118, 'eval/recall': 0.8002499999999999, 'eval/F1': 0.7883297788278342, 'eval/AUC': 0.9703175520833333}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 07:38:12,684 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 07:38:33,913 INFO] confusion matrix:
[[0.96    0.      0.005   0.00125 0.00125 0.00125 0.00125 0.      0.01875
  0.01125]
 [0.0675  0.78375 0.      0.06875 0.0125  0.0225  0.00875 0.02125 0.015
  0.     ]
 [0.01125 0.00125 0.9725  0.00125 0.      0.      0.      0.      0.00375
  0.01   ]
 [0.0125  0.19625 0.00125 0.34875 0.11625 0.22    0.06125 0.03375 0.00375
  0.00625]
 [0.      0.00625 0.      0.015   0.93875 0.01    0.02625 0.0025  0.00125
  0.     ]
 [0.0025  0.04    0.      0.02125 0.06625 0.62    0.21    0.03125 0.00875
  0.     ]
 [0.00625 0.005   0.00375 0.0025  0.03625 0.0125  0.92875 0.00375 0.00125
  0.     ]
 [0.01375 0.19625 0.      0.0525  0.0325  0.0425  0.03125 0.63125 0.
  0.     ]
 [0.00875 0.      0.00125 0.00125 0.      0.      0.00125 0.      0.9775
  0.01   ]
 [0.0075  0.00125 0.1425  0.      0.      0.      0.00375 0.00125 0.01625
  0.8275 ]]
[2023-08-01 07:38:33,919 INFO] 395000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.7342e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1755, device='cuda:0'), 'train/shrink_loss': tensor(0.0795, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0614, device='cuda:0'), 'train/removed_class_idx': 2.5327100436719583, 'train/uncertainty_avg': 0.7457364794172862, 'train/certain_ratio_ema': 0.7728281852562454, 'train/total_loss': tensor(0.2370, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.026067940817522273, 'train/prefecth_time': 0.019681055068969725, 'train/run_time': 0.55573681640625, 'eval/loss': tensor(1.4547, device='cuda:0'), 'eval/top-1-acc': 0.798875, 'eval/top-5-acc': 0.9855, 'eval/precision': 0.8000809096717043, 'eval/recall': 0.798875, 'eval/F1': 0.7884419953339228, 'eval/AUC': 0.9678007638888887}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 08:27:45,705 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 08:27:55,864 INFO] confusion matrix:
[[0.96125 0.00125 0.005   0.      0.0025  0.00125 0.00125 0.      0.0175
  0.01   ]
 [0.07625 0.77625 0.      0.06    0.0075  0.02375 0.005   0.03125 0.02
  0.     ]
 [0.01375 0.00125 0.96875 0.00125 0.      0.      0.      0.      0.0025
  0.0125 ]
 [0.02    0.16625 0.      0.37375 0.09    0.25625 0.01625 0.06625 0.005
  0.00625]
 [0.      0.0075  0.      0.02875 0.92125 0.01625 0.0125  0.0125  0.00125
  0.     ]
 [0.00375 0.0325  0.      0.03875 0.0575  0.6425  0.1825  0.035   0.0075
  0.     ]
 [0.00875 0.00625 0.00375 0.00375 0.03    0.01375 0.925   0.00625 0.0025
  0.     ]
 [0.01875 0.20375 0.      0.09375 0.02625 0.05125 0.00625 0.59875 0.00125
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.      0.      0.98
  0.00875]
 [0.0075  0.00125 0.14125 0.      0.      0.      0.      0.0025  0.01375
  0.83375]]
[2023-08-01 08:27:55,871 INFO] 400000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.2549e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1085, device='cuda:0'), 'train/shrink_loss': tensor(0.0486, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0374, device='cuda:0'), 'train/removed_class_idx': 2.4536079944734026, 'train/uncertainty_avg': 0.7276388446218324, 'train/certain_ratio_ema': 0.7697521763186612, 'train/total_loss': tensor(0.1460, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.025970069900322013, 'train/prefecth_time': 0.01838319969177246, 'train/run_time': 0.5683152465820313, 'eval/loss': tensor(1.3723, device='cuda:0'), 'eval/top-1-acc': 0.798125, 'eval/top-5-acc': 0.986, 'eval/precision': 0.7935768718806554, 'eval/recall': 0.7981250000000001, 'eval/F1': 0.7889804576946389, 'eval/AUC': 0.9691012586805556}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 09:17:07,088 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 09:17:27,740 INFO] confusion matrix:
[[0.9575  0.00125 0.00625 0.      0.0025  0.      0.00125 0.      0.01875
  0.0125 ]
 [0.0725  0.78375 0.      0.0675  0.0075  0.01875 0.01    0.02375 0.01625
  0.     ]
 [0.01125 0.00125 0.97    0.00125 0.      0.      0.00125 0.      0.0025
  0.0125 ]
 [0.015   0.22    0.      0.28875 0.11375 0.24625 0.05    0.05375 0.0075
  0.005  ]
 [0.      0.0125  0.      0.015   0.93875 0.00875 0.0175  0.00625 0.00125
  0.     ]
 [0.00125 0.04625 0.      0.01625 0.06    0.63375 0.19125 0.04125 0.01
  0.     ]
 [0.00625 0.01    0.00375 0.00125 0.0225  0.01125 0.93625 0.0075  0.00125
  0.     ]
 [0.01875 0.205   0.      0.04375 0.03    0.04    0.0275  0.63375 0.00125
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.00125 0.      0.9775
  0.01125]
 [0.0075  0.00125 0.14625 0.      0.      0.      0.      0.00125 0.0175
  0.82625]]
[2023-08-01 09:17:27,747 INFO] 405000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1373, device='cuda:0'), 'train/shrink_loss': tensor(0.0570, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0440, device='cuda:0'), 'train/removed_class_idx': 2.4499997550000243, 'train/uncertainty_avg': 0.7564686152849355, 'train/certain_ratio_ema': 0.7717700602511501, 'train/total_loss': tensor(0.1814, device='cuda:0'), 'train/mask_ratio': tensor(0.7768, device='cuda:0'), 'lr': 0.02587108348817756, 'train/prefecth_time': 0.018908159255981445, 'train/run_time': 0.5846188354492188, 'eval/loss': tensor(1.5129, device='cuda:0'), 'eval/top-1-acc': 0.794625, 'eval/top-5-acc': 0.981125, 'eval/precision': 0.7931316111279937, 'eval/recall': 0.794625, 'eval/F1': 0.7815973332465048, 'eval/AUC': 0.967241154513889}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 10:06:36,943 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 10:06:46,726 INFO] confusion matrix:
[[0.9575  0.      0.005   0.00125 0.0025  0.00125 0.00125 0.      0.01875
  0.0125 ]
 [0.0725  0.79125 0.      0.04125 0.0125  0.02125 0.005   0.03875 0.0175
  0.     ]
 [0.015   0.00125 0.96875 0.00125 0.      0.      0.      0.      0.00375
  0.01   ]
 [0.00875 0.15375 0.      0.34    0.09375 0.295   0.01125 0.085   0.00625
  0.00625]
 [0.      0.01    0.      0.02375 0.9275  0.01125 0.0125  0.01375 0.00125
  0.     ]
 [0.0025  0.03375 0.      0.02625 0.0725  0.63875 0.175   0.045   0.00625
  0.     ]
 [0.0075  0.00375 0.005   0.00875 0.025   0.0125  0.92875 0.00625 0.0025
  0.     ]
 [0.01    0.2     0.      0.04125 0.02625 0.0525  0.00625 0.6625  0.00125
  0.     ]
 [0.0075  0.      0.      0.0025  0.      0.      0.      0.      0.9825
  0.0075 ]
 [0.005   0.00125 0.14625 0.00125 0.      0.      0.      0.00125 0.015
  0.83   ]]
[2023-08-01 10:06:46,735 INFO] 410000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.6903e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1379, device='cuda:0'), 'train/shrink_loss': tensor(0.0370, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0287, device='cuda:0'), 'train/removed_class_idx': 2.4468082503395476, 'train/uncertainty_avg': 0.7496965332372348, 'train/certain_ratio_ema': 0.7747765528622793, 'train/total_loss': tensor(0.1666, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.025770985832861918, 'train/prefecth_time': 0.019108671188354492, 'train/run_time': 0.549870849609375, 'eval/loss': tensor(1.4107, device='cuda:0'), 'eval/top-1-acc': 0.80275, 'eval/top-5-acc': 0.98475, 'eval/precision': 0.8001618551665498, 'eval/recall': 0.80275, 'eval/F1': 0.7924040739880541, 'eval/AUC': 0.9694701822916667}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 10:56:20,195 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 10:56:30,696 INFO] confusion matrix:
[[0.96625 0.00125 0.00625 0.      0.00125 0.      0.00125 0.      0.0175
  0.00625]
 [0.07125 0.76625 0.      0.0925  0.0125  0.01875 0.005   0.01125 0.0225
  0.     ]
 [0.00625 0.      0.97875 0.00375 0.      0.      0.0025  0.      0.0025
  0.00625]
 [0.00125 0.18125 0.      0.42625 0.07125 0.24375 0.01875 0.03625 0.01625
  0.005  ]
 [0.      0.0125  0.      0.04375 0.91625 0.0125  0.01    0.00375 0.00125
  0.     ]
 [0.00125 0.0475  0.      0.06125 0.0525  0.64    0.15875 0.03125 0.0075
  0.     ]
 [0.005   0.00625 0.00375 0.00875 0.03375 0.01125 0.92    0.00875 0.0025
  0.     ]
 [0.00375 0.2125  0.      0.13375 0.01875 0.0475  0.00625 0.5675  0.01
  0.     ]
 [0.00625 0.      0.      0.00125 0.00125 0.      0.      0.      0.98375
  0.0075 ]
 [0.0075  0.00125 0.19125 0.00125 0.      0.      0.      0.00125 0.01
  0.7875 ]]
[2023-08-01 10:56:30,703 INFO] 415000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.0976, device='cuda:0'), 'train/shrink_loss': tensor(0.1006, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0776, device='cuda:0'), 'train/removed_class_idx': 2.5454542883379507, 'train/uncertainty_avg': 0.743194437877496, 'train/certain_ratio_ema': 0.7711352862362969, 'train/total_loss': tensor(0.1753, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.025669781233879443, 'train/prefecth_time': 0.01884992027282715, 'train/run_time': 0.5979955444335937, 'eval/loss': tensor(1.4774, device='cuda:0'), 'eval/top-1-acc': 0.79525, 'eval/top-5-acc': 0.9825, 'eval/precision': 0.795835050362163, 'eval/recall': 0.79525, 'eval/F1': 0.7887031378601383, 'eval/AUC': 0.9663852170138889}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 11:45:45,779 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 11:46:08,098 INFO] confusion matrix:
[[0.9675  0.00125 0.00375 0.      0.0025  0.      0.      0.      0.015
  0.01   ]
 [0.06875 0.78875 0.      0.0875  0.01125 0.01375 0.00625 0.00875 0.015
  0.     ]
 [0.01125 0.00125 0.965   0.0025  0.      0.      0.00125 0.      0.0025
  0.01625]
 [0.00125 0.20875 0.      0.40375 0.0725  0.2225  0.0225  0.045   0.01125
  0.0125 ]
 [0.00125 0.01    0.      0.04375 0.915   0.01125 0.01375 0.00375 0.00125
  0.     ]
 [0.      0.04625 0.      0.05    0.05    0.61875 0.18    0.04875 0.00625
  0.     ]
 [0.0025  0.00625 0.0025  0.0075  0.025   0.00625 0.93625 0.0075  0.005
  0.00125]
 [0.00375 0.2125  0.      0.1075  0.01875 0.0375  0.005   0.59875 0.0125
  0.00375]
 [0.0075  0.      0.      0.00125 0.      0.00125 0.      0.      0.98125
  0.00875]
 [0.00875 0.00125 0.10125 0.      0.      0.      0.      0.00125 0.015
  0.8725 ]]
[2023-08-01 11:46:08,105 INFO] 420000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1094, device='cuda:0'), 'train/shrink_loss': tensor(0.0426, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0330, device='cuda:0'), 'train/removed_class_idx': 2.4062497493489845, 'train/uncertainty_avg': 0.7331902806902199, 'train/certain_ratio_ema': 0.7750024399171295, 'train/total_loss': tensor(0.1425, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.025567474038281135, 'train/prefecth_time': 0.021383424758911133, 'train/run_time': 0.5500577392578125, 'eval/loss': tensor(1.4284, device='cuda:0'), 'eval/top-1-acc': 0.80475, 'eval/top-5-acc': 0.983375, 'eval/precision': 0.801535936280479, 'eval/recall': 0.80475, 'eval/F1': 0.7973380962236308, 'eval/AUC': 0.9680483680555557}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 12:35:22,765 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 12:35:32,581 INFO] confusion matrix:
[[0.965   0.      0.00625 0.00125 0.00125 0.00125 0.00125 0.      0.015
  0.00875]
 [0.0775  0.77125 0.      0.06375 0.01125 0.02    0.00375 0.0425  0.00875
  0.00125]
 [0.0025  0.00125 0.97625 0.00125 0.      0.      0.      0.0025  0.005
  0.01125]
 [0.005   0.18    0.      0.37875 0.08875 0.25    0.01375 0.0775  0.00125
  0.005  ]
 [0.      0.01    0.      0.02625 0.93125 0.0125  0.0125  0.00625 0.00125
  0.     ]
 [0.      0.04375 0.      0.03125 0.0575  0.6375  0.1925  0.03375 0.00375
  0.     ]
 [0.005   0.00375 0.0025  0.0025  0.03125 0.01125 0.9325  0.00875 0.0025
  0.     ]
 [0.0025  0.19125 0.      0.0525  0.02625 0.04875 0.00625 0.6725  0.
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.      0.      0.98
  0.01   ]
 [0.00625 0.00125 0.15375 0.      0.      0.      0.00125 0.005   0.01625
  0.81625]]
[2023-08-01 12:35:32,588 INFO] 425000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1128, device='cuda:0'), 'train/shrink_loss': tensor(0.0677, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0520, device='cuda:0'), 'train/removed_class_idx': 2.4310342731867007, 'train/uncertainty_avg': 0.7493485421868112, 'train/certain_ratio_ema': 0.7677948116585362, 'train/total_loss': tensor(0.1651, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.025464068640477944, 'train/prefecth_time': 0.020205856323242188, 'train/run_time': 0.5570157470703125, 'eval/loss': tensor(1.3561, device='cuda:0'), 'eval/top-1-acc': 0.806125, 'eval/top-5-acc': 0.9835, 'eval/precision': 0.8036632888636277, 'eval/recall': 0.8061250000000001, 'eval/F1': 0.7975713010680877, 'eval/AUC': 0.9697098784722222}, BEST_EVAL_ACC: 0.809625, at 360000 iters
[2023-08-01 13:24:48,700 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 13:25:10,143 INFO] confusion matrix:
[[0.96875 0.      0.00625 0.00125 0.00125 0.      0.      0.      0.015
  0.0075 ]
 [0.07625 0.7875  0.      0.08    0.01    0.0125  0.005   0.01125 0.0175
  0.     ]
 [0.0075  0.0025  0.9775  0.00125 0.      0.      0.      0.      0.0025
  0.00875]
 [0.0025  0.2075  0.00125 0.4025  0.10875 0.21125 0.015   0.04    0.00375
  0.0075 ]
 [0.      0.00875 0.      0.03125 0.93625 0.00875 0.00875 0.005   0.00125
  0.     ]
 [0.0025  0.04375 0.      0.02625 0.06625 0.70375 0.115   0.035   0.0075
  0.     ]
 [0.00875 0.01    0.00375 0.00625 0.03375 0.00875 0.9225  0.005   0.00125
  0.     ]
 [0.005   0.2125  0.      0.08875 0.0225  0.045   0.0075  0.61875 0.
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.      0.      0.98
  0.01   ]
 [0.01125 0.00125 0.1525  0.      0.      0.      0.0025  0.00125 0.015
  0.81625]]
[2023-08-01 13:25:10,150 INFO] 430000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1397, device='cuda:0'), 'train/shrink_loss': tensor(0.0765, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0585, device='cuda:0'), 'train/removed_class_idx': 2.535714059311245, 'train/uncertainty_avg': 0.7337882047203864, 'train/certain_ratio_ema': 0.7644072344796743, 'train/total_loss': tensor(0.1983, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.025359569482051997, 'train/prefecth_time': 0.01938252830505371, 'train/run_time': 0.5586736450195312, 'eval/loss': tensor(1.2742, device='cuda:0'), 'eval/top-1-acc': 0.811375, 'eval/top-5-acc': 0.98625, 'eval/precision': 0.8118016223014983, 'eval/recall': 0.8113750000000002, 'eval/F1': 0.804126196875251, 'eval/AUC': 0.9717059982638891}, BEST_EVAL_ACC: 0.811375, at 430000 iters
[2023-08-01 13:25:12,707 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 14:14:29,029 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 14:14:39,515 INFO] confusion matrix:
[[0.9625  0.      0.00875 0.00125 0.00125 0.00125 0.      0.      0.0175
  0.0075 ]
 [0.07125 0.78375 0.0025  0.08125 0.00875 0.01625 0.005   0.0125  0.01875
  0.     ]
 [0.0025  0.00125 0.97625 0.00125 0.      0.      0.      0.      0.005
  0.01375]
 [0.00125 0.16    0.00875 0.4725  0.06375 0.20625 0.035   0.0425  0.005
  0.005  ]
 [0.      0.00875 0.00625 0.03625 0.92125 0.0075  0.0125  0.00625 0.00125
  0.     ]
 [0.      0.045   0.00625 0.04125 0.05125 0.62625 0.185   0.03625 0.00875
  0.     ]
 [0.00625 0.005   0.01    0.0025  0.025   0.01125 0.93    0.0075  0.0025
  0.     ]
 [0.00125 0.2     0.0175  0.10375 0.01875 0.04125 0.02    0.59625 0.00125
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.      0.      0.97875
  0.01   ]
 [0.0075  0.00125 0.08875 0.      0.      0.      0.      0.00125 0.0175
  0.88375]]
[2023-08-01 14:14:39,522 INFO] 435000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.3242e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1518, device='cuda:0'), 'train/shrink_loss': tensor(0.0378, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0294, device='cuda:0'), 'train/removed_class_idx': 2.5555552716049696, 'train/uncertainty_avg': 0.7417929245682549, 'train/certain_ratio_ema': 0.7780779945835316, 'train/total_loss': tensor(0.1813, device='cuda:0'), 'train/mask_ratio': tensor(0.7991, device='cuda:0'), 'lr': 0.02525398105156584, 'train/prefecth_time': 0.020834367752075197, 'train/run_time': 0.552060791015625, 'eval/loss': tensor(1.2401, device='cuda:0'), 'eval/top-1-acc': 0.813125, 'eval/top-5-acc': 0.986625, 'eval/precision': 0.8114019518286891, 'eval/recall': 0.813125, 'eval/F1': 0.8066367737475195, 'eval/AUC': 0.9728687239583336}, BEST_EVAL_ACC: 0.813125, at 435000 iters
[2023-08-01 14:14:42,758 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 15:04:07,590 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 15:04:17,607 INFO] confusion matrix:
[[0.96875 0.00125 0.0025  0.00125 0.00125 0.      0.      0.      0.01625
  0.00875]
 [0.075   0.78    0.      0.07    0.01    0.01375 0.0075  0.02625 0.01625
  0.00125]
 [0.01875 0.      0.96125 0.00125 0.      0.      0.      0.      0.00375
  0.015  ]
 [0.00125 0.21    0.      0.42625 0.07625 0.18375 0.05625 0.035   0.00125
  0.01   ]
 [0.00125 0.00875 0.      0.02125 0.94125 0.01    0.01    0.00625 0.00125
  0.     ]
 [0.0025  0.05    0.      0.04    0.06875 0.62    0.18875 0.02375 0.00625
  0.     ]
 [0.00875 0.00875 0.0025  0.0025  0.0375  0.0075  0.92375 0.00625 0.00125
  0.00125]
 [0.00375 0.18875 0.      0.0525  0.025   0.04125 0.04    0.64875 0.
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.00125 0.      0.98
  0.00875]
 [0.01125 0.00125 0.08375 0.      0.      0.      0.00125 0.00125 0.01375
  0.8875 ]]
[2023-08-01 15:04:17,614 INFO] 440000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.1350e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1241, device='cuda:0'), 'train/shrink_loss': tensor(0.0669, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0515, device='cuda:0'), 'train/removed_class_idx': 2.485981076076535, 'train/uncertainty_avg': 0.7496605388627052, 'train/certain_ratio_ema': 0.7687705329787021, 'train/total_loss': tensor(0.1757, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.02514730788436962, 'train/prefecth_time': 0.024773408889770508, 'train/run_time': 0.552481689453125, 'eval/loss': tensor(1.3567, device='cuda:0'), 'eval/top-1-acc': 0.81375, 'eval/top-5-acc': 0.984375, 'eval/precision': 0.8145172805468809, 'eval/recall': 0.81375, 'eval/F1': 0.8064731630089286, 'eval/AUC': 0.9683930468749998}, BEST_EVAL_ACC: 0.81375, at 440000 iters
[2023-08-01 15:04:19,468 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 15:53:39,778 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 15:53:49,732 INFO] confusion matrix:
[[0.96375 0.00125 0.00625 0.      0.00125 0.00125 0.      0.      0.01875
  0.0075 ]
 [0.075   0.78375 0.      0.07625 0.01125 0.02125 0.0075  0.0125  0.0125
  0.     ]
 [0.00625 0.00125 0.98    0.00125 0.      0.      0.      0.      0.0025
  0.00875]
 [0.01875 0.2375  0.      0.33875 0.07875 0.22    0.05625 0.03875 0.00125
  0.01   ]
 [0.      0.0125  0.      0.0275  0.9275  0.01    0.0175  0.00375 0.00125
  0.     ]
 [0.00125 0.05    0.00125 0.02875 0.05875 0.605   0.2225  0.0275  0.005
  0.     ]
 [0.005   0.01125 0.00375 0.00375 0.0325  0.01    0.92875 0.00375 0.00125
  0.     ]
 [0.02    0.2375  0.      0.12625 0.0275  0.0375  0.02625 0.525   0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00125 0.      0.98375
  0.00625]
 [0.01    0.00125 0.14875 0.      0.      0.      0.00125 0.00125 0.01625
  0.82125]]
[2023-08-01 15:53:49,739 INFO] 445000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.5339e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1402, device='cuda:0'), 'train/shrink_loss': tensor(0.0707, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0548, device='cuda:0'), 'train/removed_class_idx': 2.4736839501385313, 'train/uncertainty_avg': 0.7531847700549202, 'train/certain_ratio_ema': 0.7744589848903717, 'train/total_loss': tensor(0.1950, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.025039554562406287, 'train/prefecth_time': 0.01984111976623535, 'train/run_time': 0.5497547607421875, 'eval/loss': tensor(1.6085, device='cuda:0'), 'eval/top-1-acc': 0.78575, 'eval/top-5-acc': 0.978625, 'eval/precision': 0.7860444494434848, 'eval/recall': 0.78575, 'eval/F1': 0.774881308380114, 'eval/AUC': 0.9627681597222221}, BEST_EVAL_ACC: 0.81375, at 440000 iters
[2023-08-01 16:43:15,713 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 16:43:25,885 INFO] confusion matrix:
[[0.96375 0.00125 0.005   0.      0.0025  0.      0.      0.      0.01875
  0.00875]
 [0.1025  0.7125  0.      0.1075  0.00875 0.02375 0.01    0.0125  0.0225
  0.     ]
 [0.005   0.      0.975   0.0025  0.      0.      0.00125 0.      0.00375
  0.0125 ]
 [0.      0.1675  0.      0.3725  0.0925  0.2575  0.06625 0.03125 0.00625
  0.00625]
 [0.      0.00875 0.      0.03625 0.9125  0.015   0.02125 0.00375 0.0025
  0.     ]
 [0.00125 0.04125 0.      0.05    0.05375 0.60375 0.19625 0.0425  0.01125
  0.     ]
 [0.005   0.00875 0.00375 0.0025  0.0275  0.01125 0.93375 0.00625 0.00125
  0.     ]
 [0.00375 0.1975  0.      0.13375 0.01875 0.04375 0.045   0.55625 0.00125
  0.     ]
 [0.0075  0.      0.      0.      0.00125 0.      0.00125 0.      0.9825
  0.0075 ]
 [0.00875 0.00125 0.11625 0.      0.      0.      0.00375 0.00125 0.0125
  0.85625]]
[2023-08-01 16:43:25,892 INFO] 450000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.5399e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1961, device='cuda:0'), 'train/shrink_loss': tensor(0.0395, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0304, device='cuda:0'), 'train/removed_class_idx': 2.4680848438207614, 'train/uncertainty_avg': 0.7630089962028015, 'train/certain_ratio_ema': 0.768203720276934, 'train/total_loss': tensor(0.2265, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.024930725714014775, 'train/prefecth_time': 0.019513088226318358, 'train/run_time': 0.548603759765625, 'eval/loss': tensor(1.5223, device='cuda:0'), 'eval/top-1-acc': 0.786875, 'eval/top-5-acc': 0.98325, 'eval/precision': 0.7833805265497791, 'eval/recall': 0.786875, 'eval/F1': 0.7780717047161214, 'eval/AUC': 0.9636509982638889}, BEST_EVAL_ACC: 0.81375, at 440000 iters
[2023-08-01 17:32:45,933 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 17:32:55,792 INFO] confusion matrix:
[[0.96625 0.00125 0.00375 0.      0.00125 0.      0.0025  0.      0.01625
  0.00875]
 [0.08    0.77625 0.      0.07625 0.01125 0.02125 0.005   0.01125 0.0175
  0.00125]
 [0.01    0.00125 0.97375 0.00125 0.      0.      0.      0.      0.0025
  0.01125]
 [0.0175  0.22125 0.      0.3425  0.0975  0.24    0.02125 0.05    0.00375
  0.00625]
 [0.      0.0125  0.      0.0325  0.9225  0.015   0.00875 0.00625 0.00125
  0.00125]
 [0.00125 0.0525  0.      0.02875 0.0525  0.66625 0.15125 0.0375  0.01
  0.     ]
 [0.0075  0.01    0.00375 0.0025  0.03625 0.01125 0.91625 0.00625 0.0025
  0.00375]
 [0.01875 0.22125 0.      0.1125  0.03875 0.045   0.00375 0.56    0.
  0.     ]
 [0.01    0.      0.      0.      0.0025  0.00125 0.      0.      0.97625
  0.01   ]
 [0.00875 0.00125 0.09375 0.      0.00125 0.      0.      0.00125 0.0125
  0.88125]]
[2023-08-01 17:32:55,799 INFO] 455000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.4644e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1395, device='cuda:0'), 'train/shrink_loss': tensor(0.0561, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0433, device='cuda:0'), 'train/removed_class_idx': 2.4642854942602237, 'train/uncertainty_avg': 0.737073102880617, 'train/certain_ratio_ema': 0.7728503531947103, 'train/total_loss': tensor(0.1830, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.024820826013731232, 'train/prefecth_time': 0.018860223770141602, 'train/run_time': 0.5598987426757812, 'eval/loss': tensor(1.4725, device='cuda:0'), 'eval/top-1-acc': 0.798125, 'eval/top-5-acc': 0.981375, 'eval/precision': 0.7949710104237946, 'eval/recall': 0.7981250000000001, 'eval/F1': 0.788468251312795, 'eval/AUC': 0.9653441927083333}, BEST_EVAL_ACC: 0.81375, at 440000 iters
[2023-08-01 18:22:33,791 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 18:22:43,987 INFO] confusion matrix:
[[0.9625  0.00125 0.00625 0.      0.00125 0.      0.00375 0.      0.0175
  0.0075 ]
 [0.0825  0.77125 0.0025  0.0775  0.01    0.01375 0.00625 0.02    0.01625
  0.     ]
 [0.0025  0.00125 0.97375 0.00125 0.      0.      0.      0.      0.00375
  0.0175 ]
 [0.0025  0.215   0.005   0.42    0.06    0.205   0.03    0.05125 0.005
  0.00625]
 [0.00125 0.01125 0.00125 0.03875 0.9225  0.01    0.00875 0.00375 0.0025
  0.     ]
 [0.00125 0.05    0.00125 0.0425  0.05    0.6675  0.13375 0.04375 0.01
  0.     ]
 [0.00375 0.00875 0.0075  0.00375 0.0325  0.01    0.91875 0.0075  0.00375
  0.00375]
 [0.0025  0.19    0.00375 0.11125 0.02375 0.0325  0.0175  0.61875 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.00125 0.      0.      0.      0.9825
  0.0075 ]
 [0.0125  0.00125 0.06125 0.      0.      0.      0.0025  0.00125 0.01375
  0.9075 ]]
[2023-08-01 18:22:43,994 INFO] 460000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1284, device='cuda:0'), 'train/shrink_loss': tensor(0.1065, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0816, device='cuda:0'), 'train/removed_class_idx': 2.470588027681678, 'train/uncertainty_avg': 0.7506064985825868, 'train/certain_ratio_ema': 0.7655945616995828, 'train/total_loss': tensor(0.2101, device='cuda:0'), 'train/mask_ratio': tensor(0.7344, device='cuda:0'), 'lr': 0.024709860182088192, 'train/prefecth_time': 0.02155244827270508, 'train/run_time': 0.5654161987304688, 'eval/loss': tensor(1.2702, device='cuda:0'), 'eval/top-1-acc': 0.8145, 'eval/top-5-acc': 0.984625, 'eval/precision': 0.8112761451735689, 'eval/recall': 0.8145000000000001, 'eval/F1': 0.8079551631331097, 'eval/AUC': 0.9718043836805556}, BEST_EVAL_ACC: 0.8145, at 460000 iters
[2023-08-01 18:22:45,865 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 19:12:22,479 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 19:12:32,803 INFO] confusion matrix:
[[0.9625  0.0025  0.00875 0.      0.00125 0.      0.      0.      0.0175
  0.0075 ]
 [0.07    0.8025  0.0025  0.0625  0.0125  0.01125 0.0075  0.0125  0.01875
  0.     ]
 [0.      0.00125 0.9725  0.      0.      0.      0.      0.      0.005
  0.02125]
 [0.      0.22375 0.01375 0.3875  0.085   0.22125 0.0175  0.04125 0.00375
  0.00625]
 [0.      0.01125 0.      0.02375 0.93875 0.0075  0.0125  0.005   0.00125
  0.     ]
 [0.00125 0.0475  0.00125 0.035   0.065   0.67    0.145   0.02875 0.00625
  0.     ]
 [0.00375 0.0125  0.0075  0.005   0.0275  0.00875 0.92625 0.005   0.0025
  0.00125]
 [0.00375 0.2175  0.01625 0.07625 0.03    0.0275  0.00625 0.6225  0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.00125 0.      0.      0.      0.98375
  0.00625]
 [0.0075  0.00125 0.0525  0.      0.      0.      0.00125 0.00125 0.015
  0.92125]]
[2023-08-01 19:12:32,810 INFO] 465000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.4675e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1211, device='cuda:0'), 'train/shrink_loss': tensor(0.0693, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0530, device='cuda:0'), 'train/removed_class_idx': 2.410714070471958, 'train/uncertainty_avg': 0.7511841356606436, 'train/certain_ratio_ema': 0.7652496823361338, 'train/total_loss': tensor(0.1741, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.024597832985411835, 'train/prefecth_time': 0.018989248275756834, 'train/run_time': 0.55634375, 'eval/loss': tensor(1.2665, device='cuda:0'), 'eval/top-1-acc': 0.81875, 'eval/top-5-acc': 0.982375, 'eval/precision': 0.8184062871005251, 'eval/recall': 0.81875, 'eval/F1': 0.8106629714454507, 'eval/AUC': 0.9723565190972222}, BEST_EVAL_ACC: 0.81875, at 465000 iters
[2023-08-01 19:12:34,759 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 20:01:49,460 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 20:01:59,713 INFO] confusion matrix:
[[0.965   0.00125 0.00625 0.      0.00125 0.      0.00125 0.      0.0175
  0.0075 ]
 [0.07375 0.77    0.      0.08375 0.01    0.01125 0.01    0.0225  0.01875
  0.     ]
 [0.00125 0.      0.9725  0.00125 0.      0.      0.      0.00125 0.0025
  0.02125]
 [0.00375 0.19625 0.00125 0.4825  0.07625 0.17125 0.0225  0.0375  0.00375
  0.005  ]
 [0.      0.00875 0.00125 0.04125 0.93    0.0075  0.00375 0.00625 0.00125
  0.     ]
 [0.00125 0.05625 0.00125 0.05375 0.0575  0.7575  0.0325  0.03125 0.00875
  0.     ]
 [0.00375 0.0075  0.00625 0.00875 0.035   0.0075  0.91875 0.00875 0.0025
  0.00125]
 [0.005   0.19625 0.0025  0.09875 0.02375 0.03    0.0175  0.625   0.00125
  0.     ]
 [0.00875 0.      0.      0.00125 0.00125 0.      0.      0.      0.98125
  0.0075 ]
 [0.01125 0.00125 0.04625 0.      0.      0.      0.      0.00125 0.01625
  0.92375]]
[2023-08-01 20:01:59,720 INFO] 470000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1034e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1805, device='cuda:0'), 'train/shrink_loss': tensor(0.0525, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0405, device='cuda:0'), 'train/removed_class_idx': 2.358024400243901, 'train/uncertainty_avg': 0.738894096520316, 'train/certain_ratio_ema': 0.7716206615897492, 'train/total_loss': tensor(0.2211, device='cuda:0'), 'train/mask_ratio': tensor(0.8192, device='cuda:0'), 'lr': 0.02448474923561727, 'train/prefecth_time': 0.024614656448364258, 'train/run_time': 0.54414306640625, 'eval/loss': tensor(1.1247, device='cuda:0'), 'eval/top-1-acc': 0.832625, 'eval/top-5-acc': 0.98675, 'eval/precision': 0.832436349410734, 'eval/recall': 0.832625, 'eval/F1': 0.828482537620161, 'eval/AUC': 0.974855138888889}, BEST_EVAL_ACC: 0.832625, at 470000 iters
[2023-08-01 20:02:13,425 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 20:51:29,413 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 20:51:39,655 INFO] confusion matrix:
[[0.9575  0.0025  0.00375 0.      0.0025  0.      0.      0.      0.02625
  0.0075 ]
 [0.07    0.79    0.      0.075   0.01    0.01    0.01375 0.0125  0.01875
  0.     ]
 [0.00875 0.00125 0.96875 0.00125 0.      0.      0.0025  0.      0.00375
  0.01375]
 [0.00375 0.2325  0.      0.41    0.05    0.1725  0.06    0.0625  0.005
  0.00375]
 [0.      0.01    0.00125 0.035   0.92375 0.00625 0.015   0.00625 0.0025
  0.     ]
 [0.      0.035   0.      0.0325  0.05625 0.78875 0.03375 0.04875 0.005
  0.     ]
 [0.005   0.00625 0.00125 0.00375 0.03125 0.00875 0.9325  0.01    0.00125
  0.     ]
 [0.005   0.215   0.      0.11875 0.02    0.0275  0.04    0.57375 0.
  0.     ]
 [0.0075  0.      0.      0.      0.00125 0.      0.0025  0.      0.98
  0.00875]
 [0.00875 0.00125 0.08375 0.      0.      0.      0.00125 0.00125 0.015
  0.88875]]
[2023-08-01 20:51:39,661 INFO] 475000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1362, device='cuda:0'), 'train/shrink_loss': tensor(0.0447, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0344, device='cuda:0'), 'train/removed_class_idx': 2.380952154195033, 'train/uncertainty_avg': 0.7395037974243224, 'train/certain_ratio_ema': 0.7696145941864805, 'train/total_loss': tensor(0.1707, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.02437061379000182, 'train/prefecth_time': 0.019402944564819335, 'train/run_time': 0.5574856567382812, 'eval/loss': tensor(1.2246, device='cuda:0'), 'eval/top-1-acc': 0.821375, 'eval/top-5-acc': 0.982375, 'eval/precision': 0.8190914076338517, 'eval/recall': 0.821375, 'eval/F1': 0.8144999155498447, 'eval/AUC': 0.9734820225694444}, BEST_EVAL_ACC: 0.832625, at 470000 iters
[2023-08-01 21:41:06,774 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 21:41:16,844 INFO] confusion matrix:
[[0.95875 0.0025  0.0025  0.      0.0025  0.      0.      0.      0.02375
  0.01   ]
 [0.06875 0.79375 0.      0.05125 0.01125 0.01375 0.0125  0.0275  0.02125
  0.     ]
 [0.0075  0.00125 0.9575  0.00125 0.      0.      0.0075  0.00125 0.00375
  0.02   ]
 [0.0025  0.23125 0.      0.37375 0.085   0.2     0.05375 0.04    0.0075
  0.00625]
 [0.      0.01    0.00125 0.01875 0.93625 0.00875 0.01625 0.005   0.00375
  0.     ]
 [0.00125 0.04375 0.      0.03375 0.0525  0.78875 0.0325  0.0375  0.01
  0.     ]
 [0.00125 0.00625 0.00125 0.0025  0.03    0.00625 0.94375 0.0075  0.
  0.00125]
 [0.      0.205   0.      0.06875 0.02625 0.02625 0.04625 0.62625 0.00125
  0.     ]
 [0.0075  0.      0.      0.      0.00125 0.      0.00375 0.      0.9775
  0.01   ]
 [0.005   0.00125 0.07125 0.      0.      0.      0.00125 0.00125 0.01625
  0.90375]]
[2023-08-01 21:41:16,851 INFO] 480000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1505, device='cuda:0'), 'train/shrink_loss': tensor(0.0687, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0527, device='cuda:0'), 'train/removed_class_idx': 2.490565802776811, 'train/uncertainty_avg': 0.7419625523626466, 'train/certain_ratio_ema': 0.7675379116649059, 'train/total_loss': tensor(0.2034, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.02425543155103641, 'train/prefecth_time': 0.020700063705444336, 'train/run_time': 0.5607540283203125, 'eval/loss': tensor(1.1667, device='cuda:0'), 'eval/top-1-acc': 0.826, 'eval/top-5-acc': 0.984, 'eval/precision': 0.8254640889307205, 'eval/recall': 0.826, 'eval/F1': 0.817633500211928, 'eval/AUC': 0.9753353038194446}, BEST_EVAL_ACC: 0.832625, at 470000 iters
[2023-08-01 22:30:43,532 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 22:30:53,479 INFO] confusion matrix:
[[0.95875 0.      0.005   0.00125 0.0025  0.      0.      0.      0.025
  0.0075 ]
 [0.07375 0.76625 0.      0.05    0.01    0.0075  0.01375 0.05875 0.02
  0.     ]
 [0.0075  0.      0.9725  0.      0.      0.      0.      0.0025  0.005
  0.0125 ]
 [0.0025  0.26125 0.00125 0.38875 0.06875 0.155   0.04625 0.06625 0.00125
  0.00875]
 [0.00125 0.00875 0.00125 0.0225  0.925   0.01375 0.0125  0.01125 0.00375
  0.     ]
 [0.      0.04875 0.00125 0.01875 0.04875 0.82875 0.01625 0.0325  0.005
  0.     ]
 [0.00375 0.00625 0.00625 0.00125 0.03    0.01125 0.935   0.00375 0.0025
  0.     ]
 [0.005   0.185   0.      0.01875 0.0225  0.02625 0.0275  0.715   0.
  0.     ]
 [0.0075  0.      0.      0.      0.00125 0.      0.      0.      0.985
  0.00625]
 [0.00625 0.00125 0.08875 0.      0.      0.      0.      0.00125 0.01625
  0.88625]]
[2023-08-01 22:30:53,485 INFO] 485000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1596, device='cuda:0'), 'train/shrink_loss': tensor(0.0652, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0502, device='cuda:0'), 'train/removed_class_idx': 2.4545452314049787, 'train/uncertainty_avg': 0.7621514218136449, 'train/certain_ratio_ema': 0.7695375969358138, 'train/total_loss': tensor(0.2099, device='cuda:0'), 'train/mask_ratio': tensor(0.7545, device='cuda:0'), 'lr': 0.024139207466154975, 'train/prefecth_time': 0.02484454345703125, 'train/run_time': 0.5566873779296875, 'eval/loss': tensor(1.0339, device='cuda:0'), 'eval/top-1-acc': 0.836125, 'eval/top-5-acc': 0.98725, 'eval/precision': 0.8387021080974385, 'eval/recall': 0.836125, 'eval/F1': 0.8289288278903605, 'eval/AUC': 0.978818611111111}, BEST_EVAL_ACC: 0.836125, at 485000 iters
[2023-08-01 22:30:55,528 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-01 23:20:22,554 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-01 23:20:32,589 INFO] confusion matrix:
[[0.96    0.      0.00625 0.00125 0.00125 0.00125 0.      0.      0.02125
  0.00875]
 [0.06875 0.7775  0.      0.0925  0.00625 0.015   0.005   0.01625 0.01875
  0.     ]
 [0.01    0.00125 0.97375 0.00125 0.      0.      0.      0.      0.00375
  0.01   ]
 [0.01    0.1975  0.      0.48    0.05625 0.195   0.0075  0.04375 0.00375
  0.00625]
 [0.      0.00875 0.      0.04625 0.9225  0.00875 0.00625 0.005   0.0025
  0.     ]
 [0.00125 0.04    0.      0.0575  0.0325  0.8125  0.01875 0.03    0.0075
  0.     ]
 [0.005   0.005   0.00375 0.01    0.02875 0.0075  0.93    0.00875 0.00125
  0.     ]
 [0.015   0.18125 0.      0.0925  0.02125 0.03375 0.005   0.64875 0.00125
  0.00125]
 [0.005   0.      0.      0.00125 0.00125 0.      0.      0.      0.98375
  0.00875]
 [0.00625 0.00125 0.125   0.      0.      0.      0.00125 0.0025  0.015
  0.84875]]
[2023-08-01 23:20:32,596 INFO] 490000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.1515e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1468, device='cuda:0'), 'train/shrink_loss': tensor(0.0968, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0748, device='cuda:0'), 'train/removed_class_idx': 2.5350874969221495, 'train/uncertainty_avg': 0.7468134884800242, 'train/certain_ratio_ema': 0.7727649475574188, 'train/total_loss': tensor(0.2216, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.02402194652754197, 'train/prefecth_time': 0.024122976303100587, 'train/run_time': 0.5728196411132812, 'eval/loss': tensor(1.1088, device='cuda:0'), 'eval/top-1-acc': 0.83375, 'eval/top-5-acc': 0.98575, 'eval/precision': 0.8343501454322153, 'eval/recall': 0.8337499999999999, 'eval/F1': 0.8300848518285313, 'eval/AUC': 0.9747761718749999}, BEST_EVAL_ACC: 0.836125, at 485000 iters
[2023-08-02 00:09:39,946 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 00:09:50,371 INFO] confusion matrix:
[[0.96    0.00125 0.005   0.      0.0025  0.00125 0.      0.      0.02
  0.01   ]
 [0.075   0.7775  0.      0.06875 0.00875 0.01375 0.00875 0.02875 0.01875
  0.     ]
 [0.0075  0.      0.97    0.00125 0.      0.      0.      0.00125 0.0025
  0.0175 ]
 [0.0025  0.1475  0.      0.4775  0.0625  0.23125 0.0125  0.0525  0.0075
  0.00625]
 [0.      0.005   0.      0.03875 0.93125 0.00875 0.0075  0.005   0.00375
  0.     ]
 [0.0025  0.0275  0.      0.03875 0.0575  0.81125 0.01875 0.035   0.00875
  0.     ]
 [0.00875 0.00125 0.0025  0.00875 0.02375 0.005   0.9375  0.00875 0.00125
  0.0025 ]
 [0.005   0.17375 0.      0.085   0.02125 0.04375 0.00375 0.665   0.0025
  0.     ]
 [0.0075  0.      0.      0.00125 0.00125 0.      0.      0.      0.98
  0.01   ]
 [0.00625 0.00125 0.06625 0.      0.      0.      0.      0.00125 0.01375
  0.91125]]
[2023-08-02 00:09:50,378 INFO] 495000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.7608e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1684, device='cuda:0'), 'train/shrink_loss': tensor(0.0455, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0352, device='cuda:0'), 'train/removed_class_idx': 2.4838707006590646, 'train/uncertainty_avg': 0.7579679468845041, 'train/certain_ratio_ema': 0.7738205890576226, 'train/total_loss': tensor(0.2036, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.023903653771917915, 'train/prefecth_time': 0.01874182319641113, 'train/run_time': 0.5583579711914063, 'eval/loss': tensor(1.0216, device='cuda:0'), 'eval/top-1-acc': 0.842125, 'eval/top-5-acc': 0.986125, 'eval/precision': 0.8397408967125974, 'eval/recall': 0.842125, 'eval/F1': 0.8374258915685158, 'eval/AUC': 0.9784153559027776}, BEST_EVAL_ACC: 0.842125, at 495000 iters
[2023-08-02 00:09:52,349 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-02 00:59:07,810 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 00:59:17,591 INFO] confusion matrix:
[[0.96    0.      0.00625 0.00125 0.00125 0.      0.      0.      0.0225
  0.00875]
 [0.0675  0.775   0.      0.08625 0.0075  0.015   0.0075  0.0225  0.01875
  0.     ]
 [0.01125 0.      0.96625 0.      0.      0.      0.0025  0.00125 0.00375
  0.015  ]
 [0.01875 0.18    0.      0.48375 0.0725  0.18    0.0125  0.04125 0.00625
  0.005  ]
 [0.      0.01125 0.00125 0.035   0.9325  0.0075  0.005   0.00375 0.00375
  0.     ]
 [0.00125 0.04125 0.      0.0425  0.05625 0.80375 0.02    0.02625 0.00875
  0.     ]
 [0.005   0.0075  0.0025  0.01    0.0275  0.005   0.9375  0.0025  0.00125
  0.00125]
 [0.01375 0.185   0.      0.0775  0.01875 0.03125 0.01125 0.6625  0.
  0.     ]
 [0.0075  0.      0.      0.0025  0.      0.      0.      0.      0.98125
  0.00875]
 [0.00625 0.00125 0.06125 0.      0.      0.      0.00125 0.00125 0.01375
  0.915  ]]
[2023-08-02 00:59:17,598 INFO] 500000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.9497e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1403, device='cuda:0'), 'train/shrink_loss': tensor(0.0327, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0253, device='cuda:0'), 'train/removed_class_idx': 2.377777513580276, 'train/uncertainty_avg': 0.7716351701425849, 'train/certain_ratio_ema': 0.775589620526887, 'train/total_loss': tensor(0.1656, device='cuda:0'), 'train/mask_ratio': tensor(0.7991, device='cuda:0'), 'lr': 0.02378433428032308, 'train/prefecth_time': 0.032532894134521484, 'train/run_time': 0.5619458618164063, 'eval/loss': tensor(1.0413, device='cuda:0'), 'eval/top-1-acc': 0.84175, 'eval/top-5-acc': 0.987125, 'eval/precision': 0.841261078577479, 'eval/recall': 0.84175, 'eval/F1': 0.8375768686352549, 'eval/AUC': 0.977195529513889}, BEST_EVAL_ACC: 0.842125, at 495000 iters
[2023-08-02 01:48:16,021 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 01:48:26,126 INFO] confusion matrix:
[[0.96    0.00125 0.00375 0.00125 0.00125 0.      0.      0.      0.02375
  0.00875]
 [0.07    0.7875  0.      0.06625 0.00875 0.01375 0.01125 0.0225  0.01875
  0.00125]
 [0.0075  0.00125 0.9725  0.      0.      0.      0.00375 0.      0.00375
  0.01125]
 [0.00375 0.1925  0.00125 0.49875 0.0475  0.17125 0.02875 0.045   0.005
  0.00625]
 [0.00125 0.00875 0.00125 0.0375  0.9325  0.0075  0.00625 0.0025  0.0025
  0.     ]
 [0.00125 0.03625 0.      0.04375 0.04625 0.82125 0.01375 0.02875 0.00875
  0.     ]
 [0.0025  0.00625 0.0025  0.00375 0.03    0.01375 0.9325  0.005   0.0025
  0.00125]
 [0.00375 0.185   0.      0.06625 0.0225  0.0325  0.0325  0.65625 0.00125
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.      0.      0.985
  0.00625]
 [0.00625 0.00125 0.0675  0.      0.      0.      0.00125 0.00125 0.0175
  0.905  ]]
[2023-08-02 01:48:26,133 INFO] 505000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1055, device='cuda:0'), 'train/shrink_loss': tensor(0.0579, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0450, device='cuda:0'), 'train/removed_class_idx': 2.515463658199623, 'train/uncertainty_avg': 0.7436233093693767, 'train/certain_ratio_ema': 0.7763745096582594, 'train/total_loss': tensor(0.1505, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.023663993177899228, 'train/prefecth_time': 0.01963577651977539, 'train/run_time': 0.5813347778320312, 'eval/loss': tensor(1.0338, device='cuda:0'), 'eval/top-1-acc': 0.845125, 'eval/top-5-acc': 0.9875, 'eval/precision': 0.8452230033344875, 'eval/recall': 0.845125, 'eval/F1': 0.840892045145971, 'eval/AUC': 0.9770549392361114}, BEST_EVAL_ACC: 0.845125, at 505000 iters
[2023-08-02 01:48:27,792 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-02 02:37:43,869 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 02:37:53,982 INFO] confusion matrix:
[[0.9575  0.00125 0.00625 0.      0.00125 0.      0.0025  0.      0.0225
  0.00875]
 [0.07    0.82375 0.      0.03875 0.00625 0.0125  0.01    0.02125 0.0175
  0.     ]
 [0.0075  0.      0.97375 0.00125 0.      0.      0.00125 0.00125 0.005
  0.01   ]
 [0.0025  0.2775  0.      0.4275  0.06375 0.14875 0.0175  0.0525  0.00625
  0.00375]
 [0.      0.01    0.      0.035   0.93375 0.00875 0.005   0.005   0.0025
  0.     ]
 [0.      0.04625 0.      0.04375 0.05    0.8075  0.01125 0.03625 0.005
  0.     ]
 [0.00125 0.00625 0.0025  0.01    0.035   0.0125  0.92375 0.005   0.00375
  0.     ]
 [0.0025  0.1825  0.      0.06625 0.0175  0.0225  0.01375 0.695   0.
  0.     ]
 [0.0075  0.      0.      0.0025  0.00125 0.      0.      0.      0.98
  0.00875]
 [0.00875 0.00125 0.11625 0.00125 0.      0.      0.00125 0.00125 0.01625
  0.85375]]
[2023-08-02 02:37:53,989 INFO] 510000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1755, device='cuda:0'), 'train/shrink_loss': tensor(0.0813, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0633, device='cuda:0'), 'train/removed_class_idx': 2.621052355678699, 'train/uncertainty_avg': 0.7142696337734026, 'train/certain_ratio_ema': 0.779404164348812, 'train/total_loss': tensor(0.2389, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.023542635633669443, 'train/prefecth_time': 0.020005792617797852, 'train/run_time': 0.5950528564453125, 'eval/loss': tensor(1.0857, device='cuda:0'), 'eval/top-1-acc': 0.837625, 'eval/top-5-acc': 0.988, 'eval/precision': 0.8401843248368221, 'eval/recall': 0.8376250000000001, 'eval/F1': 0.832674213172289, 'eval/AUC': 0.9759408680555554}, BEST_EVAL_ACC: 0.845125, at 505000 iters
[2023-08-02 03:26:52,378 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 03:27:02,653 INFO] confusion matrix:
[[0.96    0.      0.0075  0.00125 0.00125 0.      0.00375 0.      0.0175
  0.00875]
 [0.0725  0.77    0.      0.07625 0.00875 0.0125  0.0025  0.04125 0.01625
  0.     ]
 [0.      0.      0.97875 0.00125 0.      0.      0.00625 0.00125 0.005
  0.0075 ]
 [0.0025  0.215   0.      0.5075  0.055   0.16    0.00375 0.0425  0.01
  0.00375]
 [0.      0.01125 0.00125 0.045   0.92625 0.00875 0.00125 0.005   0.00125
  0.     ]
 [0.00125 0.04125 0.      0.05625 0.04375 0.81375 0.01125 0.0275  0.005
  0.     ]
 [0.      0.005   0.00375 0.0125  0.03    0.0125  0.9275  0.00625 0.0025
  0.     ]
 [0.00375 0.165   0.      0.0925  0.01125 0.02375 0.0025  0.6975  0.00375
  0.     ]
 [0.005   0.      0.00125 0.0025  0.      0.      0.      0.      0.98
  0.01125]
 [0.00875 0.00125 0.1325  0.      0.      0.      0.0025  0.00125 0.01125
  0.8425 ]]
[2023-08-02 03:27:02,660 INFO] 515000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.0779e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1376, device='cuda:0'), 'train/shrink_loss': tensor(0.0526, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0409, device='cuda:0'), 'train/removed_class_idx': 2.43999967466671, 'train/uncertainty_avg': 0.7812159434427529, 'train/certain_ratio_ema': 0.7772377284885713, 'train/total_loss': tensor(0.1785, device='cuda:0'), 'train/mask_ratio': tensor(0.8326, device='cuda:0'), 'lr': 0.023420266860316168, 'train/prefecth_time': 0.019808864593505858, 'train/run_time': 0.55025439453125, 'eval/loss': tensor(1.0302, device='cuda:0'), 'eval/top-1-acc': 0.840375, 'eval/top-5-acc': 0.988875, 'eval/precision': 0.8414401405169804, 'eval/recall': 0.8403750000000001, 'eval/F1': 0.8377659261840472, 'eval/AUC': 0.9773996614583333}, BEST_EVAL_ACC: 0.845125, at 505000 iters
[2023-08-02 04:16:16,217 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 04:16:26,243 INFO] confusion matrix:
[[0.9625  0.00125 0.0025  0.00125 0.00125 0.      0.005   0.      0.0175
  0.00875]
 [0.1475  0.72875 0.      0.07125 0.00625 0.01125 0.005   0.00875 0.02125
  0.     ]
 [0.      0.00125 0.97125 0.00125 0.      0.      0.01    0.      0.005
  0.01125]
 [0.00125 0.155   0.      0.57875 0.04625 0.14625 0.00125 0.06375 0.00375
  0.00375]
 [0.      0.00625 0.      0.0325  0.935   0.0125  0.00125 0.01    0.0025
  0.     ]
 [0.0025  0.025   0.      0.065   0.03625 0.83    0.00875 0.02125 0.01125
  0.     ]
 [0.0025  0.005   0.00375 0.00375 0.0425  0.01375 0.92    0.005   0.0025
  0.00125]
 [0.00625 0.18875 0.      0.11625 0.01875 0.03375 0.00375 0.6325  0.
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.      0.00125 0.97625
  0.01125]
 [0.0075  0.      0.11    0.      0.      0.      0.005   0.00125 0.0125
  0.86375]]
[2023-08-02 04:16:26,250 INFO] 520000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1206, device='cuda:0'), 'train/shrink_loss': tensor(0.0452, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0351, device='cuda:0'), 'train/removed_class_idx': 2.4946233876749044, 'train/uncertainty_avg': 0.7514190035691893, 'train/certain_ratio_ema': 0.7774293724341266, 'train/total_loss': tensor(0.1558, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.02329689211395725, 'train/prefecth_time': 0.019480640411376954, 'train/run_time': 0.5484852905273437, 'eval/loss': tensor(1.0220, device='cuda:0'), 'eval/top-1-acc': 0.839875, 'eval/top-5-acc': 0.9915, 'eval/precision': 0.840662161601635, 'eval/recall': 0.8398749999999999, 'eval/F1': 0.8370794346753065, 'eval/AUC': 0.9765590017361109}, BEST_EVAL_ACC: 0.845125, at 505000 iters
[2023-08-02 05:05:36,779 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 05:05:46,588 INFO] confusion matrix:
[[0.96375 0.00125 0.0025  0.00125 0.00125 0.      0.00625 0.      0.015
  0.00875]
 [0.0725  0.805   0.      0.065   0.01125 0.01125 0.0075  0.00875 0.0175
  0.00125]
 [0.0025  0.00125 0.9725  0.00125 0.      0.      0.01125 0.      0.0025
  0.00875]
 [0.00375 0.17625 0.      0.4825  0.0925  0.20125 0.0025  0.03    0.00625
  0.005  ]
 [0.      0.00875 0.00125 0.0225  0.945   0.01375 0.0025  0.0025  0.00375
  0.     ]
 [0.      0.02875 0.      0.025   0.0475  0.86875 0.0075  0.015   0.0075
  0.     ]
 [0.00375 0.005   0.00125 0.00375 0.03875 0.0125  0.92625 0.005   0.00125
  0.0025 ]
 [0.0025  0.18125 0.      0.0825  0.05375 0.0475  0.005   0.6275  0.
  0.     ]
 [0.00625 0.      0.      0.      0.00125 0.      0.      0.      0.98125
  0.01125]
 [0.005   0.00125 0.13625 0.      0.      0.      0.0025  0.00125 0.0125
  0.84125]]
[2023-08-02 05:05:46,595 INFO] 525000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.4983e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1265, device='cuda:0'), 'train/shrink_loss': tensor(0.0658, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0518, device='cuda:0'), 'train/removed_class_idx': 2.354838456468983, 'train/uncertainty_avg': 0.7622825404714587, 'train/certain_ratio_ema': 0.7879296235496273, 'train/total_loss': tensor(0.1784, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.023172516693920196, 'train/prefecth_time': 0.025278879165649415, 'train/run_time': 0.555527587890625, 'eval/loss': tensor(1.0467, device='cuda:0'), 'eval/top-1-acc': 0.841375, 'eval/top-5-acc': 0.990625, 'eval/precision': 0.8456635879253263, 'eval/recall': 0.841375, 'eval/F1': 0.8363066416835092, 'eval/AUC': 0.9788294965277777}, BEST_EVAL_ACC: 0.845125, at 505000 iters
[2023-08-02 05:54:55,171 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 05:55:05,473 INFO] confusion matrix:
[[0.96375 0.00125 0.00375 0.00125 0.0025  0.      0.      0.      0.01875
  0.00875]
 [0.07375 0.7925  0.      0.07625 0.0075  0.01375 0.00875 0.0125  0.015
  0.     ]
 [0.00875 0.00125 0.97875 0.00125 0.      0.      0.      0.      0.0025
  0.0075 ]
 [0.00375 0.18875 0.      0.495   0.0675  0.1525  0.04875 0.03125 0.005
  0.0075 ]
 [0.00125 0.0075  0.00125 0.025   0.945   0.00625 0.00875 0.00375 0.00125
  0.     ]
 [0.00125 0.03125 0.      0.04375 0.04375 0.835   0.01875 0.0175  0.00875
  0.     ]
 [0.00375 0.00125 0.00375 0.0025  0.03375 0.01375 0.935   0.005   0.00125
  0.     ]
 [0.00375 0.15125 0.      0.0725  0.02125 0.03625 0.04    0.675   0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00125 0.      0.98125
  0.00875]
 [0.0075  0.00125 0.17875 0.      0.      0.      0.0025  0.00125 0.02
  0.78875]]
[2023-08-02 05:55:05,480 INFO] 530000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1072, device='cuda:0'), 'train/shrink_loss': tensor(0.0367, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0284, device='cuda:0'), 'train/removed_class_idx': 2.3947365270083516, 'train/uncertainty_avg': 0.7532958981378455, 'train/certain_ratio_ema': 0.7740170678504502, 'train/total_loss': tensor(0.1357, device='cuda:0'), 'train/mask_ratio': tensor(0.8304, device='cuda:0'), 'lr': 0.023047145942514547, 'train/prefecth_time': 0.021689279556274414, 'train/run_time': 0.5402189331054688, 'eval/loss': tensor(1.0310, device='cuda:0'), 'eval/top-1-acc': 0.839, 'eval/top-5-acc': 0.990125, 'eval/precision': 0.8405707194700816, 'eval/recall': 0.8389999999999999, 'eval/F1': 0.8340451884794833, 'eval/AUC': 0.978702092013889}, BEST_EVAL_ACC: 0.845125, at 505000 iters
[2023-08-02 06:44:23,401 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 06:44:33,172 INFO] confusion matrix:
[[0.95875 0.00125 0.005   0.00125 0.0025  0.      0.00125 0.      0.02125
  0.00875]
 [0.07125 0.815   0.0025  0.06    0.0075  0.01125 0.00625 0.00875 0.0175
  0.     ]
 [0.00875 0.00125 0.96875 0.00125 0.      0.      0.      0.      0.0025
  0.0175 ]
 [0.      0.145   0.      0.5625  0.03875 0.16875 0.05125 0.0225  0.00375
  0.0075 ]
 [0.      0.00625 0.00125 0.03125 0.94    0.0075  0.00875 0.00375 0.00125
  0.     ]
 [0.00125 0.02625 0.      0.04125 0.0425  0.8475  0.01625 0.01625 0.00875
  0.     ]
 [0.01    0.005   0.0025  0.00375 0.035   0.01125 0.925   0.005   0.0025
  0.     ]
 [0.00375 0.19    0.      0.06    0.01875 0.03625 0.03875 0.65125 0.00125
  0.     ]
 [0.00625 0.      0.00125 0.00125 0.      0.      0.0025  0.      0.97875
  0.01   ]
 [0.00625 0.00125 0.07625 0.      0.      0.      0.0025  0.00125 0.01375
  0.89875]]
[2023-08-02 06:44:33,179 INFO] 535000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2190e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1359, device='cuda:0'), 'train/shrink_loss': tensor(0.0648, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0506, device='cuda:0'), 'train/removed_class_idx': 2.3870965175165035, 'train/uncertainty_avg': 0.7482326187545236, 'train/certain_ratio_ema': 0.7809961105608251, 'train/total_loss': tensor(0.1865, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.022920785244802414, 'train/prefecth_time': 0.0183470401763916, 'train/run_time': 0.5501591796875, 'eval/loss': tensor(0.9353, device='cuda:0'), 'eval/top-1-acc': 0.854625, 'eval/top-5-acc': 0.99125, 'eval/precision': 0.8568731106169514, 'eval/recall': 0.8546249999999999, 'eval/F1': 0.8510699251390565, 'eval/AUC': 0.9803695138888888}, BEST_EVAL_ACC: 0.854625, at 535000 iters
[2023-08-02 06:44:34,769 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-02 07:33:34,210 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 07:33:44,660 INFO] confusion matrix:
[[0.96    0.      0.00375 0.00125 0.0025  0.00125 0.      0.      0.02125
  0.01   ]
 [0.06875 0.8175  0.      0.055   0.01    0.01125 0.005   0.015   0.0175
  0.     ]
 [0.0075  0.00125 0.96875 0.00125 0.      0.      0.      0.      0.005
  0.01625]
 [0.0025  0.1825  0.      0.52125 0.05875 0.14875 0.005   0.07125 0.005
  0.005  ]
 [0.      0.0075  0.      0.02375 0.94625 0.01125 0.0025  0.0075  0.00125
  0.     ]
 [0.0025  0.0375  0.      0.03375 0.0375  0.83875 0.00875 0.03375 0.0075
  0.     ]
 [0.005   0.00875 0.0025  0.0075  0.03125 0.01125 0.925   0.00375 0.0025
  0.0025 ]
 [0.00125 0.1925  0.      0.0725  0.01625 0.02375 0.0025  0.69125 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.00125 0.      0.      0.      0.98375
  0.00625]
 [0.0125  0.00125 0.0575  0.      0.      0.      0.00125 0.00125 0.015
  0.91125]]
[2023-08-02 07:33:44,667 INFO] 540000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.1081e-06, device='cuda:0'), 'train/certain_loss': tensor(0.0717, device='cuda:0'), 'train/shrink_loss': tensor(0.1000, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0779, device='cuda:0'), 'train/removed_class_idx': 2.596638437257274, 'train/uncertainty_avg': 0.7410956461714009, 'train/certain_ratio_ema': 0.7789623906205562, 'train/total_loss': tensor(0.1496, device='cuda:0'), 'train/mask_ratio': tensor(0.7344, device='cuda:0'), 'lr': 0.022793440028367164, 'train/prefecth_time': 0.02002787208557129, 'train/run_time': 0.5600733032226562, 'eval/loss': tensor(0.9414, device='cuda:0'), 'eval/top-1-acc': 0.856375, 'eval/top-5-acc': 0.988, 'eval/precision': 0.8577613108209249, 'eval/recall': 0.8563750000000001, 'eval/F1': 0.853181625970237, 'eval/AUC': 0.9804692881944445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 07:33:46,564 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/model_best.pth
[2023-08-02 08:23:58,175 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 08:24:08,064 INFO] confusion matrix:
[[0.96375 0.00125 0.0025  0.00125 0.00125 0.      0.      0.      0.01875
  0.01125]
 [0.07    0.81375 0.      0.06875 0.0075  0.01    0.0075  0.0075  0.015
  0.     ]
 [0.00625 0.00125 0.97375 0.00125 0.      0.      0.00125 0.      0.00375
  0.0125 ]
 [0.0025  0.18875 0.      0.5875  0.045   0.13375 0.00625 0.0275  0.0025
  0.00625]
 [0.      0.01    0.00125 0.03875 0.935   0.0075  0.0025  0.00375 0.00125
  0.     ]
 [0.      0.04125 0.      0.04875 0.0375  0.83125 0.00625 0.0275  0.0075
  0.     ]
 [0.00625 0.00625 0.0025  0.00625 0.03    0.00875 0.9275  0.00875 0.0025
  0.00125]
 [0.0025  0.18625 0.      0.12625 0.01625 0.01875 0.0025  0.6475  0.
  0.     ]
 [0.0075  0.      0.      0.00375 0.      0.      0.      0.      0.9775
  0.01125]
 [0.00625 0.00125 0.10375 0.00125 0.      0.      0.      0.00125 0.01125
  0.875  ]]
[2023-08-02 08:24:08,070 INFO] 545000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.4237e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0957, device='cuda:0'), 'train/shrink_loss': tensor(0.0688, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0537, device='cuda:0'), 'train/removed_class_idx': 2.368420803324126, 'train/uncertainty_avg': 0.7960641562578533, 'train/certain_ratio_ema': 0.7806532400048383, 'train/total_loss': tensor(0.1495, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.02266511576308029, 'train/prefecth_time': 0.019660959243774413, 'train/run_time': 0.5516028442382812, 'eval/loss': tensor(0.9394, device='cuda:0'), 'eval/top-1-acc': 0.85325, 'eval/top-5-acc': 0.9895, 'eval/precision': 0.8574730917498329, 'eval/recall': 0.8532499999999998, 'eval/F1': 0.8516227824622288, 'eval/AUC': 0.9789604427083333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 09:13:18,628 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 09:13:40,053 INFO] confusion matrix:
[[0.9575  0.00125 0.005   0.0025  0.00125 0.      0.      0.      0.02375
  0.00875]
 [0.06875 0.80125 0.      0.08375 0.005   0.015   0.00375 0.00625 0.01625
  0.     ]
 [0.00625 0.00125 0.97125 0.00125 0.      0.      0.00125 0.      0.0025
  0.01625]
 [0.00875 0.11125 0.      0.5825  0.0575  0.1925  0.01    0.03    0.00625
  0.00125]
 [0.      0.00625 0.      0.0425  0.93375 0.01    0.0025  0.0025  0.0025
  0.     ]
 [0.      0.02375 0.      0.17125 0.045   0.72    0.01125 0.0225  0.00625
  0.     ]
 [0.00375 0.0075  0.0025  0.01625 0.02625 0.01    0.92875 0.0025  0.0025
  0.     ]
 [0.01125 0.1925  0.      0.1325  0.0225  0.04375 0.005   0.5925  0.
  0.     ]
 [0.00875 0.      0.      0.0025  0.00125 0.      0.      0.      0.9775
  0.01   ]
 [0.005   0.00125 0.09375 0.00125 0.      0.      0.      0.00125 0.0125
  0.885  ]]
[2023-08-02 09:13:40,060 INFO] 550000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.5860e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1886, device='cuda:0'), 'train/shrink_loss': tensor(0.0689, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0535, device='cuda:0'), 'train/removed_class_idx': 2.5145628626637997, 'train/uncertainty_avg': 0.7503389117868317, 'train/certain_ratio_ema': 0.7758502041597546, 'train/total_loss': tensor(0.2421, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.022535817960866473, 'train/prefecth_time': 0.019815807342529298, 'train/run_time': 0.5529066162109375, 'eval/loss': tensor(0.9963, device='cuda:0'), 'eval/top-1-acc': 0.835, 'eval/top-5-acc': 0.989125, 'eval/precision': 0.8400321903622687, 'eval/recall': 0.835, 'eval/F1': 0.8333175523830958, 'eval/AUC': 0.9781298784722223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 10:02:58,026 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 10:03:07,942 INFO] confusion matrix:
[[0.95875 0.0025  0.0025  0.      0.00125 0.      0.00125 0.      0.02625
  0.0075 ]
 [0.075   0.81375 0.      0.01125 0.00375 0.015   0.04875 0.01625 0.01625
  0.     ]
 [0.00625 0.0025  0.96625 0.      0.      0.      0.00375 0.      0.00625
  0.015  ]
 [0.0075  0.1575  0.00125 0.23625 0.055   0.19125 0.24    0.10625 0.00375
  0.00125]
 [0.00125 0.01    0.      0.005   0.86125 0.01    0.09875 0.0125  0.00125
  0.     ]
 [0.00125 0.02625 0.      0.03    0.03375 0.72625 0.1125  0.06375 0.00625
  0.     ]
 [0.00625 0.01    0.00125 0.      0.02125 0.0075  0.945   0.005   0.0025
  0.00125]
 [0.0025  0.21    0.      0.00375 0.01375 0.0275  0.0725  0.67    0.
  0.     ]
 [0.00625 0.      0.      0.      0.00125 0.      0.      0.      0.985
  0.0075 ]
 [0.00875 0.00125 0.05875 0.      0.      0.      0.00125 0.00125 0.0175
  0.91125]]
[2023-08-02 10:03:07,949 INFO] 555000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.0793e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1248, device='cuda:0'), 'train/shrink_loss': tensor(0.0797, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0603, device='cuda:0'), 'train/removed_class_idx': 2.4264704098183523, 'train/uncertainty_avg': 0.7625653139207162, 'train/certain_ratio_ema': 0.7565025394289077, 'train/total_loss': tensor(0.1852, device='cuda:0'), 'train/mask_ratio': tensor(0.6964, device='cuda:0'), 'lr': 0.02240555217546681, 'train/prefecth_time': 0.028778528213500975, 'train/run_time': 0.574302490234375, 'eval/loss': tensor(1.0814, device='cuda:0'), 'eval/top-1-acc': 0.807375, 'eval/top-5-acc': 0.983125, 'eval/precision': 0.8204067010023792, 'eval/recall': 0.8073750000000001, 'eval/F1': 0.7927281989236956, 'eval/AUC': 0.9762311284722226}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 10:52:52,268 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 10:53:02,026 INFO] confusion matrix:
[[0.9575  0.0025  0.0025  0.      0.00125 0.      0.00875 0.      0.01875
  0.00875]
 [0.065   0.80625 0.      0.00375 0.0025  0.0125  0.08    0.02    0.01
  0.     ]
 [0.      0.0025  0.96125 0.      0.      0.      0.0075  0.      0.01125
  0.0175 ]
 [0.0025  0.155   0.      0.2875  0.0475  0.15    0.29125 0.06625 0.
  0.     ]
 [0.      0.00625 0.00125 0.01875 0.78125 0.015   0.16625 0.01    0.00125
  0.     ]
 [0.      0.025   0.      0.2525  0.02125 0.54875 0.1075  0.0425  0.0025
  0.     ]
 [0.0025  0.01    0.0025  0.0025  0.02375 0.00875 0.93625 0.005   0.005
  0.00375]
 [0.0025  0.175   0.      0.01    0.02375 0.02875 0.0925  0.66625 0.00125
  0.     ]
 [0.00875 0.      0.      0.00125 0.      0.      0.005   0.      0.975
  0.01   ]
 [0.005   0.00125 0.06625 0.      0.      0.      0.01625 0.0025  0.01625
  0.8925 ]]
[2023-08-02 10:53:02,033 INFO] 560000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.2911e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1879, device='cuda:0'), 'train/shrink_loss': tensor(0.1242, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0927, device='cuda:0'), 'train/removed_class_idx': 2.5196848409696977, 'train/uncertainty_avg': 0.7296126823215523, 'train/certain_ratio_ema': 0.7464738004818825, 'train/total_loss': tensor(0.2807, device='cuda:0'), 'train/mask_ratio': tensor(0.7165, device='cuda:0'), 'lr': 0.02227432400220029, 'train/prefecth_time': 0.02447551918029785, 'train/run_time': 0.56212353515625, 'eval/loss': tensor(1.2389, device='cuda:0'), 'eval/top-1-acc': 0.78125, 'eval/top-5-acc': 0.983875, 'eval/precision': 0.7873185521140524, 'eval/recall': 0.78125, 'eval/F1': 0.7734365427292984, 'eval/AUC': 0.9696985243055557}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 11:43:04,734 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 11:43:27,676 INFO] confusion matrix:
[[0.95    0.0025  0.005   0.      0.      0.      0.00875 0.      0.0225
  0.01125]
 [0.0625  0.81625 0.      0.005   0.01125 0.02    0.055   0.015   0.015
  0.     ]
 [0.00125 0.0025  0.97375 0.      0.      0.00125 0.00625 0.      0.00375
  0.01125]
 [0.0025  0.185   0.      0.27375 0.08875 0.21125 0.18625 0.05125 0.00125
  0.     ]
 [0.      0.01    0.00125 0.      0.88125 0.0125  0.0875  0.00625 0.00125
  0.     ]
 [0.      0.03875 0.      0.04375 0.07875 0.70375 0.10875 0.0225  0.00375
  0.     ]
 [0.0025  0.01625 0.00375 0.      0.0525  0.01625 0.89875 0.0025  0.0025
  0.005  ]
 [0.00375 0.21375 0.      0.00375 0.0225  0.04125 0.08375 0.63125 0.
  0.     ]
 [0.01125 0.      0.      0.      0.00125 0.      0.00125 0.      0.975
  0.01125]
 [0.0075  0.00125 0.075   0.      0.      0.      0.01625 0.00125 0.0125
  0.88625]]
[2023-08-02 11:43:27,683 INFO] 565000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.2408e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1556, device='cuda:0'), 'train/shrink_loss': tensor(0.0789, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0576, device='cuda:0'), 'train/removed_class_idx': 2.4687498071289213, 'train/uncertainty_avg': 0.7363442268510995, 'train/certain_ratio_ema': 0.7300703914715709, 'train/total_loss': tensor(0.2132, device='cuda:0'), 'train/mask_ratio': tensor(0.7143, device='cuda:0'), 'lr': 0.022142139077723427, 'train/prefecth_time': 0.023644384384155274, 'train/run_time': 0.5744116821289063, 'eval/loss': tensor(1.0876, device='cuda:0'), 'eval/top-1-acc': 0.799, 'eval/top-5-acc': 0.986125, 'eval/precision': 0.816206911726734, 'eval/recall': 0.799, 'eval/F1': 0.7870764376148875, 'eval/AUC': 0.973570625}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 12:33:37,128 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 12:33:47,986 INFO] confusion matrix:
[[0.96    0.0025  0.0025  0.00125 0.00125 0.      0.00875 0.      0.0125
  0.01125]
 [0.08625 0.81125 0.      0.025   0.00875 0.02125 0.01625 0.0175  0.01375
  0.     ]
 [0.00625 0.0025  0.96    0.      0.      0.      0.00875 0.      0.00375
  0.01875]
 [0.005   0.17375 0.      0.43875 0.0525  0.20125 0.08375 0.04125 0.00375
  0.     ]
 [0.      0.035   0.      0.0225  0.81875 0.01375 0.10625 0.0025  0.00125
  0.     ]
 [0.00125 0.06125 0.      0.0525  0.0575  0.69625 0.10125 0.0275  0.0025
  0.     ]
 [0.00375 0.01125 0.00125 0.00625 0.28375 0.0175  0.665   0.0025  0.00375
  0.005  ]
 [0.00375 0.16625 0.      0.03625 0.01625 0.03625 0.05    0.69    0.00125
  0.     ]
 [0.0075  0.      0.      0.0025  0.      0.      0.0125  0.      0.9725
  0.005  ]
 [0.0075  0.      0.0525  0.00125 0.00125 0.      0.03    0.00125 0.0175
  0.88875]]
[2023-08-02 12:33:47,993 INFO] 570000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1623, device='cuda:0'), 'train/shrink_loss': tensor(0.0542, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0395, device='cuda:0'), 'train/removed_class_idx': 2.5428569006802952, 'train/uncertainty_avg': 0.7283578442969953, 'train/certain_ratio_ema': 0.7285594425750362, 'train/total_loss': tensor(0.2021, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.022009003079788165, 'train/prefecth_time': 0.01887276840209961, 'train/run_time': 0.554811767578125, 'eval/loss': tensor(1.1945, device='cuda:0'), 'eval/top-1-acc': 0.790125, 'eval/top-5-acc': 0.974625, 'eval/precision': 0.7984017234457534, 'eval/recall': 0.790125, 'eval/F1': 0.7868184520007566, 'eval/AUC': 0.9652484114583332}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 13:24:09,660 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 13:24:19,837 INFO] confusion matrix:
[[0.905   0.00375 0.00375 0.      0.00125 0.      0.06    0.      0.01625
  0.01   ]
 [0.05    0.77625 0.      0.01125 0.0125  0.0125  0.10625 0.01875 0.0125
  0.     ]
 [0.0025  0.005   0.935   0.      0.      0.      0.03625 0.      0.0025
  0.01875]
 [0.0025  0.13625 0.      0.325   0.0525  0.1625  0.21625 0.1025  0.0025
  0.     ]
 [0.      0.01125 0.      0.00625 0.79625 0.00875 0.17    0.00625 0.00125
  0.     ]
 [0.      0.015   0.      0.03625 0.0575  0.62875 0.21625 0.04375 0.0025
  0.     ]
 [0.00125 0.00625 0.00125 0.      0.1975  0.01125 0.76875 0.005   0.0025
  0.00625]
 [0.      0.16125 0.      0.005   0.01375 0.02625 0.13    0.6625  0.00125
  0.     ]
 [0.00375 0.      0.      0.      0.00125 0.      0.0225  0.00125 0.9625
  0.00875]
 [0.0025  0.0025  0.04375 0.      0.      0.      0.04625 0.0025  0.01625
  0.88625]]
[2023-08-02 13:24:19,843 INFO] 575000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1433, device='cuda:0'), 'train/shrink_loss': tensor(0.0726, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0526, device='cuda:0'), 'train/removed_class_idx': 2.52671736437272, 'train/uncertainty_avg': 0.7316694993309518, 'train/certain_ratio_ema': 0.7244962444363469, 'train/total_loss': tensor(0.1962, device='cuda:0'), 'train/mask_ratio': tensor(0.7076, device='cuda:0'), 'lr': 0.02187492172699801, 'train/prefecth_time': 0.02025494384765625, 'train/run_time': 0.5668588256835938, 'eval/loss': tensor(1.3477, device='cuda:0'), 'eval/top-1-acc': 0.764625, 'eval/top-5-acc': 0.963125, 'eval/precision': 0.7986822082153389, 'eval/recall': 0.764625, 'eval/F1': 0.7637077385160022, 'eval/AUC': 0.9636513368055554}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 14:14:38,091 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 14:14:48,676 INFO] confusion matrix:
[[0.9025  0.00125 0.00125 0.00125 0.00125 0.      0.06875 0.      0.015
  0.00875]
 [0.05625 0.7625  0.      0.03375 0.005   0.01625 0.1075  0.00875 0.01
  0.     ]
 [0.0025  0.0025  0.86375 0.      0.      0.      0.11    0.      0.
  0.02125]
 [0.00125 0.06375 0.      0.4025  0.02375 0.13375 0.30125 0.0725  0.00125
  0.     ]
 [0.      0.005   0.      0.02375 0.6625  0.0075  0.29375 0.00625 0.00125
  0.     ]
 [0.      0.01625 0.      0.04875 0.0625  0.53875 0.2825  0.05    0.00125
  0.     ]
 [0.00125 0.005   0.00375 0.      0.6     0.00625 0.36875 0.0075  0.0025
  0.005  ]
 [0.0025  0.13375 0.      0.04375 0.01125 0.01375 0.19125 0.6025  0.00125
  0.     ]
 [0.005   0.00125 0.      0.00125 0.      0.      0.1025  0.00125 0.87875
  0.01   ]
 [0.00875 0.00125 0.04    0.      0.      0.      0.13    0.0025  0.01
  0.8075 ]]
[2023-08-02 14:14:48,683 INFO] 580000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1854, device='cuda:0'), 'train/shrink_loss': tensor(0.0836, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0613, device='cuda:0'), 'train/removed_class_idx': 2.535999797120016, 'train/uncertainty_avg': 0.7259106474935544, 'train/certain_ratio_ema': 0.7338180265284394, 'train/total_loss': tensor(0.2471, device='cuda:0'), 'train/mask_ratio': tensor(0.7210, device='cuda:0'), 'lr': 0.02173990077856237, 'train/prefecth_time': 0.020470783233642577, 'train/run_time': 0.6061875, 'eval/loss': tensor(2.1684, device='cuda:0'), 'eval/top-1-acc': 0.679, 'eval/top-5-acc': 0.965125, 'eval/precision': 0.7493548602352107, 'eval/recall': 0.679, 'eval/F1': 0.701160908426567, 'eval/AUC': 0.9308111458333334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 15:05:06,376 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 15:05:17,883 INFO] confusion matrix:
[[0.895   0.      0.00125 0.00375 0.00125 0.      0.0725  0.      0.0175
  0.00875]
 [0.05125 0.7425  0.      0.0525  0.00875 0.0175  0.11125 0.005   0.01125
  0.     ]
 [0.00375 0.0025  0.87125 0.      0.      0.      0.10125 0.0025  0.00125
  0.0175 ]
 [0.00125 0.1     0.      0.3875  0.0475  0.1325  0.29875 0.03    0.0025
  0.     ]
 [0.      0.015   0.00125 0.02    0.66625 0.005   0.2875  0.00375 0.00125
  0.     ]
 [0.      0.0375  0.      0.045   0.11125 0.50625 0.28375 0.01125 0.005
  0.     ]
 [0.00125 0.00625 0.00125 0.      0.6375  0.01    0.335   0.00375 0.0025
  0.0025 ]
 [0.00125 0.16    0.      0.05375 0.0275  0.0175  0.2     0.53875 0.00125
  0.     ]
 [0.00625 0.      0.00125 0.00125 0.      0.      0.0925  0.      0.89
  0.00875]
 [0.00625 0.00125 0.06625 0.00125 0.      0.      0.12    0.00375 0.01125
  0.79   ]]
[2023-08-02 15:05:17,891 INFO] 585000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.2055e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1483, device='cuda:0'), 'train/shrink_loss': tensor(0.1135, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0824, device='cuda:0'), 'train/removed_class_idx': 2.338709488813751, 'train/uncertainty_avg': 0.7704736726110826, 'train/certain_ratio_ema': 0.7257992732383561, 'train/total_loss': tensor(0.2308, device='cuda:0'), 'train/mask_ratio': tensor(0.7232, device='cuda:0'), 'lr': 0.021603946034049217, 'train/prefecth_time': 0.02366124725341797, 'train/run_time': 0.5635095825195312, 'eval/loss': tensor(2.4034, device='cuda:0'), 'eval/top-1-acc': 0.66225, 'eval/top-5-acc': 0.963, 'eval/precision': 0.7386486667684921, 'eval/recall': 0.66225, 'eval/F1': 0.6839418375015439, 'eval/AUC': 0.9231415625}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 15:55:16,530 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 15:55:27,900 INFO] confusion matrix:
[[0.925   0.0025  0.00375 0.00125 0.      0.      0.03625 0.      0.02
  0.01125]
 [0.0625  0.77125 0.      0.02625 0.00875 0.0175  0.09    0.0125  0.01125
  0.     ]
 [0.0025  0.0025  0.8625  0.      0.      0.      0.10875 0.      0.
  0.02375]
 [0.0025  0.12375 0.      0.31625 0.08125 0.17125 0.2675  0.035   0.0025
  0.     ]
 [0.      0.0075  0.      0.0225  0.6875  0.01    0.26625 0.00375 0.0025
  0.     ]
 [0.      0.02125 0.      0.08375 0.07625 0.5375  0.23625 0.04125 0.00375
  0.     ]
 [0.00625 0.00125 0.00875 0.      0.62375 0.01    0.34125 0.00375 0.0025
  0.0025 ]
 [0.0025  0.16375 0.      0.03125 0.05125 0.01625 0.14375 0.59125 0.
  0.     ]
 [0.00625 0.      0.      0.00125 0.      0.      0.09375 0.      0.89
  0.00875]
 [0.00625 0.      0.03    0.      0.0025  0.      0.115   0.00125 0.01625
  0.82875]]
[2023-08-02 15:55:27,907 INFO] 590000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1486, device='cuda:0'), 'train/shrink_loss': tensor(0.1145, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0845, device='cuda:0'), 'train/removed_class_idx': 2.4586464316807195, 'train/uncertainty_avg': 0.7510139724817328, 'train/certain_ratio_ema': 0.7383546327439877, 'train/total_loss': tensor(0.2333, device='cuda:0'), 'train/mask_ratio': tensor(0.7031, device='cuda:0'), 'lr': 0.02146706333313594, 'train/prefecth_time': 0.02376652717590332, 'train/run_time': 0.564802734375, 'eval/loss': tensor(2.1934, device='cuda:0'), 'eval/top-1-acc': 0.675125, 'eval/top-5-acc': 0.975375, 'eval/precision': 0.7324514808236102, 'eval/recall': 0.6751250000000001, 'eval/F1': 0.689121835876392, 'eval/AUC': 0.9342637586805557}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 16:45:43,598 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 16:45:54,663 INFO] confusion matrix:
[[0.95625 0.00125 0.00125 0.00125 0.00125 0.      0.005   0.      0.02125
  0.0125 ]
 [0.05875 0.8025  0.      0.03375 0.00875 0.01625 0.03625 0.03375 0.01
  0.     ]
 [0.005   0.00125 0.935   0.      0.      0.      0.0375  0.00125 0.00375
  0.01625]
 [0.0025  0.0775  0.      0.445   0.0425  0.20625 0.135   0.09    0.00125
  0.     ]
 [0.      0.00875 0.      0.00625 0.8275  0.01375 0.115   0.0275  0.00125
  0.     ]
 [0.00375 0.045   0.      0.05    0.09    0.63    0.11375 0.06375 0.00375
  0.     ]
 [0.0025  0.00875 0.0075  0.00375 0.79125 0.01125 0.1675  0.00125 0.0025
  0.00375]
 [0.0025  0.15    0.      0.01875 0.01    0.05625 0.09125 0.67125 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.01625 0.      0.965
  0.01   ]
 [0.00375 0.00125 0.05    0.      0.      0.      0.03375 0.0025  0.0125
  0.89625]]
[2023-08-02 16:45:54,670 INFO] 595000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1267, device='cuda:0'), 'train/shrink_loss': tensor(0.0641, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0470, device='cuda:0'), 'train/removed_class_idx': 2.4615382721893635, 'train/uncertainty_avg': 0.732339875576018, 'train/certain_ratio_ema': 0.7331193294016651, 'train/total_loss': tensor(0.1739, device='cuda:0'), 'train/mask_ratio': tensor(0.7098, device='cuda:0'), 'lr': 0.021329258555358537, 'train/prefecth_time': 0.018598463058471678, 'train/run_time': 0.5662657470703125, 'eval/loss': tensor(1.6666, device='cuda:0'), 'eval/top-1-acc': 0.729625, 'eval/top-5-acc': 0.98275, 'eval/precision': 0.7402478465440178, 'eval/recall': 0.7296250000000001, 'eval/F1': 0.7239795838853842, 'eval/AUC': 0.9487859288194442}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 17:36:30,884 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 17:36:42,933 INFO] confusion matrix:
[[0.9125  0.      0.00625 0.0025  0.      0.      0.05    0.      0.02125
  0.0075 ]
 [0.05875 0.73625 0.      0.0625  0.0075  0.01    0.10625 0.00875 0.01
  0.     ]
 [0.0025  0.00375 0.86375 0.      0.      0.      0.12    0.      0.0025
  0.0075 ]
 [0.00375 0.0625  0.      0.44125 0.05375 0.0975  0.2975  0.0425  0.00125
  0.     ]
 [0.      0.00625 0.0025  0.0275  0.63875 0.0075  0.31125 0.00625 0.
  0.     ]
 [0.0075  0.02875 0.      0.0575  0.12625 0.44125 0.28875 0.04625 0.00375
  0.     ]
 [0.00125 0.0075  0.00375 0.      0.605   0.00375 0.36625 0.00625 0.00375
  0.0025 ]
 [0.00375 0.115   0.      0.06    0.0325  0.00875 0.1925  0.5875  0.
  0.     ]
 [0.005   0.      0.00125 0.00125 0.      0.      0.125   0.      0.86125
  0.00625]
 [0.005   0.      0.11    0.0025  0.00125 0.      0.125   0.00375 0.01375
  0.73875]]
[2023-08-02 17:36:42,940 INFO] 600000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1385, device='cuda:0'), 'train/shrink_loss': tensor(0.0773, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0564, device='cuda:0'), 'train/removed_class_idx': 2.35576900425298, 'train/uncertainty_avg': 0.7710258652059648, 'train/certain_ratio_ema': 0.7294845126691394, 'train/total_loss': tensor(0.1951, device='cuda:0'), 'train/mask_ratio': tensor(0.7679, device='cuda:0'), 'lr': 0.021190537619859062, 'train/prefecth_time': 0.02191638374328613, 'train/run_time': 0.5591046142578125, 'eval/loss': tensor(2.3572, device='cuda:0'), 'eval/top-1-acc': 0.65875, 'eval/top-5-acc': 0.97625, 'eval/precision': 0.7369681457985564, 'eval/recall': 0.6587500000000001, 'eval/F1': 0.68198668199482, 'eval/AUC': 0.9271487673611112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 18:27:15,505 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 18:27:26,577 INFO] confusion matrix:
[[0.9525  0.00125 0.0025  0.00125 0.00125 0.      0.01125 0.      0.0175
  0.0125 ]
 [0.0675  0.7675  0.      0.045   0.0075  0.01875 0.07125 0.0075  0.015
  0.     ]
 [0.005   0.0025  0.90125 0.      0.      0.00125 0.0775  0.      0.005
  0.0075 ]
 [0.00375 0.07875 0.      0.34    0.04    0.22375 0.26    0.0525  0.00125
  0.     ]
 [0.      0.00625 0.      0.0275  0.71625 0.00875 0.23375 0.005   0.0025
  0.     ]
 [0.00625 0.0275  0.      0.04    0.11    0.56    0.2225  0.02375 0.01
  0.     ]
 [0.0025  0.005   0.00375 0.      0.65    0.00875 0.32125 0.00625 0.00125
  0.00125]
 [0.00375 0.15    0.      0.06625 0.0175  0.04125 0.1775  0.54375 0.
  0.     ]
 [0.005   0.      0.      0.00125 0.      0.      0.03625 0.00125 0.94875
  0.0075 ]
 [0.005   0.00125 0.16625 0.00125 0.      0.      0.08125 0.00375 0.015
  0.72625]]
[2023-08-02 18:27:26,585 INFO] 605000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.6125e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1706, device='cuda:0'), 'train/shrink_loss': tensor(0.0619, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0451, device='cuda:0'), 'train/removed_class_idx': 2.4607840724721495, 'train/uncertainty_avg': 0.7514191570426816, 'train/certain_ratio_ema': 0.7292283733853762, 'train/total_loss': tensor(0.2158, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.02105090648513138, 'train/prefecth_time': 0.01883340835571289, 'train/run_time': 0.5563510131835937, 'eval/loss': tensor(1.9640, device='cuda:0'), 'eval/top-1-acc': 0.67775, 'eval/top-5-acc': 0.9735, 'eval/precision': 0.7203132662231952, 'eval/recall': 0.67775, 'eval/F1': 0.684985837988737, 'eval/AUC': 0.9361425260416668}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 19:17:49,773 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 19:18:00,059 INFO] confusion matrix:
[[0.95625 0.0025  0.005   0.00125 0.      0.00125 0.0075  0.      0.0175
  0.00875]
 [0.07    0.7775  0.      0.0275  0.00375 0.01625 0.07875 0.01    0.01625
  0.     ]
 [0.00375 0.00625 0.87625 0.      0.      0.      0.09875 0.      0.
  0.015  ]
 [0.00375 0.0675  0.      0.33625 0.06    0.22125 0.27375 0.035   0.00125
  0.00125]
 [0.0025  0.00625 0.      0.01375 0.71875 0.015   0.23625 0.00375 0.00375
  0.     ]
 [0.0075  0.02375 0.      0.01625 0.11125 0.50625 0.27625 0.04875 0.01
  0.     ]
 [0.00125 0.0075  0.0025  0.      0.55375 0.02    0.39875 0.0075  0.005
  0.00375]
 [0.0025  0.13125 0.      0.02    0.01625 0.02625 0.21875 0.5825  0.00125
  0.00125]
 [0.00625 0.      0.      0.      0.00125 0.      0.01875 0.      0.9625
  0.01125]
 [0.005   0.00125 0.08875 0.      0.      0.      0.06    0.00125 0.01125
  0.8325 ]]
[2023-08-02 19:18:00,066 INFO] 610000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0007, device='cuda:0'), 'train/certain_loss': tensor(0.1947, device='cuda:0'), 'train/shrink_loss': tensor(0.1017, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0736, device='cuda:0'), 'train/removed_class_idx': 2.869565009451811, 'train/uncertainty_avg': 0.728021688590114, 'train/certain_ratio_ema': 0.7240671835846241, 'train/total_loss': tensor(0.2690, device='cuda:0'), 'train/mask_ratio': tensor(0.6920, device='cuda:0'), 'lr': 0.020910371148765237, 'train/prefecth_time': 0.02408755111694336, 'train/run_time': 0.5722190551757812, 'eval/loss': tensor(1.8376, device='cuda:0'), 'eval/top-1-acc': 0.69475, 'eval/top-5-acc': 0.97625, 'eval/precision': 0.7465697653194707, 'eval/recall': 0.69475, 'eval/F1': 0.7031067619441715, 'eval/AUC': 0.9444789583333334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 20:07:51,911 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 20:08:02,471 INFO] confusion matrix:
[[0.95625 0.0025  0.00375 0.      0.00125 0.      0.00375 0.      0.02125
  0.01125]
 [0.0725  0.78    0.      0.0175  0.00375 0.0375  0.06    0.0025  0.02625
  0.     ]
 [0.005   0.0025  0.91875 0.      0.      0.00125 0.05    0.00125 0.0025
  0.01875]
 [0.00375 0.07875 0.      0.25875 0.05    0.3025  0.295   0.005   0.00625
  0.     ]
 [0.      0.00625 0.      0.0075  0.6875  0.02375 0.27    0.00125 0.00375
  0.     ]
 [0.00375 0.03125 0.      0.01625 0.14875 0.505   0.27875 0.00375 0.0125
  0.     ]
 [0.0025  0.00375 0.0025  0.      0.6175  0.01125 0.34875 0.00125 0.01
  0.0025 ]
 [0.0025  0.1975  0.      0.02375 0.02625 0.1275  0.2025  0.42    0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.00125 0.0025  0.      0.97375
  0.01375]
 [0.00375 0.00125 0.0925  0.      0.      0.      0.025   0.00125 0.01
  0.86625]]
[2023-08-02 20:08:02,479 INFO] 615000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.0908, device='cuda:0'), 'train/shrink_loss': tensor(0.1239, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0910, device='cuda:0'), 'train/removed_class_idx': 2.3759998099200152, 'train/uncertainty_avg': 0.7608506109001396, 'train/certain_ratio_ema': 0.7348540547136883, 'train/total_loss': tensor(0.1819, device='cuda:0'), 'train/mask_ratio': tensor(0.7210, device='cuda:0'), 'lr': 0.02076893764718863, 'train/prefecth_time': 0.04861759948730469, 'train/run_time': 0.5718689575195313, 'eval/loss': tensor(2.1572, device='cuda:0'), 'eval/top-1-acc': 0.6715, 'eval/top-5-acc': 0.975, 'eval/precision': 0.7310249050572414, 'eval/recall': 0.6715, 'eval/F1': 0.672557948825164, 'eval/AUC': 0.9355274218750002}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 20:58:24,743 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 20:58:35,613 INFO] confusion matrix:
[[0.95625 0.      0.00125 0.00375 0.00375 0.      0.00375 0.      0.02125
  0.01   ]
 [0.065   0.7175  0.      0.095   0.0075  0.00875 0.07125 0.01125 0.02375
  0.     ]
 [0.00625 0.0025  0.85375 0.      0.0025  0.0025  0.10875 0.      0.005
  0.01875]
 [0.0025  0.10125 0.      0.4175  0.06    0.0975  0.30875 0.01    0.0025
  0.     ]
 [0.00125 0.00875 0.      0.03625 0.61375 0.01375 0.31875 0.00375 0.00375
  0.     ]
 [0.00375 0.04125 0.      0.0675  0.14625 0.40625 0.31375 0.01125 0.01
  0.     ]
 [0.0025  0.01    0.0025  0.      0.5925  0.01125 0.3725  0.      0.00375
  0.005  ]
 [0.0025  0.1625  0.      0.08375 0.04    0.01125 0.22    0.47875 0.
  0.00125]
 [0.005   0.      0.      0.0025  0.      0.      0.0025  0.      0.9775
  0.0125 ]
 [0.01125 0.00125 0.04875 0.00125 0.      0.      0.04125 0.00125 0.015
  0.88   ]]
[2023-08-02 20:58:35,620 INFO] 620000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1947, device='cuda:0'), 'train/shrink_loss': tensor(0.0474, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0348, device='cuda:0'), 'train/removed_class_idx': 2.4158413449662035, 'train/uncertainty_avg': 0.7619961778469931, 'train/certain_ratio_ema': 0.7335137584865905, 'train/total_loss': tensor(0.2297, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.02062661205540855, 'train/prefecth_time': 0.018476768493652342, 'train/run_time': 0.5513800659179687, 'eval/loss': tensor(2.4365, device='cuda:0'), 'eval/top-1-acc': 0.667375, 'eval/top-5-acc': 0.96475, 'eval/precision': 0.7287294916448148, 'eval/recall': 0.667375, 'eval/F1': 0.6800325945207094, 'eval/AUC': 0.92482265625}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 21:48:49,134 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 21:48:59,277 INFO] confusion matrix:
[[0.95875 0.      0.00125 0.00375 0.0025  0.      0.00375 0.      0.02
  0.01   ]
 [0.07375 0.7625  0.      0.04125 0.0025  0.03625 0.0575  0.005   0.02
  0.00125]
 [0.01375 0.00125 0.9525  0.      0.0025  0.      0.01    0.      0.00375
  0.01625]
 [0.0075  0.1225  0.      0.305   0.04375 0.19875 0.31125 0.0075  0.00375
  0.     ]
 [0.      0.00875 0.00125 0.01375 0.5775  0.045   0.35    0.00125 0.0025
  0.     ]
 [0.01    0.0375  0.      0.04625 0.07375 0.50875 0.31125 0.0025  0.01
  0.     ]
 [0.00375 0.0125  0.0025  0.005   0.46875 0.06125 0.43625 0.      0.00625
  0.00375]
 [0.00375 0.22625 0.      0.0575  0.0275  0.1     0.21    0.3725  0.00125
  0.00125]
 [0.00625 0.      0.      0.0025  0.      0.      0.      0.      0.98
  0.01125]
 [0.00625 0.00125 0.1125  0.00125 0.      0.00125 0.00625 0.      0.01375
  0.8575 ]]
[2023-08-02 21:48:59,284 INFO] 625000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.2169, device='cuda:0'), 'train/shrink_loss': tensor(0.0839, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0619, device='cuda:0'), 'train/removed_class_idx': 2.4731180136432243, 'train/uncertainty_avg': 0.7575230418409858, 'train/certain_ratio_ema': 0.7377000911660461, 'train/total_loss': tensor(0.2791, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.020483400486750004, 'train/prefecth_time': 0.0183670711517334, 'train/run_time': 0.5458812255859375, 'eval/loss': tensor(2.3233, device='cuda:0'), 'eval/top-1-acc': 0.671125, 'eval/top-5-acc': 0.963625, 'eval/precision': 0.7172440840559245, 'eval/recall': 0.671125, 'eval/F1': 0.6715398983681926, 'eval/AUC': 0.9263667100694445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 22:38:55,629 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 22:39:05,825 INFO] confusion matrix:
[[0.955   0.      0.00375 0.00375 0.00125 0.      0.00375 0.      0.0225
  0.01   ]
 [0.0725  0.72375 0.      0.0825  0.0075  0.01875 0.0725  0.00375 0.01875
  0.     ]
 [0.0075  0.      0.95125 0.0025  0.      0.      0.0125  0.      0.00375
  0.0225 ]
 [0.00625 0.11625 0.      0.37    0.04    0.15125 0.3     0.01125 0.005
  0.     ]
 [0.00125 0.0075  0.      0.0325  0.60625 0.01375 0.33375 0.      0.005
  0.     ]
 [0.00625 0.0325  0.      0.04875 0.14125 0.48375 0.27    0.005   0.0125
  0.     ]
 [0.00375 0.00625 0.0075  0.00125 0.57375 0.01875 0.38375 0.      0.00375
  0.00125]
 [0.00375 0.23125 0.      0.1775  0.015   0.0225  0.2225  0.32625 0.00125
  0.     ]
 [0.0075  0.      0.      0.0025  0.      0.      0.      0.      0.98125
  0.00875]
 [0.00625 0.00125 0.04625 0.00375 0.      0.      0.02    0.      0.01375
  0.90875]]
[2023-08-02 22:39:05,832 INFO] 630000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.7253e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1296, device='cuda:0'), 'train/shrink_loss': tensor(0.0785, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0593, device='cuda:0'), 'train/removed_class_idx': 2.4137928953626813, 'train/uncertainty_avg': 0.7457712071108169, 'train/certain_ratio_ema': 0.7551256966547981, 'train/total_loss': tensor(0.1889, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.020339309092593467, 'train/prefecth_time': 0.020332096099853515, 'train/run_time': 0.5585183715820312, 'eval/loss': tensor(2.5142, device='cuda:0'), 'eval/top-1-acc': 0.669, 'eval/top-5-acc': 0.964125, 'eval/precision': 0.7166889237620839, 'eval/recall': 0.6689999999999999, 'eval/F1': 0.6714998828008748, 'eval/AUC': 0.9251508159722223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-02 23:28:39,844 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-02 23:28:51,293 INFO] confusion matrix:
[[0.95625 0.0025  0.00375 0.      0.00125 0.      0.00375 0.      0.02375
  0.00875]
 [0.06875 0.735   0.      0.04125 0.0075  0.0125  0.075   0.04375 0.01625
  0.     ]
 [0.005   0.00125 0.9425  0.00125 0.      0.      0.0275  0.      0.005
  0.0175 ]
 [0.00375 0.09375 0.      0.385   0.04    0.1275  0.30625 0.04125 0.0025
  0.     ]
 [0.00125 0.00875 0.      0.02875 0.6125  0.015   0.32375 0.0075  0.0025
  0.     ]
 [0.00625 0.0275  0.      0.02375 0.14125 0.4625  0.29375 0.03875 0.00625
  0.     ]
 [0.005   0.005   0.00625 0.00375 0.58375 0.01    0.37625 0.0025  0.005
  0.0025 ]
 [0.005   0.11875 0.      0.055   0.01125 0.01375 0.20375 0.5925  0.
  0.     ]
 [0.0075  0.      0.00125 0.0025  0.      0.      0.00125 0.      0.97625
  0.01125]
 [0.005   0.00125 0.03875 0.0025  0.00125 0.      0.02625 0.00125 0.00875
  0.915  ]]
[2023-08-02 23:28:51,301 INFO] 635000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1321, device='cuda:0'), 'train/shrink_loss': tensor(0.0449, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0344, device='cuda:0'), 'train/removed_class_idx': 2.3913040879017293, 'train/uncertainty_avg': 0.7599359362047046, 'train/certain_ratio_ema': 0.7663951830445508, 'train/total_loss': tensor(0.1670, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.020194344062110643, 'train/prefecth_time': 0.01939740753173828, 'train/run_time': 0.54802880859375, 'eval/loss': tensor(2.3578, device='cuda:0'), 'eval/top-1-acc': 0.695375, 'eval/top-5-acc': 0.9745, 'eval/precision': 0.7390785292896656, 'eval/recall': 0.6953750000000001, 'eval/F1': 0.7044642026685841, 'eval/AUC': 0.9311988194444447}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 00:18:49,333 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 00:18:59,947 INFO] confusion matrix:
[[0.95875 0.      0.0025  0.00375 0.00375 0.      0.00125 0.      0.01875
  0.01125]
 [0.065   0.76    0.      0.0825  0.0025  0.01125 0.0575  0.00625 0.015
  0.     ]
 [0.005   0.00125 0.96625 0.0025  0.00125 0.      0.0025  0.      0.00625
  0.015  ]
 [0.0025  0.1225  0.      0.41375 0.01625 0.1475  0.2875  0.00875 0.00125
  0.     ]
 [0.      0.01375 0.      0.07625 0.565   0.02125 0.3175  0.0025  0.00375
  0.     ]
 [0.0075  0.03875 0.      0.0825  0.05625 0.49375 0.2975  0.01375 0.01
  0.     ]
 [0.00375 0.01625 0.00375 0.005   0.32125 0.08375 0.54625 0.0125  0.00375
  0.00375]
 [0.0025  0.18375 0.      0.1425  0.01    0.03375 0.1775  0.45    0.
  0.     ]
 [0.00875 0.      0.      0.0025  0.      0.      0.      0.      0.98
  0.00875]
 [0.0075  0.00125 0.0825  0.00125 0.      0.      0.00375 0.00125 0.01375
  0.88875]]
[2023-08-03 00:18:59,953 INFO] 640000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.3424e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1770, device='cuda:0'), 'train/shrink_loss': tensor(0.0917, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0680, device='cuda:0'), 'train/removed_class_idx': 2.3731341512586455, 'train/uncertainty_avg': 0.7403038145435523, 'train/certain_ratio_ema': 0.7416278425035432, 'train/total_loss': tensor(0.2451, device='cuda:0'), 'train/mask_ratio': tensor(0.7009, device='cuda:0'), 'lr': 0.020048511621998617, 'train/prefecth_time': 0.02077984046936035, 'train/run_time': 0.5658358764648438, 'eval/loss': tensor(2.0207, device='cuda:0'), 'eval/top-1-acc': 0.70225, 'eval/top-5-acc': 0.972875, 'eval/precision': 0.732082731461308, 'eval/recall': 0.7022499999999999, 'eval/F1': 0.7046457776554532, 'eval/AUC': 0.9391630208333333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 01:08:37,796 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 01:08:58,304 INFO] confusion matrix:
[[0.9625  0.      0.0025  0.00375 0.      0.      0.00375 0.      0.0175
  0.01   ]
 [0.06625 0.74625 0.      0.065   0.0075  0.01625 0.0575  0.0225  0.0175
  0.00125]
 [0.005   0.      0.96625 0.0025  0.      0.00125 0.0025  0.00125 0.005
  0.01625]
 [0.      0.10875 0.      0.39    0.03375 0.15    0.28875 0.02625 0.0025
  0.     ]
 [0.      0.01125 0.      0.03    0.6025  0.015   0.33875 0.00125 0.00125
  0.     ]
 [0.005   0.04625 0.      0.05125 0.14375 0.455   0.27125 0.02375 0.00375
  0.     ]
 [0.00375 0.0125  0.00375 0.00625 0.5625  0.01375 0.385   0.00375 0.005
  0.00375]
 [0.00375 0.1275  0.      0.09    0.015   0.03125 0.19625 0.53625 0.
  0.     ]
 [0.005   0.      0.      0.0025  0.      0.      0.      0.      0.98375
  0.00875]
 [0.00375 0.00125 0.065   0.0025  0.      0.      0.0025  0.00125 0.01
  0.91375]]
[2023-08-03 01:08:58,311 INFO] 645000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.6620e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1412, device='cuda:0'), 'train/shrink_loss': tensor(0.0361, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0273, device='cuda:0'), 'train/removed_class_idx': 2.5161287617065846, 'train/uncertainty_avg': 0.7522763534828997, 'train/certain_ratio_ema': 0.7563837277168033, 'train/total_loss': tensor(0.1686, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.019901818036212403, 'train/prefecth_time': 0.018467103958129883, 'train/run_time': 0.5516552124023437, 'eval/loss': tensor(2.4178, device='cuda:0'), 'eval/top-1-acc': 0.694125, 'eval/top-5-acc': 0.970625, 'eval/precision': 0.7283211658552589, 'eval/recall': 0.6941250000000001, 'eval/F1': 0.6999699831132065, 'eval/AUC': 0.9297757465277777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 01:58:27,987 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 01:58:38,646 INFO] confusion matrix:
[[0.95375 0.00125 0.00125 0.0025  0.00125 0.      0.00625 0.      0.0225
  0.01125]
 [0.0575  0.7675  0.      0.05375 0.005   0.01875 0.07    0.00875 0.01875
  0.     ]
 [0.00625 0.00125 0.94125 0.00375 0.      0.0025  0.02125 0.00125 0.005
  0.0175 ]
 [0.00125 0.105   0.      0.375   0.03    0.1725  0.30125 0.01125 0.00375
  0.     ]
 [0.      0.01    0.      0.03375 0.595   0.02    0.33375 0.00375 0.00375
  0.     ]
 [0.0075  0.0325  0.      0.0325  0.1175  0.47625 0.31    0.01375 0.01
  0.     ]
 [0.005   0.01375 0.0025  0.0025  0.5625  0.01875 0.38875 0.      0.005
  0.00125]
 [0.0025  0.1525  0.      0.1325  0.0125  0.03625 0.21375 0.45    0.
  0.     ]
 [0.00625 0.      0.      0.0025  0.      0.      0.00125 0.      0.9775
  0.0125 ]
 [0.0075  0.00125 0.06125 0.0025  0.      0.      0.02875 0.00125 0.00875
  0.88875]]
[2023-08-03 01:58:38,653 INFO] 650000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.6523e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1678, device='cuda:0'), 'train/shrink_loss': tensor(0.0708, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0537, device='cuda:0'), 'train/removed_class_idx': 2.4907405101166193, 'train/uncertainty_avg': 0.7646914978303598, 'train/certain_ratio_ema': 0.7579049337259194, 'train/total_loss': tensor(0.2215, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.019754269605695894, 'train/prefecth_time': 0.019223583221435546, 'train/run_time': 0.5567384033203125, 'eval/loss': tensor(2.5403, device='cuda:0'), 'eval/top-1-acc': 0.681375, 'eval/top-5-acc': 0.96875, 'eval/precision': 0.7258175500279125, 'eval/recall': 0.681375, 'eval/F1': 0.6887477647422154, 'eval/AUC': 0.9234552604166666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 02:48:25,911 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 02:48:36,065 INFO] confusion matrix:
[[0.95125 0.      0.0025  0.00375 0.0025  0.      0.005   0.      0.025
  0.01   ]
 [0.06    0.7525  0.      0.04375 0.00375 0.01625 0.06625 0.03625 0.02125
  0.     ]
 [0.005   0.0025  0.86125 0.00125 0.      0.00125 0.10875 0.00125 0.005
  0.01375]
 [0.0025  0.1325  0.      0.2525  0.03625 0.17625 0.2975  0.09875 0.00375
  0.     ]
 [0.      0.01    0.      0.01    0.58    0.01625 0.33875 0.04375 0.00125
  0.     ]
 [0.00625 0.04375 0.      0.015   0.09875 0.46625 0.29625 0.06625 0.0075
  0.     ]
 [0.00125 0.01    0.0025  0.      0.5675  0.025   0.37875 0.00875 0.005
  0.00125]
 [0.00125 0.185   0.      0.04    0.01375 0.0275  0.20625 0.525   0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.0025  0.      0.97875
  0.01125]
 [0.00375 0.00125 0.0925  0.      0.00125 0.      0.0525  0.00125 0.00625
  0.84125]]
[2023-08-03 02:48:36,071 INFO] 655000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0020, device='cuda:0'), 'train/certain_loss': tensor(0.1421, device='cuda:0'), 'train/shrink_loss': tensor(0.0828, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0625, device='cuda:0'), 'train/removed_class_idx': 2.377550777800941, 'train/uncertainty_avg': 0.73947841928693, 'train/certain_ratio_ema': 0.7542382189183838, 'train/total_loss': tensor(0.2066, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.01960587266811121, 'train/prefecth_time': 0.020436864852905273, 'train/run_time': 0.5504497680664062, 'eval/loss': tensor(2.6997, device='cuda:0'), 'eval/top-1-acc': 0.65875, 'eval/top-5-acc': 0.963375, 'eval/precision': 0.7022721778258914, 'eval/recall': 0.6587500000000001, 'eval/F1': 0.664279903022977, 'eval/AUC': 0.9212137152777776}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 03:38:09,592 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 03:38:19,411 INFO] confusion matrix:
[[0.96375 0.00125 0.00125 0.00125 0.00125 0.      0.005   0.      0.0125
  0.01375]
 [0.065   0.72875 0.      0.0225  0.005   0.01625 0.09    0.06125 0.01125
  0.     ]
 [0.0075  0.      0.8525  0.      0.      0.00125 0.11875 0.00375 0.00375
  0.0125 ]
 [0.025   0.11875 0.      0.20375 0.03    0.1575  0.29875 0.165   0.00125
  0.     ]
 [0.00125 0.01    0.      0.005   0.605   0.0125  0.33    0.035   0.00125
  0.     ]
 [0.00875 0.035   0.      0.02625 0.11    0.4825  0.2675  0.06625 0.00375
  0.     ]
 [0.00625 0.01375 0.0025  0.00125 0.5775  0.01375 0.36875 0.00875 0.00375
  0.00375]
 [0.0175  0.15    0.      0.00875 0.01125 0.0125  0.22125 0.57875 0.
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.00625 0.      0.9675
  0.015  ]
 [0.0025  0.00125 0.09375 0.      0.      0.      0.05    0.00125 0.0075
  0.84375]]
[2023-08-03 03:38:19,418 INFO] 660000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1698, device='cuda:0'), 'train/shrink_loss': tensor(0.0751, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0571, device='cuda:0'), 'train/removed_class_idx': 2.6106192379982973, 'train/uncertainty_avg': 0.7382339820106948, 'train/certain_ratio_ema': 0.7596569662682793, 'train/total_loss': tensor(0.2270, device='cuda:0'), 'train/mask_ratio': tensor(0.7478, device='cuda:0'), 'lr': 0.019456633597566476, 'train/prefecth_time': 0.019361343383789063, 'train/run_time': 0.5584197998046875, 'eval/loss': tensor(2.7185, device='cuda:0'), 'eval/top-1-acc': 0.6595, 'eval/top-5-acc': 0.969875, 'eval/precision': 0.7098966785177186, 'eval/recall': 0.6595, 'eval/F1': 0.6629142736053033, 'eval/AUC': 0.9184821354166668}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 04:28:04,037 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 04:28:13,764 INFO] confusion matrix:
[[0.7325  0.00125 0.0025  0.0025  0.      0.      0.0125  0.      0.015
  0.23375]
 [0.06375 0.7025  0.      0.04375 0.00625 0.01625 0.09125 0.0675  0.00875
  0.     ]
 [0.02625 0.      0.845   0.00125 0.      0.00125 0.11375 0.0025  0.00125
  0.00875]
 [0.0125  0.08625 0.      0.2875  0.03125 0.16375 0.3     0.1175  0.00125
  0.     ]
 [0.      0.00875 0.      0.01    0.61    0.0125  0.31875 0.03875 0.00125
  0.     ]
 [0.01125 0.03125 0.      0.0175  0.10375 0.45625 0.2825  0.09375 0.00375
  0.     ]
 [0.00625 0.00875 0.00375 0.0025  0.5875  0.00875 0.3725  0.005   0.00375
  0.00125]
 [0.01125 0.14    0.      0.06    0.01375 0.02125 0.195   0.55875 0.
  0.     ]
 [0.0025  0.      0.      0.00125 0.      0.      0.01375 0.      0.96125
  0.02125]
 [0.0175  0.00125 0.1125  0.00125 0.00125 0.      0.0925  0.00125 0.02
  0.7525 ]]
[2023-08-03 04:28:13,771 INFO] 665000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1619, device='cuda:0'), 'train/shrink_loss': tensor(0.0916, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0684, device='cuda:0'), 'train/removed_class_idx': 2.58208935954557, 'train/uncertainty_avg': 0.7436481748661619, 'train/certain_ratio_ema': 0.74689467414086, 'train/total_loss': tensor(0.2309, device='cuda:0'), 'train/mask_ratio': tensor(0.7009, device='cuda:0'), 'lr': 0.019306558804342042, 'train/prefecth_time': 0.019422079086303713, 'train/run_time': 0.569224853515625, 'eval/loss': tensor(2.9596, device='cuda:0'), 'eval/top-1-acc': 0.627875, 'eval/top-5-acc': 0.97325, 'eval/precision': 0.674114858512582, 'eval/recall': 0.6278749999999998, 'eval/F1': 0.6371276801405712, 'eval/AUC': 0.9115894357638888}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 05:18:07,415 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 05:18:17,288 INFO] confusion matrix:
[[0.95125 0.0025  0.0025  0.00375 0.00125 0.      0.005   0.      0.015
  0.01875]
 [0.0575  0.6875  0.      0.11375 0.00625 0.0175  0.095   0.01    0.0125
  0.     ]
 [0.0225  0.00625 0.85625 0.0025  0.      0.00375 0.1     0.      0.0025
  0.00625]
 [0.0025  0.0775  0.      0.3775  0.03125 0.1975  0.3     0.01    0.00375
  0.     ]
 [0.00125 0.005   0.      0.0425  0.60125 0.015   0.33125 0.0025  0.00125
  0.     ]
 [0.0075  0.02625 0.      0.045   0.1     0.525   0.26875 0.0225  0.005
  0.     ]
 [0.00375 0.01    0.0025  0.00375 0.5725  0.01375 0.38875 0.      0.005
  0.     ]
 [0.00125 0.135   0.      0.155   0.01375 0.02375 0.2225  0.4475  0.
  0.00125]
 [0.00375 0.      0.0025  0.0025  0.      0.      0.005   0.      0.97625
  0.01   ]
 [0.01    0.00125 0.14875 0.0025  0.      0.      0.0775  0.00125 0.0125
  0.74625]]
[2023-08-03 05:18:17,295 INFO] 670000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.7216e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0940, device='cuda:0'), 'train/shrink_loss': tensor(0.1002, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0751, device='cuda:0'), 'train/removed_class_idx': 2.4695650026465215, 'train/uncertainty_avg': 0.7763273551432375, 'train/certain_ratio_ema': 0.7488287677840808, 'train/total_loss': tensor(0.1691, device='cuda:0'), 'train/mask_ratio': tensor(0.7433, device='cuda:0'), 'lr': 0.019155654734615134, 'train/prefecth_time': 0.019384672164916992, 'train/run_time': 0.5600486450195312, 'eval/loss': tensor(2.5362, device='cuda:0'), 'eval/top-1-acc': 0.65575, 'eval/top-5-acc': 0.974625, 'eval/precision': 0.7102726326916369, 'eval/recall': 0.6557499999999999, 'eval/F1': 0.6686625559076599, 'eval/AUC': 0.9271069357638889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 06:07:54,960 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 06:08:05,007 INFO] confusion matrix:
[[0.95    0.0025  0.00125 0.00375 0.00125 0.      0.01    0.      0.01875
  0.0125 ]
 [0.06375 0.69    0.      0.065   0.00625 0.01625 0.105   0.03125 0.0225
  0.     ]
 [0.015   0.00625 0.82875 0.      0.      0.00125 0.12875 0.      0.0025
  0.0175 ]
 [0.00375 0.0975  0.      0.3575  0.02    0.175   0.31    0.02875 0.0075
  0.     ]
 [0.00125 0.01    0.      0.0175  0.56625 0.03375 0.31625 0.04875 0.00625
  0.     ]
 [0.00625 0.0225  0.      0.03375 0.0825  0.52125 0.29125 0.0325  0.01
  0.     ]
 [0.00375 0.01    0.0025  0.00125 0.53    0.065   0.3725  0.00625 0.0075
  0.00125]
 [0.005   0.21625 0.      0.05375 0.01125 0.04125 0.21875 0.45375 0.
  0.     ]
 [0.0075  0.      0.      0.      0.      0.00125 0.015   0.      0.965
  0.01125]
 [0.00875 0.00125 0.10375 0.      0.      0.00125 0.0775  0.00125 0.00875
  0.7975 ]]
[2023-08-03 06:08:05,015 INFO] 675000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2585e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1482, device='cuda:0'), 'train/shrink_loss': tensor(0.0637, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0480, device='cuda:0'), 'train/removed_class_idx': 2.5145628626637997, 'train/uncertainty_avg': 0.7493096909978405, 'train/certain_ratio_ema': 0.7542209974997773, 'train/total_loss': tensor(0.1962, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.019003927870182957, 'train/prefecth_time': 0.019088064193725586, 'train/run_time': 0.5549877319335937, 'eval/loss': tensor(2.6693, device='cuda:0'), 'eval/top-1-acc': 0.65025, 'eval/top-5-acc': 0.964625, 'eval/precision': 0.7000223327915607, 'eval/recall': 0.65025, 'eval/F1': 0.6623193181079069, 'eval/AUC': 0.9137460763888886}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 06:57:46,361 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 06:57:56,075 INFO] confusion matrix:
[[0.9475  0.00125 0.00125 0.00375 0.00125 0.      0.01625 0.      0.01375
  0.015  ]
 [0.06375 0.68375 0.      0.0375  0.0075  0.0175  0.1075  0.0775  0.005
  0.     ]
 [0.035   0.00125 0.81    0.      0.      0.00125 0.13    0.00375 0.0025
  0.01625]
 [0.00625 0.0925  0.      0.285   0.03375 0.12625 0.30875 0.14375 0.00375
  0.     ]
 [0.00125 0.00875 0.00125 0.00875 0.58125 0.0225  0.32375 0.05125 0.00125
  0.     ]
 [0.0075  0.0275  0.      0.0225  0.1325  0.48625 0.28125 0.03875 0.00375
  0.     ]
 [0.005   0.0075  0.00125 0.00125 0.58125 0.01375 0.3775  0.00625 0.0025
  0.00375]
 [0.0025  0.14    0.      0.0225  0.01625 0.01625 0.22125 0.58125 0.
  0.     ]
 [0.00625 0.      0.      0.      0.      0.      0.0175  0.      0.965
  0.01125]
 [0.01375 0.00125 0.10875 0.      0.      0.      0.0775  0.00125 0.01125
  0.78625]]
[2023-08-03 06:57:56,082 INFO] 680000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.2642e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1513, device='cuda:0'), 'train/shrink_loss': tensor(0.0548, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0411, device='cuda:0'), 'train/removed_class_idx': 2.339805598077126, 'train/uncertainty_avg': 0.7675270818566371, 'train/certain_ratio_ema': 0.7511248823271224, 'train/total_loss': tensor(0.1925, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.018851384728184328, 'train/prefecth_time': 0.01893836784362793, 'train/run_time': 0.5508513793945312, 'eval/loss': tensor(2.7200, device='cuda:0'), 'eval/top-1-acc': 0.650375, 'eval/top-5-acc': 0.973, 'eval/precision': 0.7092884817491872, 'eval/recall': 0.650375, 'eval/F1': 0.6623829349193835, 'eval/AUC': 0.9175539149305555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 07:47:49,092 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 07:47:58,868 INFO] confusion matrix:
[[0.95625 0.00125 0.00125 0.      0.0025  0.      0.0125  0.00125 0.01125
  0.01375]
 [0.06    0.74125 0.      0.0175  0.00875 0.055   0.1025  0.00875 0.00625
  0.     ]
 [0.0175  0.      0.82875 0.      0.00125 0.00125 0.1375  0.00125 0.00125
  0.01125]
 [0.00375 0.145   0.      0.325   0.035   0.15    0.31875 0.02125 0.00125
  0.     ]
 [0.00125 0.0075  0.      0.01375 0.5825  0.06375 0.3275  0.0025  0.00125
  0.     ]
 [0.005   0.045   0.      0.10875 0.14625 0.4175  0.27625 0.      0.00125
  0.     ]
 [0.005   0.00875 0.0025  0.00125 0.57625 0.01875 0.38375 0.00125 0.00125
  0.00125]
 [0.00375 0.22125 0.      0.04375 0.03375 0.22375 0.23125 0.2425  0.
  0.     ]
 [0.0075  0.00125 0.      0.00125 0.      0.      0.03875 0.      0.93875
  0.0125 ]
 [0.00875 0.00125 0.1325  0.00125 0.      0.00125 0.10125 0.      0.01375
  0.74   ]]
[2023-08-03 07:47:58,875 INFO] 685000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1590, device='cuda:0'), 'train/shrink_loss': tensor(0.0581, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0428, device='cuda:0'), 'train/removed_class_idx': 2.425925701303176, 'train/uncertainty_avg': 0.7454848482257772, 'train/certain_ratio_ema': 0.7369305510230916, 'train/total_loss': tensor(0.2019, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.018698031860819687, 'train/prefecth_time': 0.018862560272216798, 'train/run_time': 0.5595614013671875, 'eval/loss': tensor(2.8732, device='cuda:0'), 'eval/top-1-acc': 0.615625, 'eval/top-5-acc': 0.963625, 'eval/precision': 0.6869025992712109, 'eval/recall': 0.615625, 'eval/F1': 0.6224003186202454, 'eval/AUC': 0.9040780034722222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 08:37:31,100 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 08:37:40,790 INFO] confusion matrix:
[[0.95    0.00125 0.00375 0.00375 0.0025  0.      0.01125 0.      0.01375
  0.01375]
 [0.05875 0.74625 0.00125 0.04875 0.00625 0.01125 0.08375 0.03625 0.0075
  0.     ]
 [0.01375 0.      0.84375 0.      0.      0.      0.11375 0.00125 0.00125
  0.02625]
 [0.00375 0.1425  0.00125 0.3075  0.03    0.1575  0.295   0.06    0.0025
  0.     ]
 [0.00125 0.01    0.      0.01625 0.6     0.01125 0.33    0.03    0.00125
  0.     ]
 [0.00625 0.0375  0.      0.0325  0.13375 0.4925  0.25625 0.035   0.00625
  0.     ]
 [0.0025  0.01    0.0025  0.00125 0.58625 0.0125  0.375   0.0025  0.00375
  0.00375]
 [0.0025  0.1825  0.      0.08125 0.01375 0.0275  0.20125 0.49125 0.
  0.     ]
 [0.00625 0.      0.      0.0025  0.      0.      0.01875 0.      0.9625
  0.01   ]
 [0.005   0.00125 0.0275  0.0025  0.      0.      0.07625 0.00125 0.01125
  0.875  ]]
[2023-08-03 08:37:40,797 INFO] 690000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.9837e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1405, device='cuda:0'), 'train/shrink_loss': tensor(0.0732, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0554, device='cuda:0'), 'train/removed_class_idx': 2.471074175944283, 'train/uncertainty_avg': 0.7445123109894161, 'train/certain_ratio_ema': 0.7575243029987221, 'train/total_loss': tensor(0.1960, device='cuda:0'), 'train/mask_ratio': tensor(0.7299, device='cuda:0'), 'lr': 0.018543875855069697, 'train/prefecth_time': 0.020724639892578126, 'train/run_time': 0.5649282836914062, 'eval/loss': tensor(2.6853, device='cuda:0'), 'eval/top-1-acc': 0.664375, 'eval/top-5-acc': 0.974375, 'eval/precision': 0.7126433189035193, 'eval/recall': 0.664375, 'eval/F1': 0.6746145667019168, 'eval/AUC': 0.9204445572916667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 09:27:41,141 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 09:27:51,633 INFO] confusion matrix:
[[0.9575  0.00125 0.00375 0.      0.0025  0.00125 0.00625 0.      0.015
  0.0125 ]
 [0.07    0.71    0.0025  0.035   0.01125 0.0575  0.085   0.0225  0.00625
  0.     ]
 [0.00375 0.0025  0.87    0.      0.      0.      0.08875 0.      0.0025
  0.0325 ]
 [0.0025  0.19375 0.01375 0.2375  0.065   0.18    0.27125 0.03375 0.0025
  0.     ]
 [0.      0.0125  0.      0.01    0.5875  0.045   0.32375 0.02    0.00125
  0.     ]
 [0.005   0.08375 0.      0.05875 0.135   0.4575  0.23125 0.025   0.00375
  0.     ]
 [0.00375 0.01625 0.0025  0.00125 0.56875 0.015   0.3875  0.      0.00375
  0.00125]
 [0.00375 0.21    0.02    0.0325  0.04    0.05375 0.18125 0.45875 0.
  0.     ]
 [0.00625 0.      0.00125 0.00125 0.00125 0.      0.01    0.      0.97125
  0.00875]
 [0.005   0.00125 0.01375 0.00125 0.0025  0.      0.05875 0.00125 0.01125
  0.905  ]]
[2023-08-03 09:27:51,639 INFO] 695000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1277, device='cuda:0'), 'train/shrink_loss': tensor(0.0820, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0595, device='cuda:0'), 'train/removed_class_idx': 2.363636184573016, 'train/uncertainty_avg': 0.73668935416505, 'train/certain_ratio_ema': 0.7253949952043593, 'train/total_loss': tensor(0.1874, device='cuda:0'), 'train/mask_ratio': tensor(0.7054, device='cuda:0'), 'lr': 0.018388923332412297, 'train/prefecth_time': 0.019673023223876953, 'train/run_time': 0.565888916015625, 'eval/loss': tensor(2.4202, device='cuda:0'), 'eval/top-1-acc': 0.65425, 'eval/top-5-acc': 0.9725, 'eval/precision': 0.6979974997365948, 'eval/recall': 0.65425, 'eval/F1': 0.6574135357840939, 'eval/AUC': 0.9176129513888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 10:17:36,550 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 10:17:46,832 INFO] confusion matrix:
[[0.95625 0.00125 0.0025  0.0025  0.00125 0.      0.005   0.      0.01625
  0.015  ]
 [0.0675  0.7     0.      0.07625 0.00875 0.02375 0.08625 0.02625 0.01125
  0.     ]
 [0.0075  0.      0.855   0.00125 0.      0.      0.09375 0.00125 0.00375
  0.0375 ]
 [0.005   0.14875 0.      0.31    0.06    0.1625  0.2925  0.01875 0.0025
  0.     ]
 [0.00125 0.01125 0.      0.0225  0.57375 0.0475  0.33    0.0125  0.00125
  0.     ]
 [0.00875 0.0475  0.      0.05125 0.10625 0.50875 0.2625  0.01125 0.00375
  0.     ]
 [0.00375 0.01125 0.00375 0.0025  0.555   0.03125 0.3875  0.      0.00375
  0.00125]
 [0.0025  0.205   0.      0.1275  0.04375 0.0425  0.215   0.36375 0.
  0.     ]
 [0.00625 0.      0.      0.00125 0.00125 0.      0.01    0.      0.9725
  0.00875]
 [0.01125 0.00125 0.02875 0.00125 0.00125 0.      0.0625  0.00125 0.01625
  0.87625]]
[2023-08-03 10:17:46,840 INFO] 700000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0154, device='cuda:0'), 'train/certain_loss': tensor(0.1545, device='cuda:0'), 'train/shrink_loss': tensor(0.0763, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0570, device='cuda:0'), 'train/removed_class_idx': 2.5196848409696977, 'train/uncertainty_avg': 0.7416061163320035, 'train/certain_ratio_ema': 0.7476819165326535, 'train/total_loss': tensor(0.2269, device='cuda:0'), 'train/mask_ratio': tensor(0.7165, device='cuda:0'), 'lr': 0.018233180948538305, 'train/prefecth_time': 0.019576351165771486, 'train/run_time': 0.563022705078125, 'eval/loss': tensor(2.7552, device='cuda:0'), 'eval/top-1-acc': 0.650375, 'eval/top-5-acc': 0.9635, 'eval/precision': 0.697841988860868, 'eval/recall': 0.650375, 'eval/F1': 0.6574551571448513, 'eval/AUC': 0.9110275086805555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 11:07:46,412 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 11:07:57,381 INFO] confusion matrix:
[[0.96    0.00125 0.0025  0.      0.00125 0.      0.005   0.      0.02
  0.01   ]
 [0.065   0.69875 0.0025  0.0275  0.01    0.02375 0.07625 0.0775  0.01875
  0.     ]
 [0.0075  0.      0.86375 0.      0.      0.      0.10375 0.00125 0.00375
  0.02   ]
 [0.00375 0.19    0.00125 0.19625 0.06    0.16875 0.30375 0.0725  0.00375
  0.     ]
 [0.00125 0.0125  0.00125 0.00625 0.5275  0.06625 0.33625 0.0475  0.00125
  0.     ]
 [0.00875 0.05625 0.      0.02875 0.105   0.51375 0.25625 0.025   0.00625
  0.     ]
 [0.00375 0.0125  0.0025  0.      0.555   0.03    0.3875  0.0025  0.00375
  0.0025 ]
 [0.00375 0.17625 0.      0.01875 0.04625 0.0225  0.19375 0.53875 0.
  0.     ]
 [0.00625 0.      0.      0.      0.00125 0.      0.0025  0.      0.98125
  0.00875]
 [0.0125  0.00125 0.045   0.      0.00125 0.      0.05375 0.00125 0.01625
  0.86875]]
[2023-08-03 11:07:57,387 INFO] 705000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1368, device='cuda:0'), 'train/shrink_loss': tensor(0.0728, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0545, device='cuda:0'), 'train/removed_class_idx': 2.499999754901985, 'train/uncertainty_avg': 0.7675848744784077, 'train/certain_ratio_ema': 0.7483666953904381, 'train/total_loss': tensor(0.1914, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.018076655393065518, 'train/prefecth_time': 0.019326175689697266, 'train/run_time': 0.552313232421875, 'eval/loss': tensor(2.6640, device='cuda:0'), 'eval/top-1-acc': 0.653625, 'eval/top-5-acc': 0.970125, 'eval/precision': 0.6990206143061741, 'eval/recall': 0.6536250000000001, 'eval/F1': 0.6564361109912109, 'eval/AUC': 0.9121320486111111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 11:57:42,750 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 11:57:53,442 INFO] confusion matrix:
[[0.96    0.00125 0.00125 0.00125 0.00125 0.      0.005   0.      0.01875
  0.01125]
 [0.06625 0.72    0.00125 0.055   0.0075  0.01375 0.06875 0.05375 0.01375
  0.     ]
 [0.01    0.      0.87875 0.      0.      0.      0.0775  0.00125 0.0025
  0.03   ]
 [0.00625 0.15375 0.0075  0.3475  0.03625 0.09    0.30375 0.05375 0.00125
  0.     ]
 [0.00125 0.01125 0.0025  0.01875 0.5725  0.02625 0.35    0.01625 0.00125
  0.     ]
 [0.00875 0.065   0.0025  0.1025  0.13875 0.38375 0.2725  0.0225  0.00375
  0.     ]
 [0.0025  0.01375 0.00625 0.00375 0.55625 0.01625 0.3925  0.0025  0.00375
  0.0025 ]
 [0.005   0.17875 0.0025  0.09    0.01875 0.0225  0.2     0.4825  0.
  0.     ]
 [0.0025  0.      0.      0.00125 0.00125 0.      0.00125 0.      0.98625
  0.0075 ]
 [0.015   0.00125 0.02375 0.      0.      0.      0.03875 0.0025  0.01375
  0.905  ]]
[2023-08-03 11:57:53,449 INFO] 710000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.9901e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1568, device='cuda:0'), 'train/shrink_loss': tensor(0.0636, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0479, device='cuda:0'), 'train/removed_class_idx': 2.3563215682389003, 'train/uncertainty_avg': 0.7711571116703033, 'train/certain_ratio_ema': 0.7536046900989054, 'train/total_loss': tensor(0.2048, device='cuda:0'), 'train/mask_ratio': tensor(0.8058, device='cuda:0'), 'lr': 0.017919353389251384, 'train/prefecth_time': 0.020152608871459962, 'train/run_time': 0.545081298828125, 'eval/loss': tensor(2.4725, device='cuda:0'), 'eval/top-1-acc': 0.662875, 'eval/top-5-acc': 0.972875, 'eval/precision': 0.7032747535929698, 'eval/recall': 0.662875, 'eval/F1': 0.6691846082042232, 'eval/AUC': 0.9251014756944445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 12:47:31,260 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 12:47:41,317 INFO] confusion matrix:
[[0.96    0.00125 0.00125 0.00125 0.00125 0.      0.0025  0.      0.02125
  0.01125]
 [0.06    0.7725  0.      0.045   0.0075  0.0125  0.0675  0.025   0.01
  0.     ]
 [0.00875 0.      0.8875  0.      0.      0.      0.0725  0.0025  0.00375
  0.025  ]
 [0.00625 0.12    0.      0.37625 0.03    0.12375 0.30625 0.03625 0.00125
  0.     ]
 [0.      0.015   0.      0.02125 0.575   0.01625 0.34625 0.025   0.00125
  0.     ]
 [0.00625 0.0275  0.      0.0525  0.12625 0.50125 0.2675  0.015   0.00375
  0.     ]
 [0.0025  0.01125 0.00125 0.00125 0.55375 0.015   0.40625 0.0025  0.0025
  0.00375]
 [0.0025  0.20875 0.      0.1325  0.0175  0.01125 0.23125 0.39625 0.
  0.     ]
 [0.00625 0.      0.      0.00125 0.      0.      0.0025  0.      0.98125
  0.00875]
 [0.00625 0.00125 0.07    0.00125 0.      0.      0.045   0.00125 0.01375
  0.86125]]
[2023-08-03 12:47:41,323 INFO] 715000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.6241e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1223, device='cuda:0'), 'train/shrink_loss': tensor(0.0813, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0618, device='cuda:0'), 'train/removed_class_idx': 2.445377945766559, 'train/uncertainty_avg': 0.7551042852354265, 'train/certain_ratio_ema': 0.7602015436293081, 'train/total_loss': tensor(0.1842, device='cuda:0'), 'train/mask_ratio': tensor(0.7344, device='cuda:0'), 'lr': 0.017761281693704195, 'train/prefecth_time': 0.019661951065063476, 'train/run_time': 0.5718214111328125, 'eval/loss': tensor(2.5618, device='cuda:0'), 'eval/top-1-acc': 0.67175, 'eval/top-5-acc': 0.97425, 'eval/precision': 0.7179251330117913, 'eval/recall': 0.6717500000000001, 'eval/F1': 0.6796736763769277, 'eval/AUC': 0.923842013888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 13:37:18,645 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 13:37:28,618 INFO] confusion matrix:
[[0.95625 0.00125 0.      0.00125 0.00125 0.      0.00375 0.00625 0.02
  0.01   ]
 [0.065   0.75625 0.      0.0825  0.0075  0.01    0.0575  0.00375 0.0175
  0.     ]
 [0.00125 0.      0.89875 0.0025  0.      0.      0.06    0.0125  0.0025
  0.0225 ]
 [0.00125 0.1675  0.      0.37125 0.04125 0.1275  0.285   0.00375 0.0025
  0.     ]
 [0.00125 0.0125  0.      0.03875 0.60625 0.01375 0.32375 0.0025  0.00125
  0.     ]
 [0.      0.05375 0.      0.07875 0.1325  0.4875  0.23625 0.0075  0.00375
  0.     ]
 [0.0025  0.0125  0.0025  0.0075  0.55    0.01    0.4075  0.0025  0.0025
  0.0025 ]
 [0.00125 0.29125 0.      0.34875 0.02    0.01375 0.19375 0.13    0.00125
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00125 0.00125 0.98125
  0.0075 ]
 [0.0125  0.00125 0.0575  0.0025  0.      0.      0.0275  0.005   0.01
  0.88375]]
[2023-08-03 13:37:28,625 INFO] 720000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.0650e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1423, device='cuda:0'), 'train/shrink_loss': tensor(0.0521, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0390, device='cuda:0'), 'train/removed_class_idx': 2.6630431887996533, 'train/uncertainty_avg': 0.7404915248350847, 'train/certain_ratio_ema': 0.7492679993427427, 'train/total_loss': tensor(0.1814, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.017602447096092908, 'train/prefecth_time': 0.02988572883605957, 'train/run_time': 0.5618880004882812, 'eval/loss': tensor(2.6834, device='cuda:0'), 'eval/top-1-acc': 0.647875, 'eval/top-5-acc': 0.973125, 'eval/precision': 0.6905228032293438, 'eval/recall': 0.647875, 'eval/F1': 0.640769550142899, 'eval/AUC': 0.9199698263888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 14:27:20,130 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 14:27:30,501 INFO] confusion matrix:
[[0.95875 0.      0.      0.00125 0.00125 0.      0.01125 0.00125 0.015
  0.01125]
 [0.06375 0.7525  0.      0.06    0.00375 0.0275  0.0825  0.005   0.00375
  0.00125]
 [0.00375 0.      0.865   0.0025  0.      0.      0.10125 0.0025  0.00375
  0.02125]
 [0.00625 0.18125 0.      0.35125 0.0475  0.07625 0.315   0.02125 0.00125
  0.     ]
 [0.0025  0.01625 0.      0.02    0.595   0.0375  0.32625 0.00125 0.00125
  0.     ]
 [0.0075  0.085   0.      0.0925  0.1175  0.38625 0.30375 0.00375 0.00375
  0.     ]
 [0.0025  0.0125  0.00375 0.00375 0.48875 0.08    0.4025  0.00125 0.0025
  0.0025 ]
 [0.00125 0.28375 0.      0.1475  0.02375 0.12    0.25    0.17375 0.
  0.     ]
 [0.0075  0.      0.      0.00125 0.      0.      0.00875 0.      0.975
  0.0075 ]
 [0.01    0.00125 0.05875 0.00125 0.      0.00125 0.0525  0.      0.01625
  0.85875]]
[2023-08-03 14:27:30,507 INFO] 725000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.1230e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1071, device='cuda:0'), 'train/shrink_loss': tensor(0.0649, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0487, device='cuda:0'), 'train/removed_class_idx': 2.4952378575963943, 'train/uncertainty_avg': 0.7348699744027439, 'train/certain_ratio_ema': 0.7503160467980468, 'train/total_loss': tensor(0.1559, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.017442856418855478, 'train/prefecth_time': 0.028109567642211914, 'train/run_time': 0.5530382690429687, 'eval/loss': tensor(2.7900, device='cuda:0'), 'eval/top-1-acc': 0.631875, 'eval/top-5-acc': 0.969625, 'eval/precision': 0.6859579189494802, 'eval/recall': 0.631875, 'eval/F1': 0.6295289100997276, 'eval/AUC': 0.909903984375}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 15:17:13,150 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 15:17:23,426 INFO] confusion matrix:
[[0.96625 0.00125 0.      0.0025  0.00125 0.      0.0025  0.00375 0.0125
  0.01   ]
 [0.06875 0.77125 0.      0.0425  0.00375 0.0325  0.065   0.0125  0.00375
  0.     ]
 [0.0025  0.00125 0.94    0.00375 0.      0.      0.01    0.01875 0.005
  0.01875]
 [0.0025  0.20375 0.      0.23125 0.03875 0.15875 0.31875 0.045   0.00125
  0.     ]
 [0.      0.0125  0.      0.0125  0.56625 0.0325  0.36375 0.01125 0.00125
  0.     ]
 [0.0025  0.07875 0.      0.01375 0.1325  0.47375 0.27875 0.02    0.
  0.     ]
 [0.0025  0.0125  0.00125 0.00375 0.55625 0.00875 0.40875 0.0025  0.0025
  0.00125]
 [0.00125 0.27125 0.      0.045   0.02125 0.1175  0.22625 0.3175  0.
  0.     ]
 [0.01    0.      0.      0.      0.      0.      0.      0.00125 0.97875
  0.01   ]
 [0.01    0.00125 0.07    0.      0.00125 0.      0.01375 0.005   0.01375
  0.885  ]]
[2023-08-03 15:17:23,433 INFO] 730000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.6291e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1647, device='cuda:0'), 'train/shrink_loss': tensor(0.0541, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0410, device='cuda:0'), 'train/removed_class_idx': 2.350427149536141, 'train/uncertainty_avg': 0.7424628227365365, 'train/certain_ratio_ema': 0.7574163836027782, 'train/total_loss': tensor(0.2057, device='cuda:0'), 'train/mask_ratio': tensor(0.7388, device='cuda:0'), 'lr': 0.017282516516905818, 'train/prefecth_time': 0.01933635139465332, 'train/run_time': 0.5637913818359375, 'eval/loss': tensor(2.6591, device='cuda:0'), 'eval/top-1-acc': 0.653875, 'eval/top-5-acc': 0.976625, 'eval/precision': 0.6945992917005144, 'eval/recall': 0.653875, 'eval/F1': 0.6509159674296217, 'eval/AUC': 0.9181320572916667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 16:07:07,059 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 16:07:17,230 INFO] confusion matrix:
[[0.96375 0.00125 0.      0.00125 0.00125 0.      0.0025  0.00625 0.0125
  0.01125]
 [0.0725  0.7775  0.      0.04125 0.005   0.0425  0.0475  0.01    0.00375
  0.     ]
 [0.      0.00125 0.81125 0.00125 0.      0.      0.01125 0.16125 0.00375
  0.01   ]
 [0.005   0.2125  0.      0.3325  0.045   0.10625 0.2875  0.01    0.00125
  0.     ]
 [0.00125 0.0125  0.      0.01125 0.57625 0.0375  0.35    0.01    0.00125
  0.     ]
 [0.01    0.09125 0.      0.0425  0.12875 0.44875 0.2575  0.02125 0.
  0.     ]
 [0.0025  0.01125 0.00125 0.00125 0.53    0.0325  0.405   0.00875 0.00375
  0.00375]
 [0.0025  0.27875 0.      0.08875 0.0175  0.195   0.1825  0.235   0.
  0.     ]
 [0.01    0.      0.      0.00125 0.      0.      0.      0.      0.98125
  0.0075 ]
 [0.01125 0.00125 0.10375 0.      0.      0.      0.01    0.01875 0.025
  0.83   ]]
[2023-08-03 16:07:17,238 INFO] 735000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1512, device='cuda:0'), 'train/shrink_loss': tensor(0.0671, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0498, device='cuda:0'), 'train/removed_class_idx': 2.4722219933127785, 'train/uncertainty_avg': 0.7483774933787912, 'train/certain_ratio_ema': 0.7424179999828553, 'train/total_loss': tensor(0.2011, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.017121434277339375, 'train/prefecth_time': 0.024319839477539063, 'train/run_time': 0.5556751098632813, 'eval/loss': tensor(2.7713, device='cuda:0'), 'eval/top-1-acc': 0.636125, 'eval/top-5-acc': 0.971375, 'eval/precision': 0.6600985159268667, 'eval/recall': 0.636125, 'eval/F1': 0.6335860653034713, 'eval/AUC': 0.9179443663194443}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 16:56:56,009 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 16:57:06,618 INFO] confusion matrix:
[[0.96375 0.00125 0.      0.00125 0.00125 0.      0.0025  0.0025  0.01625
  0.01125]
 [0.07375 0.75875 0.      0.05625 0.005   0.0325  0.065   0.005   0.00375
  0.     ]
 [0.      0.      0.79375 0.0025  0.      0.      0.01875 0.16625 0.005
  0.01375]
 [0.0025  0.16375 0.      0.32875 0.06125 0.12875 0.3025  0.01125 0.00125
  0.     ]
 [0.00125 0.015   0.      0.01625 0.57375 0.03625 0.35    0.0075  0.
  0.     ]
 [0.00625 0.075   0.      0.06625 0.13125 0.44125 0.265   0.015   0.
  0.     ]
 [0.0025  0.01125 0.0025  0.00375 0.54    0.02875 0.40125 0.00875 0.00125
  0.     ]
 [0.      0.26125 0.      0.1725  0.03375 0.15125 0.22375 0.1575  0.
  0.     ]
 [0.0075  0.      0.      0.      0.      0.00125 0.00125 0.      0.98125
  0.00875]
 [0.00875 0.00125 0.1325  0.00125 0.      0.00125 0.0225  0.0125  0.0125
  0.8075 ]]
[2023-08-03 16:57:06,624 INFO] 740000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1338, device='cuda:0'), 'train/shrink_loss': tensor(0.0748, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0566, device='cuda:0'), 'train/removed_class_idx': 2.3749997879464475, 'train/uncertainty_avg': 0.7466931570457966, 'train/certain_ratio_ema': 0.7570786858939769, 'train/total_loss': tensor(0.1908, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.01695961661913729, 'train/prefecth_time': 0.01914896011352539, 'train/run_time': 0.5560661010742187, 'eval/loss': tensor(3.0657, device='cuda:0'), 'eval/top-1-acc': 0.62075, 'eval/top-5-acc': 0.964, 'eval/precision': 0.6389345073431528, 'eval/recall': 0.62075, 'eval/F1': 0.6169563724712617, 'eval/AUC': 0.9060333940972224}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 17:46:56,070 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 17:47:05,967 INFO] confusion matrix:
[[0.96    0.      0.      0.00125 0.00125 0.      0.      0.00625 0.0175
  0.01375]
 [0.07    0.7775  0.      0.04625 0.00625 0.02625 0.0375  0.02125 0.01375
  0.00125]
 [0.00125 0.00125 0.78125 0.      0.      0.      0.0025  0.20125 0.00375
  0.00875]
 [0.005   0.12125 0.      0.35125 0.0325  0.19    0.25625 0.0425  0.00125
  0.     ]
 [0.      0.01125 0.      0.0125  0.6125  0.0425  0.30125 0.01625 0.00375
  0.     ]
 [0.005   0.04625 0.      0.0575  0.14    0.4925  0.215   0.03875 0.005
  0.     ]
 [0.0025  0.00875 0.0025  0.0025  0.5475  0.01875 0.39625 0.01875 0.0025
  0.     ]
 [0.005   0.26875 0.      0.13375 0.0225  0.20625 0.19    0.1725  0.
  0.00125]
 [0.0075  0.      0.      0.00125 0.      0.      0.      0.      0.97875
  0.0125 ]
 [0.0075  0.00125 0.16125 0.00125 0.      0.      0.005   0.02375 0.0075
  0.7925 ]]
[2023-08-03 17:47:05,974 INFO] 745000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.0539e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1696, device='cuda:0'), 'train/shrink_loss': tensor(0.0497, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0370, device='cuda:0'), 'train/removed_class_idx': 2.4999997881356113, 'train/uncertainty_avg': 0.7399163490446118, 'train/certain_ratio_ema': 0.7452177058498508, 'train/total_loss': tensor(0.2067, device='cuda:0'), 'train/mask_ratio': tensor(0.7366, device='cuda:0'), 'lr': 0.0167970704928692, 'train/prefecth_time': 0.02403420829772949, 'train/run_time': 0.562603515625, 'eval/loss': tensor(2.6807, device='cuda:0'), 'eval/top-1-acc': 0.6315, 'eval/top-5-acc': 0.961625, 'eval/precision': 0.6392918609436966, 'eval/recall': 0.6315, 'eval/F1': 0.6265164293364934, 'eval/AUC': 0.9216203819444445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 18:36:51,781 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 18:37:02,156 INFO] confusion matrix:
[[0.9625  0.00125 0.      0.00125 0.00125 0.      0.00375 0.      0.01625
  0.01375]
 [0.0775  0.7975  0.      0.05125 0.005   0.015   0.035   0.0125  0.005
  0.00125]
 [0.0025  0.      0.805   0.0025  0.      0.      0.035   0.00125 0.00625
  0.1475 ]
 [0.00625 0.155   0.00125 0.30375 0.0325  0.20625 0.24    0.04125 0.00125
  0.0125 ]
 [0.00375 0.01125 0.00125 0.02    0.59875 0.0325  0.30375 0.0225  0.00125
  0.005  ]
 [0.01125 0.0525  0.      0.03125 0.13375 0.50125 0.20125 0.06125 0.0025
  0.005  ]
 [0.0025  0.01625 0.0025  0.00125 0.50875 0.0175  0.425   0.01875 0.005
  0.0025 ]
 [0.00375 0.27625 0.      0.175   0.02    0.0425  0.145   0.32375 0.
  0.01375]
 [0.00875 0.      0.      0.      0.      0.      0.00125 0.      0.98
  0.01   ]
 [0.00625 0.00125 0.17    0.00125 0.      0.      0.01625 0.00125 0.01125
  0.7925 ]]
[2023-08-03 18:37:02,162 INFO] 750000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.8316e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1126, device='cuda:0'), 'train/shrink_loss': tensor(0.0742, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0548, device='cuda:0'), 'train/removed_class_idx': 2.3801650925483395, 'train/uncertainty_avg': 0.7661744602245023, 'train/certain_ratio_ema': 0.7386860753281691, 'train/total_loss': tensor(0.1674, device='cuda:0'), 'train/mask_ratio': tensor(0.7299, device='cuda:0'), 'lr': 0.016633802880394725, 'train/prefecth_time': 0.01841097640991211, 'train/run_time': 0.560160888671875, 'eval/loss': tensor(2.3728, device='cuda:0'), 'eval/top-1-acc': 0.649, 'eval/top-5-acc': 0.9665, 'eval/precision': 0.6624710803979307, 'eval/recall': 0.649, 'eval/F1': 0.6429304359980831, 'eval/AUC': 0.9276808072916667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 19:26:58,783 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 19:27:08,904 INFO] confusion matrix:
[[0.96875 0.0025  0.      0.00125 0.00125 0.      0.00125 0.      0.01125
  0.01375]
 [0.07625 0.735   0.      0.0775  0.005   0.01125 0.055   0.03375 0.00625
  0.     ]
 [0.0025  0.00875 0.93875 0.0025  0.      0.      0.00875 0.00125 0.005
  0.0325 ]
 [0.00375 0.14    0.      0.3325  0.02375 0.17875 0.27875 0.04    0.0025
  0.     ]
 [0.00125 0.015   0.      0.03875 0.58625 0.01875 0.325   0.01375 0.
  0.00125]
 [0.01125 0.03875 0.      0.0575  0.12625 0.48875 0.24375 0.03375 0.
  0.     ]
 [0.0025  0.015   0.0025  0.00375 0.505   0.01    0.44625 0.00625 0.00375
  0.005  ]
 [0.00125 0.19625 0.      0.1375  0.00625 0.0175  0.195   0.44375 0.
  0.0025 ]
 [0.005   0.      0.      0.00125 0.      0.      0.      0.      0.9825
  0.01125]
 [0.005   0.00125 0.20375 0.0025  0.00125 0.      0.00375 0.00125 0.015
  0.76625]]
[2023-08-03 19:27:08,911 INFO] 755000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1892, device='cuda:0'), 'train/shrink_loss': tensor(0.0468, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0353, device='cuda:0'), 'train/removed_class_idx': 2.377550777800941, 'train/uncertainty_avg': 0.7804187205175146, 'train/certain_ratio_ema': 0.7551761451807544, 'train/total_loss': tensor(0.2246, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.01646982079456353, 'train/prefecth_time': 0.018762975692749023, 'train/run_time': 0.549511474609375, 'eval/loss': tensor(2.5147, device='cuda:0'), 'eval/top-1-acc': 0.668875, 'eval/top-5-acc': 0.96825, 'eval/precision': 0.6943314764793939, 'eval/recall': 0.668875, 'eval/F1': 0.6698238735701258, 'eval/AUC': 0.9294291840277777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 20:16:58,015 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 20:17:08,265 INFO] confusion matrix:
[[0.96625 0.00125 0.      0.00125 0.00125 0.      0.      0.0075  0.00875
  0.01375]
 [0.07125 0.78    0.      0.06375 0.00625 0.0075  0.05875 0.01    0.0025
  0.     ]
 [0.      0.      0.9     0.0025  0.      0.      0.045   0.0225  0.0025
  0.0275 ]
 [0.00375 0.14125 0.      0.33625 0.04875 0.12125 0.30375 0.04375 0.00125
  0.     ]
 [0.00125 0.01375 0.      0.02625 0.61    0.01875 0.32125 0.00875 0.
  0.     ]
 [0.0075  0.045   0.      0.04125 0.14875 0.48625 0.24625 0.025   0.
  0.     ]
 [0.00125 0.01    0.0025  0.00375 0.5175  0.0275  0.41375 0.02    0.0025
  0.00125]
 [0.0025  0.28125 0.      0.22875 0.02625 0.03    0.25125 0.18    0.
  0.     ]
 [0.00375 0.      0.      0.00125 0.      0.      0.00125 0.      0.985
  0.00875]
 [0.0075  0.00125 0.18125 0.00125 0.      0.      0.01    0.005   0.0175
  0.77625]]
[2023-08-03 20:17:08,272 INFO] 760000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.9899e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1953, device='cuda:0'), 'train/shrink_loss': tensor(0.0639, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0480, device='cuda:0'), 'train/removed_class_idx': 2.4563104411349084, 'train/uncertainty_avg': 0.7630178193368103, 'train/certain_ratio_ema': 0.751074055036392, 'train/total_loss': tensor(0.2433, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.01630513127891414, 'train/prefecth_time': 0.02069878387451172, 'train/run_time': 0.555944091796875, 'eval/loss': tensor(2.7034, device='cuda:0'), 'eval/top-1-acc': 0.643375, 'eval/top-5-acc': 0.971, 'eval/precision': 0.6691035954146589, 'eval/recall': 0.643375, 'eval/F1': 0.6381231996419253, 'eval/AUC': 0.9161050868055557}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 21:06:34,927 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 21:06:45,432 INFO] confusion matrix:
[[0.965   0.00125 0.00125 0.0025  0.00125 0.      0.005   0.005   0.00875
  0.01   ]
 [0.065   0.7675  0.      0.0825  0.00375 0.0125  0.06    0.00875 0.
  0.     ]
 [0.      0.00125 0.95    0.00125 0.      0.      0.00625 0.02125 0.00375
  0.01625]
 [0.0025  0.09375 0.      0.35375 0.03125 0.2125  0.28    0.025   0.00125
  0.     ]
 [0.      0.02    0.00125 0.03375 0.60625 0.0225  0.30875 0.0075  0.
  0.     ]
 [0.0025  0.045   0.      0.04875 0.1375  0.53125 0.2225  0.0125  0.
  0.     ]
 [0.00125 0.01125 0.0025  0.0025  0.52625 0.0125  0.43375 0.0075  0.00125
  0.00125]
 [0.      0.28375 0.      0.265   0.02125 0.03    0.21875 0.18125 0.
  0.     ]
 [0.00375 0.      0.      0.      0.      0.      0.00125 0.0025  0.98375
  0.00875]
 [0.00375 0.00125 0.1525  0.00125 0.      0.      0.0125  0.0025  0.01125
  0.815  ]]
[2023-08-03 21:06:45,439 INFO] 765000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1370, device='cuda:0'), 'train/shrink_loss': tensor(0.0689, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0529, device='cuda:0'), 'train/removed_class_idx': 2.4444442355175866, 'train/uncertainty_avg': 0.7571645659100629, 'train/certain_ratio_ema': 0.7679636523338742, 'train/total_loss': tensor(0.1902, device='cuda:0'), 'train/mask_ratio': tensor(0.7388, device='cuda:0'), 'lr': 0.016139741407371372, 'train/prefecth_time': 0.02039695930480957, 'train/run_time': 0.558695556640625, 'eval/loss': tensor(2.6125, device='cuda:0'), 'eval/top-1-acc': 0.65875, 'eval/top-5-acc': 0.975875, 'eval/precision': 0.6833102476678479, 'eval/recall': 0.6587500000000001, 'eval/F1': 0.6519381124367298, 'eval/AUC': 0.9269667621527776}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 21:56:25,324 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 21:56:35,285 INFO] confusion matrix:
[[0.9725  0.      0.00125 0.      0.00125 0.      0.00125 0.00625 0.00875
  0.00875]
 [0.07375 0.8     0.      0.0525  0.005   0.0125  0.045   0.00625 0.0025
  0.0025 ]
 [0.00125 0.00125 0.95375 0.00125 0.      0.      0.00875 0.02    0.0025
  0.01125]
 [0.0075  0.1475  0.      0.27375 0.05    0.19125 0.29    0.03875 0.00125
  0.     ]
 [0.0025  0.01375 0.      0.0175  0.6025  0.02125 0.34125 0.00125 0.
  0.     ]
 [0.015   0.04625 0.      0.015   0.13    0.5375  0.24125 0.015   0.
  0.     ]
 [0.00375 0.0075  0.00375 0.      0.51125 0.0175  0.4425  0.0075  0.00375
  0.0025 ]
 [0.00125 0.3625  0.      0.145   0.03125 0.1225  0.20125 0.13625 0.
  0.     ]
 [0.0075  0.      0.      0.      0.      0.00125 0.      0.      0.98375
  0.0075 ]
 [0.00375 0.0025  0.215   0.00125 0.      0.00125 0.0125  0.00375 0.0125
  0.7475 ]]
[2023-08-03 21:56:35,292 INFO] 770000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.6970e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1041, device='cuda:0'), 'train/shrink_loss': tensor(0.0434, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0333, device='cuda:0'), 'train/removed_class_idx': 2.313131079481709, 'train/uncertainty_avg': 0.7695858766845471, 'train/certain_ratio_ema': 0.7675798319954399, 'train/total_loss': tensor(0.1375, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.01597365828394251, 'train/prefecth_time': 0.018649856567382814, 'train/run_time': 0.5498944091796875, 'eval/loss': tensor(2.7660, device='cuda:0'), 'eval/top-1-acc': 0.645, 'eval/top-5-acc': 0.975, 'eval/precision': 0.6658956357528688, 'eval/recall': 0.6449999999999999, 'eval/F1': 0.6304778390369356, 'eval/AUC': 0.9190699131944443}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 22:45:49,957 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 22:46:00,116 INFO] confusion matrix:
[[0.965   0.00125 0.      0.0025  0.0025  0.      0.00125 0.0075  0.01125
  0.00875]
 [0.07    0.77625 0.      0.07125 0.00375 0.0075  0.055   0.01125 0.00375
  0.00125]
 [0.      0.      0.9475  0.00125 0.      0.      0.01375 0.0225  0.00375
  0.01125]
 [0.00125 0.12    0.      0.36375 0.04875 0.17125 0.265   0.02875 0.00125
  0.     ]
 [0.00125 0.01625 0.00125 0.035   0.62625 0.02125 0.295   0.00375 0.
  0.     ]
 [0.005   0.0475  0.      0.03    0.125   0.5925  0.19125 0.00875 0.
  0.     ]
 [0.00125 0.0125  0.0025  0.005   0.54375 0.0175  0.40375 0.01    0.0025
  0.00125]
 [0.      0.32625 0.      0.2575  0.0325  0.03625 0.1925  0.15375 0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.0025  0.      0.98125
  0.00875]
 [0.00625 0.0025  0.13875 0.00125 0.      0.      0.025   0.0075  0.01125
  0.8075 ]]
[2023-08-03 22:46:00,123 INFO] 775000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1315, device='cuda:0'), 'train/shrink_loss': tensor(0.0531, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0408, device='cuda:0'), 'train/removed_class_idx': 2.436363414876053, 'train/uncertainty_avg': 0.7588683191662609, 'train/certain_ratio_ema': 0.76941498776667, 'train/total_loss': tensor(0.1725, device='cuda:0'), 'train/mask_ratio': tensor(0.7545, device='cuda:0'), 'lr': 0.015806889042412134, 'train/prefecth_time': 0.02118739128112793, 'train/run_time': 0.5737070922851563, 'eval/loss': tensor(2.7098, device='cuda:0'), 'eval/top-1-acc': 0.66175, 'eval/top-5-acc': 0.975375, 'eval/precision': 0.6818528366696708, 'eval/recall': 0.6617500000000001, 'eval/F1': 0.6525617626918934, 'eval/AUC': 0.9221251562500001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-03 23:35:28,567 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-03 23:35:38,568 INFO] confusion matrix:
[[0.965   0.00125 0.00125 0.0025  0.      0.      0.0025  0.00625 0.01375
  0.0075 ]
 [0.0725  0.7675  0.      0.0775  0.005   0.01125 0.05125 0.00625 0.00875
  0.     ]
 [0.      0.00125 0.94625 0.0025  0.      0.      0.015   0.02    0.00375
  0.01125]
 [0.00125 0.08    0.      0.3925  0.04625 0.19125 0.265   0.0225  0.00125
  0.     ]
 [0.      0.015   0.00125 0.04125 0.6525  0.0225  0.2625  0.00375 0.00125
  0.     ]
 [0.      0.0325  0.      0.03625 0.145   0.56125 0.19875 0.02125 0.005
  0.     ]
 [0.00375 0.015   0.0025  0.00625 0.5825  0.0175  0.36125 0.00625 0.00375
  0.00125]
 [0.00125 0.24    0.      0.24    0.0375  0.0425  0.175   0.26375 0.
  0.     ]
 [0.005   0.      0.      0.00125 0.      0.      0.005   0.      0.98
  0.00875]
 [0.005   0.00125 0.125   0.00125 0.      0.      0.0325  0.00625 0.0125
  0.81625]]
[2023-08-03 23:35:38,576 INFO] 780000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.8486e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1371, device='cuda:0'), 'train/shrink_loss': tensor(0.0893, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0680, device='cuda:0'), 'train/removed_class_idx': 2.585858324660775, 'train/uncertainty_avg': 0.7626670379504433, 'train/certain_ratio_ema': 0.7621584491154696, 'train/total_loss': tensor(0.2051, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.015639440846035742, 'train/prefecth_time': 0.01983647918701172, 'train/run_time': 0.5675485229492188, 'eval/loss': tensor(2.5371, device='cuda:0'), 'eval/top-1-acc': 0.670625, 'eval/top-5-acc': 0.972875, 'eval/precision': 0.6979254771498635, 'eval/recall': 0.670625, 'eval/F1': 0.6680653458747212, 'eval/AUC': 0.9261119791666668}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 00:25:03,970 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 00:25:14,139 INFO] confusion matrix:
[[0.96625 0.00125 0.00125 0.0025  0.0025  0.      0.00375 0.00625 0.00875
  0.0075 ]
 [0.075   0.75875 0.      0.07375 0.00625 0.01375 0.06    0.0125  0.
  0.     ]
 [0.00125 0.00125 0.90875 0.      0.      0.      0.05625 0.01875 0.00375
  0.01   ]
 [0.0025  0.1225  0.      0.365   0.045   0.1825  0.2675  0.01375 0.00125
  0.     ]
 [0.0025  0.01375 0.00125 0.03    0.66625 0.01375 0.27    0.0025  0.
  0.     ]
 [0.005   0.04125 0.      0.03    0.135   0.5725  0.205   0.01125 0.
  0.     ]
 [0.00375 0.01    0.00125 0.00375 0.53    0.01125 0.42625 0.00875 0.00375
  0.00125]
 [0.      0.28125 0.      0.19375 0.03    0.02875 0.175   0.29    0.
  0.00125]
 [0.0075  0.      0.      0.00125 0.      0.      0.01375 0.      0.96875
  0.00875]
 [0.005   0.00125 0.13875 0.0025  0.      0.      0.0525  0.00875 0.01
  0.78125]]
[2023-08-04 00:25:14,146 INFO] 785000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.3925e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1659, device='cuda:0'), 'train/shrink_loss': tensor(0.0805, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0624, device='cuda:0'), 'train/removed_class_idx': 2.5102038254894055, 'train/uncertainty_avg': 0.7450935165456675, 'train/certain_ratio_ema': 0.774875515794591, 'train/total_loss': tensor(0.2284, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.01547132088723204, 'train/prefecth_time': 0.030438175201416017, 'train/run_time': 0.5510016479492188, 'eval/loss': tensor(2.5166, device='cuda:0'), 'eval/top-1-acc': 0.670375, 'eval/top-5-acc': 0.974375, 'eval/precision': 0.7065274872207644, 'eval/recall': 0.670375, 'eval/F1': 0.6702467567683585, 'eval/AUC': 0.9304194965277778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 01:14:25,168 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 01:14:36,014 INFO] confusion matrix:
[[0.95875 0.00125 0.00125 0.0025  0.      0.      0.00875 0.01    0.00875
  0.00875]
 [0.07375 0.76375 0.      0.0725  0.00375 0.0125  0.065   0.005   0.00125
  0.0025 ]
 [0.0025  0.      0.86375 0.0025  0.      0.      0.105   0.02    0.00125
  0.005  ]
 [0.0025  0.11375 0.      0.39625 0.03625 0.1575  0.25375 0.02125 0.00125
  0.0175 ]
 [0.00125 0.0125  0.      0.0375  0.68125 0.01125 0.25    0.00125 0.
  0.005  ]
 [0.01    0.04375 0.      0.05375 0.12125 0.56375 0.1925  0.00875 0.
  0.00625]
 [0.0025  0.0125  0.00125 0.00125 0.60375 0.01875 0.33625 0.01625 0.0025
  0.005  ]
 [0.      0.33    0.      0.305   0.025   0.02875 0.16375 0.13    0.
  0.0175 ]
 [0.00625 0.      0.      0.      0.      0.      0.0275  0.      0.96
  0.00625]
 [0.01    0.0025  0.2025  0.      0.      0.      0.0775  0.0075  0.0125
  0.6875 ]]
[2023-08-04 01:14:36,022 INFO] 790000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1302, device='cuda:0'), 'train/shrink_loss': tensor(0.0647, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0499, device='cuda:0'), 'train/removed_class_idx': 2.297029475541636, 'train/uncertainty_avg': 0.7593872113959431, 'train/certain_ratio_ema': 0.7705036135453305, 'train/total_loss': tensor(0.1805, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.015302536387273996, 'train/prefecth_time': 0.019253055572509767, 'train/run_time': 0.5550415649414062, 'eval/loss': tensor(2.9398, device='cuda:0'), 'eval/top-1-acc': 0.634125, 'eval/top-5-acc': 0.977, 'eval/precision': 0.6625574500841395, 'eval/recall': 0.6341249999999999, 'eval/F1': 0.6267331312258625, 'eval/AUC': 0.9108479600694447}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 02:04:04,345 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 02:04:14,493 INFO] confusion matrix:
[[0.95875 0.00125 0.      0.0025  0.0025  0.      0.0125  0.00375 0.01
  0.00875]
 [0.07125 0.7425  0.      0.08875 0.00875 0.0075  0.0775  0.00375 0.
  0.     ]
 [0.      0.00125 0.855   0.00125 0.      0.      0.11    0.01875 0.0025
  0.01125]
 [0.0025  0.10625 0.      0.42625 0.0375  0.13    0.27375 0.0225  0.
  0.00125]
 [0.00125 0.0125  0.      0.04    0.66875 0.015   0.2625  0.      0.
  0.     ]
 [0.0075  0.045   0.      0.05125 0.095   0.59875 0.195   0.0075  0.
  0.     ]
 [0.00375 0.00875 0.0025  0.00375 0.63125 0.0125  0.32875 0.0025  0.0025
  0.00375]
 [0.      0.32    0.      0.32375 0.01875 0.025   0.205   0.105   0.
  0.0025 ]
 [0.0075  0.      0.      0.00125 0.      0.      0.03625 0.      0.9475
  0.0075 ]
 [0.00875 0.00125 0.19625 0.0025  0.      0.      0.085   0.00625 0.015
  0.685  ]]
[2023-08-04 02:04:14,499 INFO] 795000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1461, device='cuda:0'), 'train/shrink_loss': tensor(0.0372, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0286, device='cuda:0'), 'train/removed_class_idx': 2.4953268695956194, 'train/uncertainty_avg': 0.740999359773106, 'train/certain_ratio_ema': 0.7690362268576941, 'train/total_loss': tensor(0.1751, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.015133094595978702, 'train/prefecth_time': 0.019799711227416993, 'train/run_time': 0.554715576171875, 'eval/loss': tensor(2.9625, device='cuda:0'), 'eval/top-1-acc': 0.631625, 'eval/top-5-acc': 0.975, 'eval/precision': 0.6729026170970156, 'eval/recall': 0.631625, 'eval/F1': 0.6266468313200287, 'eval/AUC': 0.9128370833333335}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 02:53:30,953 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 02:53:41,037 INFO] confusion matrix:
[[0.965   0.00125 0.      0.00125 0.00125 0.      0.00625 0.005   0.01
  0.01   ]
 [0.07375 0.77    0.      0.07375 0.0025  0.0125  0.06375 0.00375 0.
  0.     ]
 [0.0025  0.00125 0.8675  0.0025  0.      0.      0.09625 0.0125  0.00125
  0.01625]
 [0.0025  0.10875 0.      0.415   0.035   0.15    0.2675  0.02    0.00125
  0.     ]
 [0.00125 0.01125 0.      0.0325  0.69375 0.01    0.24625 0.005   0.
  0.     ]
 [0.0075  0.05    0.      0.09125 0.09    0.52375 0.19625 0.04    0.
  0.00125]
 [0.00375 0.0075  0.0025  0.0075  0.5925  0.0175  0.355   0.0075  0.0025
  0.00375]
 [0.      0.27    0.      0.27125 0.01    0.015   0.1775  0.25625 0.
  0.     ]
 [0.005   0.      0.      0.00125 0.      0.      0.0125  0.      0.975
  0.00625]
 [0.00875 0.00125 0.1575  0.0025  0.      0.      0.0825  0.0075  0.0125
  0.7275 ]]
[2023-08-04 02:53:41,044 INFO] 800000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.9492e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1424, device='cuda:0'), 'train/shrink_loss': tensor(0.0445, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0338, device='cuda:0'), 'train/removed_class_idx': 2.377358266286956, 'train/uncertainty_avg': 0.7573297495780981, 'train/certain_ratio_ema': 0.7601611931425566, 'train/total_loss': tensor(0.1762, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.01496300279139593, 'train/prefecth_time': 0.02015564727783203, 'train/run_time': 0.553246826171875, 'eval/loss': tensor(2.6585, device='cuda:0'), 'eval/top-1-acc': 0.654875, 'eval/top-5-acc': 0.9725, 'eval/precision': 0.6920352532746035, 'eval/recall': 0.6548749999999999, 'eval/F1': 0.6555880154869529, 'eval/AUC': 0.9203032552083334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 03:43:08,012 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 03:43:17,960 INFO] confusion matrix:
[[0.96375 0.00125 0.      0.00125 0.00125 0.      0.00375 0.00625 0.0125
  0.01   ]
 [0.07    0.78125 0.      0.065   0.00375 0.0075  0.065   0.0075  0.
  0.     ]
 [0.      0.      0.82625 0.      0.      0.      0.115   0.03375 0.0025
  0.0225 ]
 [0.0025  0.1025  0.      0.36    0.02875 0.19875 0.2725  0.03375 0.00125
  0.     ]
 [0.0025  0.01125 0.      0.0325  0.66    0.0225  0.26625 0.005   0.
  0.     ]
 [0.005   0.04875 0.      0.05625 0.06375 0.59375 0.2175  0.015   0.
  0.     ]
 [0.00125 0.00875 0.00125 0.00375 0.59375 0.03375 0.33625 0.01375 0.00375
  0.00375]
 [0.      0.315   0.      0.2175  0.015   0.02875 0.2175  0.205   0.
  0.00125]
 [0.0075  0.      0.      0.00125 0.      0.      0.01    0.00125 0.97125
  0.00875]
 [0.0125  0.00125 0.08125 0.0025  0.      0.      0.07875 0.00875 0.00875
  0.80625]]
[2023-08-04 03:43:17,966 INFO] 805000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.5007e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2174, device='cuda:0'), 'train/shrink_loss': tensor(0.0718, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0553, device='cuda:0'), 'train/removed_class_idx': 2.50925902692046, 'train/uncertainty_avg': 0.7483390966772665, 'train/certain_ratio_ema': 0.7704626221996116, 'train/total_loss': tensor(0.2728, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.014792268279495547, 'train/prefecth_time': 0.0256429443359375, 'train/run_time': 0.5592053833007813, 'eval/loss': tensor(2.7156, device='cuda:0'), 'eval/top-1-acc': 0.650375, 'eval/top-5-acc': 0.971625, 'eval/precision': 0.6820457737574976, 'eval/recall': 0.650375, 'eval/F1': 0.6499473743859226, 'eval/AUC': 0.9184075868055557}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 04:32:31,967 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 04:32:41,636 INFO] confusion matrix:
[[0.96    0.00125 0.005   0.00125 0.00125 0.      0.00625 0.      0.01625
  0.00875]
 [0.06625 0.75    0.0025  0.07    0.00375 0.0075  0.075   0.025   0.
  0.     ]
 [0.      0.      0.8225  0.00125 0.      0.      0.12875 0.00375 0.00375
  0.04   ]
 [0.00375 0.13375 0.0025  0.41375 0.025   0.12375 0.2675  0.02875 0.00125
  0.     ]
 [0.      0.0125  0.0025  0.03375 0.67875 0.0075  0.25625 0.00875 0.
  0.     ]
 [0.00125 0.0625  0.0075  0.05375 0.0575  0.5625  0.2075  0.0475  0.
  0.     ]
 [0.00125 0.0175  0.005   0.00625 0.61875 0.02125 0.3175  0.00625 0.00375
  0.0025 ]
 [0.      0.22625 0.0025  0.17875 0.00375 0.01875 0.1925  0.375   0.
  0.0025 ]
 [0.00375 0.      0.00125 0.0025  0.      0.      0.01125 0.00125 0.975
  0.005  ]
 [0.00625 0.0025  0.02625 0.00375 0.      0.      0.095   0.00125 0.015
  0.85   ]]
[2023-08-04 04:32:41,643 INFO] 810000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.3887e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1056, device='cuda:0'), 'train/shrink_loss': tensor(0.0539, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0414, device='cuda:0'), 'train/removed_class_idx': 2.323076744378712, 'train/uncertainty_avg': 0.7627598570081505, 'train/certain_ratio_ema': 0.7679550570566521, 'train/total_loss': tensor(0.1471, device='cuda:0'), 'train/mask_ratio': tensor(0.7098, device='cuda:0'), 'lr': 0.014620898393853691, 'train/prefecth_time': 0.03060201644897461, 'train/run_time': 0.5700945434570313, 'eval/loss': tensor(2.4980, device='cuda:0'), 'eval/top-1-acc': 0.6705, 'eval/top-5-acc': 0.972, 'eval/precision': 0.7121961802367461, 'eval/recall': 0.6704999999999999, 'eval/F1': 0.6786792477785564, 'eval/AUC': 0.9251281944444445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 05:22:00,641 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 05:22:10,527 INFO] confusion matrix:
[[0.9575  0.00125 0.00375 0.00125 0.0025  0.      0.0075  0.00125 0.01625
  0.00875]
 [0.065   0.7425  0.0025  0.085   0.00375 0.00875 0.06375 0.02875 0.
  0.     ]
 [0.      0.005   0.83875 0.00375 0.      0.      0.11875 0.00125 0.00625
  0.02625]
 [0.00375 0.095   0.00125 0.45    0.02375 0.14    0.25    0.035   0.00125
  0.     ]
 [0.00125 0.0125  0.00125 0.03625 0.71375 0.00875 0.215   0.01125 0.
  0.     ]
 [0.0025  0.04    0.00625 0.07    0.06625 0.59875 0.165   0.05    0.00125
  0.     ]
 [0.00125 0.01875 0.00125 0.00125 0.66875 0.01125 0.28125 0.01    0.00125
  0.005  ]
 [0.      0.19625 0.00125 0.14125 0.0075  0.015   0.15    0.4875  0.
  0.00125]
 [0.0075  0.      0.      0.00125 0.      0.      0.015   0.00125 0.97
  0.005  ]
 [0.01125 0.00375 0.025   0.      0.      0.      0.085   0.00125 0.01375
  0.86   ]]
[2023-08-04 05:22:10,534 INFO] 815000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1219, device='cuda:0'), 'train/shrink_loss': tensor(0.0739, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0567, device='cuda:0'), 'train/removed_class_idx': 2.3965515175386622, 'train/uncertainty_avg': 0.7555165631223106, 'train/certain_ratio_ema': 0.7677651411925307, 'train/total_loss': tensor(0.1788, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.014448900495337764, 'train/prefecth_time': 0.023087520599365235, 'train/run_time': 0.56094287109375, 'eval/loss': tensor(2.4029, device='cuda:0'), 'eval/top-1-acc': 0.69, 'eval/top-5-acc': 0.974875, 'eval/precision': 0.7239023155755868, 'eval/recall': 0.6900000000000001, 'eval/F1': 0.6982510776319282, 'eval/AUC': 0.9232009635416664}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 06:11:29,014 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 06:11:38,941 INFO] confusion matrix:
[[0.96    0.00125 0.005   0.0025  0.0025  0.      0.005   0.00125 0.01125
  0.01125]
 [0.06625 0.76375 0.0025  0.05875 0.00625 0.0075  0.06875 0.02625 0.
  0.     ]
 [0.00125 0.00375 0.80125 0.0025  0.      0.      0.1475  0.00125 0.00375
  0.03875]
 [0.0025  0.12375 0.00125 0.3225  0.0375  0.16375 0.275   0.0725  0.00125
  0.     ]
 [0.      0.0125  0.00125 0.01625 0.695   0.00875 0.24875 0.0175  0.
  0.     ]
 [0.00125 0.04875 0.      0.00875 0.05625 0.63875 0.21375 0.0325  0.
  0.     ]
 [0.00125 0.01    0.00125 0.      0.62625 0.01    0.34125 0.005   0.00125
  0.00375]
 [0.      0.24625 0.00125 0.11125 0.01625 0.0325  0.195   0.39625 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.005   0.0025  0.9775
  0.00875]
 [0.00625 0.0025  0.01625 0.      0.      0.      0.1025  0.0025  0.015
  0.855  ]]
[2023-08-04 06:11:38,947 INFO] 820000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1554, device='cuda:0'), 'train/shrink_loss': tensor(0.0541, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0419, device='cuda:0'), 'train/removed_class_idx': 2.4947365795014127, 'train/uncertainty_avg': 0.7504248911453517, 'train/certain_ratio_ema': 0.7747826583591715, 'train/total_loss': tensor(0.1974, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.014276281971790268, 'train/prefecth_time': 0.018546304702758788, 'train/run_time': 0.5572489624023438, 'eval/loss': tensor(2.6036, device='cuda:0'), 'eval/top-1-acc': 0.675125, 'eval/top-5-acc': 0.9705, 'eval/precision': 0.7177581858051342, 'eval/recall': 0.6751250000000001, 'eval/F1': 0.6819556103021172, 'eval/AUC': 0.9236224045138891}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 07:00:54,922 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 07:01:04,711 INFO] confusion matrix:
[[0.9525  0.00125 0.00375 0.0025  0.0025  0.      0.01375 0.0025  0.01375
  0.0075 ]
 [0.06125 0.755   0.00125 0.0575  0.00625 0.01    0.07875 0.03    0.
  0.     ]
 [0.      0.00125 0.84    0.00125 0.      0.      0.125   0.00375 0.0025
  0.02625]
 [0.0025  0.11875 0.      0.365   0.02    0.165   0.2675  0.06    0.00125
  0.     ]
 [0.      0.0125  0.00125 0.02    0.7225  0.00375 0.23    0.01    0.
  0.     ]
 [0.0025  0.02875 0.      0.0425  0.05    0.5975  0.2125  0.06625 0.
  0.     ]
 [0.0025  0.00875 0.0025  0.00125 0.62875 0.0125  0.33    0.01    0.00125
  0.0025 ]
 [0.      0.19875 0.      0.07625 0.0075  0.015   0.1925  0.50875 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01875 0.0025  0.9625
  0.01125]
 [0.00625 0.0025  0.01875 0.      0.      0.      0.1125  0.00125 0.01125
  0.8475 ]]
[2023-08-04 07:01:04,718 INFO] 825000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.3880e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1858, device='cuda:0'), 'train/shrink_loss': tensor(0.0571, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0440, device='cuda:0'), 'train/removed_class_idx': 2.3861383776100618, 'train/uncertainty_avg': 0.7590589208479241, 'train/certain_ratio_ema': 0.7698094513931028, 'train/total_loss': tensor(0.2298, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.014103050237711473, 'train/prefecth_time': 0.02007110404968262, 'train/run_time': 0.55556396484375, 'eval/loss': tensor(2.5220, device='cuda:0'), 'eval/top-1-acc': 0.688125, 'eval/top-5-acc': 0.9765, 'eval/precision': 0.7307121631290212, 'eval/recall': 0.6881250000000001, 'eval/F1': 0.6984009075947888, 'eval/AUC': 0.9252148958333333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 07:50:43,704 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 07:50:54,225 INFO] confusion matrix:
[[0.9575  0.00125 0.00375 0.0025  0.0025  0.      0.01    0.      0.01125
  0.01125]
 [0.065   0.77375 0.00625 0.0525  0.005   0.005   0.0775  0.00875 0.00625
  0.     ]
 [0.0025  0.      0.83625 0.0025  0.      0.      0.0975  0.00375 0.00125
  0.05625]
 [0.005   0.11625 0.01125 0.43125 0.02375 0.13375 0.2425  0.035   0.00125
  0.     ]
 [0.00125 0.00875 0.00125 0.0275  0.71625 0.01625 0.22125 0.00625 0.00125
  0.     ]
 [0.00625 0.03625 0.00375 0.045   0.05125 0.66    0.16125 0.035   0.00125
  0.     ]
 [0.00375 0.00875 0.00125 0.0025  0.64125 0.01875 0.29    0.025   0.0025
  0.00625]
 [0.00125 0.22875 0.0025  0.15625 0.01125 0.025   0.15625 0.4175  0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.0175  0.      0.96375
  0.01125]
 [0.0075  0.00125 0.0275  0.0025  0.      0.      0.0675  0.00375 0.01125
  0.87875]]
[2023-08-04 07:50:54,232 INFO] 830000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0006, device='cuda:0'), 'train/certain_loss': tensor(0.1790, device='cuda:0'), 'train/shrink_loss': tensor(0.0498, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0378, device='cuda:0'), 'train/removed_class_idx': 2.4876031001980907, 'train/uncertainty_avg': 0.72932094711915, 'train/certain_ratio_ema': 0.7597992025217702, 'train/total_loss': tensor(0.2175, device='cuda:0'), 'train/mask_ratio': tensor(0.7299, device='cuda:0'), 'lr': 0.01392921273394094, 'train/prefecth_time': 0.01938435173034668, 'train/run_time': 0.5604205322265625, 'eval/loss': tensor(2.2808, device='cuda:0'), 'eval/top-1-acc': 0.6925, 'eval/top-5-acc': 0.976125, 'eval/precision': 0.7229599585276245, 'eval/recall': 0.6925000000000001, 'eval/F1': 0.6970739422444022, 'eval/AUC': 0.9271556510416669}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 08:40:14,083 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 08:40:34,105 INFO] confusion matrix:
[[0.96375 0.00125 0.005   0.00125 0.0025  0.      0.005   0.      0.00875
  0.0125 ]
 [0.06375 0.7825  0.005   0.03875 0.0075  0.00625 0.07    0.02625 0.
  0.     ]
 [0.      0.      0.83125 0.      0.      0.      0.11375 0.0075  0.00375
  0.04375]
 [0.005   0.0675  0.005   0.34125 0.0325  0.1975  0.25125 0.09875 0.00125
  0.     ]
 [0.      0.01125 0.      0.02    0.71375 0.015   0.225   0.015   0.
  0.     ]
 [0.0025  0.03125 0.00625 0.0825  0.0625  0.58375 0.17125 0.06    0.
  0.     ]
 [0.00375 0.01125 0.00125 0.00375 0.65625 0.01125 0.28875 0.0125  0.00375
  0.0075 ]
 [0.00125 0.18875 0.0025  0.07375 0.015   0.02    0.19375 0.50375 0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.01125 0.      0.97
  0.01125]
 [0.01125 0.00125 0.01625 0.00125 0.      0.      0.07625 0.0025  0.0125
  0.87875]]
[2023-08-04 08:40:34,112 INFO] 835000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1777, device='cuda:0'), 'train/shrink_loss': tensor(0.0432, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0330, device='cuda:0'), 'train/removed_class_idx': 2.6491225746383704, 'train/uncertainty_avg': 0.742317230272625, 'train/certain_ratio_ema': 0.7632456269368931, 'train/total_loss': tensor(0.2110, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.01375477692733792, 'train/prefecth_time': 0.018941951751708985, 'train/run_time': 0.5608292236328125, 'eval/loss': tensor(2.5127, device='cuda:0'), 'eval/top-1-acc': 0.68575, 'eval/top-5-acc': 0.9715, 'eval/precision': 0.7152301802280906, 'eval/recall': 0.68575, 'eval/F1': 0.6910713223125583, 'eval/AUC': 0.9230474305555556}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 09:19:57,358 INFO] confusion matrix:
[[0.95625 0.00125 0.00625 0.00125 0.0025  0.      0.0125  0.      0.01125
  0.00875]
 [0.06375 0.76    0.00125 0.06125 0.00625 0.01    0.0725  0.025   0.
  0.     ]
 [0.      0.00125 0.83625 0.00125 0.      0.      0.12    0.00375 0.00125
  0.03625]
 [0.005   0.0875  0.015   0.31625 0.03    0.19125 0.265   0.08875 0.00125
  0.     ]
 [0.      0.01125 0.      0.0125  0.7025  0.01375 0.2375  0.0225  0.
  0.     ]
 [0.00125 0.0575  0.005   0.1     0.06    0.515   0.1975  0.06375 0.
  0.     ]
 [0.0025  0.01125 0.00125 0.00125 0.6325  0.01    0.3175  0.0125  0.0025
  0.00875]
 [0.00125 0.255   0.0075  0.1425  0.00875 0.055   0.215   0.31375 0.
  0.00125]
 [0.00375 0.      0.      0.      0.      0.      0.01625 0.0025  0.96875
  0.00875]
 [0.0075  0.00125 0.04    0.      0.      0.      0.085   0.0025  0.01375
  0.85   ]]
[2023-08-04 09:19:57,368 INFO] 839000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.0844e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1426, device='cuda:0'), 'train/shrink_loss': tensor(0.0759, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0587, device='cuda:0'), 'train/removed_class_idx': 2.4747472247730076, 'train/uncertainty_avg': 0.7688986656040917, 'train/certain_ratio_ema': 0.7733863954754084, 'train/total_loss': tensor(0.2013, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.013614802538159955, 'train/prefecth_time': 0.01977712059020996, 'train/run_time': 0.5511932373046875, 'eval/loss': tensor(2.7742, device='cuda:0'), 'eval/top-1-acc': 0.653625, 'eval/top-5-acc': 0.972625, 'eval/precision': 0.6800313538907689, 'eval/recall': 0.653625, 'eval/F1': 0.6558873235918223, 'eval/AUC': 0.9151742708333335}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 09:29:46,689 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 09:29:56,345 INFO] confusion matrix:
[[0.96    0.00125 0.00625 0.00125 0.0025  0.      0.0075  0.      0.01125
  0.01   ]
 [0.0625  0.74625 0.00375 0.08125 0.0075  0.0075  0.0725  0.01875 0.
  0.     ]
 [0.      0.      0.83375 0.00375 0.      0.      0.12875 0.0025  0.0025
  0.02875]
 [0.005   0.0925  0.0025  0.3925  0.0325  0.15625 0.27    0.0475  0.00125
  0.     ]
 [0.      0.00875 0.      0.02125 0.69625 0.00625 0.25125 0.01625 0.
  0.     ]
 [0.00125 0.04125 0.00625 0.0425  0.0525  0.6125  0.20125 0.0425  0.
  0.     ]
 [0.0025  0.00875 0.0025  0.0025  0.65    0.01125 0.3075  0.0075  0.00375
  0.00375]
 [0.00125 0.2675  0.0025  0.29125 0.00875 0.02625 0.2175  0.18375 0.
  0.00125]
 [0.00375 0.      0.00125 0.      0.      0.      0.01125 0.      0.9725
  0.01125]
 [0.01    0.00125 0.02375 0.      0.      0.      0.10875 0.0025  0.015
  0.83875]]
[2023-08-04 09:29:56,351 INFO] 840000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.0305e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1270, device='cuda:0'), 'train/shrink_loss': tensor(0.0639, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0498, device='cuda:0'), 'train/removed_class_idx': 2.4629627349108576, 'train/uncertainty_avg': 0.7444655548088008, 'train/certain_ratio_ema': 0.7785004534679956, 'train/total_loss': tensor(0.1769, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.013579750310460614, 'train/prefecth_time': 0.01875980758666992, 'train/run_time': 0.5965330200195312, 'eval/loss': tensor(2.8720, device='cuda:0'), 'eval/top-1-acc': 0.654375, 'eval/top-5-acc': 0.969875, 'eval/precision': 0.6869977978084634, 'eval/recall': 0.654375, 'eval/F1': 0.6553762980528772, 'eval/AUC': 0.9124179947916666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 09:39:55,188 INFO] confusion matrix:
[[0.955   0.00125 0.00375 0.0025  0.0025  0.      0.01375 0.00125 0.01
  0.01   ]
 [0.06375 0.74125 0.00375 0.0825  0.00875 0.00625 0.07375 0.02    0.
  0.     ]
 [0.00125 0.0025  0.81    0.00625 0.      0.      0.12875 0.005   0.0025
  0.04375]
 [0.005   0.1125  0.0025  0.425   0.025   0.11625 0.25875 0.05375 0.00125
  0.     ]
 [0.      0.01125 0.      0.02    0.695   0.0075  0.2475  0.01875 0.
  0.     ]
 [0.00125 0.055   0.005   0.03375 0.04625 0.615   0.19625 0.0475  0.
  0.     ]
 [0.0025  0.0125  0.      0.0025  0.645   0.0175  0.3     0.01625 0.00125
  0.0025 ]
 [0.00125 0.2525  0.      0.26875 0.00625 0.02375 0.19375 0.2525  0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.015   0.0025  0.96625
  0.01   ]
 [0.00875 0.0025  0.01375 0.      0.      0.      0.09125 0.00375 0.0125
  0.8675 ]]
[2023-08-04 09:39:55,198 INFO] 841000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1038, device='cuda:0'), 'train/shrink_loss': tensor(0.0531, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0413, device='cuda:0'), 'train/removed_class_idx': 2.330188459416183, 'train/uncertainty_avg': 0.761180386956639, 'train/certain_ratio_ema': 0.7775817924460766, 'train/total_loss': tensor(0.1456, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.013544674750987548, 'train/prefecth_time': 0.01984236717224121, 'train/run_time': 0.5554915771484376, 'eval/loss': tensor(2.8217, device='cuda:0'), 'eval/top-1-acc': 0.66275, 'eval/top-5-acc': 0.973375, 'eval/precision': 0.6972749611435655, 'eval/recall': 0.66275, 'eval/F1': 0.6673574549358785, 'eval/AUC': 0.9140342100694446}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 09:49:53,393 INFO] confusion matrix:
[[0.95125 0.00125 0.005   0.00125 0.0025  0.      0.01625 0.00125 0.01
  0.01125]
 [0.0625  0.74875 0.0025  0.07    0.00625 0.00875 0.0775  0.02375 0.
  0.     ]
 [0.      0.0025  0.81875 0.00375 0.      0.      0.13125 0.      0.00625
  0.0375 ]
 [0.00375 0.09625 0.00125 0.38375 0.035   0.14875 0.26875 0.06125 0.00125
  0.     ]
 [0.      0.01125 0.      0.0175  0.72    0.0075  0.23    0.01375 0.
  0.     ]
 [0.00125 0.03375 0.0075  0.03625 0.0475  0.63    0.20875 0.035   0.
  0.     ]
 [0.00375 0.00875 0.00125 0.      0.63875 0.0125  0.32    0.01125 0.00125
  0.0025 ]
 [0.00125 0.22125 0.0025  0.19375 0.01125 0.02875 0.205   0.335   0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.02    0.00125 0.9625
  0.01125]
 [0.00875 0.00125 0.0175  0.      0.      0.      0.115   0.0025  0.0125
  0.8425 ]]
[2023-08-04 09:49:53,404 INFO] 842000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.5326e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1240, device='cuda:0'), 'train/shrink_loss': tensor(0.0710, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0552, device='cuda:0'), 'train/removed_class_idx': 2.5813950486749944, 'train/uncertainty_avg': 0.7296415062050962, 'train/certain_ratio_ema': 0.7773773948641567, 'train/total_loss': tensor(0.1792, device='cuda:0'), 'train/mask_ratio': tensor(0.8080, device='cuda:0'), 'lr': 0.013509575920005113, 'train/prefecth_time': 0.021363199234008787, 'train/run_time': 0.5459080200195312, 'eval/loss': tensor(2.6622, device='cuda:0'), 'eval/top-1-acc': 0.67125, 'eval/top-5-acc': 0.9765, 'eval/precision': 0.71179544898587, 'eval/recall': 0.67125, 'eval/F1': 0.6789165662182641, 'eval/AUC': 0.9199498611111112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 10:00:06,069 INFO] confusion matrix:
[[0.95625 0.00125 0.005   0.      0.0025  0.      0.01625 0.00125 0.01
  0.0075 ]
 [0.06375 0.745   0.0025  0.05875 0.00625 0.00875 0.08625 0.0275  0.00125
  0.     ]
 [0.00125 0.0075  0.82875 0.00125 0.      0.      0.125   0.0025  0.00375
  0.03   ]
 [0.00375 0.10875 0.00125 0.38    0.01875 0.15125 0.27625 0.05875 0.00125
  0.     ]
 [0.      0.0125  0.00125 0.0175  0.71625 0.01    0.23625 0.00625 0.
  0.     ]
 [0.0025  0.03625 0.00625 0.03125 0.0425  0.6275  0.22125 0.0325  0.
  0.     ]
 [0.0025  0.01875 0.00125 0.00125 0.645   0.01125 0.30875 0.00875 0.
  0.0025 ]
 [0.00125 0.23    0.0025  0.11625 0.0075  0.0175  0.21625 0.4075  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.035   0.00125 0.9475
  0.01   ]
 [0.01    0.0025  0.0175  0.      0.      0.      0.115   0.0025  0.01375
  0.83875]]
[2023-08-04 10:00:06,084 INFO] 843000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0006, device='cuda:0'), 'train/certain_loss': tensor(0.1520, device='cuda:0'), 'train/shrink_loss': tensor(0.0562, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0435, device='cuda:0'), 'train/removed_class_idx': 2.515151261095832, 'train/uncertainty_avg': 0.7344543571297605, 'train/certain_ratio_ema': 0.7729380764312676, 'train/total_loss': tensor(0.1960, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.013474453877817653, 'train/prefecth_time': 0.021649183273315428, 'train/run_time': 0.5568357543945313, 'eval/loss': tensor(2.6091, device='cuda:0'), 'eval/top-1-acc': 0.675625, 'eval/top-5-acc': 0.974375, 'eval/precision': 0.7237273255284877, 'eval/recall': 0.675625, 'eval/F1': 0.6865259312633156, 'eval/AUC': 0.9165024479166667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 10:10:05,349 INFO] confusion matrix:
[[0.95625 0.00125 0.      0.0025  0.0025  0.      0.01875 0.      0.00875
  0.01   ]
 [0.065   0.74125 0.00125 0.0725  0.005   0.00875 0.09375 0.0125  0.
  0.     ]
 [0.00375 0.00125 0.82875 0.0025  0.      0.      0.13125 0.00125 0.005
  0.02625]
 [0.00375 0.10875 0.00125 0.4575  0.01125 0.1325  0.26375 0.02    0.00125
  0.     ]
 [0.      0.01125 0.00125 0.03875 0.7075  0.01125 0.22625 0.00375 0.
  0.     ]
 [0.005   0.03625 0.005   0.06125 0.03375 0.6275  0.2075  0.02375 0.
  0.     ]
 [0.0025  0.0175  0.00125 0.005   0.64125 0.015   0.3075  0.005   0.00125
  0.00375]
 [0.00125 0.24375 0.      0.26    0.005   0.025   0.19875 0.265   0.
  0.00125]
 [0.01    0.      0.      0.      0.      0.      0.0375  0.      0.94375
  0.00875]
 [0.01    0.0025  0.02125 0.0025  0.      0.      0.115   0.      0.00875
  0.84   ]]
[2023-08-04 10:10:05,359 INFO] 844000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0008, device='cuda:0'), 'train/certain_loss': tensor(0.1703, device='cuda:0'), 'train/shrink_loss': tensor(0.0882, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0681, device='cuda:0'), 'train/removed_class_idx': 2.4909088644628303, 'train/uncertainty_avg': 0.7560544166538484, 'train/certain_ratio_ema': 0.7719459117518473, 'train/total_loss': tensor(0.2391, device='cuda:0'), 'train/mask_ratio': tensor(0.7545, device='cuda:0'), 'lr': 0.013439308684769405, 'train/prefecth_time': 0.020632959365844725, 'train/run_time': 0.5562594604492187, 'eval/loss': tensor(2.6734, device='cuda:0'), 'eval/top-1-acc': 0.6675, 'eval/top-5-acc': 0.973, 'eval/precision': 0.7190349120907941, 'eval/recall': 0.6674999999999999, 'eval/F1': 0.6746646332913178, 'eval/AUC': 0.9148723350694444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 10:19:55,147 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 10:20:05,112 INFO] confusion matrix:
[[0.9575  0.00125 0.      0.      0.00125 0.      0.02125 0.      0.01
  0.00875]
 [0.06    0.75375 0.      0.04125 0.00375 0.00875 0.0975  0.035   0.
  0.     ]
 [0.00125 0.00375 0.835   0.      0.      0.      0.13375 0.00375 0.005
  0.0175 ]
 [0.00375 0.12125 0.00125 0.3375  0.02375 0.1475  0.26625 0.0975  0.00125
  0.     ]
 [0.      0.01375 0.      0.02875 0.71625 0.01125 0.22625 0.00375 0.
  0.     ]
 [0.00125 0.0475  0.005   0.03125 0.03875 0.6575  0.19125 0.0275  0.
  0.     ]
 [0.00375 0.0125  0.00125 0.005   0.675   0.015   0.28125 0.00375 0.
  0.0025 ]
 [0.00125 0.26375 0.      0.10625 0.00875 0.02875 0.19875 0.39125 0.
  0.00125]
 [0.00875 0.      0.      0.      0.      0.      0.03625 0.      0.9475
  0.0075 ]
 [0.01    0.00375 0.0275  0.00125 0.      0.      0.1175  0.00125 0.01
  0.82875]]
[2023-08-04 10:20:05,119 INFO] 845000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.0639e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1428, device='cuda:0'), 'train/shrink_loss': tensor(0.0420, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0326, device='cuda:0'), 'train/removed_class_idx': 2.344444183950646, 'train/uncertainty_avg': 0.767525292257881, 'train/certain_ratio_ema': 0.7768013421141777, 'train/total_loss': tensor(0.1755, device='cuda:0'), 'train/mask_ratio': tensor(0.7991, device='cuda:0'), 'lr': 0.013404140401244368, 'train/prefecth_time': 0.01828160095214844, 'train/run_time': 0.547464111328125, 'eval/loss': tensor(2.6598, device='cuda:0'), 'eval/top-1-acc': 0.670625, 'eval/top-5-acc': 0.973375, 'eval/precision': 0.7151106894559166, 'eval/recall': 0.670625, 'eval/F1': 0.6793883262807032, 'eval/AUC': 0.9126150000000001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 10:30:01,133 INFO] confusion matrix:
[[0.94875 0.00125 0.      0.0025  0.0025  0.      0.0225  0.      0.01375
  0.00875]
 [0.0625  0.7575  0.      0.0575  0.005   0.0075  0.09125 0.01875 0.
  0.     ]
 [0.00625 0.0025  0.83375 0.      0.      0.      0.13375 0.00375 0.00375
  0.01625]
 [0.005   0.12875 0.      0.38    0.01625 0.1625  0.2725  0.03375 0.
  0.00125]
 [0.      0.01    0.      0.0325  0.70625 0.01375 0.23375 0.00375 0.
  0.     ]
 [0.00375 0.035   0.      0.0525  0.0425  0.66    0.19    0.01625 0.
  0.     ]
 [0.00375 0.0125  0.00125 0.005   0.655   0.015   0.30125 0.0025  0.00125
  0.0025 ]
 [0.00125 0.205   0.      0.175   0.00625 0.01875 0.19125 0.40125 0.
  0.00125]
 [0.0075  0.      0.      0.00125 0.      0.      0.03875 0.      0.9425
  0.01   ]
 [0.01    0.00375 0.04125 0.0025  0.      0.      0.115   0.      0.01125
  0.81625]]
[2023-08-04 10:30:01,149 INFO] 846000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.8102e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1766, device='cuda:0'), 'train/shrink_loss': tensor(0.1095, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0855, device='cuda:0'), 'train/removed_class_idx': 2.3960393667287754, 'train/uncertainty_avg': 0.7691429437146488, 'train/certain_ratio_ema': 0.7804073215928125, 'train/total_loss': tensor(0.2621, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.013368949087666214, 'train/prefecth_time': 0.018922943115234375, 'train/run_time': 0.5529428100585938, 'eval/loss': tensor(2.6493, device='cuda:0'), 'eval/top-1-acc': 0.67475, 'eval/top-5-acc': 0.978375, 'eval/precision': 0.7240001956081208, 'eval/recall': 0.67475, 'eval/F1': 0.6855692797776236, 'eval/AUC': 0.9172359809027777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 10:40:07,735 INFO] confusion matrix:
[[0.94    0.00125 0.      0.00125 0.0025  0.      0.03    0.      0.01375
  0.01125]
 [0.06125 0.7525  0.      0.04    0.00625 0.0075  0.08625 0.045   0.00125
  0.     ]
 [0.00375 0.00375 0.83625 0.      0.      0.00125 0.13125 0.00375 0.00375
  0.01625]
 [0.00375 0.135   0.      0.3375  0.0225  0.1375  0.2575  0.105   0.
  0.00125]
 [0.      0.00875 0.      0.03    0.7275  0.01125 0.21375 0.00875 0.
  0.     ]
 [0.00375 0.03    0.      0.0475  0.04625 0.64375 0.1725  0.05625 0.
  0.     ]
 [0.0025  0.01375 0.005   0.0025  0.67875 0.0125  0.27625 0.00375 0.00125
  0.00375]
 [0.0025  0.1625  0.      0.05875 0.00875 0.01375 0.1625  0.59    0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.05625 0.      0.92875
  0.0075 ]
 [0.01375 0.00375 0.025   0.00125 0.      0.      0.1175  0.00125 0.00875
  0.82875]]
[2023-08-04 10:40:07,745 INFO] 847000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.4116e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1394, device='cuda:0'), 'train/shrink_loss': tensor(0.0622, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0486, device='cuda:0'), 'train/removed_class_idx': 2.404255063377121, 'train/uncertainty_avg': 0.7758039954759263, 'train/certain_ratio_ema': 0.7823931279480919, 'train/total_loss': tensor(0.1881, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.013333734804498197, 'train/prefecth_time': 0.020035104751586916, 'train/run_time': 0.5676324462890625, 'eval/loss': tensor(2.6358, device='cuda:0'), 'eval/top-1-acc': 0.686125, 'eval/top-5-acc': 0.97525, 'eval/precision': 0.7294284580752646, 'eval/recall': 0.686125, 'eval/F1': 0.6970606841435418, 'eval/AUC': 0.9151286631944444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 10:50:04,346 INFO] confusion matrix:
[[0.935   0.00125 0.0025  0.0025  0.0025  0.      0.03375 0.      0.0125
  0.01   ]
 [0.06125 0.765   0.      0.0675  0.0075  0.00875 0.085   0.00375 0.00125
  0.     ]
 [0.0075  0.0025  0.8375  0.00625 0.      0.00125 0.1225  0.      0.005
  0.0175 ]
 [0.00375 0.11125 0.      0.4325  0.02125 0.1675  0.25875 0.00375 0.00125
  0.     ]
 [0.      0.0075  0.      0.04375 0.70625 0.015   0.22625 0.00125 0.
  0.     ]
 [0.0025  0.03    0.      0.05375 0.03875 0.6925  0.1775  0.005   0.
  0.     ]
 [0.00375 0.0075  0.00125 0.00875 0.67875 0.01375 0.28    0.      0.00125
  0.005  ]
 [0.00125 0.235   0.      0.2     0.00625 0.03375 0.17375 0.34875 0.
  0.00125]
 [0.00375 0.      0.      0.0025  0.      0.      0.07375 0.      0.9125
  0.0075 ]
 [0.0125  0.0025  0.0325  0.00375 0.      0.      0.11    0.      0.01
  0.82875]]
[2023-08-04 10:50:04,358 INFO] 848000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.8219e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1096, device='cuda:0'), 'train/shrink_loss': tensor(0.0613, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0480, device='cuda:0'), 'train/removed_class_idx': 2.53260842036865, 'train/uncertainty_avg': 0.7410863285909177, 'train/certain_ratio_ema': 0.7821851677165998, 'train/total_loss': tensor(0.1576, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.013298497612243013, 'train/prefecth_time': 0.02357200050354004, 'train/run_time': 0.5809408569335938, 'eval/loss': tensor(2.6519, device='cuda:0'), 'eval/top-1-acc': 0.673875, 'eval/top-5-acc': 0.97975, 'eval/precision': 0.7339039301717954, 'eval/recall': 0.673875, 'eval/F1': 0.6845152240464556, 'eval/AUC': 0.91894828125}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 11:00:11,192 INFO] confusion matrix:
[[0.96    0.00125 0.00625 0.      0.00375 0.      0.      0.      0.01625
  0.0125 ]
 [0.0725  0.80875 0.      0.01625 0.01    0.01375 0.01    0.065   0.00375
  0.     ]
 [0.00375 0.00125 0.945   0.      0.      0.      0.01625 0.0025  0.00375
  0.0275 ]
 [0.0075  0.22625 0.00125 0.22375 0.04    0.2675  0.04375 0.18    0.0025
  0.0075 ]
 [0.005   0.01375 0.00125 0.0175  0.91375 0.01375 0.01125 0.0225  0.00125
  0.     ]
 [0.0125  0.04625 0.      0.08    0.06625 0.705   0.035   0.055   0.
  0.     ]
 [0.0025  0.015   0.00125 0.005   0.89125 0.01875 0.0475  0.0075  0.00125
  0.01   ]
 [0.00125 0.1875  0.      0.0325  0.0125  0.03375 0.01625 0.71375 0.
  0.0025 ]
 [0.00625 0.      0.      0.00125 0.      0.      0.      0.      0.985
  0.0075 ]
 [0.01    0.00125 0.03    0.00125 0.      0.      0.005   0.00125 0.01125
  0.94   ]]
[2023-08-04 11:00:11,203 INFO] 849000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.6306e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1213, device='cuda:0'), 'train/shrink_loss': tensor(0.1100, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0827, device='cuda:0'), 'train/removed_class_idx': 2.409090726584036, 'train/uncertainty_avg': 0.7397262760610855, 'train/certain_ratio_ema': 0.7514916486451421, 'train/total_loss': tensor(0.2041, device='cuda:0'), 'train/mask_ratio': tensor(0.7054, device='cuda:0'), 'lr': 0.013263237571442748, 'train/prefecth_time': 0.01897596740722656, 'train/run_time': 0.56540673828125, 'eval/loss': tensor(1.7498, device='cuda:0'), 'eval/top-1-acc': 0.72425, 'eval/top-5-acc': 0.974125, 'eval/precision': 0.7035050866336636, 'eval/recall': 0.72425, 'eval/F1': 0.6898189256435519, 'eval/AUC': 0.9442544097222222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 11:10:06,925 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 11:10:17,034 INFO] confusion matrix:
[[0.96375 0.00125 0.005   0.      0.00375 0.      0.      0.      0.015
  0.01125]
 [0.07625 0.79625 0.      0.015   0.00875 0.01125 0.01125 0.08    0.00125
  0.     ]
 [0.00375 0.      0.95875 0.      0.      0.      0.00125 0.00375 0.00375
  0.02875]
 [0.00375 0.21    0.005   0.2975  0.035   0.27875 0.01375 0.145   0.0025
  0.00875]
 [0.0025  0.01125 0.00125 0.0175  0.91625 0.01125 0.0075  0.0325  0.
  0.     ]
 [0.0025  0.045   0.00125 0.07    0.05625 0.77    0.0225  0.0325  0.
  0.     ]
 [0.00375 0.01375 0.00625 0.0025  0.93    0.01375 0.01625 0.00375 0.00125
  0.00875]
 [0.0025  0.2675  0.      0.0325  0.01375 0.0425  0.0025  0.63625 0.
  0.0025 ]
 [0.005   0.      0.      0.00125 0.      0.      0.      0.      0.98375
  0.01   ]
 [0.00875 0.00125 0.03375 0.00125 0.      0.      0.      0.00125 0.01
  0.94375]]
[2023-08-04 11:10:17,046 INFO] 850000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.1836e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1481, device='cuda:0'), 'train/shrink_loss': tensor(0.0622, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0472, device='cuda:0'), 'train/removed_class_idx': 2.345794173290264, 'train/uncertainty_avg': 0.7414685552377672, 'train/certain_ratio_ema': 0.7590269858021426, 'train/total_loss': tensor(0.1953, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.01322795474267872, 'train/prefecth_time': 0.019020416259765624, 'train/run_time': 0.5538580322265625, 'eval/loss': tensor(1.8988, device='cuda:0'), 'eval/top-1-acc': 0.72825, 'eval/top-5-acc': 0.981625, 'eval/precision': 0.706257969235954, 'eval/recall': 0.72825, 'eval/F1': 0.6918616075892374, 'eval/AUC': 0.9451567013888886}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 11:20:14,824 INFO] confusion matrix:
[[0.965   0.0025  0.0025  0.      0.00375 0.      0.      0.      0.01375
  0.0125 ]
 [0.06875 0.80375 0.00125 0.07125 0.00875 0.01    0.0175  0.0175  0.00125
  0.     ]
 [0.00375 0.      0.95875 0.00125 0.      0.      0.00375 0.      0.005
  0.0275 ]
 [0.00375 0.22875 0.0025  0.48875 0.02625 0.185   0.04    0.015   0.00375
  0.00625]
 [0.      0.01375 0.00125 0.0425  0.915   0.01375 0.01    0.00375 0.
  0.     ]
 [0.      0.0525  0.      0.0475  0.0475  0.79375 0.05    0.00875 0.
  0.     ]
 [0.00125 0.01375 0.00375 0.0075  0.69625 0.0125  0.25875 0.00125 0.
  0.005  ]
 [0.      0.26875 0.      0.12375 0.01    0.03125 0.0325  0.53125 0.
  0.0025 ]
 [0.0025  0.      0.00125 0.0025  0.      0.      0.0025  0.      0.98625
  0.005  ]
 [0.0075  0.00125 0.03125 0.00125 0.      0.      0.00125 0.      0.01375
  0.94375]]
[2023-08-04 11:20:14,845 INFO] 851000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2885e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1347, device='cuda:0'), 'train/shrink_loss': tensor(0.0713, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0550, device='cuda:0'), 'train/removed_class_idx': 2.6371679082152295, 'train/uncertainty_avg': 0.7311346274223814, 'train/certain_ratio_ema': 0.7715479325143292, 'train/total_loss': tensor(0.1897, device='cuda:0'), 'train/mask_ratio': tensor(0.7478, device='cuda:0'), 'lr': 0.013192649186571407, 'train/prefecth_time': 0.01954915237426758, 'train/run_time': 0.557059326171875, 'eval/loss': tensor(1.3746, device='cuda:0'), 'eval/top-1-acc': 0.7645, 'eval/top-5-acc': 0.983875, 'eval/precision': 0.7816004799678429, 'eval/recall': 0.7645, 'eval/F1': 0.752700262485585, 'eval/AUC': 0.9649671440972223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 11:30:29,496 INFO] confusion matrix:
[[0.96625 0.      0.0025  0.00375 0.0025  0.      0.00125 0.      0.015
  0.00875]
 [0.07    0.79125 0.      0.045   0.01    0.01375 0.0225  0.04625 0.00125
  0.     ]
 [0.00375 0.      0.95375 0.00125 0.      0.      0.0075  0.00125 0.00625
  0.02625]
 [0.025   0.15875 0.      0.4625  0.025   0.17375 0.0525  0.09125 0.00375
  0.0075 ]
 [0.0075  0.01125 0.00125 0.02    0.9275  0.01125 0.0075  0.01375 0.
  0.     ]
 [0.00625 0.0375  0.      0.03625 0.05375 0.8     0.02875 0.0375  0.
  0.     ]
 [0.00625 0.01    0.00125 0.00375 0.6575  0.00875 0.30375 0.0025  0.00125
  0.005  ]
 [0.02    0.2325  0.      0.05    0.005   0.03125 0.02375 0.635   0.
  0.0025 ]
 [0.005   0.      0.00125 0.00125 0.      0.      0.      0.      0.9875
  0.005  ]
 [0.0075  0.00125 0.05375 0.      0.      0.      0.      0.00125 0.0125
  0.92375]]
[2023-08-04 11:30:29,513 INFO] 852000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1544, device='cuda:0'), 'train/shrink_loss': tensor(0.0819, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0628, device='cuda:0'), 'train/removed_class_idx': 2.495726282416557, 'train/uncertainty_avg': 0.7634611147145327, 'train/certain_ratio_ema': 0.767179904027642, 'train/total_loss': tensor(0.2174, device='cuda:0'), 'train/mask_ratio': tensor(0.7388, device='cuda:0'), 'lr': 0.013157320963780344, 'train/prefecth_time': 0.018066112518310546, 'train/run_time': 0.5603713989257812, 'eval/loss': tensor(1.3820, device='cuda:0'), 'eval/top-1-acc': 0.775125, 'eval/top-5-acc': 0.98675, 'eval/precision': 0.7855461808074656, 'eval/recall': 0.775125, 'eval/F1': 0.7633790092268461, 'eval/AUC': 0.9641468315972221}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 11:40:36,000 INFO] confusion matrix:
[[0.965   0.      0.      0.00375 0.00375 0.      0.0025  0.      0.015
  0.01   ]
 [0.06625 0.7975  0.      0.07375 0.00875 0.01    0.02875 0.0125  0.00125
  0.00125]
 [0.00625 0.      0.94    0.0025  0.      0.      0.0225  0.      0.005
  0.02375]
 [0.025   0.12625 0.      0.4875  0.03    0.16125 0.145   0.02    0.00125
  0.00375]
 [0.00375 0.01375 0.      0.02625 0.90875 0.015   0.0275  0.005   0.
  0.     ]
 [0.00375 0.03625 0.      0.06375 0.04375 0.8     0.045   0.0075  0.
  0.     ]
 [0.00375 0.01    0.00125 0.0025  0.805   0.01375 0.1475  0.0025  0.00375
  0.01   ]
 [0.015   0.18125 0.      0.1525  0.01375 0.03375 0.07625 0.5225  0.00125
  0.00375]
 [0.00375 0.      0.00125 0.0025  0.      0.      0.00625 0.      0.97875
  0.0075 ]
 [0.0075  0.0025  0.06    0.      0.      0.      0.01375 0.00125 0.01125
  0.90375]]
[2023-08-04 11:40:36,016 INFO] 853000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.6832e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1791, device='cuda:0'), 'train/shrink_loss': tensor(0.0797, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0600, device='cuda:0'), 'train/removed_class_idx': 2.432432213294395, 'train/uncertainty_avg': 0.7634174909246927, 'train/certain_ratio_ema': 0.7521384228863885, 'train/total_loss': tensor(0.2391, device='cuda:0'), 'train/mask_ratio': tensor(0.7522, device='cuda:0'), 'lr': 0.013121970135004, 'train/prefecth_time': 0.01916889572143555, 'train/run_time': 0.5607422485351562, 'eval/loss': tensor(1.5041, device='cuda:0'), 'eval/top-1-acc': 0.745125, 'eval/top-5-acc': 0.9825, 'eval/precision': 0.7471815128889016, 'eval/recall': 0.745125, 'eval/F1': 0.7314082276509932, 'eval/AUC': 0.9568326128472223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 11:50:37,292 INFO] confusion matrix:
[[0.9425  0.00125 0.      0.0025  0.0025  0.00125 0.025   0.      0.015
  0.01   ]
 [0.06    0.795   0.      0.04875 0.0075  0.015   0.05625 0.01625 0.00125
  0.     ]
 [0.0025  0.      0.86625 0.0025  0.      0.      0.10625 0.00125 0.005
  0.01625]
 [0.0075  0.17    0.      0.36875 0.0175  0.145   0.2475  0.0425  0.00125
  0.     ]
 [0.      0.01125 0.      0.0325  0.77875 0.01375 0.15875 0.005   0.
  0.     ]
 [0.      0.0325  0.      0.03625 0.0425  0.7175  0.14125 0.03    0.
  0.     ]
 [0.0025  0.0075  0.00125 0.0025  0.68625 0.01375 0.2725  0.0025  0.0025
  0.00875]
 [0.0025  0.165   0.      0.075   0.005   0.02125 0.14125 0.58625 0.00125
  0.0025 ]
 [0.00375 0.      0.      0.0025  0.      0.      0.05625 0.      0.93
  0.0075 ]
 [0.00625 0.00125 0.0925  0.      0.      0.      0.07625 0.00125 0.01125
  0.81125]]
[2023-08-04 11:50:37,307 INFO] 854000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1628, device='cuda:0'), 'train/shrink_loss': tensor(0.0658, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0501, device='cuda:0'), 'train/removed_class_idx': 2.3723401731553007, 'train/uncertainty_avg': 0.7509089001432326, 'train/certain_ratio_ema': 0.7617079607595986, 'train/total_loss': tensor(0.2134, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.013086596760979681, 'train/prefecth_time': 0.02030246353149414, 'train/run_time': 0.5608011474609375, 'eval/loss': tensor(1.9904, device='cuda:0'), 'eval/top-1-acc': 0.706875, 'eval/top-5-acc': 0.979, 'eval/precision': 0.7393202053625041, 'eval/recall': 0.706875, 'eval/F1': 0.7122984484236722, 'eval/AUC': 0.9411580815972221}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 12:00:31,536 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 12:00:41,559 INFO] confusion matrix:
[[0.92375 0.      0.      0.00125 0.0025  0.00125 0.04625 0.0025  0.0125
  0.01   ]
 [0.05625 0.77875 0.      0.0425  0.0075  0.01    0.06375 0.04125 0.
  0.     ]
 [0.      0.      0.85625 0.      0.      0.00125 0.115   0.00625 0.00375
  0.0175 ]
 [0.0025  0.1575  0.      0.3525  0.01    0.1125  0.24    0.12375 0.00125
  0.     ]
 [0.      0.01    0.      0.0325  0.73    0.01125 0.20625 0.01    0.
  0.     ]
 [0.      0.03125 0.      0.055   0.0325  0.66375 0.16    0.0575  0.
  0.     ]
 [0.00125 0.00625 0.      0.005   0.69125 0.01125 0.2725  0.0075  0.00125
  0.00375]
 [0.      0.155   0.      0.10125 0.0025  0.015   0.14375 0.58    0.00125
  0.00125]
 [0.00375 0.      0.      0.00125 0.      0.      0.07375 0.      0.91125
  0.01   ]
 [0.00625 0.00125 0.08    0.00125 0.      0.      0.09125 0.0025  0.01125
  0.80625]]
[2023-08-04 12:00:41,566 INFO] 855000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1884, device='cuda:0'), 'train/shrink_loss': tensor(0.0641, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0492, device='cuda:0'), 'train/removed_class_idx': 2.3660712173150698, 'train/uncertainty_avg': 0.7835714013653853, 'train/certain_ratio_ema': 0.7667044277479623, 'train/total_loss': tensor(0.2379, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.013051200902483446, 'train/prefecth_time': 0.029559999465942382, 'train/run_time': 0.574552734375, 'eval/loss': tensor(2.4268, device='cuda:0'), 'eval/top-1-acc': 0.6875, 'eval/top-5-acc': 0.97325, 'eval/precision': 0.7227422288005865, 'eval/recall': 0.6875, 'eval/F1': 0.696788056032963, 'eval/AUC': 0.9253293229166666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 12:10:41,352 INFO] confusion matrix:
[[0.91875 0.      0.      0.0025  0.0025  0.      0.05    0.      0.015
  0.01125]
 [0.0575  0.775   0.      0.05875 0.00625 0.005   0.085   0.0125  0.
  0.     ]
 [0.      0.      0.845   0.00125 0.      0.      0.11125 0.00375 0.00375
  0.035  ]
 [0.005   0.175   0.      0.3575  0.015   0.1275  0.2725  0.04625 0.00125
  0.     ]
 [0.      0.01    0.      0.03375 0.71625 0.01    0.225   0.005   0.
  0.     ]
 [0.00125 0.03875 0.      0.05625 0.03625 0.67125 0.17125 0.025   0.
  0.     ]
 [0.00125 0.01125 0.00125 0.005   0.685   0.01125 0.27625 0.00125 0.00125
  0.00625]
 [0.00125 0.2275  0.      0.15    0.005   0.015   0.19625 0.4025  0.
  0.0025 ]
 [0.005   0.      0.      0.00125 0.      0.      0.06625 0.      0.92125
  0.00625]
 [0.0075  0.00125 0.0625  0.00125 0.00125 0.      0.06625 0.0025  0.0125
  0.845  ]]
[2023-08-04 12:10:41,392 INFO] 856000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1259, device='cuda:0'), 'train/shrink_loss': tensor(0.0629, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0488, device='cuda:0'), 'train/removed_class_idx': 2.3854164181857898, 'train/uncertainty_avg': 0.7606486894713879, 'train/certain_ratio_ema': 0.7760734503464305, 'train/total_loss': tensor(0.1750, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.013015782620329966, 'train/prefecth_time': 0.01877459144592285, 'train/run_time': 0.5482950439453125, 'eval/loss': tensor(2.7059, device='cuda:0'), 'eval/top-1-acc': 0.672875, 'eval/top-5-acc': 0.9695, 'eval/precision': 0.718512906941556, 'eval/recall': 0.672875, 'eval/F1': 0.6821971917168292, 'eval/AUC': 0.9152942361111113}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 12:20:43,354 INFO] confusion matrix:
[[0.935   0.00125 0.00125 0.00125 0.00375 0.      0.035   0.      0.0125
  0.01   ]
 [0.06375 0.79625 0.      0.02875 0.005   0.005   0.07625 0.025   0.
  0.     ]
 [0.00625 0.00125 0.8425  0.      0.      0.      0.1025  0.00625 0.005
  0.03625]
 [0.005   0.18625 0.      0.3325  0.0175  0.1125  0.25625 0.08875 0.
  0.00125]
 [0.00125 0.01375 0.      0.02625 0.7175  0.0125  0.2225  0.00625 0.
  0.     ]
 [0.0025  0.0575  0.      0.09    0.03625 0.59875 0.17875 0.03625 0.
  0.     ]
 [0.00125 0.00875 0.00125 0.0075  0.66875 0.01    0.29375 0.00375 0.0025
  0.0025 ]
 [0.00125 0.2375  0.      0.05625 0.0075  0.0125  0.1875  0.4975  0.
  0.     ]
 [0.00625 0.      0.      0.00125 0.      0.      0.0375  0.      0.94875
  0.00625]
 [0.01125 0.0025  0.03125 0.00125 0.00125 0.      0.06625 0.00125 0.015
  0.87   ]]
[2023-08-04 12:20:43,370 INFO] 857000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1719, device='cuda:0'), 'train/shrink_loss': tensor(0.0661, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0510, device='cuda:0'), 'train/removed_class_idx': 2.3103445620293606, 'train/uncertainty_avg': 0.7756017545006867, 'train/certain_ratio_ema': 0.7711779308167825, 'train/total_loss': tensor(0.2233, device='cuda:0'), 'train/mask_ratio': tensor(0.8058, device='cuda:0'), 'lr': 0.012980341975372456, 'train/prefecth_time': 0.018902431488037108, 'train/run_time': 0.5447996826171875, 'eval/loss': tensor(2.4601, device='cuda:0'), 'eval/top-1-acc': 0.68325, 'eval/top-5-acc': 0.97375, 'eval/precision': 0.7229019041545854, 'eval/recall': 0.68325, 'eval/F1': 0.6903200419065969, 'eval/AUC': 0.9250612673611109}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 12:30:57,816 INFO] confusion matrix:
[[0.93875 0.00125 0.00125 0.0025  0.0025  0.      0.02875 0.      0.01375
  0.01125]
 [0.0625  0.775   0.      0.05    0.01125 0.0075  0.08    0.01375 0.
  0.     ]
 [0.00625 0.      0.8375  0.00125 0.      0.      0.12125 0.0075  0.005
  0.02125]
 [0.005   0.12875 0.      0.36375 0.015   0.14875 0.2775  0.06    0.00125
  0.     ]
 [0.      0.01    0.      0.02    0.72875 0.01    0.22375 0.0075  0.
  0.     ]
 [0.0025  0.02875 0.      0.04875 0.03625 0.69    0.17125 0.0225  0.
  0.     ]
 [0.      0.0075  0.00125 0.00375 0.65125 0.0125  0.31375 0.005   0.00125
  0.00375]
 [0.0025  0.21625 0.      0.11    0.00875 0.01375 0.21    0.4375  0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.025   0.      0.96125
  0.00625]
 [0.01125 0.00125 0.0425  0.      0.      0.      0.09375 0.0025  0.01125
  0.8375 ]]
[2023-08-04 12:30:57,827 INFO] 858000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.3433e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1476, device='cuda:0'), 'train/shrink_loss': tensor(0.0788, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0606, device='cuda:0'), 'train/removed_class_idx': 2.29999979090911, 'train/uncertainty_avg': 0.7720999698547452, 'train/certain_ratio_ema': 0.7697397069972022, 'train/total_loss': tensor(0.2083, device='cuda:0'), 'train/mask_ratio': tensor(0.7545, device='cuda:0'), 'lr': 0.012944879028502538, 'train/prefecth_time': 0.021526975631713866, 'train/run_time': 0.553719482421875, 'eval/loss': tensor(2.4209, device='cuda:0'), 'eval/top-1-acc': 0.688375, 'eval/top-5-acc': 0.967125, 'eval/precision': 0.7314423581616851, 'eval/recall': 0.688375, 'eval/F1': 0.6971669313008285, 'eval/AUC': 0.9248051996527777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 12:41:00,987 INFO] confusion matrix:
[[0.92625 0.0025  0.      0.00125 0.0025  0.      0.0375  0.      0.01625
  0.01375]
 [0.06875 0.77125 0.      0.0375  0.00625 0.0075  0.07625 0.0275  0.005
  0.     ]
 [0.00875 0.      0.83375 0.      0.      0.      0.125   0.00125 0.0025
  0.02875]
 [0.01    0.14125 0.      0.36    0.0175  0.16375 0.26625 0.0275  0.0025
  0.01125]
 [0.      0.0125  0.      0.02625 0.72875 0.01    0.21625 0.005   0.00125
  0.     ]
 [0.00125 0.04375 0.      0.05625 0.03875 0.655   0.18    0.025   0.
  0.     ]
 [0.0025  0.005   0.0025  0.00625 0.6275  0.01375 0.3325  0.0025  0.0025
  0.005  ]
 [0.0025  0.175   0.      0.0875  0.00625 0.01625 0.175   0.53125 0.
  0.00625]
 [0.005   0.      0.00125 0.00125 0.      0.      0.03875 0.      0.94375
  0.01   ]
 [0.01    0.00125 0.03125 0.00125 0.      0.      0.09    0.00125 0.0075
  0.8575 ]]
[2023-08-04 12:41:00,998 INFO] 859000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.5148e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1259, device='cuda:0'), 'train/shrink_loss': tensor(0.0362, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0278, device='cuda:0'), 'train/removed_class_idx': 2.304347575614394, 'train/uncertainty_avg': 0.776975271264613, 'train/certain_ratio_ema': 0.7689770008097242, 'train/total_loss': tensor(0.1537, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.012909393840650154, 'train/prefecth_time': 0.020034879684448243, 'train/run_time': 0.5518976440429687, 'eval/loss': tensor(2.3765, device='cuda:0'), 'eval/top-1-acc': 0.694, 'eval/top-5-acc': 0.96725, 'eval/precision': 0.7366599856207626, 'eval/recall': 0.694, 'eval/F1': 0.7035568786007165, 'eval/AUC': 0.9236232378472223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 12:50:54,866 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 12:51:05,487 INFO] confusion matrix:
[[0.92375 0.00125 0.      0.      0.00125 0.00125 0.0425  0.      0.01625
  0.01375]
 [0.065   0.7925  0.      0.03375 0.00625 0.0125  0.07625 0.0125  0.00125
  0.     ]
 [0.01    0.00125 0.825   0.      0.      0.      0.13875 0.00125 0.00125
  0.0225 ]
 [0.02    0.1375  0.      0.37125 0.01125 0.17375 0.26375 0.02125 0.00125
  0.     ]
 [0.      0.01    0.      0.02625 0.72    0.01625 0.22    0.0075  0.
  0.     ]
 [0.00125 0.03    0.      0.2125  0.03375 0.5325  0.17875 0.01125 0.
  0.     ]
 [0.0025  0.00625 0.0025  0.0075  0.6425  0.015   0.3175  0.      0.0025
  0.00375]
 [0.015   0.21    0.      0.08125 0.00625 0.03    0.185   0.47    0.
  0.0025 ]
 [0.00875 0.      0.      0.00125 0.      0.      0.045   0.      0.93625
  0.00875]
 [0.00875 0.00125 0.0225  0.00375 0.      0.      0.10875 0.      0.01
  0.845  ]]
[2023-08-04 12:51:05,494 INFO] 860000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2303e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1977, device='cuda:0'), 'train/shrink_loss': tensor(0.0627, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0486, device='cuda:0'), 'train/removed_class_idx': 2.350515221596369, 'train/uncertainty_avg': 0.763708580013994, 'train/certain_ratio_ema': 0.7753249283968375, 'train/total_loss': tensor(0.2463, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.012873886472783475, 'train/prefecth_time': 0.02138697624206543, 'train/run_time': 0.5528954467773437, 'eval/loss': tensor(2.6174, device='cuda:0'), 'eval/top-1-acc': 0.673375, 'eval/top-5-acc': 0.97525, 'eval/precision': 0.7211804222883866, 'eval/recall': 0.6733750000000001, 'eval/F1': 0.6840355134386847, 'eval/AUC': 0.9151158940972222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 13:01:14,910 INFO] confusion matrix:
[[0.9125  0.00125 0.      0.      0.0025  0.00125 0.0525  0.      0.01625
  0.01375]
 [0.0625  0.815   0.      0.00625 0.0075  0.00875 0.08125 0.01125 0.0075
  0.     ]
 [0.0125  0.00125 0.82375 0.      0.      0.      0.13    0.00125 0.0025
  0.02875]
 [0.005   0.2225  0.      0.26    0.0225  0.18125 0.275   0.0175  0.00125
  0.015  ]
 [0.      0.0225  0.      0.00125 0.72875 0.0125  0.225   0.00625 0.0025
  0.00125]
 [0.0025  0.0475  0.      0.22625 0.03375 0.50125 0.17375 0.01125 0.00375
  0.     ]
 [0.00125 0.0075  0.      0.005   0.675   0.01125 0.28875 0.00125 0.0025
  0.0075 ]
 [0.0025  0.25    0.      0.025   0.00375 0.02375 0.1825  0.5025  0.
  0.01   ]
 [0.005   0.      0.00125 0.00125 0.      0.      0.03125 0.      0.9525
  0.00875]
 [0.01    0.0025  0.04625 0.00125 0.00125 0.      0.0975  0.      0.01125
  0.83   ]]
[2023-08-04 13:01:14,929 INFO] 861000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1214, device='cuda:0'), 'train/shrink_loss': tensor(0.0690, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0536, device='cuda:0'), 'train/removed_class_idx': 2.3333331111111324, 'train/uncertainty_avg': 0.7616781199044367, 'train/certain_ratio_ema': 0.7780487624343477, 'train/total_loss': tensor(0.1752, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.012838356985908753, 'train/prefecth_time': 0.02106425666809082, 'train/run_time': 0.5540850830078125, 'eval/loss': tensor(2.8684, device='cuda:0'), 'eval/top-1-acc': 0.6615, 'eval/top-5-acc': 0.97, 'eval/precision': 0.7064962195018556, 'eval/recall': 0.6615, 'eval/F1': 0.6674994850829574, 'eval/AUC': 0.9070335937500001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 13:11:13,511 INFO] confusion matrix:
[[0.9075  0.00125 0.      0.      0.00125 0.00125 0.05625 0.      0.01875
  0.01375]
 [0.065   0.775   0.      0.00625 0.00625 0.00875 0.07875 0.0575  0.0025
  0.     ]
 [0.0125  0.      0.83125 0.      0.      0.      0.12375 0.0125  0.00125
  0.01875]
 [0.00375 0.1     0.      0.31    0.0225  0.11    0.27375 0.1725  0.00125
  0.00625]
 [0.      0.01    0.      0.005   0.7275  0.01    0.2225  0.025   0.
  0.     ]
 [0.00125 0.01875 0.      0.25125 0.035   0.47375 0.1625  0.0575  0.
  0.     ]
 [0.00125 0.00375 0.00125 0.00125 0.7025  0.01125 0.265   0.00625 0.0025
  0.005  ]
 [0.00125 0.175   0.      0.0225  0.005   0.0175  0.1725  0.60125 0.00125
  0.00375]
 [0.00625 0.      0.      0.      0.      0.      0.03    0.      0.9575
  0.00625]
 [0.00875 0.00125 0.0675  0.      0.      0.      0.09625 0.0025  0.0125
  0.81125]]
[2023-08-04 13:11:13,522 INFO] 862000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.3900e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1361, device='cuda:0'), 'train/shrink_loss': tensor(0.0545, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0424, device='cuda:0'), 'train/removed_class_idx': 2.404255063377121, 'train/uncertainty_avg': 0.7564880458486629, 'train/certain_ratio_ema': 0.7776255714361767, 'train/total_loss': tensor(0.1785, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.012802805441070274, 'train/prefecth_time': 0.018735136032104492, 'train/run_time': 0.5521768798828125, 'eval/loss': tensor(2.9053, device='cuda:0'), 'eval/top-1-acc': 0.666, 'eval/top-5-acc': 0.967125, 'eval/precision': 0.7012281345513915, 'eval/recall': 0.6660000000000001, 'eval/F1': 0.6737043970726749, 'eval/AUC': 0.904924253472222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 13:21:12,081 INFO] confusion matrix:
[[0.905   0.00125 0.      0.0025  0.0025  0.      0.05875 0.00125 0.015
  0.01375]
 [0.065   0.76875 0.      0.0375  0.01125 0.00875 0.0775  0.02875 0.0025
  0.     ]
 [0.01125 0.00125 0.81875 0.00125 0.      0.      0.13375 0.00625 0.00125
  0.02625]
 [0.00375 0.0725  0.      0.35375 0.02375 0.1575  0.275   0.1125  0.00125
  0.     ]
 [0.      0.0075  0.      0.01125 0.7275  0.01125 0.22375 0.01875 0.
  0.     ]
 [0.00125 0.015   0.      0.09875 0.0425  0.625   0.1725  0.04375 0.00125
  0.     ]
 [0.00125 0.00875 0.00125 0.      0.705   0.01125 0.26375 0.0025  0.0025
  0.00375]
 [0.00125 0.18    0.      0.0575  0.005   0.01625 0.18125 0.5575  0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.03    0.      0.95625
  0.00625]
 [0.00875 0.00125 0.03625 0.00125 0.      0.      0.1     0.0025  0.0125
  0.8375 ]]
[2023-08-04 13:21:12,096 INFO] 863000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.6247e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0954, device='cuda:0'), 'train/shrink_loss': tensor(0.0588, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0456, device='cuda:0'), 'train/removed_class_idx': 2.453703476508937, 'train/uncertainty_avg': 0.710413035591703, 'train/certain_ratio_ema': 0.7755154170280505, 'train/total_loss': tensor(0.1411, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.012767231899350199, 'train/prefecth_time': 0.018396575927734374, 'train/run_time': 0.556031982421875, 'eval/loss': tensor(2.7080, device='cuda:0'), 'eval/top-1-acc': 0.681375, 'eval/top-5-acc': 0.965, 'eval/precision': 0.724443015999347, 'eval/recall': 0.681375, 'eval/F1': 0.693096878716734, 'eval/AUC': 0.9097752256944445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 13:31:11,182 INFO] confusion matrix:
[[0.92    0.00125 0.00125 0.0025  0.00125 0.      0.0425  0.00125 0.0175
  0.0125 ]
 [0.065   0.785   0.      0.0225  0.0075  0.00875 0.06625 0.04375 0.00125
  0.     ]
 [0.01375 0.0025  0.8175  0.00125 0.      0.      0.13125 0.0025  0.00125
  0.03   ]
 [0.00375 0.12625 0.      0.32    0.02375 0.14625 0.265   0.11375 0.00125
  0.     ]
 [0.      0.01125 0.      0.0075  0.72125 0.01375 0.22375 0.0225  0.
  0.     ]
 [0.0025  0.03    0.      0.11    0.04125 0.6025  0.17125 0.0425  0.
  0.     ]
 [0.00125 0.01    0.      0.      0.6975  0.01125 0.27    0.0025  0.0025
  0.005  ]
 [0.00125 0.19625 0.      0.04    0.00375 0.01625 0.1575  0.58375 0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.0225  0.      0.96125
  0.00875]
 [0.015   0.0025  0.0625  0.      0.      0.      0.10375 0.0025  0.01125
  0.8025 ]]
[2023-08-04 13:31:11,200 INFO] 864000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.5382e-06, device='cuda:0'), 'train/certain_loss': tensor(0.1436, device='cuda:0'), 'train/shrink_loss': tensor(0.0659, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0512, device='cuda:0'), 'train/removed_class_idx': 2.4952378575963943, 'train/uncertainty_avg': 0.7467144686392947, 'train/certain_ratio_ema': 0.7774537354793851, 'train/total_loss': tensor(0.1948, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.012731636421868484, 'train/prefecth_time': 0.052318687438964846, 'train/run_time': 0.5657796630859375, 'eval/loss': tensor(2.7635, device='cuda:0'), 'eval/top-1-acc': 0.678375, 'eval/top-5-acc': 0.9615, 'eval/precision': 0.7166024327023217, 'eval/recall': 0.6783750000000001, 'eval/F1': 0.6863321604972583, 'eval/AUC': 0.9098225694444444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 13:41:04,089 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 13:41:14,604 INFO] confusion matrix:
[[0.94125 0.00125 0.00125 0.00125 0.0025  0.      0.025   0.      0.015
  0.0125 ]
 [0.0725  0.76125 0.      0.0125  0.00875 0.01    0.06375 0.06875 0.0025
  0.     ]
 [0.0175  0.00125 0.8275  0.      0.      0.      0.1175  0.01    0.00125
  0.025  ]
 [0.005   0.14375 0.      0.29625 0.0225  0.1475  0.26125 0.1225  0.00125
  0.     ]
 [0.      0.0125  0.      0.0075  0.71125 0.01    0.23625 0.0225  0.
  0.     ]
 [0.00125 0.0275  0.      0.2125  0.04125 0.5075  0.16625 0.04375 0.
  0.     ]
 [0.00125 0.0125  0.      0.00375 0.685   0.00875 0.28    0.00125 0.0025
  0.005  ]
 [0.00375 0.185   0.      0.025   0.0075  0.01625 0.16875 0.5925  0.
  0.00125]
 [0.00875 0.00125 0.      0.      0.      0.      0.01875 0.      0.96
  0.01125]
 [0.00875 0.0025  0.0675  0.      0.00125 0.      0.1025  0.00375 0.00875
  0.805  ]]
[2023-08-04 13:41:14,631 INFO] 865000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.0560e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1402, device='cuda:0'), 'train/shrink_loss': tensor(0.0599, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0467, device='cuda:0'), 'train/removed_class_idx': 2.4074071844993346, 'train/uncertainty_avg': 0.7636027048521157, 'train/certain_ratio_ema': 0.7789906133175509, 'train/total_loss': tensor(0.1869, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.01269601906978279, 'train/prefecth_time': 0.019222591400146486, 'train/run_time': 0.5561277465820312, 'eval/loss': tensor(2.8454, device='cuda:0'), 'eval/top-1-acc': 0.66825, 'eval/top-5-acc': 0.96625, 'eval/precision': 0.6993651882822123, 'eval/recall': 0.66825, 'eval/F1': 0.6740628242030071, 'eval/AUC': 0.9116181423611109}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 13:51:25,307 INFO] confusion matrix:
[[0.95375 0.      0.0025  0.0025  0.0025  0.      0.0125  0.      0.01375
  0.0125 ]
 [0.06875 0.7575  0.      0.03625 0.00875 0.01    0.07    0.0475  0.00125
  0.     ]
 [0.02375 0.      0.83    0.00625 0.      0.      0.11625 0.0025  0.00125
  0.02   ]
 [0.00625 0.12    0.      0.4325  0.015   0.10375 0.26625 0.055   0.00125
  0.     ]
 [0.      0.01    0.      0.02625 0.70875 0.00875 0.2325  0.01375 0.
  0.     ]
 [0.0025  0.015   0.      0.2725  0.03625 0.49    0.17375 0.01    0.
  0.     ]
 [0.00125 0.005   0.00125 0.00875 0.67875 0.00875 0.29    0.      0.00125
  0.005  ]
 [0.00375 0.165   0.      0.09625 0.00375 0.00875 0.175   0.54625 0.
  0.00125]
 [0.0075  0.00125 0.      0.00125 0.      0.      0.01625 0.      0.9625
  0.01125]
 [0.00875 0.0025  0.06    0.0025  0.00125 0.      0.11125 0.      0.01
  0.80375]]
[2023-08-04 13:51:25,323 INFO] 866000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1293, device='cuda:0'), 'train/shrink_loss': tensor(0.0518, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0402, device='cuda:0'), 'train/removed_class_idx': 2.6274507227989488, 'train/uncertainty_avg': 0.7443720231541803, 'train/certain_ratio_ema': 0.7754958924517945, 'train/total_loss': tensor(0.1696, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.012660379904288347, 'train/prefecth_time': 0.01858131217956543, 'train/run_time': 0.5527512817382813, 'eval/loss': tensor(2.6087, device='cuda:0'), 'eval/top-1-acc': 0.6775, 'eval/top-5-acc': 0.968625, 'eval/precision': 0.7192086274185188, 'eval/recall': 0.6775, 'eval/F1': 0.6884021145963103, 'eval/AUC': 0.9186809461805554}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 14:01:22,827 INFO] confusion matrix:
[[0.93875 0.00125 0.0025  0.      0.00375 0.      0.02625 0.      0.01625
  0.01125]
 [0.065   0.7775  0.      0.01375 0.0075  0.01    0.07    0.055   0.00125
  0.     ]
 [0.01625 0.00125 0.84    0.      0.      0.      0.11375 0.00375 0.00125
  0.02375]
 [0.005   0.11    0.      0.2775  0.025   0.19875 0.26625 0.11625 0.
  0.00125]
 [0.      0.00875 0.      0.00625 0.73375 0.01    0.215   0.02625 0.
  0.     ]
 [0.00125 0.0225  0.      0.1525  0.04    0.585   0.17625 0.0225  0.
  0.     ]
 [0.00125 0.01    0.0025  0.      0.69375 0.01    0.27375 0.00125 0.00125
  0.00625]
 [0.0025  0.18875 0.      0.02375 0.00875 0.0175  0.17125 0.58625 0.
  0.00125]
 [0.005   0.00125 0.      0.00125 0.      0.      0.04    0.      0.94125
  0.01125]
 [0.01    0.00125 0.05375 0.      0.      0.      0.1125  0.0025  0.00875
  0.81125]]
[2023-08-04 14:01:22,842 INFO] 867000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.0591e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1721, device='cuda:0'), 'train/shrink_loss': tensor(0.0501, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0392, device='cuda:0'), 'train/removed_class_idx': 2.527472249728324, 'train/uncertainty_avg': 0.7470475442895652, 'train/certain_ratio_ema': 0.7811731855781948, 'train/total_loss': tensor(0.2113, device='cuda:0'), 'train/mask_ratio': tensor(0.7969, device='cuda:0'), 'lr': 0.012624718986617864, 'train/prefecth_time': 0.01975801658630371, 'train/run_time': 0.5522783203125, 'eval/loss': tensor(2.7342, device='cuda:0'), 'eval/top-1-acc': 0.6765, 'eval/top-5-acc': 0.969375, 'eval/precision': 0.7112859954263251, 'eval/recall': 0.6765000000000001, 'eval/F1': 0.6828305296477091, 'eval/AUC': 0.9093240017361113}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 14:11:21,311 INFO] confusion matrix:
[[0.955   0.00125 0.0025  0.      0.0025  0.      0.015   0.      0.015
  0.00875]
 [0.065   0.77875 0.      0.0125  0.0075  0.01    0.06125 0.06375 0.00125
  0.     ]
 [0.0125  0.      0.84625 0.      0.      0.      0.11375 0.0075  0.00125
  0.01875]
 [0.00375 0.1125  0.      0.3025  0.025   0.1525  0.2575  0.145   0.
  0.00125]
 [0.      0.00875 0.      0.00625 0.71625 0.01125 0.22375 0.03375 0.
  0.     ]
 [0.00125 0.025   0.      0.175   0.0325  0.54625 0.1725  0.0475  0.
  0.     ]
 [0.00125 0.00875 0.00375 0.      0.6825  0.01    0.2775  0.0075  0.0025
  0.00625]
 [0.00125 0.19    0.      0.02875 0.005   0.01625 0.17    0.5875  0.
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.      0.03375 0.00125 0.95
  0.00875]
 [0.015   0.00125 0.08    0.      0.      0.      0.1125  0.005   0.00875
  0.7775 ]]
[2023-08-04 14:11:21,333 INFO] 868000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.8692e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2015, device='cuda:0'), 'train/shrink_loss': tensor(0.0751, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0587, device='cuda:0'), 'train/removed_class_idx': 2.307017341489707, 'train/uncertainty_avg': 0.7542299097364508, 'train/certain_ratio_ema': 0.7818643165873339, 'train/total_loss': tensor(0.2602, device='cuda:0'), 'train/mask_ratio': tensor(0.7455, device='cuda:0'), 'lr': 0.012589036378041435, 'train/prefecth_time': 0.02847577667236328, 'train/run_time': 0.5576712036132813, 'eval/loss': tensor(2.8253, device='cuda:0'), 'eval/top-1-acc': 0.67375, 'eval/top-5-acc': 0.97025, 'eval/precision': 0.7056193822173477, 'eval/recall': 0.6737500000000001, 'eval/F1': 0.6797138417565305, 'eval/AUC': 0.9078249305555555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 14:21:21,055 INFO] confusion matrix:
[[0.95625 0.00125 0.00125 0.      0.0025  0.      0.01    0.      0.01875
  0.01   ]
 [0.06375 0.76125 0.      0.01375 0.01    0.01    0.07    0.07    0.00125
  0.     ]
 [0.02    0.      0.82125 0.      0.      0.      0.12875 0.00875 0.0025
  0.01875]
 [0.00375 0.11625 0.      0.34    0.0225  0.12625 0.255   0.135   0.00125
  0.     ]
 [0.      0.0075  0.00125 0.01125 0.695   0.01125 0.2425  0.03125 0.
  0.     ]
 [0.00125 0.0275  0.      0.23125 0.0325  0.47625 0.18    0.05125 0.
  0.     ]
 [0.0025  0.00875 0.005   0.0025  0.66125 0.01125 0.29875 0.00375 0.0025
  0.00375]
 [0.0025  0.19    0.      0.02625 0.0075  0.01375 0.175   0.58375 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0275  0.0025  0.9525
  0.01125]
 [0.01    0.00125 0.07375 0.      0.      0.      0.1175  0.00375 0.01
  0.78375]]
[2023-08-04 14:21:21,076 INFO] 869000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.4282e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1480, device='cuda:0'), 'train/shrink_loss': tensor(0.0536, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0418, device='cuda:0'), 'train/removed_class_idx': 2.672727029752088, 'train/uncertainty_avg': 0.7488428071764516, 'train/certain_ratio_ema': 0.7798943778847218, 'train/total_loss': tensor(0.1899, device='cuda:0'), 'train/mask_ratio': tensor(0.7545, device='cuda:0'), 'lr': 0.012553332139866402, 'train/prefecth_time': 0.019122335433959962, 'train/run_time': 0.5636677856445312, 'eval/loss': tensor(2.9173, device='cuda:0'), 'eval/top-1-acc': 0.666875, 'eval/top-5-acc': 0.969875, 'eval/precision': 0.7017239030952439, 'eval/recall': 0.6668749999999999, 'eval/F1': 0.674837791357955, 'eval/AUC': 0.9073787673611111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 14:31:12,836 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 14:31:23,353 INFO] confusion matrix:
[[0.9525  0.00125 0.      0.      0.0025  0.      0.0125  0.      0.01625
  0.015  ]
 [0.065   0.78    0.      0.04625 0.0075  0.00875 0.065   0.02625 0.00125
  0.     ]
 [0.02125 0.      0.81875 0.00125 0.      0.00125 0.1275  0.00375 0.005
  0.02125]
 [0.00375 0.1175  0.      0.47125 0.015   0.11625 0.25875 0.01625 0.00125
  0.     ]
 [0.      0.00625 0.      0.02875 0.70125 0.01125 0.24125 0.01125 0.
  0.     ]
 [0.00125 0.0325  0.      0.27    0.02875 0.46875 0.18625 0.0125  0.
  0.     ]
 [0.      0.01125 0.00375 0.005   0.6625  0.01125 0.3     0.      0.00125
  0.005  ]
 [0.0025  0.1975  0.      0.11375 0.005   0.01625 0.17    0.49375 0.
  0.00125]
 [0.005   0.      0.      0.0025  0.      0.      0.01875 0.      0.96
  0.01375]
 [0.01375 0.00125 0.07625 0.00125 0.      0.      0.10125 0.0025  0.00875
  0.795  ]]
[2023-08-04 14:31:23,375 INFO] 870000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1786, device='cuda:0'), 'train/shrink_loss': tensor(0.0818, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0638, device='cuda:0'), 'train/removed_class_idx': 2.442477659957729, 'train/uncertainty_avg': 0.7658953532202487, 'train/certain_ratio_ema': 0.7796647103117442, 'train/total_loss': tensor(0.2429, device='cuda:0'), 'train/mask_ratio': tensor(0.7478, device='cuda:0'), 'lr': 0.012517606333437292, 'train/prefecth_time': 0.020417152404785158, 'train/run_time': 0.5938318481445313, 'eval/loss': tensor(2.8905, device='cuda:0'), 'eval/top-1-acc': 0.674125, 'eval/top-5-acc': 0.96725, 'eval/precision': 0.7193491888736627, 'eval/recall': 0.674125, 'eval/F1': 0.6844148006791848, 'eval/AUC': 0.9073115798611111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 14:41:23,129 INFO] confusion matrix:
[[0.955   0.00125 0.      0.00125 0.0025  0.      0.01    0.00125 0.0175
  0.01125]
 [0.06375 0.77625 0.      0.0175  0.0075  0.00875 0.06125 0.06375 0.00125
  0.     ]
 [0.02125 0.00125 0.8175  0.      0.      0.      0.12375 0.01    0.0025
  0.02375]
 [0.00375 0.1325  0.      0.31    0.025   0.12125 0.25625 0.15    0.00125
  0.     ]
 [0.      0.0075  0.      0.00625 0.70625 0.01125 0.23875 0.03    0.
  0.     ]
 [0.00125 0.03625 0.      0.18625 0.03375 0.4925  0.185   0.065   0.
  0.     ]
 [0.00125 0.0075  0.00125 0.00125 0.6725  0.00875 0.295   0.005   0.00125
  0.00625]
 [0.00125 0.185   0.      0.02875 0.005   0.01375 0.16625 0.5975  0.00125
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.015   0.      0.9675
  0.01   ]
 [0.0125  0.00125 0.0625  0.00125 0.      0.      0.0925  0.0025  0.01
  0.8175 ]]
[2023-08-04 14:41:23,154 INFO] 871000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.1977e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1747, device='cuda:0'), 'train/shrink_loss': tensor(0.0607, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0474, device='cuda:0'), 'train/removed_class_idx': 2.3913040879017293, 'train/uncertainty_avg': 0.7724026450724315, 'train/certain_ratio_ema': 0.7819758207235876, 'train/total_loss': tensor(0.2222, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.012481859020135672, 'train/prefecth_time': 0.01857711982727051, 'train/run_time': 0.5673887939453125, 'eval/loss': tensor(2.8000, device='cuda:0'), 'eval/top-1-acc': 0.6735, 'eval/top-5-acc': 0.9695, 'eval/precision': 0.7050600081481905, 'eval/recall': 0.6735, 'eval/F1': 0.6788525616070114, 'eval/AUC': 0.9119386631944446}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 14:51:38,762 INFO] confusion matrix:
[[0.95625 0.0025  0.      0.      0.0025  0.      0.01125 0.      0.01625
  0.01125]
 [0.0625  0.795   0.      0.025   0.0075  0.01    0.06375 0.0325  0.00375
  0.     ]
 [0.02    0.0025  0.81125 0.      0.      0.00125 0.13375 0.00125 0.00125
  0.02875]
 [0.005   0.115   0.      0.38125 0.0275  0.1475  0.27375 0.0375  0.00125
  0.01125]
 [0.      0.00625 0.      0.01375 0.715   0.01125 0.2375  0.01625 0.
  0.     ]
 [0.00125 0.03625 0.      0.22375 0.03625 0.4975  0.19625 0.00875 0.
  0.     ]
 [0.00125 0.0075  0.00125 0.0025  0.665   0.0075  0.3075  0.      0.00125
  0.00625]
 [0.0025  0.22875 0.      0.0525  0.0125  0.02    0.18125 0.4925  0.0025
  0.0075 ]
 [0.005   0.      0.      0.      0.      0.      0.0175  0.      0.9675
  0.01   ]
 [0.015   0.0025  0.06625 0.      0.00125 0.      0.09125 0.00125 0.01375
  0.80875]]
[2023-08-04 14:51:38,780 INFO] 872000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.0036e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1613, device='cuda:0'), 'train/shrink_loss': tensor(0.0652, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0510, device='cuda:0'), 'train/removed_class_idx': 2.5353532792572446, 'train/uncertainty_avg': 0.7590706186758646, 'train/certain_ratio_ema': 0.7814804273585332, 'train/total_loss': tensor(0.2123, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.012446090261380065, 'train/prefecth_time': 0.024703359603881835, 'train/run_time': 0.5516312866210937, 'eval/loss': tensor(2.7648, device='cuda:0'), 'eval/top-1-acc': 0.67325, 'eval/top-5-acc': 0.97225, 'eval/precision': 0.7144483471760923, 'eval/recall': 0.6732500000000001, 'eval/F1': 0.6814149037903863, 'eval/AUC': 0.9121530381944445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 15:01:39,969 INFO] confusion matrix:
[[0.95    0.0025  0.      0.00125 0.0025  0.      0.015   0.      0.02
  0.00875]
 [0.06375 0.80375 0.      0.02375 0.00625 0.00875 0.06875 0.02375 0.00125
  0.     ]
 [0.02375 0.      0.81125 0.0075  0.      0.      0.14    0.00125 0.0025
  0.01375]
 [0.005   0.13    0.      0.38125 0.0225  0.1525  0.2725  0.035   0.00125
  0.     ]
 [0.      0.00625 0.      0.01625 0.71375 0.0125  0.235   0.01625 0.
  0.     ]
 [0.00125 0.03125 0.      0.1475  0.03875 0.5675  0.1975  0.01625 0.
  0.     ]
 [0.00125 0.005   0.00125 0.00375 0.66125 0.00875 0.30875 0.00125 0.0025
  0.00625]
 [0.00125 0.19375 0.      0.05125 0.00625 0.01    0.17625 0.56    0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.0175  0.      0.96875
  0.00875]
 [0.0175  0.0025  0.09375 0.0025  0.      0.      0.10375 0.      0.01375
  0.76625]]
[2023-08-04 15:01:40,005 INFO] 873000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.7209e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1768, device='cuda:0'), 'train/shrink_loss': tensor(0.0411, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0321, device='cuda:0'), 'train/removed_class_idx': 2.3939391521273583, 'train/uncertainty_avg': 0.7722361174739241, 'train/certain_ratio_ema': 0.7826110188622475, 'train/total_loss': tensor(0.2090, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.012410300118625846, 'train/prefecth_time': 0.025905439376831055, 'train/run_time': 0.5495643310546875, 'eval/loss': tensor(2.6631, device='cuda:0'), 'eval/top-1-acc': 0.683125, 'eval/top-5-acc': 0.970375, 'eval/precision': 0.7275783875113647, 'eval/recall': 0.6831250000000001, 'eval/F1': 0.6936059404538109, 'eval/AUC': 0.9163855989583334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 15:12:27,981 INFO] confusion matrix:
[[0.95    0.00125 0.      0.00125 0.0025  0.      0.01625 0.      0.01625
  0.0125 ]
 [0.065   0.79625 0.      0.0175  0.0075  0.00875 0.06375 0.04    0.00125
  0.     ]
 [0.03125 0.0025  0.81375 0.      0.      0.      0.13125 0.00125 0.0025
  0.0175 ]
 [0.005   0.15375 0.      0.285   0.03    0.17375 0.26125 0.09    0.00125
  0.     ]
 [0.00125 0.0075  0.      0.01125 0.70125 0.01875 0.2375  0.0225  0.
  0.     ]
 [0.0025  0.03125 0.      0.01625 0.04125 0.6825  0.17125 0.055   0.
  0.     ]
 [0.00125 0.00875 0.00125 0.      0.665   0.0075  0.31    0.      0.00125
  0.005  ]
 [0.00125 0.18375 0.      0.035   0.00625 0.01625 0.1625  0.59375 0.
  0.00125]
 [0.00875 0.      0.      0.      0.      0.      0.01875 0.      0.9625
  0.01   ]
 [0.0175  0.00125 0.11125 0.00125 0.      0.      0.11625 0.0025  0.0125
  0.7375 ]]
[2023-08-04 15:12:28,020 INFO] 874000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.2141, device='cuda:0'), 'train/shrink_loss': tensor(0.0717, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0562, device='cuda:0'), 'train/removed_class_idx': 2.4226801626102925, 'train/uncertainty_avg': 0.7743404188643014, 'train/certain_ratio_ema': 0.7840786395036271, 'train/total_loss': tensor(0.2704, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.012374488653365118, 'train/prefecth_time': 0.020441055297851562, 'train/run_time': 0.5506370849609376, 'eval/loss': tensor(2.6614, device='cuda:0'), 'eval/top-1-acc': 0.68325, 'eval/top-5-acc': 0.9715, 'eval/precision': 0.7288017943627831, 'eval/recall': 0.68325, 'eval/F1': 0.6886759256786894, 'eval/AUC': 0.9185407725694443}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 15:22:22,982 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 15:22:34,020 INFO] confusion matrix:
[[0.95125 0.0025  0.      0.00125 0.0025  0.      0.0175  0.      0.015
  0.01   ]
 [0.0625  0.8     0.      0.0175  0.00625 0.0075  0.06125 0.04375 0.00125
  0.     ]
 [0.00625 0.00125 0.8575  0.      0.      0.      0.11    0.0025  0.0025
  0.02   ]
 [0.00375 0.1475  0.      0.2625  0.01625 0.175   0.25625 0.1375  0.00125
  0.     ]
 [0.      0.01    0.      0.00875 0.69625 0.0225  0.23375 0.02875 0.
  0.     ]
 [0.00125 0.03375 0.      0.05    0.03    0.66875 0.165   0.05125 0.
  0.     ]
 [0.00125 0.0125  0.00125 0.00125 0.6375  0.015   0.32125 0.0025  0.0025
  0.005  ]
 [0.00125 0.20125 0.      0.02875 0.005   0.01375 0.16375 0.585   0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01875 0.      0.96625
  0.01   ]
 [0.01125 0.00125 0.08375 0.      0.      0.      0.09375 0.00375 0.0125
  0.79375]]
[2023-08-04 15:22:34,051 INFO] 875000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.1162e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1757, device='cuda:0'), 'train/shrink_loss': tensor(0.0806, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0631, device='cuda:0'), 'train/removed_class_idx': 2.5510201478550867, 'train/uncertainty_avg': 0.7337600685476577, 'train/certain_ratio_ema': 0.7823467555183043, 'train/total_loss': tensor(0.2388, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.01233865592712664, 'train/prefecth_time': 0.019471424102783203, 'train/run_time': 0.57009912109375, 'eval/loss': tensor(2.5427, device='cuda:0'), 'eval/top-1-acc': 0.69025, 'eval/top-5-acc': 0.972875, 'eval/precision': 0.7249448341659973, 'eval/recall': 0.69025, 'eval/F1': 0.6928039705665227, 'eval/AUC': 0.9218459635416666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 15:32:36,243 INFO] confusion matrix:
[[0.95125 0.00125 0.00125 0.0025  0.0025  0.      0.0125  0.      0.02
  0.00875]
 [0.06375 0.7875  0.      0.02375 0.005   0.01    0.0625  0.045   0.0025
  0.     ]
 [0.0025  0.      0.86125 0.      0.00125 0.      0.1025  0.005   0.00125
  0.02625]
 [0.00375 0.1425  0.      0.28625 0.01125 0.1575  0.2625  0.135   0.00125
  0.     ]
 [0.      0.01    0.      0.01    0.6825  0.02    0.2425  0.035   0.
  0.     ]
 [0.00125 0.03    0.      0.02    0.02625 0.70375 0.16625 0.05125 0.00125
  0.     ]
 [0.00125 0.0125  0.00125 0.00125 0.61125 0.02    0.3375  0.00625 0.0025
  0.00625]
 [0.00125 0.185   0.      0.07875 0.0025  0.01875 0.17375 0.53875 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01875 0.      0.9675
  0.00875]
 [0.00625 0.00125 0.0675  0.      0.      0.      0.07625 0.0025  0.0125
  0.83375]]
[2023-08-04 15:32:36,272 INFO] 876000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.9644e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1447, device='cuda:0'), 'train/shrink_loss': tensor(0.0641, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0501, device='cuda:0'), 'train/removed_class_idx': 2.4945052203840414, 'train/uncertainty_avg': 0.7473205692299211, 'train/certain_ratio_ema': 0.7814609973781271, 'train/total_loss': tensor(0.1948, device='cuda:0'), 'train/mask_ratio': tensor(0.7969, device='cuda:0'), 'lr': 0.012302802001475677, 'train/prefecth_time': 0.019338144302368163, 'train/run_time': 0.5575648803710938, 'eval/loss': tensor(2.5175, device='cuda:0'), 'eval/top-1-acc': 0.695, 'eval/top-5-acc': 0.9695, 'eval/precision': 0.7249669943353374, 'eval/recall': 0.6950000000000001, 'eval/F1': 0.6981767171200248, 'eval/AUC': 0.9247930642361112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 15:42:53,625 INFO] confusion matrix:
[[0.95375 0.0025  0.0025  0.00125 0.0025  0.      0.01125 0.      0.01625
  0.01   ]
 [0.065   0.805   0.      0.0275  0.00375 0.00875 0.06375 0.0225  0.00375
  0.     ]
 [0.00125 0.      0.8375  0.      0.0025  0.      0.1125  0.00375 0.0025
  0.04   ]
 [0.00375 0.11875 0.      0.35875 0.01125 0.16    0.26375 0.0825  0.00125
  0.     ]
 [0.      0.00875 0.      0.02125 0.67625 0.01375 0.2575  0.02125 0.00125
  0.     ]
 [0.00125 0.03625 0.      0.0575  0.03    0.685   0.17625 0.01125 0.0025
  0.     ]
 [0.0025  0.01    0.      0.00375 0.625   0.0175  0.32875 0.00125 0.0025
  0.00875]
 [0.00125 0.21375 0.      0.06375 0.005   0.01875 0.1675  0.52625 0.00125
  0.0025 ]
 [0.005   0.      0.      0.      0.      0.      0.02    0.00125 0.965
  0.00875]
 [0.01    0.00125 0.07125 0.      0.      0.      0.08    0.0025  0.01125
  0.82375]]
[2023-08-04 15:42:53,654 INFO] 877000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.3027e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1721, device='cuda:0'), 'train/shrink_loss': tensor(0.0914, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0711, device='cuda:0'), 'train/removed_class_idx': 2.4677417364724406, 'train/uncertainty_avg': 0.7537781276707761, 'train/certain_ratio_ema': 0.7777939992543609, 'train/total_loss': tensor(0.2432, device='cuda:0'), 'train/mask_ratio': tensor(0.7232, device='cuda:0'), 'lr': 0.012266926938013924, 'train/prefecth_time': 0.022255359649658205, 'train/run_time': 0.5889212646484375, 'eval/loss': tensor(2.3771, device='cuda:0'), 'eval/top-1-acc': 0.696, 'eval/top-5-acc': 0.97625, 'eval/precision': 0.7318441070539289, 'eval/recall': 0.6960000000000001, 'eval/F1': 0.7029882761082491, 'eval/AUC': 0.9276406163194444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 15:52:58,085 INFO] confusion matrix:
[[0.96    0.00375 0.00125 0.00125 0.0025  0.      0.0125  0.      0.00875
  0.01   ]
 [0.0625  0.81    0.      0.0275  0.00125 0.01    0.0575  0.03125 0.
  0.     ]
 [0.00125 0.0025  0.83875 0.      0.0025  0.      0.1125  0.0025  0.00125
  0.03875]
 [0.00375 0.15    0.      0.33625 0.0125  0.18    0.255   0.04375 0.01875
  0.     ]
 [0.      0.0125  0.      0.0125  0.6825  0.01625 0.24625 0.0275  0.
  0.0025 ]
 [0.00125 0.0525  0.      0.03375 0.02625 0.6925  0.17    0.0225  0.
  0.00125]
 [0.00125 0.01    0.00125 0.00375 0.645   0.01375 0.305   0.00375 0.0025
  0.01375]
 [0.00125 0.1975  0.      0.06375 0.00375 0.01625 0.16    0.54375 0.0125
  0.00125]
 [0.005   0.      0.      0.0025  0.      0.      0.02125 0.      0.9625
  0.00875]
 [0.00875 0.00125 0.08    0.00125 0.      0.      0.07875 0.00125 0.01125
  0.8175 ]]
[2023-08-04 15:52:58,114 INFO] 878000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.0091e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1399, device='cuda:0'), 'train/shrink_loss': tensor(0.0623, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0485, device='cuda:0'), 'train/removed_class_idx': 2.5102038254894055, 'train/uncertainty_avg': 0.7337979625008123, 'train/certain_ratio_ema': 0.7792489656197866, 'train/total_loss': tensor(0.1884, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.01223103079837941, 'train/prefecth_time': 0.019788063049316407, 'train/run_time': 0.5505093994140625, 'eval/loss': tensor(2.4952, device='cuda:0'), 'eval/top-1-acc': 0.694875, 'eval/top-5-acc': 0.973875, 'eval/precision': 0.7300439471798343, 'eval/recall': 0.694875, 'eval/F1': 0.6999844335180267, 'eval/AUC': 0.9237600954861112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 16:03:00,116 INFO] confusion matrix:
[[0.9575  0.0025  0.      0.      0.00375 0.00125 0.0125  0.      0.01125
  0.01125]
 [0.0625  0.78    0.      0.03375 0.00625 0.00875 0.06125 0.0475  0.
  0.     ]
 [0.00375 0.00375 0.86375 0.00125 0.      0.      0.0975  0.0025  0.
  0.0275 ]
 [0.00375 0.14625 0.      0.345   0.01    0.1775  0.2475  0.05875 0.01125
  0.     ]
 [0.      0.0125  0.00125 0.01    0.69    0.01625 0.2375  0.0325  0.
  0.     ]
 [0.00125 0.0575  0.      0.14125 0.0325  0.54375 0.18125 0.0425  0.
  0.     ]
 [0.00125 0.01125 0.      0.00625 0.64    0.01375 0.30875 0.00375 0.0025
  0.0125 ]
 [0.      0.19    0.      0.0725  0.00375 0.02875 0.16    0.53625 0.0075
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.      0.02125 0.      0.96
  0.0125 ]
 [0.0075  0.00125 0.1025  0.00125 0.      0.      0.095   0.00125 0.00875
  0.7825 ]]
[2023-08-04 16:03:00,144 INFO] 879000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.2001, device='cuda:0'), 'train/shrink_loss': tensor(0.0793, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0619, device='cuda:0'), 'train/removed_class_idx': 2.330188459416183, 'train/uncertainty_avg': 0.7530643952099556, 'train/certain_ratio_ema': 0.7809404186988225, 'train/total_loss': tensor(0.2622, device='cuda:0'), 'train/mask_ratio': tensor(0.7634, device='cuda:0'), 'lr': 0.012195113644246353, 'train/prefecth_time': 0.020056703567504882, 'train/run_time': 0.5532523803710937, 'eval/loss': tensor(2.6414, device='cuda:0'), 'eval/top-1-acc': 0.67675, 'eval/top-5-acc': 0.977375, 'eval/precision': 0.704664310950718, 'eval/recall': 0.67675, 'eval/F1': 0.681997153989834, 'eval/AUC': 0.9162988628472222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 16:12:52,766 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 16:13:15,500 INFO] confusion matrix:
[[0.95375 0.00125 0.      0.0025  0.00375 0.      0.01375 0.      0.01375
  0.01125]
 [0.06375 0.75    0.      0.03875 0.005   0.00875 0.065   0.065   0.0025
  0.00125]
 [0.00375 0.      0.865   0.00125 0.      0.      0.1025  0.0025  0.
  0.025  ]
 [0.00375 0.105   0.      0.365   0.01    0.14625 0.26125 0.1075  0.00125
  0.     ]
 [0.      0.00875 0.00125 0.0175  0.6725  0.01125 0.24375 0.04375 0.
  0.00125]
 [0.00125 0.035   0.      0.05375 0.025   0.59    0.2     0.095   0.
  0.     ]
 [0.0025  0.0075  0.      0.01    0.615   0.01375 0.33375 0.0025  0.0025
  0.0125 ]
 [0.      0.1675  0.      0.10875 0.0025  0.0125  0.17875 0.52875 0.
  0.00125]
 [0.00375 0.      0.      0.0025  0.      0.      0.01625 0.      0.96625
  0.01125]
 [0.01    0.00125 0.11625 0.00125 0.      0.      0.10125 0.00125 0.01
  0.75875]]
[2023-08-04 16:13:15,540 INFO] 880000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1413, device='cuda:0'), 'train/shrink_loss': tensor(0.0766, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0600, device='cuda:0'), 'train/removed_class_idx': 2.3663363993726336, 'train/uncertainty_avg': 0.763172678700102, 'train/certain_ratio_ema': 0.7836563315106936, 'train/total_loss': tensor(0.2018, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.01215917553732508, 'train/prefecth_time': 0.020556831359863283, 'train/run_time': 0.55362060546875, 'eval/loss': tensor(2.6772, device='cuda:0'), 'eval/top-1-acc': 0.678375, 'eval/top-5-acc': 0.971, 'eval/precision': 0.7094729247007192, 'eval/recall': 0.6783750000000001, 'eval/F1': 0.686197847529702, 'eval/AUC': 0.9164359982638888}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 16:23:21,747 INFO] confusion matrix:
[[0.945   0.0025  0.      0.00125 0.005   0.00125 0.02125 0.      0.0125
  0.01125]
 [0.06    0.7725  0.      0.0175  0.00375 0.00875 0.075   0.06125 0.00125
  0.     ]
 [0.00125 0.      0.86    0.00125 0.00125 0.      0.1075  0.00375 0.
  0.025  ]
 [0.0025  0.11875 0.      0.2425  0.01125 0.13875 0.2675  0.2175  0.00125
  0.     ]
 [0.      0.00875 0.00125 0.01    0.68375 0.01125 0.245   0.04    0.
  0.     ]
 [0.      0.03875 0.      0.05    0.025   0.59875 0.18625 0.10125 0.
  0.     ]
 [0.00125 0.00875 0.      0.0075  0.63125 0.0125  0.3225  0.00375 0.0025
  0.01   ]
 [0.00125 0.205   0.      0.04125 0.00375 0.015   0.17625 0.55625 0.
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.      0.02875 0.      0.95375
  0.01125]
 [0.01    0.00125 0.10375 0.00125 0.00125 0.      0.115   0.00125 0.01
  0.75625]]
[2023-08-04 16:23:21,791 INFO] 881000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.5981e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2009, device='cuda:0'), 'train/shrink_loss': tensor(0.0644, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0501, device='cuda:0'), 'train/removed_class_idx': 2.5428569006802952, 'train/uncertainty_avg': 0.74693460503372, 'train/certain_ratio_ema': 0.7771471177738244, 'train/total_loss': tensor(0.2510, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.012123216539361938, 'train/prefecth_time': 0.018941856384277343, 'train/run_time': 0.5544327392578124, 'eval/loss': tensor(2.7780, device='cuda:0'), 'eval/top-1-acc': 0.669125, 'eval/top-5-acc': 0.967375, 'eval/precision': 0.7064288505251424, 'eval/recall': 0.669125, 'eval/F1': 0.6735963989019184, 'eval/AUC': 0.9139445746527778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 16:33:30,141 INFO] confusion matrix:
[[0.95    0.0025  0.0025  0.      0.00125 0.      0.02    0.0025  0.0125
  0.00875]
 [0.06625 0.7625  0.      0.005   0.005   0.00875 0.07875 0.0725  0.00125
  0.     ]
 [0.00125 0.      0.875   0.      0.00125 0.      0.0975  0.01    0.
  0.015  ]
 [0.00375 0.08375 0.      0.18625 0.01125 0.14875 0.26625 0.29875 0.00125
  0.     ]
 [0.      0.00875 0.00125 0.005   0.69625 0.01375 0.23375 0.04    0.
  0.00125]
 [0.00125 0.04625 0.      0.11875 0.03125 0.56625 0.185   0.05125 0.
  0.     ]
 [0.      0.00875 0.00125 0.005   0.6475  0.01125 0.3125  0.005   0.0025
  0.00625]
 [0.00125 0.2425  0.      0.0175  0.00375 0.0125  0.185   0.53625 0.
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.      0.02875 0.      0.9525
  0.0125 ]
 [0.00875 0.00125 0.105   0.00125 0.      0.      0.1     0.00125 0.01
  0.7725 ]]
[2023-08-04 16:33:30,169 INFO] 882000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.4221e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2061, device='cuda:0'), 'train/shrink_loss': tensor(0.0545, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0424, device='cuda:0'), 'train/removed_class_idx': 2.384615155325466, 'train/uncertainty_avg': 0.7795956316507533, 'train/certain_ratio_ema': 0.7781044557941877, 'train/total_loss': tensor(0.2485, device='cuda:0'), 'train/mask_ratio': tensor(0.7679, device='cuda:0'), 'lr': 0.01208723671213914, 'train/prefecth_time': 0.018412351608276367, 'train/run_time': 0.5549591064453125, 'eval/loss': tensor(2.7456, device='cuda:0'), 'eval/top-1-acc': 0.661, 'eval/top-5-acc': 0.971125, 'eval/precision': 0.6904511336637233, 'eval/recall': 0.6609999999999999, 'eval/F1': 0.6616222197373756, 'eval/AUC': 0.916960425347222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 16:43:31,181 INFO] confusion matrix:
[[0.95    0.00125 0.00125 0.      0.00125 0.      0.0225  0.      0.015
  0.00875]
 [0.065   0.8     0.      0.03125 0.00625 0.0075  0.07625 0.0125  0.00125
  0.     ]
 [0.00125 0.00125 0.88    0.00125 0.00125 0.      0.09375 0.0025  0.
  0.01875]
 [0.0025  0.11875 0.00125 0.41    0.01125 0.1675  0.255   0.0325  0.00125
  0.     ]
 [0.      0.01125 0.      0.0275  0.70875 0.01    0.22625 0.01625 0.
  0.     ]
 [0.00125 0.0375  0.      0.13625 0.03625 0.61    0.17375 0.005   0.
  0.     ]
 [0.00125 0.01    0.00125 0.00625 0.6525  0.01125 0.30625 0.00125 0.00125
  0.00875]
 [0.00125 0.365   0.      0.1     0.005   0.0225  0.17625 0.32875 0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.0575  0.      0.925
  0.01   ]
 [0.01625 0.00125 0.105   0.0025  0.      0.      0.09875 0.      0.0125
  0.76375]]
[2023-08-04 16:43:31,213 INFO] 883000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.3785e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1616, device='cuda:0'), 'train/shrink_loss': tensor(0.0420, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0333, device='cuda:0'), 'train/removed_class_idx': 2.333333009259304, 'train/uncertainty_avg': 0.7506812997630709, 'train/certain_ratio_ema': 0.7932722076356992, 'train/total_loss': tensor(0.1949, device='cuda:0'), 'train/mask_ratio': tensor(0.8393, device='cuda:0'), 'lr': 0.012051236117474712, 'train/prefecth_time': 0.02412063980102539, 'train/run_time': 0.5558795776367188, 'eval/loss': tensor(2.5960, device='cuda:0'), 'eval/top-1-acc': 0.66825, 'eval/top-5-acc': 0.9755, 'eval/precision': 0.7139339007893504, 'eval/recall': 0.66825, 'eval/F1': 0.6731504804833531, 'eval/AUC': 0.9171912847222224}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 16:53:34,444 INFO] confusion matrix:
[[0.94375 0.0025  0.00125 0.      0.00125 0.      0.02625 0.      0.01375
  0.01125]
 [0.06125 0.7825  0.      0.0375  0.005   0.00875 0.0725  0.03125 0.00125
  0.     ]
 [0.0025  0.0025  0.87    0.0025  0.00125 0.      0.0925  0.0025  0.00125
  0.025  ]
 [0.00625 0.1075  0.00125 0.3975  0.01875 0.155   0.24625 0.06625 0.00125
  0.     ]
 [0.00125 0.0075  0.      0.0175  0.70375 0.0125  0.23    0.0275  0.
  0.     ]
 [0.00125 0.03625 0.      0.02875 0.03125 0.72625 0.15625 0.02    0.
  0.     ]
 [0.      0.01    0.00125 0.00125 0.6425  0.0125  0.3175  0.0025  0.0025
  0.01   ]
 [0.00125 0.23125 0.      0.055   0.005   0.0225  0.16125 0.5225  0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.06125 0.      0.91875
  0.0125 ]
 [0.0075  0.00125 0.11    0.00125 0.      0.      0.09875 0.00125 0.01125
  0.76875]]
[2023-08-04 16:53:34,481 INFO] 884000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2019e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1381, device='cuda:0'), 'train/shrink_loss': tensor(0.0489, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0387, device='cuda:0'), 'train/removed_class_idx': 2.369047337018174, 'train/uncertainty_avg': 0.7658877645967656, 'train/certain_ratio_ema': 0.7905622831168841, 'train/total_loss': tensor(0.1768, device='cuda:0'), 'train/mask_ratio': tensor(0.8125, device='cuda:0'), 'lr': 0.012015214817222342, 'train/prefecth_time': 0.02141744041442871, 'train/run_time': 0.5458123168945312, 'eval/loss': tensor(2.4068, device='cuda:0'), 'eval/top-1-acc': 0.695125, 'eval/top-5-acc': 0.98, 'eval/precision': 0.7356209606051303, 'eval/recall': 0.695125, 'eval/F1': 0.7038498855306511, 'eval/AUC': 0.9252645052083331}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 17:03:29,415 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 17:03:53,016 INFO] confusion matrix:
[[0.9475  0.00125 0.00125 0.      0.0025  0.      0.0225  0.      0.01375
  0.01125]
 [0.05875 0.77875 0.      0.00125 0.005   0.00875 0.07375 0.06875 0.005
  0.     ]
 [0.0025  0.00125 0.86625 0.      0.      0.      0.0975  0.00625 0.0025
  0.02375]
 [0.00375 0.15125 0.00125 0.21625 0.02625 0.16625 0.2575  0.175   0.0025
  0.     ]
 [0.      0.0075  0.      0.      0.71    0.0125  0.23625 0.0325  0.00125
  0.     ]
 [0.00125 0.0325  0.      0.02    0.0375  0.705   0.17375 0.02625 0.00375
  0.     ]
 [0.00125 0.0075  0.00125 0.      0.62375 0.01875 0.33125 0.0025  0.0025
  0.01125]
 [0.0025  0.27125 0.      0.00125 0.01    0.025   0.17375 0.515   0.
  0.00125]
 [0.0075  0.      0.      0.      0.      0.      0.04125 0.      0.9425
  0.00875]
 [0.01    0.00125 0.13    0.      0.      0.      0.10375 0.0025  0.01
  0.7425 ]]
[2023-08-04 17:03:53,124 INFO] 885000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0018, device='cuda:0'), 'train/certain_loss': tensor(0.1242, device='cuda:0'), 'train/shrink_loss': tensor(0.0911, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0723, device='cuda:0'), 'train/removed_class_idx': 2.6018516109396654, 'train/uncertainty_avg': 0.7326627749423096, 'train/certain_ratio_ema': 0.7944840468687169, 'train/total_loss': tensor(0.1983, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.011979172873271294, 'train/prefecth_time': 0.01832815933227539, 'train/run_time': 0.5566715087890625, 'eval/loss': tensor(2.6669, device='cuda:0'), 'eval/top-1-acc': 0.6755, 'eval/top-5-acc': 0.97675, 'eval/precision': 0.7292248666728998, 'eval/recall': 0.6755, 'eval/F1': 0.67570865660893, 'eval/AUC': 0.9177921354166667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 17:14:02,371 INFO] confusion matrix:
[[0.94375 0.0025  0.      0.00125 0.00125 0.      0.0225  0.00125 0.015
  0.0125 ]
 [0.05875 0.7925  0.      0.04625 0.005   0.0075  0.0775  0.00875 0.00375
  0.     ]
 [0.00125 0.      0.8525  0.00625 0.      0.      0.11    0.00125 0.00125
  0.0275 ]
 [0.00375 0.145   0.      0.42625 0.02375 0.14125 0.255   0.00375 0.00125
  0.     ]
 [0.      0.0075  0.      0.025   0.71    0.01    0.2375  0.0075  0.00125
  0.00125]
 [0.00125 0.04    0.      0.23375 0.035   0.505   0.18125 0.00125 0.0025
  0.     ]
 [0.0025  0.01125 0.00125 0.005   0.64375 0.01125 0.3075  0.      0.0025
  0.015  ]
 [0.00125 0.33125 0.      0.19875 0.01875 0.02625 0.165   0.2575  0.
  0.00125]
 [0.00625 0.      0.      0.0025  0.      0.      0.03125 0.      0.95125
  0.00875]
 [0.00875 0.0025  0.11    0.00125 0.      0.      0.0975  0.      0.01
  0.77   ]]
[2023-08-04 17:14:02,405 INFO] 886000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.7982e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1350, device='cuda:0'), 'train/shrink_loss': tensor(0.0398, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0317, device='cuda:0'), 'train/removed_class_idx': 2.4687497428385683, 'train/uncertainty_avg': 0.7362394428995241, 'train/certain_ratio_ema': 0.7958217255752841, 'train/total_loss': tensor(0.1668, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.011943110347546318, 'train/prefecth_time': 0.04035430526733398, 'train/run_time': 0.5892880859375, 'eval/loss': tensor(2.8483, device='cuda:0'), 'eval/top-1-acc': 0.651625, 'eval/top-5-acc': 0.974, 'eval/precision': 0.7067798564648322, 'eval/recall': 0.6516249999999999, 'eval/F1': 0.6537714633881581, 'eval/AUC': 0.9087002951388888}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 17:24:11,137 INFO] confusion matrix:
[[0.94625 0.00375 0.      0.00125 0.00125 0.      0.02    0.00125 0.01375
  0.0125 ]
 [0.05875 0.76875 0.      0.06    0.005   0.0075  0.08    0.01375 0.005
  0.00125]
 [0.      0.      0.84125 0.005   0.      0.      0.12125 0.005   0.00125
  0.02625]
 [0.0025  0.1325  0.      0.40125 0.015   0.1775  0.25375 0.01625 0.00125
  0.     ]
 [0.      0.01125 0.      0.0175  0.70125 0.01125 0.2425  0.0125  0.00125
  0.0025 ]
 [0.00125 0.0375  0.      0.0625  0.03    0.69375 0.17    0.00125 0.00375
  0.     ]
 [0.0025  0.0075  0.      0.00875 0.63875 0.01    0.31875 0.      0.0025
  0.01125]
 [0.00125 0.26375 0.      0.20625 0.015   0.02875 0.1725  0.31125 0.
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.      0.0275  0.      0.95875
  0.0075 ]
 [0.00875 0.0025  0.08625 0.0025  0.      0.      0.10875 0.00375 0.01
  0.7775 ]]
[2023-08-04 17:24:11,185 INFO] 887000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.6222e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1483, device='cuda:0'), 'train/shrink_loss': tensor(0.0635, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0503, device='cuda:0'), 'train/removed_class_idx': 2.476190240362834, 'train/uncertainty_avg': 0.756638400076197, 'train/certain_ratio_ema': 0.7923118712516178, 'train/total_loss': tensor(0.1987, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.011907027302007501, 'train/prefecth_time': 0.01891753578186035, 'train/run_time': 0.5764343872070312, 'eval/loss': tensor(2.7527, device='cuda:0'), 'eval/top-1-acc': 0.671875, 'eval/top-5-acc': 0.97475, 'eval/precision': 0.7174503732368112, 'eval/recall': 0.671875, 'eval/F1': 0.6768288535414922, 'eval/AUC': 0.9107164930555557}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 17:34:53,801 INFO] confusion matrix:
[[0.94875 0.0025  0.00125 0.0025  0.00125 0.      0.01625 0.0025  0.01625
  0.00875]
 [0.06125 0.77125 0.      0.02875 0.00625 0.00625 0.0725  0.0425  0.01
  0.00125]
 [0.      0.      0.84875 0.00125 0.      0.      0.11125 0.0125  0.0025
  0.02375]
 [0.00125 0.135   0.      0.37625 0.01875 0.155   0.24375 0.0675  0.0025
  0.     ]
 [0.      0.01    0.      0.01375 0.73    0.01    0.205   0.0275  0.00125
  0.0025 ]
 [0.00125 0.03    0.      0.03875 0.0375  0.7025  0.16375 0.02125 0.005
  0.     ]
 [0.0025  0.0075  0.0025  0.      0.7225  0.0125  0.24    0.00125 0.00375
  0.0075 ]
 [0.00125 0.23875 0.      0.07875 0.00875 0.03125 0.1675  0.47125 0.
  0.0025 ]
 [0.005   0.      0.      0.00125 0.      0.      0.02125 0.      0.96375
  0.00875]
 [0.005   0.00125 0.0875  0.      0.      0.      0.115   0.0075  0.00875
  0.775  ]]
[2023-08-04 17:34:53,854 INFO] 888000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.6570e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1193, device='cuda:0'), 'train/shrink_loss': tensor(0.0310, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0245, device='cuda:0'), 'train/removed_class_idx': 2.2608692375551827, 'train/uncertainty_avg': 0.7717863710166176, 'train/certain_ratio_ema': 0.7904009850457122, 'train/total_loss': tensor(0.1438, device='cuda:0'), 'train/mask_ratio': tensor(0.8460, device='cuda:0'), 'lr': 0.011870923798650212, 'train/prefecth_time': 0.0627061767578125, 'train/run_time': 0.5847092895507813, 'eval/loss': tensor(2.7123, device='cuda:0'), 'eval/top-1-acc': 0.68275, 'eval/top-5-acc': 0.972375, 'eval/precision': 0.7193850118909124, 'eval/recall': 0.6827500000000001, 'eval/F1': 0.689076966683692, 'eval/AUC': 0.9090336371527779}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 17:47:11,248 INFO] confusion matrix:
[[0.95375 0.0025  0.      0.      0.00125 0.      0.00875 0.005   0.01625
  0.0125 ]
 [0.06125 0.79875 0.      0.02375 0.00375 0.00875 0.0675  0.03125 0.005
  0.     ]
 [0.      0.      0.8475  0.      0.      0.      0.1075  0.015   0.00375
  0.02625]
 [0.00125 0.18125 0.00125 0.37375 0.01375 0.155   0.2625  0.01    0.00125
  0.     ]
 [0.      0.01375 0.      0.02    0.7075  0.01    0.23375 0.0125  0.0025
  0.     ]
 [0.00125 0.0425  0.      0.06875 0.03125 0.66875 0.18125 0.0025  0.00375
  0.     ]
 [0.0025  0.01125 0.0025  0.0025  0.67625 0.01    0.28625 0.00125 0.0025
  0.005  ]
 [0.      0.315   0.      0.105   0.01125 0.02625 0.18875 0.3525  0.
  0.00125]
 [0.00875 0.      0.      0.00125 0.      0.      0.01625 0.      0.96625
  0.0075 ]
 [0.00625 0.00375 0.0725  0.      0.      0.      0.09125 0.00625 0.0075
  0.8125 ]]
[2023-08-04 17:47:11,310 INFO] 889000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.8730e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1138, device='cuda:0'), 'train/shrink_loss': tensor(0.0415, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0330, device='cuda:0'), 'train/removed_class_idx': 2.409638263899004, 'train/uncertainty_avg': 0.7731855894291139, 'train/certain_ratio_ema': 0.7944777819180138, 'train/total_loss': tensor(0.1468, device='cuda:0'), 'train/mask_ratio': tensor(0.8147, device='cuda:0'), 'lr': 0.011834799899504951, 'train/prefecth_time': 0.05919094467163086, 'train/run_time': 0.6752590942382812, 'eval/loss': tensor(2.7939, device='cuda:0'), 'eval/top-1-acc': 0.67675, 'eval/top-5-acc': 0.974875, 'eval/precision': 0.7204776398375671, 'eval/recall': 0.67675, 'eval/F1': 0.6810625507778548, 'eval/AUC': 0.9094497222222221}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 17:59:28,053 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 17:59:40,765 INFO] confusion matrix:
[[0.955   0.00125 0.      0.      0.00125 0.      0.01375 0.005   0.015
  0.00875]
 [0.06    0.79375 0.      0.03    0.005   0.01    0.07125 0.025   0.005
  0.     ]
 [0.      0.      0.8575  0.      0.      0.      0.10625 0.015   0.0025
  0.01875]
 [0.0025  0.14375 0.      0.39    0.015   0.17    0.25125 0.0125  0.015
  0.     ]
 [0.      0.0075  0.00125 0.02125 0.6925  0.0125  0.25    0.01375 0.00125
  0.     ]
 [0.      0.0275  0.      0.21375 0.02875 0.5675  0.15875 0.00125 0.0025
  0.     ]
 [0.00375 0.0075  0.00375 0.005   0.6475  0.0075  0.31625 0.      0.0025
  0.00625]
 [0.00125 0.2875  0.      0.12875 0.01125 0.0275  0.18125 0.35375 0.0075
  0.00125]
 [0.00875 0.      0.      0.00125 0.      0.      0.0225  0.      0.96125
  0.00625]
 [0.00875 0.0025  0.10125 0.00125 0.      0.      0.08875 0.00625 0.00875
  0.7825 ]]
[2023-08-04 17:59:40,794 INFO] 890000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.7349e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1578, device='cuda:0'), 'train/shrink_loss': tensor(0.0728, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0575, device='cuda:0'), 'train/removed_class_idx': 2.4845358263365127, 'train/uncertainty_avg': 0.7297428886727324, 'train/certain_ratio_ema': 0.7891782336812208, 'train/total_loss': tensor(0.2153, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.011798655666637257, 'train/prefecth_time': 0.06413593292236328, 'train/run_time': 0.62008203125, 'eval/loss': tensor(2.7486, device='cuda:0'), 'eval/top-1-acc': 0.667, 'eval/top-5-acc': 0.975375, 'eval/precision': 0.7059038585580871, 'eval/recall': 0.6669999999999999, 'eval/F1': 0.6713374641881831, 'eval/AUC': 0.9157374652777778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 18:12:36,740 INFO] confusion matrix:
[[0.945   0.0025  0.      0.      0.0025  0.      0.02375 0.005   0.0125
  0.00875]
 [0.05875 0.76125 0.      0.02875 0.00625 0.00875 0.0725  0.06125 0.0025
  0.     ]
 [0.      0.      0.855   0.00125 0.      0.      0.12    0.0125  0.00125
  0.01   ]
 [0.0025  0.0825  0.      0.38125 0.01875 0.19375 0.2625  0.0575  0.00125
  0.     ]
 [0.      0.0075  0.      0.025   0.6925  0.01125 0.24625 0.0175  0.
  0.     ]
 [0.00125 0.02    0.      0.18375 0.02625 0.5825  0.1775  0.00875 0.
  0.     ]
 [0.0025  0.01    0.00375 0.00375 0.6575  0.00625 0.30625 0.0025  0.0025
  0.005  ]
 [0.00125 0.19125 0.      0.0975  0.01    0.02    0.1775  0.50125 0.
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.      0.07125 0.00125 0.9125
  0.00875]
 [0.00875 0.00125 0.1325  0.0025  0.      0.      0.1     0.00625 0.0075
  0.74125]]
[2023-08-04 18:12:36,859 INFO] 891000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.5537e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1907, device='cuda:0'), 'train/shrink_loss': tensor(0.0765, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0594, device='cuda:0'), 'train/removed_class_idx': 2.5436890734282454, 'train/uncertainty_avg': 0.7510757590904962, 'train/certain_ratio_ema': 0.7774002127774056, 'train/total_loss': tensor(0.2501, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.01176249116214763, 'train/prefecth_time': 0.06017279815673828, 'train/run_time': 0.6608002319335937, 'eval/loss': tensor(2.6682, device='cuda:0'), 'eval/top-1-acc': 0.667875, 'eval/top-5-acc': 0.978625, 'eval/precision': 0.708351216706504, 'eval/recall': 0.667875, 'eval/F1': 0.6794819414725394, 'eval/AUC': 0.9150867274305555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 18:25:24,857 INFO] confusion matrix:
[[0.9725  0.0025  0.00375 0.      0.0025  0.      0.00125 0.      0.0125
  0.005  ]
 [0.07125 0.84125 0.      0.05375 0.01375 0.00875 0.00625 0.00125 0.0025
  0.00125]
 [0.0025  0.0025  0.97    0.00125 0.      0.      0.00875 0.      0.0025
  0.0125 ]
 [0.0125  0.1825  0.00125 0.44125 0.05625 0.20875 0.0875  0.0025  0.00125
  0.00625]
 [0.0025  0.01125 0.00125 0.0125  0.94    0.015   0.01375 0.00125 0.00125
  0.00125]
 [0.0025  0.06    0.00125 0.06875 0.05    0.79125 0.02375 0.      0.0025
  0.     ]
 [0.0025  0.01875 0.00625 0.0025  0.90125 0.01375 0.0475  0.      0.0025
  0.005  ]
 [0.0075  0.37    0.      0.255   0.0375  0.06875 0.045   0.215   0.
  0.00125]
 [0.0075  0.      0.00125 0.      0.      0.      0.      0.      0.9825
  0.00875]
 [0.01    0.0025  0.1525  0.      0.      0.      0.      0.      0.01
  0.825  ]]
[2023-08-04 18:25:25,030 INFO] 892000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1564, device='cuda:0'), 'train/shrink_loss': tensor(0.0440, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0337, device='cuda:0'), 'train/removed_class_idx': 2.2823526726643912, 'train/uncertainty_avg': 0.7782240155414104, 'train/certain_ratio_ema': 0.7646362933046479, 'train/total_loss': tensor(0.1902, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.011726306448171374, 'train/prefecth_time': 0.06285193634033204, 'train/run_time': 0.6579921264648437, 'eval/loss': tensor(1.7795, device='cuda:0'), 'eval/top-1-acc': 0.702625, 'eval/top-5-acc': 0.983625, 'eval/precision': 0.7119919135324907, 'eval/recall': 0.702625, 'eval/F1': 0.6659262914630346, 'eval/AUC': 0.9484814322916666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 18:38:16,406 INFO] confusion matrix:
[[0.9675  0.00125 0.      0.00125 0.0025  0.      0.0025  0.      0.01375
  0.01125]
 [0.0675  0.82125 0.      0.06    0.0075  0.0075  0.0325  0.00125 0.00125
  0.00125]
 [0.01    0.00125 0.92375 0.00375 0.      0.      0.01375 0.      0.005
  0.0425 ]
 [0.00625 0.15375 0.      0.445   0.0225  0.13875 0.2275  0.      0.00125
  0.005  ]
 [0.      0.01    0.      0.0275  0.9225  0.01    0.03    0.      0.
  0.     ]
 [0.0025  0.0475  0.      0.065   0.03875 0.7725  0.07125 0.      0.0025
  0.     ]
 [0.00125 0.01375 0.0025  0.0025  0.88625 0.01375 0.06625 0.      0.0025
  0.01125]
 [0.00125 0.31    0.      0.26875 0.01625 0.035   0.18625 0.18125 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.00375 0.      0.98125
  0.00875]
 [0.00875 0.0025  0.13375 0.00125 0.      0.      0.0025  0.      0.00875
  0.8425 ]]
[2023-08-04 18:38:16,447 INFO] 893000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.0948, device='cuda:0'), 'train/shrink_loss': tensor(0.0432, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0333, device='cuda:0'), 'train/removed_class_idx': 2.3299997670000234, 'train/uncertainty_avg': 0.741774483949478, 'train/certain_ratio_ema': 0.7710389315681552, 'train/total_loss': tensor(0.1283, device='cuda:0'), 'train/mask_ratio': tensor(0.7768, device='cuda:0'), 'lr': 0.01169010158687852, 'train/prefecth_time': 0.06872434997558594, 'train/run_time': 0.6668941040039063, 'eval/loss': tensor(2.2123, device='cuda:0'), 'eval/top-1-acc': 0.692375, 'eval/top-5-acc': 0.977375, 'eval/precision': 0.7138137198369513, 'eval/recall': 0.692375, 'eval/F1': 0.6656422878501262, 'eval/AUC': 0.9328003993055556}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 18:51:15,454 INFO] confusion matrix:
[[0.96375 0.00125 0.      0.      0.0025  0.      0.00625 0.      0.015
  0.01125]
 [0.06625 0.80875 0.      0.00375 0.00625 0.00875 0.02875 0.075   0.0025
  0.     ]
 [0.00375 0.      0.88875 0.      0.      0.      0.04    0.00375 0.0025
  0.06125]
 [0.005   0.1525  0.      0.30625 0.0275  0.14875 0.17625 0.1825  0.00125
  0.     ]
 [0.      0.01    0.      0.005   0.885   0.01    0.06125 0.02875 0.
  0.     ]
 [0.00125 0.03875 0.      0.18625 0.0375  0.61625 0.07375 0.04375 0.00125
  0.00125]
 [0.0025  0.01375 0.00125 0.00375 0.88    0.01125 0.0675  0.005   0.0025
  0.0125 ]
 [0.00125 0.2     0.      0.01    0.01    0.01875 0.08    0.67875 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01    0.      0.975
  0.01   ]
 [0.00875 0.00125 0.12875 0.      0.      0.      0.0275  0.00125 0.00875
  0.82375]]
[2023-08-04 18:51:15,494 INFO] 894000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.1659e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0924, device='cuda:0'), 'train/shrink_loss': tensor(0.0515, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0406, device='cuda:0'), 'train/removed_class_idx': 2.2823526726643912, 'train/uncertainty_avg': 0.7807791611776588, 'train/certain_ratio_ema': 0.7891059716352561, 'train/total_loss': tensor(0.1332, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.011653876640473728, 'train/prefecth_time': 0.05953446578979492, 'train/run_time': 0.6782021484375, 'eval/loss': tensor(2.2624, device='cuda:0'), 'eval/top-1-acc': 0.701375, 'eval/top-5-acc': 0.97425, 'eval/precision': 0.6919057614396866, 'eval/recall': 0.701375, 'eval/F1': 0.6835649193273081, 'eval/AUC': 0.9211062847222224}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 19:04:02,029 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 19:04:13,788 INFO] confusion matrix:
[[0.955   0.00125 0.      0.0025  0.00125 0.      0.01125 0.      0.0175
  0.01125]
 [0.06375 0.78375 0.      0.015   0.00625 0.01    0.04125 0.07625 0.00375
  0.     ]
 [0.0075  0.00125 0.8625  0.      0.      0.      0.09875 0.00375 0.0025
  0.02375]
 [0.005   0.12375 0.00125 0.34    0.0125  0.14    0.205   0.17125 0.00125
  0.     ]
 [0.      0.00875 0.      0.0125  0.7825  0.01    0.155   0.03125 0.
  0.     ]
 [0.0025  0.03125 0.      0.20875 0.0275  0.58    0.09875 0.05    0.00125
  0.     ]
 [0.0025  0.01375 0.0025  0.00625 0.80875 0.01125 0.13875 0.00875 0.0025
  0.005  ]
 [0.00125 0.2175  0.      0.02625 0.0075  0.01625 0.10125 0.62875 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.0125  0.      0.9725
  0.00875]
 [0.01    0.00125 0.12875 0.      0.      0.      0.05875 0.0025  0.01125
  0.7875 ]]
[2023-08-04 19:04:13,828 INFO] 895000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.5488e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1852, device='cuda:0'), 'train/shrink_loss': tensor(0.0493, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0388, device='cuda:0'), 'train/removed_class_idx': 2.277227497304208, 'train/uncertainty_avg': 0.7607650092125005, 'train/certain_ratio_ema': 0.7868220829838736, 'train/total_loss': tensor(0.2240, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.011617631671196149, 'train/prefecth_time': 0.05869446563720703, 'train/run_time': 0.6905325927734375, 'eval/loss': tensor(2.5402, device='cuda:0'), 'eval/top-1-acc': 0.683125, 'eval/top-5-acc': 0.972125, 'eval/precision': 0.6921104667228357, 'eval/recall': 0.683125, 'eval/F1': 0.6788166054566812, 'eval/AUC': 0.9180733159722223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 19:17:00,949 INFO] confusion matrix:
[[0.9575  0.00125 0.00125 0.0025  0.00125 0.      0.01    0.      0.01875
  0.0075 ]
 [0.0625  0.77875 0.      0.00875 0.0075  0.00875 0.0525  0.0725  0.00875
  0.     ]
 [0.00625 0.00125 0.85    0.      0.      0.      0.10875 0.00375 0.0025
  0.0275 ]
 [0.005   0.1075  0.00125 0.275   0.01125 0.175   0.2475  0.17625 0.00125
  0.     ]
 [0.      0.00875 0.      0.00625 0.72375 0.00625 0.22    0.0325  0.0025
  0.     ]
 [0.00125 0.02875 0.      0.21375 0.02875 0.55    0.1375  0.0375  0.0025
  0.     ]
 [0.0025  0.01125 0.00125 0.00375 0.7375  0.01    0.21875 0.00625 0.0025
  0.00625]
 [0.00125 0.2425  0.      0.02    0.00625 0.0175  0.1525  0.55875 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01375 0.00125 0.96875
  0.01125]
 [0.01    0.00125 0.12625 0.      0.      0.      0.085   0.0025  0.01
  0.765  ]]
[2023-08-04 19:17:00,990 INFO] 896000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.8044e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1101, device='cuda:0'), 'train/shrink_loss': tensor(0.0447, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0353, device='cuda:0'), 'train/removed_class_idx': 2.4468082503395476, 'train/uncertainty_avg': 0.7452455372052919, 'train/certain_ratio_ema': 0.7886310114306568, 'train/total_loss': tensor(0.1455, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.011581366741319356, 'train/prefecth_time': 0.06523702239990234, 'train/run_time': 0.665811279296875, 'eval/loss': tensor(2.8105, device='cuda:0'), 'eval/top-1-acc': 0.664625, 'eval/top-5-acc': 0.964, 'eval/precision': 0.6839130536891385, 'eval/recall': 0.6646249999999999, 'eval/F1': 0.665052112363235, 'eval/AUC': 0.9120512499999998}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 19:29:59,470 INFO] confusion matrix:
[[0.9625  0.00125 0.      0.      0.00125 0.      0.0075  0.      0.01875
  0.00875]
 [0.065   0.78875 0.      0.005   0.00875 0.01    0.05625 0.055   0.01125
  0.     ]
 [0.00875 0.      0.84125 0.      0.      0.      0.115   0.00375 0.00125
  0.03   ]
 [0.005   0.1     0.      0.28625 0.0125  0.22125 0.24125 0.1325  0.00125
  0.     ]
 [0.      0.00875 0.      0.0075  0.73    0.01    0.215   0.02625 0.0025
  0.     ]
 [0.00125 0.02375 0.      0.26875 0.02375 0.5125  0.1425  0.02375 0.0025
  0.00125]
 [0.0025  0.00875 0.      0.005   0.7375  0.0125  0.21625 0.00625 0.0025
  0.00875]
 [0.00125 0.25375 0.      0.02    0.01    0.0325  0.155   0.52625 0.
  0.00125]
 [0.00375 0.      0.00125 0.      0.      0.      0.015   0.00125 0.965
  0.01375]
 [0.01125 0.00125 0.115   0.      0.      0.      0.10625 0.0025  0.01375
  0.75   ]]
[2023-08-04 19:29:59,530 INFO] 897000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1364, device='cuda:0'), 'train/shrink_loss': tensor(0.0634, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0500, device='cuda:0'), 'train/removed_class_idx': 2.527472249728324, 'train/uncertainty_avg': 0.7512574247998975, 'train/certain_ratio_ema': 0.7888139471049244, 'train/total_loss': tensor(0.1866, device='cuda:0'), 'train/mask_ratio': tensor(0.7969, device='cuda:0'), 'lr': 0.011545081913151201, 'train/prefecth_time': 0.0552751350402832, 'train/run_time': 0.6502110595703126, 'eval/loss': tensor(3.0542, device='cuda:0'), 'eval/top-1-acc': 0.657875, 'eval/top-5-acc': 0.954625, 'eval/precision': 0.6770303697684902, 'eval/recall': 0.657875, 'eval/F1': 0.6588516622954803, 'eval/AUC': 0.8981154340277778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 19:42:50,599 INFO] confusion matrix:
[[0.95625 0.00125 0.00125 0.00125 0.0025  0.      0.0125  0.      0.0175
  0.0075 ]
 [0.06375 0.79375 0.      0.02875 0.00625 0.00875 0.0625  0.02125 0.015
  0.     ]
 [0.00875 0.00125 0.86    0.      0.      0.      0.10375 0.00375 0.00125
  0.02125]
 [0.005   0.13    0.      0.3775  0.01125 0.18125 0.2375  0.055   0.0025
  0.     ]
 [0.      0.00625 0.      0.01625 0.725   0.00875 0.22375 0.01625 0.00375
  0.     ]
 [0.00125 0.02875 0.      0.27875 0.02125 0.48625 0.165   0.015   0.00375
  0.     ]
 [0.00375 0.00875 0.0025  0.00625 0.72375 0.01125 0.23125 0.005   0.0025
  0.005  ]
 [0.      0.2725  0.      0.1075  0.01    0.025   0.15    0.43125 0.0025
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.01625 0.      0.9675
  0.01   ]
 [0.01375 0.00125 0.135   0.      0.      0.      0.0875  0.00375 0.0125
  0.74625]]
[2023-08-04 19:42:50,632 INFO] 898000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.1024e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1266, device='cuda:0'), 'train/shrink_loss': tensor(0.0561, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0445, device='cuda:0'), 'train/removed_class_idx': 2.268041003294742, 'train/uncertainty_avg': 0.7528277808836177, 'train/certain_ratio_ema': 0.792669768762492, 'train/total_loss': tensor(0.1712, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.01150877724903372, 'train/prefecth_time': 0.06458236694335938, 'train/run_time': 0.6783480224609375, 'eval/loss': tensor(3.1063, device='cuda:0'), 'eval/top-1-acc': 0.6575, 'eval/top-5-acc': 0.954125, 'eval/precision': 0.6867612167460486, 'eval/recall': 0.6575, 'eval/F1': 0.66026831125039, 'eval/AUC': 0.8949021006944444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 19:56:04,040 INFO] confusion matrix:
[[0.9525  0.00125 0.00125 0.      0.0025  0.      0.01875 0.      0.015
  0.00875]
 [0.06    0.77    0.      0.0075  0.005   0.01    0.06875 0.065   0.01375
  0.     ]
 [0.00875 0.00125 0.85625 0.      0.      0.      0.10125 0.00375 0.0025
  0.02625]
 [0.00375 0.1225  0.      0.2975  0.01125 0.21    0.24125 0.11125 0.0025
  0.     ]
 [0.      0.0075  0.      0.01125 0.7175  0.01    0.2225  0.0275  0.00375
  0.     ]
 [0.00125 0.02125 0.      0.27875 0.0225  0.4775  0.165   0.03125 0.0025
  0.     ]
 [0.00375 0.00875 0.0025  0.005   0.71625 0.01    0.2375  0.00875 0.0025
  0.005  ]
 [0.      0.22375 0.      0.0375  0.00625 0.0325  0.15125 0.54625 0.00125
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.015   0.00125 0.9675
  0.01   ]
 [0.01625 0.00125 0.145   0.      0.      0.      0.08625 0.0025  0.01125
  0.7375 ]]
[2023-08-04 19:56:04,088 INFO] 899000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.0880e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1609, device='cuda:0'), 'train/shrink_loss': tensor(0.0454, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0361, device='cuda:0'), 'train/removed_class_idx': 2.4794517151436004, 'train/uncertainty_avg': 0.778691506432543, 'train/certain_ratio_ema': 0.7952228600843344, 'train/total_loss': tensor(0.1971, device='cuda:0'), 'train/mask_ratio': tensor(0.8371, device='cuda:0'), 'lr': 0.011472452811343053, 'train/prefecth_time': 0.06567116546630859, 'train/run_time': 0.6787882080078125, 'eval/loss': tensor(3.1795, device='cuda:0'), 'eval/top-1-acc': 0.656, 'eval/top-5-acc': 0.956625, 'eval/precision': 0.6757775565398616, 'eval/recall': 0.656, 'eval/F1': 0.6578458246966756, 'eval/AUC': 0.8951228298611111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 20:08:46,335 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 20:08:58,665 INFO] confusion matrix:
[[0.9425  0.00125 0.00125 0.      0.0025  0.      0.02625 0.      0.0175
  0.00875]
 [0.0575  0.77    0.      0.03    0.00625 0.0075  0.0725  0.045   0.01125
  0.     ]
 [0.01    0.      0.8425  0.      0.      0.      0.11625 0.00375 0.00125
  0.02625]
 [0.00375 0.12375 0.      0.3975  0.0075  0.16375 0.225   0.07625 0.0025
  0.     ]
 [0.      0.00875 0.      0.02375 0.7275  0.01    0.20625 0.02    0.00375
  0.     ]
 [0.00125 0.035   0.      0.28125 0.0225  0.46625 0.16375 0.0275  0.0025
  0.     ]
 [0.00125 0.01125 0.00125 0.005   0.72    0.01    0.23    0.01125 0.0025
  0.0075 ]
 [0.      0.24625 0.      0.09    0.00625 0.02125 0.14125 0.49375 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0175  0.      0.9675
  0.00875]
 [0.01125 0.00125 0.155   0.      0.      0.      0.09625 0.00375 0.01
  0.7225 ]]
[2023-08-04 20:08:58,732 INFO] 900000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0006, device='cuda:0'), 'train/certain_loss': tensor(0.1313, device='cuda:0'), 'train/shrink_loss': tensor(0.0359, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0286, device='cuda:0'), 'train/removed_class_idx': 2.4761901814059306, 'train/uncertainty_avg': 0.7357443025158907, 'train/certain_ratio_ema': 0.7968816959548005, 'train/total_loss': tensor(0.1604, device='cuda:0'), 'train/mask_ratio': tensor(0.8125, device='cuda:0'), 'lr': 0.011436108662489295, 'train/prefecth_time': 0.052703041076660156, 'train/run_time': 0.6678679809570313, 'eval/loss': tensor(3.1496, device='cuda:0'), 'eval/top-1-acc': 0.656, 'eval/top-5-acc': 0.958625, 'eval/precision': 0.6836339735699106, 'eval/recall': 0.6559999999999999, 'eval/F1': 0.6604838759399342, 'eval/AUC': 0.8988541840277777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 20:19:39,598 INFO] confusion matrix:
[[0.9425  0.00125 0.00125 0.      0.0025  0.      0.0275  0.      0.015
  0.01   ]
 [0.05625 0.775   0.      0.03625 0.00625 0.00875 0.08375 0.03125 0.0025
  0.     ]
 [0.00875 0.      0.83625 0.0025  0.      0.      0.12375 0.0025  0.
  0.02625]
 [0.00375 0.13125 0.      0.41125 0.00875 0.1525  0.22375 0.0675  0.00125
  0.     ]
 [0.      0.0075  0.      0.0225  0.74    0.01    0.2     0.02    0.
  0.     ]
 [0.00125 0.03125 0.      0.265   0.02125 0.49375 0.16125 0.02375 0.0025
  0.     ]
 [0.0025  0.01    0.      0.005   0.7225  0.01    0.2275  0.01    0.0025
  0.01   ]
 [0.      0.235   0.      0.09875 0.0075  0.02125 0.1425  0.49375 0.
  0.00125]
 [0.00625 0.      0.00125 0.00125 0.      0.      0.02125 0.      0.965
  0.005  ]
 [0.00875 0.00125 0.17375 0.      0.      0.      0.105   0.0025  0.01125
  0.6975 ]]
[2023-08-04 20:19:39,614 INFO] 901000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.9944e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1462, device='cuda:0'), 'train/shrink_loss': tensor(0.0635, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0504, device='cuda:0'), 'train/removed_class_idx': 2.4148933601177274, 'train/uncertainty_avg': 0.7380919267324204, 'train/certain_ratio_ema': 0.7935118432584782, 'train/total_loss': tensor(0.1966, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.011399744864916399, 'train/prefecth_time': 0.02136476707458496, 'train/run_time': 0.5498112182617187, 'eval/loss': tensor(3.1445, device='cuda:0'), 'eval/top-1-acc': 0.65825, 'eval/top-5-acc': 0.954625, 'eval/precision': 0.690462554655068, 'eval/recall': 0.65825, 'eval/F1': 0.6641701831438258, 'eval/AUC': 0.89758296875}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 20:29:40,645 INFO] confusion matrix:
[[0.945   0.01    0.00125 0.      0.0025  0.      0.02    0.      0.01375
  0.0075 ]
 [0.05625 0.75375 0.      0.075   0.0075  0.00875 0.06875 0.02875 0.00125
  0.     ]
 [0.00375 0.01    0.84    0.00375 0.      0.      0.11875 0.00125 0.
  0.0225 ]
 [0.00125 0.15625 0.      0.42875 0.01125 0.1375  0.215   0.04875 0.00125
  0.     ]
 [0.      0.0075  0.      0.0225  0.74875 0.01    0.19375 0.0175  0.
  0.     ]
 [0.00125 0.05375 0.      0.19125 0.02875 0.5475  0.155   0.02    0.0025
  0.     ]
 [0.00125 0.01625 0.00125 0.0025  0.71    0.00875 0.23875 0.01125 0.0025
  0.0075 ]
 [0.      0.22    0.      0.23125 0.0075  0.02    0.125   0.3925  0.0025
  0.00125]
 [0.005   0.      0.0025  0.00125 0.      0.      0.02125 0.      0.965
  0.005  ]
 [0.00625 0.0025  0.18125 0.      0.      0.      0.10625 0.0025  0.015
  0.68625]]
[2023-08-04 20:29:40,655 INFO] 902000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.2381e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1550, device='cuda:0'), 'train/shrink_loss': tensor(0.0441, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0343, device='cuda:0'), 'train/removed_class_idx': 2.368420803324126, 'train/uncertainty_avg': 0.7530967424739867, 'train/certain_ratio_ema': 0.7779002411140198, 'train/total_loss': tensor(0.1894, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.011363361481102105, 'train/prefecth_time': 0.018899776458740233, 'train/run_time': 0.5519930419921875, 'eval/loss': tensor(2.7549, device='cuda:0'), 'eval/top-1-acc': 0.654625, 'eval/top-5-acc': 0.968375, 'eval/precision': 0.6889181088293751, 'eval/recall': 0.654625, 'eval/F1': 0.6589470975288265, 'eval/AUC': 0.9156013888888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 20:39:50,245 INFO] confusion matrix:
[[0.9525  0.005   0.00125 0.      0.00375 0.      0.015   0.      0.01375
  0.00875]
 [0.06125 0.76125 0.      0.03    0.00625 0.00875 0.07375 0.0575  0.00125
  0.     ]
 [0.      0.01    0.83625 0.00125 0.      0.      0.1225  0.0025  0.
  0.0275 ]
 [0.0025  0.1175  0.      0.3425  0.01875 0.2025  0.24375 0.0675  0.005
  0.     ]
 [0.      0.00625 0.      0.01    0.73875 0.015   0.2075  0.02125 0.
  0.00125]
 [0.00125 0.0275  0.      0.08625 0.0325  0.64375 0.17375 0.035   0.
  0.     ]
 [0.00375 0.01    0.00125 0.      0.675   0.015   0.2725  0.00375 0.0025
  0.01625]
 [0.      0.1925  0.      0.04125 0.00875 0.02375 0.1475  0.585   0.
  0.00125]
 [0.00625 0.      0.0025  0.      0.      0.      0.02875 0.      0.95875
  0.00375]
 [0.00625 0.00375 0.17625 0.      0.      0.      0.09875 0.00125 0.00875
  0.705  ]]
[2023-08-04 20:39:50,256 INFO] 903000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.4466e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1533, device='cuda:0'), 'train/shrink_loss': tensor(0.0797, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0624, device='cuda:0'), 'train/removed_class_idx': 2.5157892088642937, 'train/uncertainty_avg': 0.7448683647932665, 'train/certain_ratio_ema': 0.7829668396122922, 'train/total_loss': tensor(0.2158, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.011326958573557777, 'train/prefecth_time': 0.02039833641052246, 'train/run_time': 0.549267822265625, 'eval/loss': tensor(2.6489, device='cuda:0'), 'eval/top-1-acc': 0.679625, 'eval/top-5-acc': 0.965125, 'eval/precision': 0.7135423511710909, 'eval/recall': 0.679625, 'eval/F1': 0.6853132779047334, 'eval/AUC': 0.9153988715277778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 20:49:50,998 INFO] confusion matrix:
[[0.95125 0.00625 0.      0.00125 0.00125 0.      0.01125 0.      0.01875
  0.01   ]
 [0.0625  0.75125 0.      0.01375 0.005   0.00875 0.07875 0.07875 0.00125
  0.     ]
 [0.      0.01625 0.82625 0.00125 0.      0.      0.135   0.0025  0.
  0.01875]
 [0.0025  0.1075  0.      0.33    0.01625 0.18    0.245   0.1175  0.00125
  0.     ]
 [0.      0.00625 0.      0.005   0.74625 0.01125 0.195   0.035   0.00125
  0.     ]
 [0.00125 0.0275  0.      0.145   0.03375 0.54375 0.195   0.05375 0.
  0.     ]
 [0.00375 0.01125 0.0025  0.00125 0.69125 0.0125  0.25625 0.01375 0.0025
  0.005  ]
 [0.      0.17875 0.      0.0325  0.0075  0.02    0.14375 0.61625 0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.0225  0.      0.96625
  0.00375]
 [0.00625 0.00625 0.20375 0.      0.      0.      0.11375 0.0025  0.01125
  0.65625]]
[2023-08-04 20:49:51,010 INFO] 904000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1030, device='cuda:0'), 'train/shrink_loss': tensor(0.0419, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0327, device='cuda:0'), 'train/removed_class_idx': 2.499999744897985, 'train/uncertainty_avg': 0.7185103382103106, 'train/certain_ratio_ema': 0.7802993485444756, 'train/total_loss': tensor(0.1359, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.011290536204828349, 'train/prefecth_time': 0.0330340461730957, 'train/run_time': 0.5545399780273438, 'eval/loss': tensor(2.8737, device='cuda:0'), 'eval/top-1-acc': 0.664375, 'eval/top-5-acc': 0.96175, 'eval/precision': 0.6977168079616598, 'eval/recall': 0.664375, 'eval/F1': 0.6695168170580525, 'eval/AUC': 0.9091988628472223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 20:59:39,991 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 20:59:50,397 INFO] confusion matrix:
[[0.95375 0.0025  0.      0.      0.0025  0.      0.01    0.      0.0175
  0.01375]
 [0.0625  0.755   0.      0.0075  0.005   0.01125 0.0775  0.08125 0.
  0.     ]
 [0.      0.02    0.8175  0.      0.      0.      0.11625 0.00375 0.
  0.0425 ]
 [0.0025  0.10125 0.      0.3175  0.01875 0.1525  0.23875 0.1675  0.00125
  0.     ]
 [0.00125 0.005   0.      0.0025  0.74375 0.00875 0.20625 0.03    0.00125
  0.00125]
 [0.00125 0.0225  0.      0.23    0.035   0.4675  0.19    0.05125 0.00125
  0.00125]
 [0.00375 0.01    0.      0.00125 0.6775  0.01    0.2575  0.01    0.0025
  0.0275 ]
 [0.      0.16875 0.      0.01625 0.0075  0.02    0.15125 0.635   0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.01875 0.00125 0.96875
  0.005  ]
 [0.005   0.00625 0.175   0.      0.      0.      0.09125 0.00375 0.00875
  0.71   ]]
[2023-08-04 20:59:50,403 INFO] 905000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.0634, device='cuda:0'), 'train/shrink_loss': tensor(0.0490, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0387, device='cuda:0'), 'train/removed_class_idx': 2.3364483797711793, 'train/uncertainty_avg': 0.761186762833179, 'train/certain_ratio_ema': 0.7894123329349789, 'train/total_loss': tensor(0.1022, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.01125409443749217, 'train/prefecth_time': 0.022382688522338868, 'train/run_time': 0.5771776733398437, 'eval/loss': tensor(3.1138, device='cuda:0'), 'eval/top-1-acc': 0.662625, 'eval/top-5-acc': 0.954125, 'eval/precision': 0.6872554300490327, 'eval/recall': 0.662625, 'eval/F1': 0.6654502747711104, 'eval/AUC': 0.8997154861111112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 21:09:48,807 INFO] confusion matrix:
[[0.95125 0.005   0.      0.      0.00125 0.      0.01125 0.      0.02
  0.01125]
 [0.0625  0.78375 0.      0.015   0.00125 0.0125  0.0675  0.055   0.0025
  0.     ]
 [0.      0.0075  0.81375 0.      0.      0.      0.12125 0.005   0.0025
  0.05   ]
 [0.0025  0.10125 0.      0.3475  0.01    0.165   0.245   0.1275  0.00125
  0.     ]
 [0.00125 0.00625 0.      0.01375 0.7425  0.00875 0.205   0.0225  0.
  0.     ]
 [0.00125 0.0225  0.      0.25    0.03    0.485   0.1825  0.025   0.0025
  0.00125]
 [0.0025  0.01    0.00125 0.0025  0.71    0.00625 0.24125 0.0075  0.0025
  0.01625]
 [0.      0.21    0.      0.03875 0.0075  0.02125 0.15375 0.5675  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.01875 0.00125 0.96625
  0.0075 ]
 [0.00625 0.00125 0.215   0.      0.      0.      0.095   0.00375 0.0125
  0.66625]]
[2023-08-04 21:09:48,850 INFO] 906000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.7680e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1324, device='cuda:0'), 'train/shrink_loss': tensor(0.0755, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0593, device='cuda:0'), 'train/removed_class_idx': 2.423529126643632, 'train/uncertainty_avg': 0.7512123598543895, 'train/certain_ratio_ema': 0.7860254716029234, 'train/total_loss': tensor(0.1917, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.01121763333416092, 'train/prefecth_time': 0.018928319931030273, 'train/run_time': 0.5818414306640625, 'eval/loss': tensor(3.1518, device='cuda:0'), 'eval/top-1-acc': 0.6565, 'eval/top-5-acc': 0.95975, 'eval/precision': 0.6819062651743342, 'eval/recall': 0.6565, 'eval/F1': 0.6601068989911162, 'eval/AUC': 0.8968064062500001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 21:22:25,396 INFO] confusion matrix:
[[0.955   0.00125 0.      0.      0.00125 0.      0.01    0.      0.02125
  0.01125]
 [0.0625  0.77125 0.      0.05875 0.00375 0.0125  0.0775  0.005   0.0075
  0.00125]
 [0.      0.00875 0.80375 0.00375 0.      0.      0.13    0.      0.
  0.05375]
 [0.0025  0.1025  0.      0.45375 0.015   0.16875 0.2525  0.0025  0.0025
  0.     ]
 [0.      0.0075  0.      0.035   0.73875 0.01125 0.2     0.005   0.00125
  0.00125]
 [0.00125 0.0325  0.      0.1875  0.03125 0.55125 0.18625 0.0025  0.00625
  0.00125]
 [0.0025  0.01    0.00125 0.0075  0.7025  0.00875 0.24875 0.00125 0.00375
  0.01375]
 [0.      0.27    0.      0.28625 0.005   0.025   0.1725  0.23875 0.00125
  0.00125]
 [0.00375 0.      0.00125 0.      0.      0.      0.02125 0.      0.96625
  0.0075 ]
 [0.00625 0.00125 0.215   0.0025  0.      0.      0.1025  0.      0.01375
  0.65875]]
[2023-08-04 21:22:25,533 INFO] 907000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.0581e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1472, device='cuda:0'), 'train/shrink_loss': tensor(0.0644, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0506, device='cuda:0'), 'train/removed_class_idx': 2.453703476508937, 'train/uncertainty_avg': 0.7446768306272779, 'train/certain_ratio_ema': 0.7853534109018786, 'train/total_loss': tensor(0.1978, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.011181152957479523, 'train/prefecth_time': 0.08001554870605469, 'train/run_time': 0.6764990844726563, 'eval/loss': tensor(3.1272, device='cuda:0'), 'eval/top-1-acc': 0.638625, 'eval/top-5-acc': 0.957625, 'eval/precision': 0.6927581312017941, 'eval/recall': 0.6386249999999999, 'eval/F1': 0.6387218366173385, 'eval/AUC': 0.9001242447916665}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 21:35:21,711 INFO] confusion matrix:
[[0.9575  0.005   0.      0.00125 0.00125 0.      0.01125 0.      0.0125
  0.01125]
 [0.0625  0.7975  0.      0.03875 0.00375 0.0125  0.0675  0.0125  0.005
  0.     ]
 [0.00125 0.005   0.8125  0.0025  0.      0.      0.12375 0.      0.
  0.055  ]
 [0.00375 0.11    0.      0.4425  0.00875 0.1775  0.24    0.01625 0.00125
  0.     ]
 [0.      0.00875 0.      0.035   0.7375  0.0125  0.19625 0.0075  0.00125
  0.00125]
 [0.00125 0.03125 0.      0.16625 0.03375 0.58125 0.1625  0.01625 0.005
  0.0025 ]
 [0.0025  0.0125  0.00125 0.005   0.72    0.01    0.2275  0.      0.00375
  0.0175 ]
 [0.00125 0.275   0.      0.11875 0.00125 0.02    0.1525  0.42875 0.00125
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.025   0.      0.95875
  0.00875]
 [0.01625 0.00125 0.20875 0.00125 0.      0.      0.095   0.00125 0.01125
  0.665  ]]
[2023-08-04 21:35:21,727 INFO] 908000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1674, device='cuda:0'), 'train/shrink_loss': tensor(0.0626, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0494, device='cuda:0'), 'train/removed_class_idx': 2.301723939506557, 'train/uncertainty_avg': 0.7434431359536376, 'train/certain_ratio_ema': 0.7900326804231365, 'train/total_loss': tensor(0.2171, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.011144653370125986, 'train/prefecth_time': 0.05413571166992188, 'train/run_time': 0.58274072265625, 'eval/loss': tensor(3.0633, device='cuda:0'), 'eval/top-1-acc': 0.660875, 'eval/top-5-acc': 0.95925, 'eval/precision': 0.6986990162246709, 'eval/recall': 0.660875, 'eval/F1': 0.6653617861492083, 'eval/AUC': 0.9011906250000001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 21:45:17,681 INFO] confusion matrix:
[[0.95625 0.0025  0.00125 0.00125 0.0025  0.      0.01625 0.      0.0125
  0.0075 ]
 [0.0625  0.785   0.      0.0125  0.0025  0.01125 0.0675  0.05625 0.0025
  0.     ]
 [0.00375 0.      0.81625 0.      0.      0.      0.14375 0.01375 0.00125
  0.02125]
 [0.005   0.10375 0.      0.3075  0.015   0.18125 0.24625 0.14    0.00125
  0.     ]
 [0.      0.0075  0.      0.00625 0.7475  0.01125 0.19625 0.03125 0.
  0.     ]
 [0.00125 0.02625 0.      0.06625 0.0325  0.67    0.1575  0.045   0.00125
  0.     ]
 [0.00375 0.01    0.00125 0.      0.7275  0.01375 0.22625 0.0075  0.00375
  0.00625]
 [0.00125 0.2175  0.      0.03625 0.00375 0.02    0.1525  0.5675  0.
  0.00125]
 [0.0075  0.      0.0025  0.      0.      0.      0.02375 0.      0.9625
  0.00375]
 [0.015   0.00125 0.22375 0.      0.      0.      0.1125  0.005   0.01125
  0.63125]]
[2023-08-04 21:45:17,693 INFO] 909000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1150, device='cuda:0'), 'train/shrink_loss': tensor(0.0773, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0609, device='cuda:0'), 'train/removed_class_idx': 2.3888886676954937, 'train/uncertainty_avg': 0.7627151106450505, 'train/certain_ratio_ema': 0.7876108403692812, 'train/total_loss': tensor(0.1762, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.011108134634811348, 'train/prefecth_time': 0.01881667137145996, 'train/run_time': 0.554912841796875, 'eval/loss': tensor(2.9244, device='cuda:0'), 'eval/top-1-acc': 0.667, 'eval/top-5-acc': 0.9625, 'eval/precision': 0.7038571673866594, 'eval/recall': 0.667, 'eval/F1': 0.6701590015579665, 'eval/AUC': 0.9055518229166666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 21:55:05,048 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 21:55:14,933 INFO] confusion matrix:
[[0.955   0.00125 0.00125 0.      0.00125 0.      0.015   0.      0.01875
  0.0075 ]
 [0.06375 0.77375 0.      0.0425  0.0025  0.01125 0.07375 0.03    0.0025
  0.     ]
 [0.00625 0.      0.81125 0.00125 0.      0.      0.15875 0.005   0.
  0.0175 ]
 [0.00375 0.11125 0.      0.42    0.01    0.1475  0.245   0.06125 0.00125
  0.     ]
 [0.      0.00875 0.      0.0225  0.73625 0.01    0.20625 0.01625 0.
  0.     ]
 [0.00125 0.0275  0.      0.07    0.02625 0.68125 0.175   0.01875 0.
  0.     ]
 [0.00375 0.00875 0.00125 0.005   0.71875 0.0125  0.23375 0.0075  0.00375
  0.005  ]
 [0.00125 0.215   0.      0.1375  0.0025  0.01375 0.1625  0.46625 0.
  0.00125]
 [0.0075  0.      0.0025  0.      0.      0.      0.01875 0.00125 0.96375
  0.00625]
 [0.015   0.00125 0.185   0.      0.      0.      0.1275  0.00375 0.01
  0.6575 ]]
[2023-08-04 21:55:14,940 INFO] 910000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.1697e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1109, device='cuda:0'), 'train/shrink_loss': tensor(0.0499, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0396, device='cuda:0'), 'train/removed_class_idx': 2.358024400243901, 'train/uncertainty_avg': 0.735083602220509, 'train/certain_ratio_ema': 0.7933211669262115, 'train/total_loss': tensor(0.1505, device='cuda:0'), 'train/mask_ratio': tensor(0.8192, device='cuda:0'), 'lr': 0.011071596814279536, 'train/prefecth_time': 0.018098783493041993, 'train/run_time': 0.5544996337890625, 'eval/loss': tensor(2.9460, device='cuda:0'), 'eval/top-1-acc': 0.669875, 'eval/top-5-acc': 0.962, 'eval/precision': 0.7096975270175969, 'eval/recall': 0.669875, 'eval/F1': 0.6782148459169458, 'eval/AUC': 0.9027989322916666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 22:05:07,601 INFO] confusion matrix:
[[0.955   0.0025  0.00125 0.      0.00125 0.      0.01375 0.      0.0175
  0.00875]
 [0.0625  0.7875  0.      0.00375 0.00125 0.01125 0.06625 0.06375 0.00375
  0.     ]
 [0.005   0.      0.82    0.      0.      0.      0.1475  0.005   0.
  0.0225 ]
 [0.005   0.13875 0.      0.30125 0.015   0.1375  0.235   0.165   0.0025
  0.     ]
 [0.      0.0075  0.      0.00125 0.7375  0.01    0.2075  0.03625 0.
  0.     ]
 [0.00125 0.03125 0.      0.04625 0.03125 0.67    0.16875 0.04875 0.00125
  0.00125]
 [0.00375 0.01    0.      0.      0.71875 0.01    0.23375 0.0075  0.00375
  0.0125 ]
 [0.00125 0.23625 0.      0.00875 0.00375 0.01625 0.145   0.5875  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.01875 0.00125 0.96625
  0.0075 ]
 [0.01875 0.00125 0.17    0.      0.      0.      0.115   0.00375 0.00875
  0.6825 ]]
[2023-08-04 22:05:07,612 INFO] 911000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1768, device='cuda:0'), 'train/shrink_loss': tensor(0.0569, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0456, device='cuda:0'), 'train/removed_class_idx': 2.451612639611544, 'train/uncertainty_avg': 0.7674748120379018, 'train/certain_ratio_ema': 0.801945995349723, 'train/total_loss': tensor(0.2225, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.011035039971307259, 'train/prefecth_time': 0.019480480194091796, 'train/run_time': 0.5481353149414062, 'eval/loss': tensor(2.9932, device='cuda:0'), 'eval/top-1-acc': 0.674125, 'eval/top-5-acc': 0.956625, 'eval/precision': 0.7185847680414421, 'eval/recall': 0.674125, 'eval/F1': 0.6777207684161055, 'eval/AUC': 0.9005631857638889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 22:15:00,637 INFO] confusion matrix:
[[0.95    0.0025  0.      0.      0.00125 0.      0.0175  0.00125 0.0175
  0.01   ]
 [0.06375 0.78125 0.      0.005   0.00125 0.01    0.07    0.0625  0.00625
  0.     ]
 [0.005   0.      0.815   0.      0.      0.      0.15    0.005   0.
  0.025  ]
 [0.005   0.1175  0.      0.2975  0.0125  0.1675  0.23125 0.1675  0.00125
  0.     ]
 [0.      0.0075  0.      0.0025  0.735   0.0075  0.21375 0.0325  0.00125
  0.     ]
 [0.00125 0.02375 0.      0.1675  0.02875 0.55875 0.17375 0.04    0.005
  0.00125]
 [0.0025  0.0075  0.00125 0.00375 0.70625 0.00625 0.25125 0.00625 0.005
  0.01   ]
 [0.0025  0.24875 0.      0.01375 0.00625 0.01625 0.1475  0.5625  0.00125
  0.00125]
 [0.005   0.      0.0025  0.      0.      0.      0.02125 0.00125 0.965
  0.005  ]
 [0.01625 0.00125 0.19875 0.      0.      0.      0.13    0.0025  0.01
  0.64125]]
[2023-08-04 22:15:00,647 INFO] 912000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.1924e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1284, device='cuda:0'), 'train/shrink_loss': tensor(0.0287, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0231, device='cuda:0'), 'train/removed_class_idx': 2.32894706198065, 'train/uncertainty_avg': 0.7704382779895521, 'train/certain_ratio_ema': 0.8051048955945302, 'train/total_loss': tensor(0.1516, device='cuda:0'), 'train/mask_ratio': tensor(0.8304, device='cuda:0'), 'lr': 0.01099846416870393, 'train/prefecth_time': 0.02556105613708496, 'train/run_time': 0.5396219482421875, 'eval/loss': tensor(3.2171, device='cuda:0'), 'eval/top-1-acc': 0.65575, 'eval/top-5-acc': 0.954875, 'eval/precision': 0.6884775391549084, 'eval/recall': 0.65575, 'eval/F1': 0.6592795474207114, 'eval/AUC': 0.8936355034722221}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 22:24:53,211 INFO] confusion matrix:
[[0.9375  0.00125 0.      0.00125 0.00125 0.      0.02875 0.      0.0175
  0.0125 ]
 [0.06    0.78625 0.      0.05    0.00625 0.01    0.0725  0.00875 0.00625
  0.     ]
 [0.00625 0.      0.8025  0.00375 0.      0.      0.1575  0.      0.00125
  0.02875]
 [0.00375 0.1025  0.      0.465   0.01125 0.16125 0.23625 0.0175  0.0025
  0.     ]
 [0.      0.0075  0.      0.035   0.725   0.00875 0.21875 0.00375 0.00125
  0.     ]
 [0.00125 0.025   0.      0.16    0.02625 0.5975  0.1825  0.0025  0.005
  0.     ]
 [0.0025  0.00875 0.00125 0.00875 0.69625 0.01    0.2575  0.      0.005
  0.01   ]
 [0.00125 0.25625 0.      0.225   0.01    0.01875 0.15375 0.3325  0.00125
  0.00125]
 [0.005   0.      0.0025  0.00125 0.      0.      0.03125 0.      0.95375
  0.00625]
 [0.0175  0.00125 0.2075  0.0025  0.      0.      0.13    0.      0.01125
  0.63   ]]
[2023-08-04 22:24:53,222 INFO] 913000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1397, device='cuda:0'), 'train/shrink_loss': tensor(0.0621, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0500, device='cuda:0'), 'train/removed_class_idx': 2.540540311663035, 'train/uncertainty_avg': 0.7168605406707249, 'train/certain_ratio_ema': 0.8046987213190947, 'train/total_loss': tensor(0.1899, device='cuda:0'), 'train/mask_ratio': tensor(0.7522, device='cuda:0'), 'lr': 0.010961869469311521, 'train/prefecth_time': 0.02108700752258301, 'train/run_time': 0.57141943359375, 'eval/loss': tensor(3.1248, device='cuda:0'), 'eval/top-1-acc': 0.64875, 'eval/top-5-acc': 0.9615, 'eval/precision': 0.7029188484124593, 'eval/recall': 0.64875, 'eval/F1': 0.655358261283788, 'eval/AUC': 0.89394453125}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 22:34:57,558 INFO] confusion matrix:
[[0.9425  0.00125 0.00125 0.00125 0.00125 0.      0.02625 0.      0.0175
  0.00875]
 [0.05875 0.78875 0.      0.00375 0.00375 0.01125 0.065   0.06375 0.005
  0.     ]
 [0.00375 0.      0.8175  0.      0.      0.      0.14625 0.00375 0.0025
  0.02625]
 [0.005   0.105   0.      0.31125 0.0075  0.18625 0.22625 0.1575  0.00125
  0.     ]
 [0.      0.0075  0.00125 0.0125  0.725   0.01    0.21375 0.02875 0.00125
  0.     ]
 [0.00125 0.0225  0.      0.21375 0.0275  0.535   0.1525  0.0425  0.00375
  0.00125]
 [0.0025  0.00625 0.00125 0.005   0.69625 0.0125  0.255   0.00625 0.00375
  0.01125]
 [0.00125 0.2075  0.      0.03125 0.00625 0.01375 0.13125 0.6075  0.
  0.00125]
 [0.005   0.      0.0025  0.      0.      0.      0.07625 0.      0.91
  0.00625]
 [0.015   0.00125 0.18    0.00125 0.      0.      0.125   0.0025  0.01
  0.665  ]]
[2023-08-04 22:34:57,569 INFO] 914000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.6216e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1316, device='cuda:0'), 'train/shrink_loss': tensor(0.0604, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0485, device='cuda:0'), 'train/removed_class_idx': 2.381443053459479, 'train/uncertainty_avg': 0.7582955405141393, 'train/certain_ratio_ema': 0.8023927537609318, 'train/total_loss': tensor(0.1801, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.010925255936004472, 'train/prefecth_time': 0.020866847991943358, 'train/run_time': 0.550392333984375, 'eval/loss': tensor(3.0103, device='cuda:0'), 'eval/top-1-acc': 0.65575, 'eval/top-5-acc': 0.969375, 'eval/precision': 0.6865708478284427, 'eval/recall': 0.65575, 'eval/F1': 0.6616441124919689, 'eval/AUC': 0.9037526388888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 22:44:42,866 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 22:44:52,788 INFO] confusion matrix:
[[0.9225  0.      0.00125 0.      0.00125 0.      0.04625 0.0025  0.01875
  0.0075 ]
 [0.06125 0.76625 0.      0.00375 0.0025  0.01125 0.0725  0.07625 0.00625
  0.     ]
 [0.00625 0.      0.8225  0.      0.      0.      0.14125 0.00375 0.0025
  0.02375]
 [0.00375 0.09375 0.      0.26625 0.00875 0.1725  0.22    0.23375 0.00125
  0.     ]
 [0.00125 0.0075  0.00125 0.00375 0.725   0.00625 0.215   0.03625 0.0025
  0.00125]
 [0.00125 0.02625 0.      0.28    0.0275  0.46625 0.14    0.055   0.00375
  0.     ]
 [0.0025  0.0075  0.00125 0.00375 0.69375 0.01125 0.2575  0.01    0.00375
  0.00875]
 [0.00125 0.2025  0.      0.01625 0.005   0.0125  0.13    0.63125 0.
  0.00125]
 [0.005   0.      0.0025  0.      0.      0.      0.11125 0.00125 0.875
  0.005  ]
 [0.01625 0.00125 0.17125 0.      0.      0.      0.1325  0.00375 0.015
  0.66   ]]
[2023-08-04 22:44:52,795 INFO] 915000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.0476e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1342, device='cuda:0'), 'train/shrink_loss': tensor(0.0433, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0349, device='cuda:0'), 'train/removed_class_idx': 2.520833070746555, 'train/uncertainty_avg': 0.744345895088887, 'train/certain_ratio_ema': 0.806528077308837, 'train/total_loss': tensor(0.1692, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.010888623631689591, 'train/prefecth_time': 0.03289523315429688, 'train/run_time': 0.5768295288085937, 'eval/loss': tensor(3.2502, device='cuda:0'), 'eval/top-1-acc': 0.63925, 'eval/top-5-acc': 0.962875, 'eval/precision': 0.6713918686133692, 'eval/recall': 0.63925, 'eval/F1': 0.6449218668123818, 'eval/AUC': 0.8949211024305553}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 22:54:46,472 INFO] confusion matrix:
[[0.9075  0.00125 0.0025  0.      0.00125 0.      0.0575  0.00125 0.01875
  0.01   ]
 [0.05875 0.78125 0.      0.00875 0.00125 0.01125 0.0775  0.0575  0.00375
  0.     ]
 [0.00625 0.      0.8225  0.      0.      0.      0.13875 0.00375 0.00125
  0.0275 ]
 [0.00375 0.09875 0.      0.38    0.01    0.17125 0.2175  0.1175  0.00125
  0.     ]
 [0.      0.0075  0.00125 0.0125  0.7225  0.0075  0.2175  0.03    0.
  0.00125]
 [0.      0.02125 0.      0.27875 0.02625 0.49125 0.14875 0.03375 0.
  0.     ]
 [0.0025  0.0075  0.00125 0.005   0.6975  0.01    0.25875 0.00625 0.0025
  0.00875]
 [0.      0.24125 0.      0.05625 0.0075  0.01875 0.135   0.54    0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.1175  0.      0.87125
  0.00375]
 [0.01375 0.00125 0.18875 0.      0.      0.      0.12875 0.00375 0.01125
  0.6525 ]]
[2023-08-04 22:54:46,484 INFO] 916000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1899, device='cuda:0'), 'train/shrink_loss': tensor(0.0596, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0480, device='cuda:0'), 'train/removed_class_idx': 2.2823526726643912, 'train/uncertainty_avg': 0.7668172060387421, 'train/certain_ratio_ema': 0.8061413718874934, 'train/total_loss': tensor(0.2380, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.010851972619305926, 'train/prefecth_time': 0.019113439559936524, 'train/run_time': 0.5738567504882812, 'eval/loss': tensor(3.2002, device='cuda:0'), 'eval/top-1-acc': 0.64275, 'eval/top-5-acc': 0.963375, 'eval/precision': 0.6823836006760495, 'eval/recall': 0.64275, 'eval/F1': 0.6530749322284923, 'eval/AUC': 0.892927361111111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 23:04:40,987 INFO] confusion matrix:
[[0.91375 0.0025  0.00125 0.      0.00125 0.      0.05125 0.00125 0.01875
  0.01   ]
 [0.06125 0.79625 0.      0.00375 0.00125 0.0125  0.065   0.05875 0.00125
  0.     ]
 [0.0075  0.00125 0.81375 0.      0.      0.      0.13375 0.0025  0.00125
  0.04   ]
 [0.005   0.095   0.      0.26625 0.01125 0.235   0.2125  0.175   0.
  0.     ]
 [0.      0.0075  0.      0.00125 0.72625 0.01125 0.21375 0.04    0.
  0.     ]
 [0.00125 0.01875 0.      0.24125 0.02625 0.51    0.14625 0.055   0.
  0.00125]
 [0.0025  0.01    0.00125 0.0025  0.7     0.01    0.2525  0.0075  0.0025
  0.01125]
 [0.      0.235   0.      0.02375 0.00625 0.02    0.13125 0.5825  0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.12375 0.      0.865
  0.00375]
 [0.01375 0.00125 0.18625 0.      0.      0.      0.12875 0.0025  0.01625
  0.65125]]
[2023-08-04 23:04:40,999 INFO] 917000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1284e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1365, device='cuda:0'), 'train/shrink_loss': tensor(0.0463, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0371, device='cuda:0'), 'train/removed_class_idx': 2.4814811751257806, 'train/uncertainty_avg': 0.743577688011391, 'train/certain_ratio_ema': 0.8009086812820708, 'train/total_loss': tensor(0.1736, device='cuda:0'), 'train/mask_ratio': tensor(0.8192, device='cuda:0'), 'lr': 0.010815302961824683, 'train/prefecth_time': 0.03419830322265625, 'train/run_time': 0.5573942260742187, 'eval/loss': tensor(3.2705, device='cuda:0'), 'eval/top-1-acc': 0.63775, 'eval/top-5-acc': 0.96375, 'eval/precision': 0.668692456868492, 'eval/recall': 0.63775, 'eval/F1': 0.6432704439144873, 'eval/AUC': 0.8926509288194446}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 23:14:38,662 INFO] confusion matrix:
[[0.9325  0.00375 0.0025  0.      0.00125 0.      0.03375 0.      0.0175
  0.00875]
 [0.06375 0.77875 0.      0.0025  0.00125 0.01125 0.06875 0.07    0.0025
  0.00125]
 [0.01125 0.      0.80375 0.      0.      0.      0.145   0.00375 0.00125
  0.035  ]
 [0.005   0.0875  0.      0.31625 0.01125 0.165   0.2075  0.205   0.0025
  0.     ]
 [0.      0.0075  0.      0.00625 0.715   0.01125 0.21625 0.04375 0.
  0.     ]
 [0.00125 0.02    0.      0.34    0.0225  0.4175  0.15125 0.0475  0.
  0.     ]
 [0.00375 0.01    0.00125 0.0025  0.69    0.0075  0.2625  0.0075  0.0025
  0.0125 ]
 [0.      0.22125 0.      0.02125 0.00875 0.02125 0.135   0.59125 0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.13    0.00125 0.85625
  0.005  ]
 [0.01375 0.0025  0.19125 0.      0.      0.      0.13125 0.00375 0.015
  0.6425 ]]
[2023-08-04 23:14:38,674 INFO] 918000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1555, device='cuda:0'), 'train/shrink_loss': tensor(0.0688, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0546, device='cuda:0'), 'train/removed_class_idx': 2.3434341067238273, 'train/uncertainty_avg': 0.7889801363939578, 'train/certain_ratio_ema': 0.794118757241182, 'train/total_loss': tensor(0.2103, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.01077861472224909, 'train/prefecth_time': 0.02448761558532715, 'train/run_time': 0.55896923828125, 'eval/loss': tensor(3.3495, device='cuda:0'), 'eval/top-1-acc': 0.631625, 'eval/top-5-acc': 0.954125, 'eval/precision': 0.6650166097462777, 'eval/recall': 0.631625, 'eval/F1': 0.6385501281493747, 'eval/AUC': 0.8898533420138891}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 23:24:43,320 INFO] confusion matrix:
[[0.945   0.00375 0.      0.      0.00125 0.      0.02625 0.      0.015
  0.00875]
 [0.0625  0.7775  0.      0.00625 0.00375 0.01125 0.0725  0.06375 0.0025
  0.     ]
 [0.01125 0.      0.8025  0.      0.      0.      0.14125 0.00375 0.00125
  0.04   ]
 [0.005   0.08875 0.      0.36625 0.01    0.14375 0.21375 0.17    0.0025
  0.     ]
 [0.00125 0.0075  0.      0.0075  0.72125 0.00875 0.21875 0.035   0.
  0.     ]
 [0.00125 0.0225  0.      0.34875 0.03    0.415   0.14125 0.04    0.
  0.00125]
 [0.00375 0.00875 0.00125 0.00375 0.695   0.00875 0.2575  0.0075  0.0025
  0.01125]
 [0.      0.22875 0.      0.02375 0.00875 0.01625 0.14    0.58125 0.
  0.00125]
 [0.0075  0.      0.00125 0.      0.      0.      0.13    0.00125 0.855
  0.005  ]
 [0.01625 0.0025  0.2025  0.      0.      0.      0.1225  0.0025  0.015
  0.63875]]
[2023-08-04 23:24:43,330 INFO] 919000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1316, device='cuda:0'), 'train/shrink_loss': tensor(0.0526, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0422, device='cuda:0'), 'train/removed_class_idx': 2.4421050060942098, 'train/uncertainty_avg': 0.7711525484901173, 'train/certain_ratio_ema': 0.8032743998846366, 'train/total_loss': tensor(0.1743, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.010741907963614294, 'train/prefecth_time': 0.048549312591552735, 'train/run_time': 0.5487337646484375, 'eval/loss': tensor(3.3562, device='cuda:0'), 'eval/top-1-acc': 0.636, 'eval/top-5-acc': 0.9535, 'eval/precision': 0.6716906478615714, 'eval/recall': 0.6359999999999999, 'eval/F1': 0.6435987570093609, 'eval/AUC': 0.8890106250000003}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 23:34:27,867 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-04 23:34:37,523 INFO] confusion matrix:
[[0.915   0.0025  0.      0.00125 0.00125 0.      0.0525  0.00125 0.015
  0.01125]
 [0.05875 0.775   0.      0.055   0.00625 0.01125 0.075   0.01625 0.00125
  0.00125]
 [0.01    0.      0.79875 0.00375 0.      0.      0.14625 0.00125 0.00125
  0.03875]
 [0.005   0.09875 0.      0.515   0.00875 0.1375  0.2175  0.01625 0.00125
  0.     ]
 [0.00125 0.0075  0.      0.03375 0.74375 0.01    0.19625 0.0075  0.
  0.     ]
 [0.00125 0.02    0.      0.2125  0.03    0.58125 0.14625 0.0075  0.
  0.00125]
 [0.00375 0.00875 0.00125 0.0075  0.70125 0.01125 0.24875 0.00125 0.0025
  0.01375]
 [0.      0.2725  0.      0.18    0.00625 0.02625 0.12125 0.39125 0.
  0.0025 ]
 [0.005   0.      0.0025  0.      0.      0.      0.125   0.00125 0.8625
  0.00375]
 [0.01125 0.00125 0.21875 0.00125 0.      0.      0.12    0.      0.01625
  0.63125]]
[2023-08-04 23:34:37,529 INFO] 920000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0009, device='cuda:0'), 'train/certain_loss': tensor(0.1554, device='cuda:0'), 'train/shrink_loss': tensor(0.0602, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0484, device='cuda:0'), 'train/removed_class_idx': 2.342592375685891, 'train/uncertainty_avg': 0.7683130047930985, 'train/certain_ratio_ema': 0.803255796370915, 'train/total_loss': tensor(0.2047, device='cuda:0'), 'train/mask_ratio': tensor(0.7589, device='cuda:0'), 'lr': 0.010705182748987288, 'train/prefecth_time': 0.01827497673034668, 'train/run_time': 0.5544406127929687, 'eval/loss': tensor(3.1065, device='cuda:0'), 'eval/top-1-acc': 0.64625, 'eval/top-5-acc': 0.964125, 'eval/precision': 0.7003123986315569, 'eval/recall': 0.64625, 'eval/F1': 0.6565316253624703, 'eval/AUC': 0.8938807118055555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 23:44:36,827 INFO] confusion matrix:
[[0.905   0.005   0.      0.      0.00125 0.      0.0625  0.00125 0.01625
  0.00875]
 [0.0575  0.83125 0.      0.00125 0.00375 0.01    0.0725  0.0225  0.00125
  0.     ]
 [0.0025  0.0025  0.79625 0.      0.      0.      0.1475  0.00375 0.00125
  0.04625]
 [0.00375 0.1775  0.00125 0.33375 0.01375 0.19375 0.21125 0.06    0.005
  0.     ]
 [0.      0.01375 0.      0.00625 0.745   0.01    0.2025  0.0225  0.
  0.     ]
 [0.00125 0.03    0.      0.2375  0.03875 0.51    0.145   0.0375  0.
  0.     ]
 [0.0025  0.01375 0.00125 0.00375 0.7     0.0075  0.2575  0.0025  0.00125
  0.01   ]
 [0.0025  0.29125 0.00125 0.0325  0.0075  0.0275  0.11375 0.52    0.00125
  0.0025 ]
 [0.005   0.      0.00125 0.      0.      0.      0.12375 0.00125 0.8625
  0.00625]
 [0.0075  0.0025  0.16    0.      0.      0.      0.11375 0.0025  0.0125
  0.70125]]
[2023-08-04 23:44:36,838 INFO] 921000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.3254e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1501, device='cuda:0'), 'train/shrink_loss': tensor(0.0372, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0292, device='cuda:0'), 'train/removed_class_idx': 2.5392154373318196, 'train/uncertainty_avg': 0.7307170485784157, 'train/certain_ratio_ema': 0.7857591749943623, 'train/total_loss': tensor(0.1794, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.010668439141466741, 'train/prefecth_time': 0.018648256301879884, 'train/run_time': 0.5540888671875, 'eval/loss': tensor(3.0274, device='cuda:0'), 'eval/top-1-acc': 0.64625, 'eval/top-5-acc': 0.9615, 'eval/precision': 0.6872112532620023, 'eval/recall': 0.64625, 'eval/F1': 0.654078903513879, 'eval/AUC': 0.8939767187500002}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-04 23:54:33,862 INFO] confusion matrix:
[[0.91375 0.0025  0.      0.      0.00125 0.      0.05625 0.00125 0.01375
  0.01125]
 [0.06125 0.785   0.      0.02125 0.005   0.01125 0.07375 0.04125 0.00125
  0.     ]
 [0.00125 0.00125 0.79375 0.00125 0.      0.      0.14875 0.005   0.0025
  0.04625]
 [0.00375 0.115   0.      0.33375 0.0125  0.1775  0.22625 0.11125 0.02
  0.     ]
 [0.      0.00625 0.      0.0125  0.74625 0.0125  0.195   0.02375 0.00375
  0.     ]
 [0.00125 0.01125 0.      0.06    0.03    0.69875 0.14125 0.0575  0.
  0.     ]
 [0.0025  0.0075  0.00125 0.00375 0.68375 0.01625 0.265   0.0075  0.00125
  0.01125]
 [0.0025  0.2175  0.      0.08625 0.00375 0.02625 0.1275  0.52375 0.01
  0.0025 ]
 [0.00625 0.      0.00125 0.      0.      0.      0.0875  0.00125 0.89875
  0.005  ]
 [0.0075  0.00125 0.125   0.      0.      0.      0.13    0.0025  0.015
  0.71875]]
[2023-08-04 23:54:33,878 INFO] 922000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1641, device='cuda:0'), 'train/shrink_loss': tensor(0.0404, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0317, device='cuda:0'), 'train/removed_class_idx': 2.315217139650311, 'train/uncertainty_avg': 0.7605692688522462, 'train/certain_ratio_ema': 0.7832126138663572, 'train/total_loss': tensor(0.1959, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.010631677204182956, 'train/prefecth_time': 0.020964128494262695, 'train/run_time': 0.5587338256835938, 'eval/loss': tensor(2.8478, device='cuda:0'), 'eval/top-1-acc': 0.66775, 'eval/top-5-acc': 0.9555, 'eval/precision': 0.7040210442151558, 'eval/recall': 0.66775, 'eval/F1': 0.6752635424700328, 'eval/AUC': 0.9002694357638888}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 00:04:28,908 INFO] confusion matrix:
[[0.92875 0.00125 0.00125 0.0025  0.00125 0.      0.03875 0.00125 0.01375
  0.01125]
 [0.06    0.76375 0.      0.04375 0.0025  0.01    0.0775  0.04    0.0025
  0.     ]
 [0.00125 0.00125 0.82    0.00125 0.      0.      0.14    0.005   0.00125
  0.03   ]
 [0.00375 0.0625  0.      0.42125 0.005   0.1125  0.24125 0.13125 0.0225
  0.     ]
 [0.      0.0075  0.      0.01625 0.7175  0.00875 0.21875 0.025   0.005
  0.00125]
 [0.00125 0.01375 0.      0.0875  0.03    0.61625 0.165   0.0825  0.00375
  0.     ]
 [0.00375 0.005   0.0025  0.005   0.6825  0.0125  0.27125 0.00375 0.00375
  0.01   ]
 [0.0025  0.19125 0.      0.1175  0.005   0.01625 0.15375 0.49    0.0225
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.04375 0.00125 0.94375
  0.005  ]
 [0.0125  0.00125 0.10875 0.      0.      0.      0.11875 0.0025  0.0125
  0.74375]]
[2023-08-05 00:04:28,923 INFO] 923000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.7833e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1640, device='cuda:0'), 'train/shrink_loss': tensor(0.0633, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0498, device='cuda:0'), 'train/removed_class_idx': 2.3367344554352596, 'train/uncertainty_avg': 0.7629702495645705, 'train/certain_ratio_ema': 0.7863999963235688, 'train/total_loss': tensor(0.2139, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.010594897000297709, 'train/prefecth_time': 0.021463136672973632, 'train/run_time': 0.552685302734375, 'eval/loss': tensor(2.8549, device='cuda:0'), 'eval/top-1-acc': 0.671625, 'eval/top-5-acc': 0.967875, 'eval/precision': 0.706874013981214, 'eval/recall': 0.6716249999999999, 'eval/F1': 0.6816398587594884, 'eval/AUC': 0.9027876302083331}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 00:14:34,660 INFO] confusion matrix:
[[0.92125 0.0025  0.00125 0.0025  0.00125 0.      0.0475  0.00125 0.01375
  0.00875]
 [0.05625 0.7775  0.      0.055   0.00375 0.01    0.08125 0.01625 0.
  0.     ]
 [0.00125 0.      0.8225  0.00625 0.      0.      0.14625 0.00125 0.0025
  0.02   ]
 [0.0025  0.0875  0.      0.5325  0.00875 0.10625 0.24375 0.0125  0.00625
  0.     ]
 [0.      0.0075  0.      0.0275  0.73125 0.005   0.22    0.005   0.00375
  0.     ]
 [0.      0.02    0.      0.2075  0.03375 0.54625 0.1725  0.02    0.
  0.     ]
 [0.00375 0.00625 0.00125 0.0125  0.685   0.01125 0.2725  0.00125 0.00375
  0.0025 ]
 [0.      0.23625 0.      0.2325  0.005   0.01375 0.16875 0.33625 0.00625
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.05875 0.00125 0.93
  0.005  ]
 [0.0125  0.00125 0.1325  0.0025  0.      0.      0.13125 0.      0.01125
  0.70875]]
[2023-08-05 00:14:34,675 INFO] 924000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1383, device='cuda:0'), 'train/shrink_loss': tensor(0.0698, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0550, device='cuda:0'), 'train/removed_class_idx': 2.3723401731553007, 'train/uncertainty_avg': 0.7490642586463762, 'train/certain_ratio_ema': 0.7881344965749753, 'train/total_loss': tensor(0.1934, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.01055809859300415, 'train/prefecth_time': 0.019372928619384767, 'train/run_time': 0.5721904907226563, 'eval/loss': tensor(2.8870, device='cuda:0'), 'eval/top-1-acc': 0.657875, 'eval/top-5-acc': 0.9635, 'eval/precision': 0.7170117010304091, 'eval/recall': 0.657875, 'eval/F1': 0.6686500471863858, 'eval/AUC': 0.9044469878472221}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 00:24:21,829 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 00:24:31,810 INFO] confusion matrix:
[[0.89625 0.0025  0.      0.00125 0.00125 0.00125 0.0675  0.00125 0.0175
  0.01125]
 [0.0575  0.785   0.      0.00375 0.00375 0.0125  0.0775  0.05875 0.00125
  0.     ]
 [0.00125 0.00125 0.80375 0.      0.      0.      0.1625  0.00375 0.00375
  0.02375]
 [0.00375 0.12    0.      0.25125 0.015   0.14875 0.24875 0.21    0.0025
  0.     ]
 [0.      0.0075  0.      0.00375 0.725   0.0075  0.22    0.035   0.
  0.00125]
 [0.00125 0.01625 0.      0.13625 0.03875 0.5475  0.17375 0.08625 0.
  0.     ]
 [0.00375 0.00625 0.0025  0.00125 0.6775  0.01    0.28375 0.00625 0.00125
  0.0075 ]
 [0.00125 0.2325  0.      0.01125 0.00625 0.01125 0.15    0.58625 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.09875 0.00125 0.88625
  0.0075 ]
 [0.01125 0.00125 0.18125 0.      0.      0.      0.13125 0.00375 0.01375
  0.6575 ]]
[2023-08-05 00:24:31,819 INFO] 925000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.9604e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1116, device='cuda:0'), 'train/shrink_loss': tensor(0.0508, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0406, device='cuda:0'), 'train/removed_class_idx': 2.434210206024973, 'train/uncertainty_avg': 0.7843054093149048, 'train/certain_ratio_ema': 0.7990330201369726, 'train/total_loss': tensor(0.1522, device='cuda:0'), 'train/mask_ratio': tensor(0.8304, device='cuda:0'), 'lr': 0.01052128204552674, 'train/prefecth_time': 0.01929792022705078, 'train/run_time': 0.5414522094726563, 'eval/loss': tensor(3.0806, device='cuda:0'), 'eval/top-1-acc': 0.64225, 'eval/top-5-acc': 0.9655, 'eval/precision': 0.6894864756363114, 'eval/recall': 0.64225, 'eval/F1': 0.6504502707759561, 'eval/AUC': 0.9000711371527779}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 00:34:24,707 INFO] confusion matrix:
[[0.91    0.      0.      0.005   0.0025  0.00125 0.0525  0.      0.0175
  0.01125]
 [0.06    0.77375 0.      0.065   0.00375 0.0125  0.07125 0.01125 0.0025
  0.     ]
 [0.00125 0.00125 0.80375 0.00375 0.      0.      0.16625 0.0025  0.00375
  0.0175 ]
 [0.00375 0.10125 0.      0.4975  0.00875 0.14875 0.22875 0.01    0.00125
  0.     ]
 [0.      0.00875 0.      0.03375 0.73375 0.0075  0.2075  0.00875 0.
  0.     ]
 [0.00125 0.0175  0.      0.1725  0.03125 0.60625 0.16    0.01    0.
  0.00125]
 [0.0025  0.00625 0.00125 0.00875 0.68375 0.01375 0.27625 0.00125 0.00125
  0.005  ]
 [0.00125 0.2425  0.      0.25875 0.0075  0.0175  0.135   0.33625 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.065   0.      0.92375
  0.00625]
 [0.01    0.00125 0.2     0.00375 0.      0.      0.13    0.00125 0.0125
  0.64125]]
[2023-08-05 00:34:24,723 INFO] 926000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1506, device='cuda:0'), 'train/shrink_loss': tensor(0.0704, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0563, device='cuda:0'), 'train/removed_class_idx': 2.298968835157852, 'train/uncertainty_avg': 0.7631823687573348, 'train/certain_ratio_ema': 0.7995516200169213, 'train/total_loss': tensor(0.2074, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.010484447421121076, 'train/prefecth_time': 0.018710655212402345, 'train/run_time': 0.5556502075195312, 'eval/loss': tensor(2.9651, device='cuda:0'), 'eval/top-1-acc': 0.65025, 'eval/top-5-acc': 0.965375, 'eval/precision': 0.7074206903779936, 'eval/recall': 0.65025, 'eval/F1': 0.6594901627119779, 'eval/AUC': 0.9031876128472222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 00:44:19,285 INFO] confusion matrix:
[[0.945   0.00125 0.      0.00125 0.0025  0.00125 0.01625 0.      0.0175
  0.015  ]
 [0.06125 0.78125 0.      0.06625 0.005   0.0125  0.0625  0.0075  0.00375
  0.     ]
 [0.      0.      0.7925  0.01125 0.      0.      0.16125 0.      0.0025
  0.0325 ]
 [0.00375 0.0975  0.      0.47375 0.0075  0.185   0.2275  0.00375 0.00125
  0.     ]
 [0.      0.00875 0.      0.0375  0.73    0.00875 0.21125 0.00375 0.
  0.     ]
 [0.00125 0.02375 0.      0.08625 0.03    0.6875  0.16375 0.00625 0.00125
  0.     ]
 [0.0025  0.0075  0.00125 0.00875 0.665   0.015   0.2925  0.      0.00375
  0.00375]
 [0.      0.24625 0.      0.28375 0.00375 0.01875 0.13125 0.315   0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.03625 0.      0.95125
  0.0075 ]
 [0.00625 0.00125 0.205   0.005   0.      0.      0.1125  0.      0.01125
  0.65875]]
[2023-08-05 00:44:19,300 INFO] 927000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1172, device='cuda:0'), 'train/shrink_loss': tensor(0.0531, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0422, device='cuda:0'), 'train/removed_class_idx': 2.391666467361128, 'train/uncertainty_avg': 0.7448159590565253, 'train/certain_ratio_ema': 0.7941398433024272, 'train/total_loss': tensor(0.1595, device='cuda:0'), 'train/mask_ratio': tensor(0.7321, device='cuda:0'), 'lr': 0.010447594783073819, 'train/prefecth_time': 0.01906163215637207, 'train/run_time': 0.5694810180664063, 'eval/loss': tensor(2.9114, device='cuda:0'), 'eval/top-1-acc': 0.66275, 'eval/top-5-acc': 0.964375, 'eval/precision': 0.7135475895483349, 'eval/recall': 0.66275, 'eval/F1': 0.6672676372229192, 'eval/AUC': 0.9090195486111112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 00:54:12,538 INFO] confusion matrix:
[[0.95    0.00125 0.      0.      0.0025  0.      0.01875 0.0025  0.015
  0.01   ]
 [0.06125 0.7975  0.      0.00375 0.005   0.01125 0.05625 0.06125 0.00375
  0.     ]
 [0.00375 0.      0.7775  0.      0.      0.      0.18875 0.01625 0.00375
  0.01   ]
 [0.0025  0.1125  0.      0.28    0.0125  0.15875 0.235   0.1975  0.00125
  0.     ]
 [0.      0.00875 0.      0.00125 0.73875 0.0075  0.205   0.03875 0.
  0.     ]
 [0.      0.02    0.      0.045   0.03    0.6875  0.14625 0.07125 0.
  0.     ]
 [0.0025  0.00625 0.00125 0.      0.66875 0.0125  0.2925  0.01    0.0025
  0.00375]
 [0.      0.21125 0.      0.005   0.005   0.0175  0.12875 0.63125 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.035   0.      0.9525
  0.0075 ]
 [0.0075  0.00125 0.19125 0.      0.      0.      0.1175  0.0075  0.01375
  0.66125]]
[2023-08-05 00:54:12,557 INFO] 928000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.9745e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0960, device='cuda:0'), 'train/shrink_loss': tensor(0.0331, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0264, device='cuda:0'), 'train/removed_class_idx': 2.34693853602668, 'train/uncertainty_avg': 0.7619850934525625, 'train/certain_ratio_ema': 0.7976958352724259, 'train/total_loss': tensor(0.1224, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.010410724194702597, 'train/prefecth_time': 0.02296339225769043, 'train/run_time': 0.5590443725585937, 'eval/loss': tensor(2.7498, device='cuda:0'), 'eval/top-1-acc': 0.676875, 'eval/top-5-acc': 0.961125, 'eval/precision': 0.7246452338405254, 'eval/recall': 0.676875, 'eval/F1': 0.6806343207876738, 'eval/AUC': 0.909177934027778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 01:04:19,363 INFO] confusion matrix:
[[0.95625 0.00125 0.      0.      0.0025  0.      0.01    0.00125 0.0175
  0.01125]
 [0.0625  0.79625 0.      0.0025  0.00625 0.01    0.055   0.06375 0.00375
  0.     ]
 [0.00375 0.      0.785   0.      0.      0.      0.1875  0.005   0.00375
  0.015  ]
 [0.00125 0.12375 0.      0.26    0.00625 0.14375 0.21875 0.245   0.00125
  0.     ]
 [0.      0.00875 0.      0.00625 0.7425  0.00625 0.20125 0.035   0.
  0.     ]
 [0.00125 0.02875 0.      0.28    0.03    0.47625 0.13625 0.0475  0.
  0.     ]
 [0.0025  0.00875 0.00125 0.00375 0.68    0.01    0.27625 0.01125 0.0025
  0.00375]
 [0.      0.2525  0.      0.01875 0.00625 0.01375 0.135   0.5725  0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.02125 0.      0.9675
  0.00625]
 [0.00625 0.0025  0.19    0.      0.      0.      0.105   0.0025  0.0125
  0.68125]]
[2023-08-05 01:04:19,373 INFO] 929000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.6443e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1598, device='cuda:0'), 'train/shrink_loss': tensor(0.0445, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0352, device='cuda:0'), 'train/removed_class_idx': 2.236558899294742, 'train/uncertainty_avg': 0.7659579912780262, 'train/certain_ratio_ema': 0.791837835889202, 'train/total_loss': tensor(0.1951, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.010373835719355854, 'train/prefecth_time': 0.032640384674072265, 'train/run_time': 0.5966744384765625, 'eval/loss': tensor(3.0317, device='cuda:0'), 'eval/top-1-acc': 0.651375, 'eval/top-5-acc': 0.96, 'eval/precision': 0.6750644426966282, 'eval/recall': 0.651375, 'eval/F1': 0.6522773915560783, 'eval/AUC': 0.9027523958333334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 01:14:09,689 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 01:14:19,654 INFO] confusion matrix:
[[0.94125 0.00125 0.      0.      0.0025  0.      0.02875 0.00125 0.01625
  0.00875]
 [0.05625 0.8175  0.      0.00875 0.0025  0.0075  0.05875 0.045   0.0025
  0.00125]
 [0.00125 0.00125 0.785   0.      0.      0.      0.18    0.00375 0.00375
  0.025  ]
 [0.00125 0.1275  0.      0.355   0.0125  0.175   0.2125  0.115   0.00125
  0.     ]
 [0.      0.0075  0.      0.01125 0.74375 0.01125 0.20625 0.02    0.
  0.     ]
 [0.00125 0.02875 0.      0.185   0.03625 0.5825  0.1425  0.02375 0.
  0.     ]
 [0.0025  0.01125 0.00125 0.0025  0.695   0.00875 0.26375 0.00625 0.0025
  0.00625]
 [0.      0.2675  0.      0.0225  0.00625 0.03375 0.13125 0.5375  0.
  0.00125]
 [0.0075  0.      0.00125 0.      0.      0.      0.02625 0.      0.96125
  0.00375]
 [0.00625 0.00125 0.25875 0.      0.      0.      0.11125 0.0025  0.01625
  0.60375]]
[2023-08-05 01:14:19,660 INFO] 930000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1236, device='cuda:0'), 'train/shrink_loss': tensor(0.0561, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0438, device='cuda:0'), 'train/removed_class_idx': 2.350515221596369, 'train/uncertainty_avg': 0.7738571438398038, 'train/certain_ratio_ema': 0.7818174611485884, 'train/total_loss': tensor(0.1676, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.010336929420412793, 'train/prefecth_time': 0.020880064010620116, 'train/run_time': 0.5508524169921875, 'eval/loss': tensor(2.7865, device='cuda:0'), 'eval/top-1-acc': 0.659125, 'eval/top-5-acc': 0.9665, 'eval/precision': 0.6928960447186022, 'eval/recall': 0.659125, 'eval/F1': 0.6633596029674976, 'eval/AUC': 0.9032872135416667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 01:24:14,859 INFO] confusion matrix:
[[0.93125 0.0025  0.      0.      0.00125 0.      0.04    0.      0.01625
  0.00875]
 [0.05875 0.79875 0.      0.04125 0.00375 0.0075  0.055   0.02875 0.00375
  0.0025 ]
 [0.00125 0.00125 0.78625 0.00125 0.      0.      0.16875 0.00125 0.00375
  0.03625]
 [0.005   0.11625 0.      0.4375  0.0075  0.16375 0.22125 0.045   0.00375
  0.     ]
 [0.      0.00875 0.      0.03375 0.735   0.00875 0.20875 0.005   0.
  0.     ]
 [0.      0.04625 0.      0.285   0.03375 0.4475  0.1625  0.025   0.
  0.     ]
 [0.0025  0.015   0.00125 0.00875 0.69375 0.00625 0.26    0.00125 0.00375
  0.0075 ]
 [0.      0.21875 0.      0.05625 0.00375 0.0225  0.1325  0.5625  0.
  0.00375]
 [0.00625 0.      0.      0.      0.      0.      0.02875 0.      0.95875
  0.00625]
 [0.00875 0.00125 0.225   0.      0.      0.      0.12625 0.00375 0.0175
  0.6175 ]]
[2023-08-05 01:24:14,869 INFO] 931000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.6470e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1039, device='cuda:0'), 'train/shrink_loss': tensor(0.0684, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0539, device='cuda:0'), 'train/removed_class_idx': 2.2470585591695813, 'train/uncertainty_avg': 0.7797438906786605, 'train/certain_ratio_ema': 0.7878181459506142, 'train/total_loss': tensor(0.1578, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.010300005361283218, 'train/prefecth_time': 0.0194769287109375, 'train/run_time': 0.5455038452148437, 'eval/loss': tensor(2.8355, device='cuda:0'), 'eval/top-1-acc': 0.6535, 'eval/top-5-acc': 0.963125, 'eval/precision': 0.6919451500604001, 'eval/recall': 0.6535, 'eval/F1': 0.6610588626043907, 'eval/AUC': 0.9028834201388889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 01:34:08,383 INFO] confusion matrix:
[[0.94375 0.0025  0.      0.      0.00125 0.      0.0225  0.      0.0175
  0.0125 ]
 [0.06125 0.795   0.      0.0025  0.0025  0.00875 0.05125 0.0725  0.005
  0.00125]
 [0.      0.00125 0.79375 0.      0.      0.      0.1525  0.00375 0.00625
  0.0425 ]
 [0.005   0.1025  0.      0.26625 0.0075  0.18    0.23375 0.20375 0.00125
  0.     ]
 [0.      0.0075  0.      0.005   0.725   0.0125  0.21375 0.035   0.
  0.00125]
 [0.00125 0.045   0.      0.3425  0.02875 0.33625 0.16875 0.0775  0.
  0.     ]
 [0.0025  0.0125  0.00125 0.0025  0.68375 0.00875 0.27125 0.00625 0.00375
  0.0075 ]
 [0.00125 0.1875  0.      0.01625 0.005   0.0375  0.1425  0.60875 0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.01875 0.      0.97
  0.00375]
 [0.0075  0.00125 0.21    0.      0.      0.00125 0.12    0.0025  0.01625
  0.64125]]
[2023-08-05 01:34:08,394 INFO] 932000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.0952e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2089, device='cuda:0'), 'train/shrink_loss': tensor(0.0495, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0392, device='cuda:0'), 'train/removed_class_idx': 2.36363612488524, 'train/uncertainty_avg': 0.760761463500879, 'train/certain_ratio_ema': 0.7916110695935215, 'train/total_loss': tensor(0.2481, device='cuda:0'), 'train/mask_ratio': tensor(0.7790, device='cuda:0'), 'lr': 0.010263063605407451, 'train/prefecth_time': 0.033444320678710934, 'train/run_time': 0.5648087158203124, 'eval/loss': tensor(3.2158, device='cuda:0'), 'eval/top-1-acc': 0.635125, 'eval/top-5-acc': 0.962, 'eval/precision': 0.6537024246463755, 'eval/recall': 0.635125, 'eval/F1': 0.6342465829495356, 'eval/AUC': 0.8946931944444445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 01:44:00,843 INFO] confusion matrix:
[[0.95    0.0025  0.      0.      0.00125 0.      0.0175  0.      0.01625
  0.0125 ]
 [0.06125 0.8075  0.      0.00875 0.0025  0.01375 0.05625 0.04625 0.0025
  0.00125]
 [0.      0.00125 0.79375 0.      0.      0.0025  0.15    0.      0.0025
  0.05   ]
 [0.00625 0.11    0.      0.305   0.01    0.21125 0.23375 0.1225  0.00125
  0.     ]
 [0.      0.0075  0.      0.0075  0.7275  0.0175  0.22125 0.0175  0.
  0.00125]
 [0.00125 0.0425  0.      0.4425  0.0225  0.33125 0.135   0.025   0.
  0.     ]
 [0.0025  0.0125  0.0025  0.005   0.69625 0.00875 0.25875 0.0025  0.00125
  0.01   ]
 [0.      0.2225  0.      0.02625 0.01    0.0675  0.145   0.5275  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.01625 0.      0.9725
  0.005  ]
 [0.00875 0.00125 0.21375 0.      0.      0.00125 0.11875 0.00125 0.01375
  0.64125]]
[2023-08-05 01:44:00,853 INFO] 933000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.4324e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1169, device='cuda:0'), 'train/shrink_loss': tensor(0.0275, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0219, device='cuda:0'), 'train/removed_class_idx': 2.249999718750035, 'train/uncertainty_avg': 0.78911395416308, 'train/certain_ratio_ema': 0.7944114114890105, 'train/total_loss': tensor(0.1388, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.010226104216256233, 'train/prefecth_time': 0.020620256423950194, 'train/run_time': 0.55744091796875, 'eval/loss': tensor(3.3118, device='cuda:0'), 'eval/top-1-acc': 0.6315, 'eval/top-5-acc': 0.953375, 'eval/precision': 0.6508933663242813, 'eval/recall': 0.6315000000000001, 'eval/F1': 0.6321723978372005, 'eval/AUC': 0.889096449652778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 01:53:53,262 INFO] confusion matrix:
[[0.945   0.0025  0.      0.      0.00125 0.      0.0225  0.      0.01625
  0.0125 ]
 [0.06125 0.79875 0.      0.00625 0.005   0.0075  0.06    0.0575  0.00125
  0.0025 ]
 [0.00125 0.      0.77875 0.      0.      0.      0.16875 0.005   0.00125
  0.045  ]
 [0.00375 0.115   0.      0.30125 0.01125 0.14    0.23625 0.19125 0.00125
  0.     ]
 [0.      0.00625 0.      0.00625 0.72    0.00625 0.22875 0.03    0.
  0.0025 ]
 [0.00125 0.03375 0.      0.42875 0.0225  0.34    0.12    0.0525  0.
  0.00125]
 [0.0025  0.0125  0.0025  0.005   0.66875 0.00625 0.29    0.00375 0.00125
  0.0075 ]
 [0.      0.2075  0.      0.02375 0.00625 0.04125 0.14625 0.57375 0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.00125 0.02125 0.      0.96375
  0.00625]
 [0.00875 0.00125 0.20875 0.      0.      0.00125 0.12875 0.00125 0.01375
  0.63625]]
[2023-08-05 01:53:53,275 INFO] 934000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.8475e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1005, device='cuda:0'), 'train/shrink_loss': tensor(0.0669, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0533, device='cuda:0'), 'train/removed_class_idx': 2.2808986201237507, 'train/uncertainty_avg': 0.7816771254488191, 'train/certain_ratio_ema': 0.796394051502606, 'train/total_loss': tensor(0.1539, device='cuda:0'), 'train/mask_ratio': tensor(0.8013, device='cuda:0'), 'lr': 0.010189127257330583, 'train/prefecth_time': 0.01862118339538574, 'train/run_time': 0.5448460083007812, 'eval/loss': tensor(3.2542, device='cuda:0'), 'eval/top-1-acc': 0.63475, 'eval/top-5-acc': 0.96225, 'eval/precision': 0.658480502927462, 'eval/recall': 0.63475, 'eval/F1': 0.6363836860214631, 'eval/AUC': 0.8973499652777779}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 02:03:42,943 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 02:04:03,118 INFO] confusion matrix:
[[0.9525  0.0025  0.      0.      0.00125 0.      0.01625 0.      0.015
  0.0125 ]
 [0.065   0.83625 0.      0.01    0.00625 0.025   0.0375  0.0175  0.
  0.0025 ]
 [0.00125 0.00125 0.77875 0.      0.      0.00375 0.18875 0.      0.0025
  0.02375]
 [0.0025  0.12125 0.00125 0.375   0.01    0.2775  0.20125 0.01    0.00125
  0.     ]
 [0.      0.0075  0.      0.00625 0.76875 0.02875 0.18125 0.00625 0.
  0.00125]
 [0.00125 0.025   0.      0.565   0.025   0.29625 0.08125 0.00625 0.
  0.     ]
 [0.0025  0.00875 0.0025  0.01125 0.695   0.01    0.26625 0.      0.
  0.00375]
 [0.00125 0.21625 0.      0.0475  0.00875 0.1375  0.14375 0.44375 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.00125 0.03625 0.      0.95125
  0.005  ]
 [0.00875 0.00125 0.21    0.      0.      0.0025  0.155   0.      0.0125
  0.61   ]]
[2023-08-05 02:04:03,125 INFO] 935000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.1007e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1535, device='cuda:0'), 'train/shrink_loss': tensor(0.0466, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0364, device='cuda:0'), 'train/removed_class_idx': 2.4693875031237242, 'train/uncertainty_avg': 0.7671720405560912, 'train/certain_ratio_ema': 0.7823276605301481, 'train/total_loss': tensor(0.1900, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.010152132792161728, 'train/prefecth_time': 0.01976371192932129, 'train/run_time': 0.5507177124023438, 'eval/loss': tensor(3.0976, device='cuda:0'), 'eval/top-1-acc': 0.627875, 'eval/top-5-acc': 0.962375, 'eval/precision': 0.6653710963748662, 'eval/recall': 0.627875, 'eval/F1': 0.63077526172453, 'eval/AUC': 0.8985216753472224}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 02:13:59,395 INFO] confusion matrix:
[[0.95375 0.0025  0.00125 0.      0.00125 0.      0.01375 0.      0.0175
  0.01   ]
 [0.06375 0.82    0.      0.00625 0.005   0.0275  0.0425  0.03375 0.
  0.00125]
 [0.00125 0.      0.78125 0.      0.      0.0025  0.185   0.00125 0.0025
  0.02625]
 [0.0025  0.13    0.      0.325   0.015   0.2425  0.23    0.05375 0.00125
  0.     ]
 [0.      0.00625 0.      0.00625 0.7725  0.015   0.18    0.01875 0.
  0.00125]
 [0.00125 0.03375 0.      0.43125 0.02875 0.355   0.13125 0.01875 0.
  0.     ]
 [0.0025  0.01    0.00125 0.0075  0.6975  0.01    0.2625  0.      0.00125
  0.0075 ]
 [0.00125 0.20125 0.      0.02375 0.00625 0.06875 0.145   0.5525  0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.00125 0.05    0.      0.93875
  0.005  ]
 [0.0075  0.00125 0.1325  0.      0.      0.00125 0.13375 0.00125 0.01375
  0.70875]]
[2023-08-05 02:13:59,406 INFO] 936000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1513, device='cuda:0'), 'train/shrink_loss': tensor(0.0460, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0360, device='cuda:0'), 'train/removed_class_idx': 2.372548787005021, 'train/uncertainty_avg': 0.762498174855542, 'train/certain_ratio_ema': 0.7823939741273277, 'train/total_loss': tensor(0.1875, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.010115120884310953, 'train/prefecth_time': 0.023076799392700194, 'train/run_time': 0.5517630615234375, 'eval/loss': tensor(2.9550, device='cuda:0'), 'eval/top-1-acc': 0.647, 'eval/top-5-acc': 0.9625, 'eval/precision': 0.6751660271734585, 'eval/recall': 0.647, 'eval/F1': 0.6513729515207424, 'eval/AUC': 0.9033042708333335}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 02:23:58,136 INFO] confusion matrix:
[[0.96    0.0025  0.00375 0.      0.00125 0.      0.01    0.      0.01375
  0.00875]
 [0.065   0.815   0.00375 0.0075  0.00375 0.00625 0.045   0.05375 0.
  0.     ]
 [0.00125 0.      0.7775  0.      0.      0.      0.185   0.00125 0.0025
  0.0325 ]
 [0.00375 0.125   0.00125 0.3675  0.015   0.1125  0.24875 0.125   0.00125
  0.     ]
 [0.      0.00625 0.0025  0.01    0.81375 0.0025  0.13875 0.025   0.
  0.00125]
 [0.00125 0.035   0.00125 0.4375  0.025   0.33625 0.13375 0.03    0.
  0.     ]
 [0.0025  0.0125  0.0025  0.01    0.71125 0.0025  0.24625 0.005   0.00125
  0.00625]
 [0.00125 0.2025  0.00125 0.02125 0.01    0.0175  0.20875 0.5325  0.
  0.005  ]
 [0.005   0.      0.      0.      0.      0.      0.045   0.      0.94625
  0.00375]
 [0.0125  0.00125 0.08625 0.      0.      0.      0.12125 0.00125 0.0125
  0.765  ]]
[2023-08-05 02:23:58,147 INFO] 937000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1524, device='cuda:0'), 'train/shrink_loss': tensor(0.0907, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0706, device='cuda:0'), 'train/removed_class_idx': 2.4999997844827773, 'train/uncertainty_avg': 0.7633598300041168, 'train/certain_ratio_ema': 0.7780357906491727, 'train/total_loss': tensor(0.2232, device='cuda:0'), 'train/mask_ratio': tensor(0.7411, device='cuda:0'), 'lr': 0.010078091597369514, 'train/prefecth_time': 0.024647903442382813, 'train/run_time': 0.5605101318359375, 'eval/loss': tensor(2.9483, device='cuda:0'), 'eval/top-1-acc': 0.656, 'eval/top-5-acc': 0.9585, 'eval/precision': 0.6888925425467785, 'eval/recall': 0.6559999999999999, 'eval/F1': 0.658961069786999, 'eval/AUC': 0.90170421875}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 02:33:55,599 INFO] confusion matrix:
[[0.96375 0.0025  0.005   0.      0.00125 0.      0.00375 0.      0.0175
  0.00625]
 [0.06875 0.835   0.00375 0.02125 0.0025  0.0075  0.04125 0.02    0.
  0.     ]
 [0.00125 0.00125 0.755   0.      0.      0.      0.2025  0.      0.00125
  0.03875]
 [0.005   0.115   0.00125 0.45875 0.01125 0.1375  0.26    0.01    0.00125
  0.     ]
 [0.      0.00875 0.00125 0.0175  0.84625 0.00375 0.11375 0.00875 0.
  0.     ]
 [0.00125 0.03    0.00125 0.335   0.02625 0.44    0.155   0.01125 0.
  0.     ]
 [0.0025  0.0125  0.      0.005   0.73375 0.0075  0.23125 0.      0.00125
  0.00625]
 [0.00125 0.22    0.00125 0.0725  0.0075  0.01375 0.25    0.43125 0.
  0.0025 ]
 [0.00625 0.      0.      0.      0.      0.      0.02875 0.      0.95625
  0.00875]
 [0.0125  0.00125 0.03875 0.      0.      0.      0.1475  0.      0.0125
  0.7875 ]]
[2023-08-05 02:33:55,612 INFO] 938000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.1079e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1589, device='cuda:0'), 'train/shrink_loss': tensor(0.0634, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0496, device='cuda:0'), 'train/removed_class_idx': 2.3799997620000237, 'train/uncertainty_avg': 0.7542190792936301, 'train/certain_ratio_ema': 0.7822548540759179, 'train/total_loss': tensor(0.2086, device='cuda:0'), 'train/mask_ratio': tensor(0.7768, device='cuda:0'), 'lr': 0.010041044994958549, 'train/prefecth_time': 0.020615711212158203, 'train/run_time': 0.551428466796875, 'eval/loss': tensor(2.8197, device='cuda:0'), 'eval/top-1-acc': 0.6705, 'eval/top-5-acc': 0.95675, 'eval/precision': 0.7217757637128706, 'eval/recall': 0.6704999999999999, 'eval/F1': 0.6775607382115867, 'eval/AUC': 0.9073026388888888}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 02:43:53,326 INFO] confusion matrix:
[[0.96125 0.0025  0.005   0.      0.00125 0.      0.00375 0.      0.01875
  0.0075 ]
 [0.0675  0.82625 0.00125 0.01    0.0025  0.0075  0.04    0.04375 0.00125
  0.     ]
 [0.00125 0.      0.77875 0.      0.      0.      0.18625 0.00125 0.0025
  0.03   ]
 [0.00375 0.11625 0.      0.38125 0.0075  0.14625 0.27    0.07375 0.00125
  0.     ]
 [0.      0.01    0.      0.015   0.835   0.00625 0.115   0.01875 0.
  0.     ]
 [0.00125 0.03125 0.      0.28125 0.03125 0.4475  0.17375 0.03375 0.
  0.     ]
 [0.00375 0.00875 0.00125 0.005   0.8     0.00875 0.16375 0.00375 0.00125
  0.00375]
 [0.00125 0.2025  0.      0.03375 0.00375 0.0075  0.2175  0.5325  0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02    0.      0.9675
  0.00625]
 [0.01    0.00125 0.03625 0.00125 0.      0.      0.13375 0.00125 0.01625
  0.8    ]]
[2023-08-05 02:43:53,343 INFO] 939000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0007, device='cuda:0'), 'train/certain_loss': tensor(0.1586, device='cuda:0'), 'train/shrink_loss': tensor(0.0772, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0606, device='cuda:0'), 'train/removed_class_idx': 2.523364250152874, 'train/uncertainty_avg': 0.7411120721458424, 'train/certain_ratio_ema': 0.7845877420032014, 'train/total_loss': tensor(0.2199, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.010003981140728917, 'train/prefecth_time': 0.02065180778503418, 'train/run_time': 0.5545875244140624, 'eval/loss': tensor(2.9265, device='cuda:0'), 'eval/top-1-acc': 0.669375, 'eval/top-5-acc': 0.94475, 'eval/precision': 0.7060966210699579, 'eval/recall': 0.669375, 'eval/F1': 0.6749473330424489, 'eval/AUC': 0.9015751649305553}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 02:53:43,142 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 02:53:52,790 INFO] confusion matrix:
[[0.96625 0.0025  0.00125 0.      0.00125 0.      0.005   0.      0.02
  0.00375]
 [0.0675  0.80875 0.      0.005   0.00125 0.0075  0.0575  0.05125 0.00125
  0.     ]
 [0.0025  0.      0.79125 0.      0.      0.      0.18625 0.00625 0.00125
  0.0125 ]
 [0.0025  0.115   0.      0.29125 0.0075  0.1725  0.255   0.155   0.00125
  0.     ]
 [0.      0.01    0.      0.0075  0.77375 0.005   0.17625 0.0275  0.
  0.     ]
 [0.00125 0.03375 0.      0.30875 0.02625 0.435   0.16875 0.02625 0.
  0.     ]
 [0.0025  0.01125 0.00125 0.00625 0.7525  0.0075  0.2075  0.0075  0.00125
  0.0025 ]
 [0.      0.20875 0.      0.015   0.005   0.01625 0.21625 0.5375  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0175  0.      0.97375
  0.0025 ]
 [0.015   0.00125 0.1025  0.      0.      0.      0.12375 0.0025  0.01625
  0.73875]]
[2023-08-05 02:53:52,796 INFO] 940000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.0605e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1425, device='cuda:0'), 'train/shrink_loss': tensor(0.0419, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0328, device='cuda:0'), 'train/removed_class_idx': 2.4226801626102925, 'train/uncertainty_avg': 0.7552263428218863, 'train/certain_ratio_ema': 0.7828464320870565, 'train/total_loss': tensor(0.1754, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.009966900098361129, 'train/prefecth_time': 0.018690303802490236, 'train/run_time': 0.5482220458984375, 'eval/loss': tensor(3.0549, device='cuda:0'), 'eval/top-1-acc': 0.652375, 'eval/top-5-acc': 0.955625, 'eval/precision': 0.6835948714447094, 'eval/recall': 0.6523749999999999, 'eval/F1': 0.6567691000783508, 'eval/AUC': 0.9007756684027778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 03:03:58,406 INFO] confusion matrix:
[[0.9625  0.00375 0.      0.      0.00125 0.      0.0075  0.0025  0.01625
  0.00625]
 [0.06375 0.82125 0.      0.00625 0.00125 0.0075  0.05375 0.045   0.00125
  0.     ]
 [0.00375 0.00125 0.77375 0.      0.      0.      0.19125 0.005   0.0025
  0.0225 ]
 [0.0025  0.10125 0.      0.30875 0.01    0.18625 0.2525  0.1375  0.00125
  0.     ]
 [0.      0.01    0.      0.0075  0.7425  0.0075  0.20625 0.02625 0.
  0.     ]
 [0.      0.03    0.      0.37375 0.0275  0.4075  0.14375 0.0175  0.
  0.     ]
 [0.0025  0.01    0.00125 0.00875 0.7425  0.0075  0.215   0.00625 0.00125
  0.005  ]
 [0.      0.25    0.      0.02375 0.005   0.02125 0.22    0.47875 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.01625 0.      0.97125
  0.00625]
 [0.015   0.00125 0.15375 0.      0.      0.      0.09875 0.0025  0.01625
  0.7125 ]]
[2023-08-05 03:03:58,420 INFO] 941000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.1075e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1952, device='cuda:0'), 'train/shrink_loss': tensor(0.0920, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0722, device='cuda:0'), 'train/removed_class_idx': 2.380952154195033, 'train/uncertainty_avg': 0.7518869291341338, 'train/certain_ratio_ema': 0.7854441796178551, 'train/total_loss': tensor(0.2674, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.009929801931565242, 'train/prefecth_time': 0.019352447509765624, 'train/run_time': 0.5567933349609375, 'eval/loss': tensor(3.2575, device='cuda:0'), 'eval/top-1-acc': 0.639375, 'eval/top-5-acc': 0.95325, 'eval/precision': 0.668456452088265, 'eval/recall': 0.639375, 'eval/F1': 0.6431412669054385, 'eval/AUC': 0.8939161718749997}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 03:13:55,005 INFO] confusion matrix:
[[0.95125 0.0025  0.      0.      0.00125 0.      0.01875 0.0025  0.015
  0.00875]
 [0.06375 0.815   0.      0.0075  0.00125 0.00875 0.0625  0.04    0.00125
  0.     ]
 [0.00125 0.      0.77125 0.      0.      0.      0.1925  0.00875 0.00375
  0.0225 ]
 [0.0025  0.12625 0.      0.3     0.01125 0.18375 0.25375 0.12    0.0025
  0.     ]
 [0.      0.01125 0.      0.0075  0.77375 0.005   0.1775  0.025   0.
  0.     ]
 [0.      0.03625 0.      0.34125 0.02375 0.43875 0.1425  0.0175  0.
  0.     ]
 [0.0025  0.01    0.00125 0.01    0.7375  0.01    0.2125  0.00875 0.00125
  0.00625]
 [0.      0.27125 0.      0.0175  0.00375 0.02875 0.22    0.4575  0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.025   0.      0.96375
  0.00375]
 [0.015   0.00125 0.14625 0.      0.      0.      0.105   0.0025  0.0125
  0.7175 ]]
[2023-08-05 03:13:55,016 INFO] 942000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.5498e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1390, device='cuda:0'), 'train/shrink_loss': tensor(0.0516, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0404, device='cuda:0'), 'train/removed_class_idx': 2.3586953957939785, 'train/uncertainty_avg': 0.7588774812490303, 'train/certain_ratio_ema': 0.7822528618566339, 'train/total_loss': tensor(0.1795, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.009892686704080705, 'train/prefecth_time': 0.08500383758544922, 'train/run_time': 0.5487813110351563, 'eval/loss': tensor(3.2730, device='cuda:0'), 'eval/top-1-acc': 0.640125, 'eval/top-5-acc': 0.946, 'eval/precision': 0.6706642611863081, 'eval/recall': 0.640125, 'eval/F1': 0.6437488808087777, 'eval/AUC': 0.8882353906250001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 03:23:52,657 INFO] confusion matrix:
[[0.9025  0.0025  0.      0.      0.00125 0.      0.0675  0.00375 0.015
  0.0075 ]
 [0.065   0.82    0.      0.005   0.00125 0.0325  0.06875 0.0075  0.
  0.     ]
 [0.00125 0.00125 0.78125 0.      0.      0.00375 0.175   0.005   0.00375
  0.02875]
 [0.00375 0.13875 0.      0.305   0.0125  0.29125 0.22375 0.02375 0.00125
  0.     ]
 [0.      0.01125 0.      0.00625 0.7925  0.02    0.15875 0.01125 0.
  0.     ]
 [0.      0.03625 0.      0.42875 0.01875 0.40375 0.11125 0.00125 0.
  0.     ]
 [0.0025  0.01    0.00125 0.01125 0.6975  0.01125 0.24    0.02    0.
  0.00625]
 [0.      0.31125 0.      0.0225  0.00375 0.22    0.1875  0.25375 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.06625 0.00125 0.92
  0.00625]
 [0.01125 0.00125 0.135   0.      0.      0.00125 0.11625 0.0025  0.01375
  0.71875]]
[2023-08-05 03:23:52,668 INFO] 943000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.9164e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1734, device='cuda:0'), 'train/shrink_loss': tensor(0.0753, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0583, device='cuda:0'), 'train/removed_class_idx': 2.581632389629348, 'train/uncertainty_avg': 0.7665462344245536, 'train/certain_ratio_ema': 0.7747218557196917, 'train/total_loss': tensor(0.2318, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.009855554479676313, 'train/prefecth_time': 0.02203049659729004, 'train/run_time': 0.549871337890625, 'eval/loss': tensor(3.3399, device='cuda:0'), 'eval/top-1-acc': 0.61375, 'eval/top-5-acc': 0.943375, 'eval/precision': 0.653522077977535, 'eval/recall': 0.6137499999999999, 'eval/F1': 0.6135801336663466, 'eval/AUC': 0.8833378124999999}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 03:33:51,860 INFO] confusion matrix:
[[0.94625 0.      0.      0.      0.00125 0.0025  0.02375 0.      0.01875
  0.0075 ]
 [0.06625 0.825   0.      0.0075  0.00125 0.01125 0.06    0.02875 0.
  0.     ]
 [0.00125 0.      0.76125 0.      0.      0.00625 0.1925  0.00125 0.0025
  0.035  ]
 [0.00625 0.1425  0.      0.3775  0.0125  0.16    0.2425  0.05625 0.0025
  0.     ]
 [0.00125 0.00875 0.      0.0075  0.7625  0.00625 0.195   0.01875 0.
  0.     ]
 [0.      0.0375  0.      0.4975  0.0175  0.32875 0.10375 0.015   0.
  0.     ]
 [0.0025  0.00875 0.      0.01125 0.675   0.01    0.27625 0.00125 0.0025
  0.0125 ]
 [0.00125 0.2775  0.      0.02    0.0075  0.03875 0.20625 0.4475  0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.04    0.      0.94625
  0.0075 ]
 [0.01375 0.00125 0.1575  0.      0.      0.0025  0.10125 0.00125 0.01375
  0.70875]]
[2023-08-05 03:33:51,871 INFO] 944000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.5398e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1236, device='cuda:0'), 'train/shrink_loss': tensor(0.0525, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0406, device='cuda:0'), 'train/removed_class_idx': 2.4186043699297244, 'train/uncertainty_avg': 0.7508963329296474, 'train/certain_ratio_ema': 0.7727855956685192, 'train/total_loss': tensor(0.1643, device='cuda:0'), 'train/mask_ratio': tensor(0.8080, device='cuda:0'), 'lr': 0.009818405322150042, 'train/prefecth_time': 0.020752479553222656, 'train/run_time': 0.559130615234375, 'eval/loss': tensor(3.1696, device='cuda:0'), 'eval/top-1-acc': 0.638, 'eval/top-5-acc': 0.95275, 'eval/precision': 0.6728176994975201, 'eval/recall': 0.638, 'eval/F1': 0.6413121120485813, 'eval/AUC': 0.8940167621527777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 03:43:41,041 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 03:43:50,961 INFO] confusion matrix:
[[0.95375 0.00125 0.00125 0.      0.00125 0.0025  0.0125  0.      0.01875
  0.00875]
 [0.0625  0.82625 0.      0.005   0.0025  0.0075  0.0525  0.04    0.00375
  0.     ]
 [0.      0.      0.76    0.      0.      0.00125 0.19125 0.0025  0.00375
  0.04125]
 [0.0025  0.1375  0.00125 0.37125 0.00875 0.09375 0.2425  0.13875 0.00375
  0.     ]
 [0.00125 0.00875 0.      0.01125 0.775   0.00625 0.17625 0.02125 0.
  0.     ]
 [0.00125 0.0325  0.      0.49125 0.02125 0.33    0.09625 0.025   0.0025
  0.     ]
 [0.0025  0.00875 0.0025  0.0075  0.695   0.0075  0.26125 0.0025  0.0025
  0.01   ]
 [0.      0.22    0.      0.0125  0.0075  0.02375 0.2075  0.52625 0.
  0.0025 ]
 [0.00625 0.      0.00125 0.      0.      0.      0.02375 0.      0.96125
  0.0075 ]
 [0.01    0.00125 0.13875 0.      0.      0.      0.0825  0.00125 0.015
  0.75125]]
[2023-08-05 03:43:50,967 INFO] 945000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.9488e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1432, device='cuda:0'), 'train/shrink_loss': tensor(0.0623, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0486, device='cuda:0'), 'train/removed_class_idx': 2.3229164246962055, 'train/uncertainty_avg': 0.7693422253093328, 'train/certain_ratio_ema': 0.7792248506975025, 'train/total_loss': tensor(0.1918, device='cuda:0'), 'train/mask_ratio': tensor(0.7857, device='cuda:0'), 'lr': 0.009781239295328955, 'train/prefecth_time': 0.01932179260253906, 'train/run_time': 0.54831640625, 'eval/loss': tensor(3.0539, device='cuda:0'), 'eval/top-1-acc': 0.651625, 'eval/top-5-acc': 0.95225, 'eval/precision': 0.6803602469203549, 'eval/recall': 0.6516249999999999, 'eval/F1': 0.6530810018320774, 'eval/AUC': 0.8990094531249999}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 03:53:46,590 INFO] confusion matrix:
[[0.95625 0.0025  0.00375 0.      0.0025  0.      0.00875 0.      0.01875
  0.0075 ]
 [0.06375 0.8225  0.00125 0.00625 0.00125 0.00625 0.05625 0.03875 0.00375
  0.     ]
 [0.      0.00125 0.76125 0.      0.      0.      0.2     0.0025  0.00125
  0.03375]
 [0.00125 0.1325  0.00125 0.38875 0.00875 0.0825  0.2475  0.13625 0.
  0.00125]
 [0.      0.00875 0.      0.015   0.805   0.00125 0.14375 0.025   0.00125
  0.     ]
 [0.00125 0.03    0.      0.54375 0.0175  0.275   0.105   0.0275  0.
  0.     ]
 [0.0025  0.0075  0.00375 0.015   0.75875 0.00625 0.19125 0.0075  0.0025
  0.005  ]
 [0.      0.245   0.      0.0225  0.00625 0.00875 0.22    0.49625 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0225  0.      0.96375
  0.0075 ]
 [0.01375 0.00125 0.12875 0.      0.      0.      0.08    0.0025  0.01625
  0.7575 ]]
[2023-08-05 03:53:46,600 INFO] 946000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.8698e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1345, device='cuda:0'), 'train/shrink_loss': tensor(0.0867, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0681, device='cuda:0'), 'train/removed_class_idx': 2.3529408996540115, 'train/uncertainty_avg': 0.7858399679786535, 'train/certain_ratio_ema': 0.7855193489277659, 'train/total_loss': tensor(0.2026, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.009744056463069127, 'train/prefecth_time': 0.02668694305419922, 'train/run_time': 0.56803466796875, 'eval/loss': tensor(3.3245, device='cuda:0'), 'eval/top-1-acc': 0.64175, 'eval/top-5-acc': 0.9355, 'eval/precision': 0.6748636343136459, 'eval/recall': 0.64175, 'eval/F1': 0.6410715270320585, 'eval/AUC': 0.8868919184027776}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 04:03:41,283 INFO] confusion matrix:
[[0.96    0.0025  0.00375 0.      0.00125 0.      0.00625 0.      0.0175
  0.00875]
 [0.065   0.8325  0.00125 0.005   0.00125 0.00625 0.0525  0.035   0.00125
  0.     ]
 [0.      0.00125 0.75375 0.      0.      0.0025  0.21625 0.0025  0.00125
  0.0225 ]
 [0.0025  0.11625 0.00125 0.3575  0.00875 0.12625 0.2325  0.15375 0.00125
  0.     ]
 [0.      0.00875 0.      0.01375 0.8525  0.00375 0.09625 0.025   0.
  0.     ]
 [0.00125 0.0375  0.      0.49625 0.0175  0.33375 0.08875 0.02375 0.00125
  0.     ]
 [0.0025  0.0075  0.00375 0.015   0.8175  0.00625 0.1325  0.00875 0.0025
  0.00375]
 [0.      0.26625 0.      0.02125 0.00625 0.0125  0.22    0.47375 0.
  0.     ]
 [0.005   0.      0.0025  0.      0.      0.      0.02625 0.      0.95875
  0.0075 ]
 [0.0175  0.00125 0.12125 0.      0.      0.      0.1025  0.0025  0.0125
  0.7425 ]]
[2023-08-05 04:03:41,294 INFO] 947000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1454, device='cuda:0'), 'train/shrink_loss': tensor(0.0567, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0446, device='cuda:0'), 'train/removed_class_idx': 2.4466017042134265, 'train/uncertainty_avg': 0.761493865287726, 'train/certain_ratio_ema': 0.7872661911687642, 'train/total_loss': tensor(0.1903, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.009706856889255485, 'train/prefecth_time': 0.02044339179992676, 'train/run_time': 0.5571904907226563, 'eval/loss': tensor(3.3954, device='cuda:0'), 'eval/top-1-acc': 0.63975, 'eval/top-5-acc': 0.931875, 'eval/precision': 0.6661249626380804, 'eval/recall': 0.63975, 'eval/F1': 0.6382005513181154, 'eval/AUC': 0.8849724218750001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 04:13:49,084 INFO] confusion matrix:
[[0.96125 0.0025  0.005   0.      0.00125 0.      0.00875 0.      0.01125
  0.01   ]
 [0.065   0.835   0.0025  0.00625 0.      0.0075  0.0625  0.02125 0.
  0.     ]
 [0.      0.00125 0.75375 0.      0.      0.00125 0.20625 0.0025  0.0025
  0.0325 ]
 [0.00375 0.13625 0.04    0.41125 0.00875 0.1125  0.2225  0.06375 0.00125
  0.     ]
 [0.      0.00875 0.005   0.0125  0.8575  0.00375 0.095   0.0175  0.
  0.     ]
 [0.00125 0.04    0.00625 0.44375 0.01625 0.38    0.1     0.0125  0.
  0.     ]
 [0.0025  0.00625 0.00875 0.01375 0.725   0.00625 0.23    0.0025  0.0025
  0.0025 ]
 [0.      0.30875 0.0275  0.01875 0.00625 0.01    0.23    0.3975  0.
  0.00125]
 [0.005   0.      0.0025  0.      0.      0.      0.105   0.      0.88125
  0.00625]
 [0.01375 0.0025  0.11125 0.      0.      0.      0.1175  0.      0.015
  0.74   ]]
[2023-08-05 04:13:49,098 INFO] 948000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1496, device='cuda:0'), 'train/shrink_loss': tensor(0.0748, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0584, device='cuda:0'), 'train/removed_class_idx': 2.3663363993726336, 'train/uncertainty_avg': 0.7567738368572685, 'train/certain_ratio_ema': 0.7798566408631317, 'train/total_loss': tensor(0.2081, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.009669640637801716, 'train/prefecth_time': 0.02022700881958008, 'train/run_time': 0.5511112060546876, 'eval/loss': tensor(2.9236, device='cuda:0'), 'eval/top-1-acc': 0.64475, 'eval/top-5-acc': 0.96975, 'eval/precision': 0.6866013093030372, 'eval/recall': 0.6447499999999999, 'eval/F1': 0.646900364817178, 'eval/AUC': 0.9106205902777776}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 04:23:46,188 INFO] confusion matrix:
[[0.96    0.      0.005   0.      0.00125 0.      0.01125 0.      0.0125
  0.01   ]
 [0.06375 0.83    0.0025  0.0175  0.0025  0.00875 0.05375 0.02125 0.
  0.     ]
 [0.00125 0.      0.7425  0.      0.      0.00125 0.22125 0.00125 0.00125
  0.03125]
 [0.0025  0.13    0.01375 0.3975  0.0075  0.1525  0.24875 0.025   0.00125
  0.02125]
 [0.      0.00875 0.00375 0.02    0.845   0.0025  0.1025  0.01625 0.
  0.00125]
 [0.      0.03375 0.0025  0.2975  0.0225  0.49875 0.12125 0.02    0.00125
  0.0025 ]
 [0.0025  0.01    0.0025  0.00875 0.7125  0.00625 0.24625 0.00125 0.0025
  0.0075 ]
 [0.      0.255   0.01    0.0225  0.0075  0.01125 0.22375 0.44875 0.
  0.02125]
 [0.00375 0.      0.      0.      0.      0.      0.07375 0.      0.9125
  0.01   ]
 [0.0125  0.00125 0.1     0.      0.      0.      0.1175  0.00125 0.0125
  0.755  ]]
[2023-08-05 04:23:46,198 INFO] 949000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1442, device='cuda:0'), 'train/shrink_loss': tensor(0.0751, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0585, device='cuda:0'), 'train/removed_class_idx': 2.448979341940883, 'train/uncertainty_avg': 0.7390748183361251, 'train/certain_ratio_ema': 0.7789924472965433, 'train/total_loss': tensor(0.2029, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.009632407772650186, 'train/prefecth_time': 0.01887171173095703, 'train/run_time': 0.5522190551757813, 'eval/loss': tensor(2.6326, device='cuda:0'), 'eval/top-1-acc': 0.663625, 'eval/top-5-acc': 0.974, 'eval/precision': 0.7051210900285547, 'eval/recall': 0.6636249999999999, 'eval/F1': 0.6692129847240996, 'eval/AUC': 0.9191546093750002}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 04:33:36,698 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 04:33:47,055 INFO] confusion matrix:
[[0.94625 0.      0.005   0.      0.0025  0.      0.02125 0.      0.01375
  0.01125]
 [0.05875 0.81125 0.0025  0.01    0.0025  0.0075  0.0725  0.035   0.
  0.     ]
 [0.      0.      0.76125 0.      0.      0.      0.20375 0.00625 0.0025
  0.02625]
 [0.0025  0.1     0.045   0.36125 0.0075  0.13375 0.265   0.08375 0.00125
  0.     ]
 [0.      0.0075  0.005   0.015   0.77375 0.005   0.175   0.01875 0.
  0.     ]
 [0.      0.025   0.005   0.3525  0.02    0.42625 0.1375  0.03375 0.
  0.     ]
 [0.0025  0.0075  0.0025  0.00875 0.66    0.005   0.29625 0.0075  0.0025
  0.0075 ]
 [0.      0.205   0.02875 0.01875 0.005   0.01    0.2175  0.51375 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.12125 0.      0.8625
  0.01125]
 [0.01125 0.00125 0.1275  0.      0.      0.      0.1075  0.0025  0.01125
  0.73875]]
[2023-08-05 04:33:47,061 INFO] 950000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.4658e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1505, device='cuda:0'), 'train/shrink_loss': tensor(0.0792, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0615, device='cuda:0'), 'train/removed_class_idx': 2.4077667565274994, 'train/uncertainty_avg': 0.7704631470579161, 'train/certain_ratio_ema': 0.7769152964256898, 'train/total_loss': tensor(0.2120, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.009595158357771775, 'train/prefecth_time': 0.019650623321533202, 'train/run_time': 0.55369091796875, 'eval/loss': tensor(2.9071, device='cuda:0'), 'eval/top-1-acc': 0.649125, 'eval/top-5-acc': 0.959125, 'eval/precision': 0.6929211305135793, 'eval/recall': 0.6491250000000001, 'eval/F1': 0.6590023602230578, 'eval/AUC': 0.90669828125}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 04:43:58,210 INFO] confusion matrix:
[[0.95125 0.      0.00375 0.0025  0.00125 0.      0.015   0.00125 0.0175
  0.0075 ]
 [0.0625  0.8125  0.00125 0.015   0.00125 0.0075  0.06875 0.03    0.00125
  0.     ]
 [0.      0.00125 0.76    0.      0.      0.      0.2025  0.0075  0.005
  0.02375]
 [0.0025  0.11    0.00875 0.3775  0.01125 0.1325  0.2675  0.08875 0.00125
  0.     ]
 [0.      0.01125 0.0025  0.0125  0.77    0.0025  0.18625 0.015   0.
  0.     ]
 [0.      0.0325  0.      0.2625  0.0225  0.49375 0.1675  0.02125 0.
  0.     ]
 [0.0025  0.0125  0.      0.0025  0.65125 0.00875 0.30875 0.00625 0.00125
  0.00625]
 [0.      0.20625 0.      0.02125 0.01    0.0125  0.23    0.52    0.
  0.     ]
 [0.00375 0.      0.      0.      0.      0.      0.095   0.00125 0.89
  0.01   ]
 [0.01125 0.00125 0.11125 0.      0.      0.      0.0975  0.00375 0.0125
  0.7625 ]]
[2023-08-05 04:43:58,221 INFO] 951000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1414e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1295, device='cuda:0'), 'train/shrink_loss': tensor(0.0456, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0350, device='cuda:0'), 'train/removed_class_idx': 2.450980151864691, 'train/uncertainty_avg': 0.7596597300734276, 'train/certain_ratio_ema': 0.7681524341873887, 'train/total_loss': tensor(0.1646, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.00955789245716583, 'train/prefecth_time': 0.024446815490722657, 'train/run_time': 0.5583552856445313, 'eval/loss': tensor(2.6787, device='cuda:0'), 'eval/top-1-acc': 0.664625, 'eval/top-5-acc': 0.96025, 'eval/precision': 0.7116781128297154, 'eval/recall': 0.664625, 'eval/F1': 0.6762266491121905, 'eval/AUC': 0.914132456597222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 04:53:56,060 INFO] confusion matrix:
[[0.95875 0.00125 0.00375 0.      0.0025  0.      0.00875 0.      0.01625
  0.00875]
 [0.06375 0.82    0.00125 0.01125 0.00125 0.01125 0.06125 0.02875 0.00125
  0.     ]
 [0.00125 0.      0.755   0.      0.      0.      0.1825  0.005   0.00375
  0.0525 ]
 [0.0025  0.105   0.      0.33125 0.01375 0.19625 0.25    0.1     0.00125
  0.     ]
 [0.      0.01    0.      0.01125 0.7725  0.00625 0.18375 0.01625 0.
  0.     ]
 [0.      0.03375 0.      0.315   0.025   0.4525  0.15625 0.0175  0.
  0.     ]
 [0.0025  0.015   0.      0.0075  0.6475  0.005   0.30875 0.00375 0.0025
  0.0075 ]
 [0.      0.28    0.00125 0.02125 0.00875 0.01625 0.20125 0.46875 0.
  0.0025 ]
 [0.005   0.      0.      0.      0.      0.      0.09625 0.00125 0.88625
  0.01125]
 [0.01375 0.00125 0.08125 0.      0.      0.      0.11125 0.0025  0.01
  0.78   ]]
[2023-08-05 04:53:56,073 INFO] 952000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.3089e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1471, device='cuda:0'), 'train/shrink_loss': tensor(0.1026, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0795, device='cuda:0'), 'train/removed_class_idx': 2.410714070471958, 'train/uncertainty_avg': 0.7666334163292475, 'train/certain_ratio_ema': 0.7747580933515795, 'train/total_loss': tensor(0.2267, device='cuda:0'), 'train/mask_ratio': tensor(0.7500, device='cuda:0'), 'lr': 0.009520610134859993, 'train/prefecth_time': 0.01901081657409668, 'train/run_time': 0.5632659301757813, 'eval/loss': tensor(2.8457, device='cuda:0'), 'eval/top-1-acc': 0.653375, 'eval/top-5-acc': 0.9615, 'eval/precision': 0.6909582244949676, 'eval/recall': 0.653375, 'eval/F1': 0.6603188328708083, 'eval/AUC': 0.909320581597222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 05:03:52,839 INFO] confusion matrix:
[[0.96    0.00125 0.      0.      0.00375 0.      0.00875 0.      0.0175
  0.00875]
 [0.0625  0.81375 0.      0.00375 0.00125 0.015   0.05125 0.04875 0.00375
  0.     ]
 [0.00625 0.      0.75875 0.      0.      0.      0.175   0.00375 0.00625
  0.05   ]
 [0.00625 0.085   0.      0.28875 0.0125  0.16    0.225   0.19    0.0325
  0.     ]
 [0.      0.01125 0.      0.01    0.76875 0.00625 0.17875 0.02    0.005
  0.     ]
 [0.00125 0.02875 0.      0.32625 0.02375 0.44625 0.12875 0.0375  0.00625
  0.00125]
 [0.0025  0.015   0.0025  0.00875 0.69875 0.01125 0.2475  0.0025  0.005
  0.00625]
 [0.      0.2325  0.      0.01875 0.00875 0.01375 0.16875 0.52625 0.02875
  0.0025 ]
 [0.005   0.      0.      0.      0.      0.00125 0.12    0.      0.865
  0.00875]
 [0.0125  0.00125 0.07    0.      0.      0.      0.115   0.00125 0.0175
  0.7825 ]]
[2023-08-05 05:03:52,854 INFO] 953000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.3051e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1263, device='cuda:0'), 'train/shrink_loss': tensor(0.0590, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0461, device='cuda:0'), 'train/removed_class_idx': 2.3999997000000373, 'train/uncertainty_avg': 0.7499581084980876, 'train/certain_ratio_ema': 0.780670677649703, 'train/total_loss': tensor(0.1724, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.009483311454910132, 'train/prefecth_time': 0.018973791122436523, 'train/run_time': 0.5575989990234375, 'eval/loss': tensor(3.0246, device='cuda:0'), 'eval/top-1-acc': 0.64575, 'eval/top-5-acc': 0.95525, 'eval/precision': 0.6729709021328317, 'eval/recall': 0.64575, 'eval/F1': 0.6496695230080278, 'eval/AUC': 0.902739392361111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 05:13:46,822 INFO] confusion matrix:
[[0.95375 0.00125 0.00125 0.      0.00375 0.00125 0.00875 0.00125 0.02
  0.00875]
 [0.06375 0.81625 0.00125 0.00375 0.00125 0.015   0.045   0.05    0.00375
  0.     ]
 [0.00375 0.      0.8375  0.      0.      0.00125 0.11125 0.00375 0.00625
  0.03625]
 [0.0025  0.0825  0.      0.34625 0.0075  0.13375 0.2075  0.17    0.05
  0.     ]
 [0.      0.01125 0.00125 0.01125 0.75875 0.00625 0.1825  0.02375 0.005
  0.     ]
 [0.00125 0.02875 0.      0.3825  0.02125 0.4125  0.10625 0.04    0.0075
  0.     ]
 [0.0025  0.02    0.00375 0.00875 0.69875 0.01    0.24    0.005   0.00625
  0.005  ]
 [0.      0.255   0.      0.02    0.00875 0.01    0.1525  0.51125 0.04125
  0.00125]
 [0.0025  0.      0.      0.      0.      0.00125 0.12875 0.00125 0.85625
  0.01   ]
 [0.01    0.00125 0.05125 0.      0.      0.      0.0725  0.00125 0.0125
  0.85125]]
[2023-08-05 05:13:46,837 INFO] 954000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.4916e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1299, device='cuda:0'), 'train/shrink_loss': tensor(0.0330, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0261, device='cuda:0'), 'train/removed_class_idx': 2.2747250247554915, 'train/uncertainty_avg': 0.7509356085506841, 'train/certain_ratio_ema': 0.7889210343421952, 'train/total_loss': tensor(0.1560, device='cuda:0'), 'train/mask_ratio': tensor(0.7969, device='cuda:0'), 'lr': 0.00944599648140023, 'train/prefecth_time': 0.01960950469970703, 'train/run_time': 0.5474996337890625, 'eval/loss': tensor(3.0102, device='cuda:0'), 'eval/top-1-acc': 0.658375, 'eval/top-5-acc': 0.961375, 'eval/precision': 0.6780425972029842, 'eval/recall': 0.6583750000000002, 'eval/F1': 0.6592402526883159, 'eval/AUC': 0.9023733593750001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 05:23:37,356 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 05:23:59,217 INFO] confusion matrix:
[[0.95    0.00125 0.00375 0.      0.00375 0.00125 0.01    0.      0.02
  0.01   ]
 [0.06    0.83    0.00125 0.0025  0.00375 0.01375 0.045   0.04125 0.0025
  0.     ]
 [0.00125 0.      0.83    0.      0.      0.      0.1325  0.00375 0.0025
  0.03   ]
 [0.00375 0.0875  0.00625 0.34375 0.005   0.1325  0.21625 0.15875 0.04625
  0.     ]
 [0.      0.01125 0.00125 0.01    0.765   0.00625 0.175   0.025   0.00625
  0.     ]
 [0.      0.03125 0.      0.365   0.01875 0.41625 0.1225  0.03875 0.0075
  0.     ]
 [0.00375 0.0175  0.005   0.01125 0.6725  0.00875 0.265   0.00375 0.00875
  0.00375]
 [0.      0.255   0.00375 0.00875 0.005   0.01    0.16375 0.515   0.0375
  0.00125]
 [0.00375 0.      0.      0.      0.      0.00125 0.13125 0.00125 0.855
  0.0075 ]
 [0.00625 0.00125 0.065   0.      0.      0.      0.06375 0.00125 0.015
  0.8475 ]]
[2023-08-05 05:23:59,224 INFO] 955000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1183, device='cuda:0'), 'train/shrink_loss': tensor(0.0787, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0616, device='cuda:0'), 'train/removed_class_idx': 2.383177347366603, 'train/uncertainty_avg': 0.776128585253492, 'train/certain_ratio_ema': 0.7821685848831409, 'train/total_loss': tensor(0.1800, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.009408665278442245, 'train/prefecth_time': 0.02375836753845215, 'train/run_time': 0.5662947998046876, 'eval/loss': tensor(2.9163, device='cuda:0'), 'eval/top-1-acc': 0.66175, 'eval/top-5-acc': 0.962, 'eval/precision': 0.6838249095386842, 'eval/recall': 0.66175, 'eval/F1': 0.6632801569672646, 'eval/AUC': 0.9093429687500001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 05:33:57,284 INFO] confusion matrix:
[[0.95875 0.00125 0.005   0.      0.00375 0.      0.0075  0.      0.01625
  0.0075 ]
 [0.06    0.85125 0.00125 0.00375 0.00375 0.0125  0.04125 0.0225  0.00375
  0.     ]
 [0.00125 0.      0.84875 0.      0.      0.      0.10125 0.0025  0.0025
  0.04375]
 [0.01375 0.09875 0.00125 0.39375 0.015   0.1375  0.2175  0.065   0.0575
  0.     ]
 [0.      0.00875 0.00125 0.0075  0.86125 0.00375 0.095   0.01625 0.00625
  0.     ]
 [0.      0.03625 0.      0.4     0.0175  0.42    0.10625 0.0125  0.0075
  0.     ]
 [0.00375 0.01125 0.005   0.01    0.81    0.00875 0.1375  0.0025  0.0075
  0.00375]
 [0.      0.3175  0.      0.01375 0.00625 0.01125 0.20125 0.40625 0.04375
  0.     ]
 [0.00625 0.      0.      0.      0.      0.      0.1325  0.      0.855
  0.00625]
 [0.0075  0.00125 0.06625 0.      0.      0.      0.025   0.00125 0.0125
  0.88625]]
[2023-08-05 05:33:57,300 INFO] 956000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.9708e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1403, device='cuda:0'), 'train/shrink_loss': tensor(0.0739, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0581, device='cuda:0'), 'train/removed_class_idx': 2.57499967812504, 'train/uncertainty_avg': 0.7424453306483799, 'train/certain_ratio_ema': 0.7853486792819009, 'train/total_loss': tensor(0.1985, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.00937131791017604, 'train/prefecth_time': 0.01971059226989746, 'train/run_time': 0.54337255859375, 'eval/loss': tensor(2.9782, device='cuda:0'), 'eval/top-1-acc': 0.661875, 'eval/top-5-acc': 0.945375, 'eval/precision': 0.682888683154337, 'eval/recall': 0.661875, 'eval/F1': 0.6562782145926774, 'eval/AUC': 0.9020553993055554}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 05:43:49,680 INFO] confusion matrix:
[[0.95875 0.      0.005   0.      0.005   0.      0.00375 0.      0.02
  0.0075 ]
 [0.06375 0.83375 0.00125 0.00375 0.0025  0.0125  0.035   0.0425  0.005
  0.     ]
 [0.00125 0.      0.8725  0.      0.      0.      0.075   0.00375 0.00375
  0.04375]
 [0.0075  0.0825  0.0025  0.3375  0.00875 0.14625 0.215   0.14875 0.05125
  0.     ]
 [0.      0.0075  0.      0.01    0.77875 0.005   0.165   0.0275  0.00625
  0.     ]
 [0.00125 0.02375 0.      0.3625  0.02    0.42    0.11875 0.04625 0.0075
  0.     ]
 [0.0025  0.0075  0.005   0.01375 0.7375  0.0075  0.21125 0.005   0.0075
  0.0025 ]
 [0.      0.225   0.      0.01    0.00125 0.00875 0.1675  0.5575  0.02875
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.04875 0.      0.94
  0.005  ]
 [0.00875 0.00125 0.0875  0.      0.      0.      0.0325  0.00125 0.015
  0.85375]]
[2023-08-05 05:43:49,696 INFO] 957000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1790, device='cuda:0'), 'train/shrink_loss': tensor(0.0955, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0760, device='cuda:0'), 'train/removed_class_idx': 2.2654865251781837, 'train/uncertainty_avg': 0.7767439825787925, 'train/certain_ratio_ema': 0.7958665471751054, 'train/total_loss': tensor(0.2551, device='cuda:0'), 'train/mask_ratio': tensor(0.7478, device='cuda:0'), 'lr': 0.009333954440769236, 'train/prefecth_time': 0.019755071640014648, 'train/run_time': 0.5576732177734375, 'eval/loss': tensor(2.8788, device='cuda:0'), 'eval/top-1-acc': 0.676375, 'eval/top-5-acc': 0.96075, 'eval/precision': 0.684110509850787, 'eval/recall': 0.676375, 'eval/F1': 0.6713540682041184, 'eval/AUC': 0.9117072743055558}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 05:53:47,149 INFO] confusion matrix:
[[0.965   0.00125 0.0025  0.      0.0025  0.      0.005   0.      0.0175
  0.00625]
 [0.06375 0.85625 0.      0.01    0.00375 0.01125 0.045   0.0075  0.0025
  0.     ]
 [0.00375 0.00375 0.8325  0.      0.      0.      0.11    0.      0.0025
  0.0475 ]
 [0.01125 0.1175  0.00125 0.4375  0.0075  0.13625 0.22375 0.02875 0.03625
  0.     ]
 [0.00125 0.01    0.      0.01125 0.77625 0.0075  0.17875 0.00875 0.00625
  0.     ]
 [0.00125 0.035   0.      0.4     0.01875 0.36875 0.15375 0.01625 0.00625
  0.     ]
 [0.00375 0.0125  0.0025  0.01    0.7225  0.0075  0.2275  0.      0.00875
  0.005  ]
 [0.00375 0.36875 0.      0.04    0.00625 0.02375 0.17625 0.3525  0.0275
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.0375  0.      0.9525
  0.005  ]
 [0.00625 0.0025  0.07375 0.      0.      0.      0.06625 0.00125 0.0175
  0.8325 ]]
[2023-08-05 05:53:47,164 INFO] 958000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.7555e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1409, device='cuda:0'), 'train/shrink_loss': tensor(0.0570, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0448, device='cuda:0'), 'train/removed_class_idx': 2.620689353943752, 'train/uncertainty_avg': 0.7458674125727656, 'train/certain_ratio_ema': 0.78648743796292, 'train/total_loss': tensor(0.1857, device='cuda:0'), 'train/mask_ratio': tensor(0.8058, device='cuda:0'), 'lr': 0.009296574934417117, 'train/prefecth_time': 0.018347328186035156, 'train/run_time': 0.5467994384765625, 'eval/loss': tensor(3.0440, device='cuda:0'), 'eval/top-1-acc': 0.660125, 'eval/top-5-acc': 0.9585, 'eval/precision': 0.6924372083092543, 'eval/recall': 0.6601250000000001, 'eval/F1': 0.6558326520069675, 'eval/AUC': 0.9026080208333336}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 06:03:40,764 INFO] confusion matrix:
[[0.965   0.00125 0.0025  0.      0.00375 0.      0.00375 0.      0.01625
  0.0075 ]
 [0.0625  0.83625 0.      0.0075  0.00125 0.01375 0.05375 0.02125 0.00375
  0.     ]
 [0.0025  0.      0.8825  0.0025  0.      0.      0.0725  0.0025  0.00125
  0.03625]
 [0.0025  0.09375 0.00125 0.3775  0.0075  0.12875 0.26375 0.09375 0.03125
  0.     ]
 [0.      0.0075  0.      0.0025  0.7725  0.00625 0.185   0.02    0.00625
  0.     ]
 [0.00125 0.02375 0.      0.34375 0.02125 0.3875  0.19    0.025   0.0075
  0.     ]
 [0.0025  0.01    0.0025  0.01    0.73    0.00875 0.22    0.0025  0.01
  0.00375]
 [0.      0.245   0.      0.025   0.00875 0.01    0.1975  0.49    0.0225
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.0225  0.      0.96375
  0.0075 ]
 [0.005   0.00125 0.0875  0.      0.      0.      0.065   0.00125 0.015
  0.825  ]]
[2023-08-05 06:03:40,774 INFO] 959000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1277, device='cuda:0'), 'train/shrink_loss': tensor(0.0654, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0520, device='cuda:0'), 'train/removed_class_idx': 2.4105260620498883, 'train/uncertainty_avg': 0.7246074117679655, 'train/certain_ratio_ema': 0.795815181330428, 'train/total_loss': tensor(0.1800, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.00925917945534254, 'train/prefecth_time': 0.019093248367309572, 'train/run_time': 0.5619588623046875, 'eval/loss': tensor(2.9531, device='cuda:0'), 'eval/top-1-acc': 0.672, 'eval/top-5-acc': 0.950875, 'eval/precision': 0.695060606048875, 'eval/recall': 0.672, 'eval/F1': 0.6711926765337102, 'eval/AUC': 0.9076967795138889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 06:13:28,237 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 06:13:38,109 INFO] confusion matrix:
[[0.96875 0.      0.00125 0.      0.00375 0.      0.0025  0.      0.01875
  0.005  ]
 [0.06375 0.86    0.      0.0025  0.00125 0.01    0.04625 0.01125 0.005
  0.     ]
 [0.00125 0.00125 0.925   0.      0.      0.      0.04125 0.      0.0025
  0.02875]
 [0.0025  0.1175  0.00125 0.36625 0.015   0.16625 0.25375 0.04125 0.03625
  0.     ]
 [0.00125 0.01    0.      0.00375 0.82875 0.00875 0.1325  0.00875 0.00625
  0.     ]
 [0.      0.02125 0.00125 0.3175  0.0225  0.46875 0.15    0.01    0.00875
  0.     ]
 [0.00375 0.00875 0.005   0.01125 0.77125 0.00625 0.1775  0.      0.01
  0.00625]
 [0.      0.2725  0.      0.025   0.01    0.01375 0.22625 0.42875 0.0225
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.00875 0.      0.975
  0.01   ]
 [0.01    0.0025  0.0875  0.      0.      0.      0.03    0.00125 0.015
  0.85375]]
[2023-08-05 06:13:38,117 INFO] 960000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.6185e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1278, device='cuda:0'), 'train/shrink_loss': tensor(0.0525, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0419, device='cuda:0'), 'train/removed_class_idx': 2.329786986192874, 'train/uncertainty_avg': 0.7550940756571013, 'train/certain_ratio_ema': 0.7976397814133779, 'train/total_loss': tensor(0.1696, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.009221768067795785, 'train/prefecth_time': 0.019755231857299806, 'train/run_time': 0.548321044921875, 'eval/loss': tensor(2.7321, device='cuda:0'), 'eval/top-1-acc': 0.68525, 'eval/top-5-acc': 0.956875, 'eval/precision': 0.7039288596961316, 'eval/recall': 0.6852499999999999, 'eval/F1': 0.6783836398502465, 'eval/AUC': 0.9172588802083337}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 06:23:46,707 INFO] confusion matrix:
[[0.96875 0.      0.      0.      0.00375 0.      0.00375 0.      0.01875
  0.005  ]
 [0.0625  0.82625 0.      0.0025  0.0025  0.01125 0.04625 0.0425  0.00625
  0.     ]
 [0.00625 0.00125 0.85875 0.      0.      0.      0.1025  0.00375 0.00125
  0.02625]
 [0.015   0.08625 0.00125 0.33125 0.00625 0.1675  0.22625 0.13375 0.0325
  0.     ]
 [0.      0.00875 0.      0.00375 0.80375 0.00625 0.1375  0.03375 0.00625
  0.     ]
 [0.00125 0.02    0.      0.29125 0.015   0.5025  0.11875 0.04    0.01125
  0.     ]
 [0.005   0.01    0.0025  0.0075  0.7075  0.00875 0.24    0.005   0.01
  0.00375]
 [0.01375 0.2025  0.      0.005   0.005   0.01625 0.1775  0.55875 0.02125
  0.     ]
 [0.00625 0.      0.      0.      0.      0.      0.01375 0.      0.97
  0.01   ]
 [0.01125 0.00125 0.11125 0.      0.      0.      0.05125 0.00125 0.01375
  0.81   ]]
[2023-08-05 06:23:46,717 INFO] 961000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.5439e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1598, device='cuda:0'), 'train/shrink_loss': tensor(0.0683, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0536, device='cuda:0'), 'train/removed_class_idx': 2.377550777800941, 'train/uncertainty_avg': 0.7573016103103897, 'train/certain_ratio_ema': 0.7841900674459963, 'train/total_loss': tensor(0.2134, device='cuda:0'), 'train/mask_ratio': tensor(0.7813, device='cuda:0'), 'lr': 0.009184340836054466, 'train/prefecth_time': 0.020040512084960938, 'train/run_time': 0.5533001098632813, 'eval/loss': tensor(2.5715, device='cuda:0'), 'eval/top-1-acc': 0.687, 'eval/top-5-acc': 0.96575, 'eval/precision': 0.6961201224772878, 'eval/recall': 0.6869999999999999, 'eval/F1': 0.6828144992414746, 'eval/AUC': 0.9262026996527777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 06:33:37,742 INFO] confusion matrix:
[[0.97125 0.00125 0.      0.      0.00375 0.      0.0025  0.      0.01625
  0.005  ]
 [0.06625 0.86875 0.      0.015   0.0025  0.0125  0.02125 0.0075  0.005
  0.00125]
 [0.01125 0.0025  0.8325  0.      0.      0.      0.12    0.      0.00125
  0.0325 ]
 [0.01875 0.0975  0.      0.5025  0.0075  0.18125 0.1275  0.025   0.0375
  0.0025 ]
 [0.      0.00875 0.      0.0275  0.91875 0.00625 0.02    0.01125 0.0075
  0.     ]
 [0.      0.02625 0.      0.37125 0.0175  0.5175  0.05125 0.00875 0.0075
  0.     ]
 [0.0025  0.01125 0.0025  0.0075  0.83875 0.0125  0.10625 0.00125 0.01
  0.0075 ]
 [0.0175  0.3     0.      0.0675  0.0075  0.01875 0.11375 0.4525  0.02125
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.005   0.      0.98125
  0.00875]
 [0.01    0.00125 0.10125 0.      0.      0.      0.01875 0.00125 0.01125
  0.85625]]
[2023-08-05 06:33:37,753 INFO] 962000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.5404e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1188, device='cuda:0'), 'train/shrink_loss': tensor(0.0837, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0668, device='cuda:0'), 'train/removed_class_idx': 2.393258158060881, 'train/uncertainty_avg': 0.7797139546078949, 'train/certain_ratio_ema': 0.798469638410023, 'train/total_loss': tensor(0.1856, device='cuda:0'), 'train/mask_ratio': tensor(0.8013, device='cuda:0'), 'lr': 0.009146897824423437, 'train/prefecth_time': 0.018310623168945314, 'train/run_time': 0.5464902954101563, 'eval/loss': tensor(2.3876, device='cuda:0'), 'eval/top-1-acc': 0.70075, 'eval/top-5-acc': 0.965125, 'eval/precision': 0.7040815547982827, 'eval/recall': 0.70075, 'eval/F1': 0.6850861261709192, 'eval/AUC': 0.9272907204861112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 06:43:31,720 INFO] confusion matrix:
[[0.96625 0.      0.00375 0.      0.00375 0.      0.00375 0.      0.0175
  0.005  ]
 [0.06    0.84125 0.00125 0.005   0.00375 0.0125  0.05125 0.02    0.005
  0.     ]
 [0.00125 0.0025  0.85    0.      0.      0.      0.11    0.      0.00375
  0.0325 ]
 [0.00375 0.085   0.01625 0.31625 0.01125 0.21    0.2425  0.07875 0.03625
  0.     ]
 [0.      0.0075  0.      0.0075  0.83875 0.0075  0.1125  0.01875 0.0075
  0.     ]
 [0.00125 0.025   0.      0.2725  0.02    0.50125 0.1425  0.03    0.0075
  0.     ]
 [0.0025  0.00875 0.005   0.00375 0.7975  0.0125  0.1525  0.0025  0.01
  0.005  ]
 [0.      0.21875 0.015   0.01875 0.00625 0.01375 0.19625 0.50625 0.02375
  0.00125]
 [0.00375 0.      0.      0.      0.      0.      0.01375 0.      0.97375
  0.00875]
 [0.00375 0.00125 0.09875 0.      0.      0.      0.06125 0.00125 0.01125
  0.8225 ]]
[2023-08-05 06:43:31,731 INFO] 963000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.6507e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1317, device='cuda:0'), 'train/shrink_loss': tensor(0.0813, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0647, device='cuda:0'), 'train/removed_class_idx': 2.3146064815048897, 'train/uncertainty_avg': 0.7559181680692556, 'train/certain_ratio_ema': 0.7964787497005934, 'train/total_loss': tensor(0.1964, device='cuda:0'), 'train/mask_ratio': tensor(0.8013, device='cuda:0'), 'lr': 0.009109439097234641, 'train/prefecth_time': 0.020380352020263674, 'train/run_time': 0.5467075805664062, 'eval/loss': tensor(2.7920, device='cuda:0'), 'eval/top-1-acc': 0.676875, 'eval/top-5-acc': 0.946875, 'eval/precision': 0.6898600750615316, 'eval/recall': 0.676875, 'eval/F1': 0.671769291991797, 'eval/AUC': 0.9115601215277778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 06:53:24,877 INFO] confusion matrix:
[[0.96    0.00125 0.00375 0.00125 0.00375 0.      0.0075  0.00125 0.015
  0.00625]
 [0.06    0.83    0.00125 0.01125 0.00375 0.01125 0.06125 0.01875 0.0025
  0.     ]
 [0.      0.0025  0.8575  0.      0.      0.      0.09875 0.      0.0025
  0.03875]
 [0.00125 0.0775  0.01375 0.30125 0.00875 0.22875 0.27375 0.06625 0.02875
  0.     ]
 [0.      0.0075  0.      0.00625 0.78875 0.00625 0.1675  0.01875 0.005
  0.     ]
 [0.00125 0.03    0.00125 0.245   0.02375 0.485   0.17625 0.03    0.0075
  0.     ]
 [0.0025  0.01    0.00625 0.00375 0.75875 0.00875 0.19625 0.00375 0.00625
  0.00375]
 [0.      0.2325  0.00375 0.01875 0.005   0.0125  0.195   0.5125  0.01875
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01875 0.      0.97
  0.00625]
 [0.00375 0.00125 0.12125 0.      0.      0.      0.075   0.00125 0.01
  0.7875 ]]
[2023-08-05 06:53:24,888 INFO] 964000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1365, device='cuda:0'), 'train/shrink_loss': tensor(0.0447, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0357, device='cuda:0'), 'train/removed_class_idx': 2.3076920118343573, 'train/uncertainty_avg': 0.77985156817514, 'train/certain_ratio_ema': 0.7989035419067132, 'train/total_loss': tensor(0.1723, device='cuda:0'), 'train/mask_ratio': tensor(0.8259, device='cuda:0'), 'lr': 0.009071964718847046, 'train/prefecth_time': 0.020002752304077148, 'train/run_time': 0.5653863525390626, 'eval/loss': tensor(2.9216, device='cuda:0'), 'eval/top-1-acc': 0.668875, 'eval/top-5-acc': 0.947, 'eval/precision': 0.6910343051204, 'eval/recall': 0.668875, 'eval/F1': 0.6682784832198706, 'eval/AUC': 0.9077502343750001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 07:03:10,516 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 07:03:20,211 INFO] confusion matrix:
[[0.9625  0.      0.00125 0.00125 0.00375 0.      0.00875 0.00375 0.01375
  0.005  ]
 [0.05875 0.8175  0.00125 0.02    0.00125 0.01125 0.0675  0.0225  0.
  0.     ]
 [0.      0.      0.81875 0.      0.      0.      0.13    0.00625 0.005
  0.04   ]
 [0.00125 0.07    0.      0.34125 0.00875 0.16375 0.3025  0.11    0.0025
  0.     ]
 [0.      0.00625 0.      0.01125 0.75375 0.005   0.20625 0.0175  0.
  0.     ]
 [0.      0.03375 0.      0.24375 0.0225  0.43875 0.21625 0.0425  0.0025
  0.     ]
 [0.00375 0.00625 0.00125 0.005   0.70375 0.01    0.25875 0.0075  0.
  0.00375]
 [0.      0.23375 0.      0.03375 0.00375 0.01    0.22625 0.49    0.00125
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02375 0.      0.9625
  0.0075 ]
 [0.005   0.00125 0.08375 0.00125 0.      0.      0.0875  0.0025  0.0075
  0.81125]]
[2023-08-05 07:03:20,218 INFO] 965000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.5328e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1154, device='cuda:0'), 'train/shrink_loss': tensor(0.0590, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0471, device='cuda:0'), 'train/removed_class_idx': 2.3092781124455555, 'train/uncertainty_avg': 0.7850839147154669, 'train/certain_ratio_ema': 0.7977199411114535, 'train/total_loss': tensor(0.1625, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.009034474753646491, 'train/prefecth_time': 0.019903839111328123, 'train/run_time': 0.5493031005859375, 'eval/loss': tensor(2.9908, device='cuda:0'), 'eval/top-1-acc': 0.6655, 'eval/top-5-acc': 0.9505, 'eval/precision': 0.7007916084103136, 'eval/recall': 0.6655, 'eval/F1': 0.6722041138630873, 'eval/AUC': 0.9036041927083335}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 07:13:14,454 INFO] confusion matrix:
[[0.9625  0.00125 0.00125 0.00125 0.0025  0.      0.0075  0.005   0.01375
  0.005  ]
 [0.06    0.81875 0.      0.01    0.0025  0.01    0.065   0.0325  0.00125
  0.     ]
 [0.      0.      0.83    0.      0.      0.      0.12125 0.0075  0.00375
  0.0375 ]
 [0.00125 0.0775  0.      0.3225  0.0125  0.2125  0.28    0.0925  0.00125
  0.     ]
 [0.      0.0075  0.      0.00875 0.75    0.005   0.21    0.01875 0.
  0.     ]
 [0.00125 0.03125 0.      0.2575  0.0225  0.45875 0.19625 0.03125 0.00125
  0.     ]
 [0.00375 0.005   0.00375 0.00625 0.695   0.00875 0.26625 0.00625 0.0025
  0.0025 ]
 [0.      0.2725  0.      0.0125  0.00875 0.01625 0.21875 0.47    0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01875 0.00125 0.9675
  0.0075 ]
 [0.00625 0.00125 0.07875 0.      0.      0.      0.09625 0.0025  0.01125
  0.80375]]
[2023-08-05 07:13:14,465 INFO] 966000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.3419e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1555, device='cuda:0'), 'train/shrink_loss': tensor(0.0397, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0318, device='cuda:0'), 'train/removed_class_idx': 2.313953219307765, 'train/uncertainty_avg': 0.7670755010746844, 'train/certain_ratio_ema': 0.8014354896695599, 'train/total_loss': tensor(0.1874, device='cuda:0'), 'train/mask_ratio': tensor(0.8080, device='cuda:0'), 'lr': 0.008996969266045596, 'train/prefecth_time': 0.020412384033203126, 'train/run_time': 0.5530674438476563, 'eval/loss': tensor(3.0970, device='cuda:0'), 'eval/top-1-acc': 0.665, 'eval/top-5-acc': 0.952125, 'eval/precision': 0.6962412764193194, 'eval/recall': 0.665, 'eval/F1': 0.6696567679862709, 'eval/AUC': 0.899363203125}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 07:23:09,194 INFO] confusion matrix:
[[0.965   0.00125 0.00125 0.      0.0025  0.      0.00625 0.00375 0.015
  0.005  ]
 [0.06125 0.83375 0.      0.01    0.0025  0.01125 0.0625  0.0175  0.00125
  0.     ]
 [0.      0.      0.82375 0.      0.      0.      0.12625 0.0025  0.00625
  0.04125]
 [0.00125 0.075   0.00125 0.355   0.01375 0.2125  0.27125 0.0675  0.0025
  0.     ]
 [0.      0.00875 0.      0.01375 0.77    0.00625 0.18625 0.015   0.
  0.     ]
 [0.00125 0.0275  0.      0.31375 0.02125 0.4425  0.1775  0.015   0.00125
  0.     ]
 [0.00375 0.00625 0.00625 0.0075  0.7025  0.0075  0.25    0.0075  0.0025
  0.00625]
 [0.      0.2975  0.      0.02    0.00875 0.02375 0.21625 0.43125 0.
  0.0025 ]
 [0.00375 0.      0.      0.      0.      0.      0.0175  0.      0.96875
  0.01   ]
 [0.0075  0.00125 0.10625 0.      0.      0.      0.08    0.      0.01375
  0.79125]]
[2023-08-05 07:23:09,208 INFO] 967000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1359, device='cuda:0'), 'train/shrink_loss': tensor(0.0702, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0560, device='cuda:0'), 'train/removed_class_idx': 2.4205605214429418, 'train/uncertainty_avg': 0.7758140499012498, 'train/certain_ratio_ema': 0.7973618258431269, 'train/total_loss': tensor(0.1920, device='cuda:0'), 'train/mask_ratio': tensor(0.7612, device='cuda:0'), 'lr': 0.008959448320483673, 'train/prefecth_time': 0.020552127838134766, 'train/run_time': 0.57764111328125, 'eval/loss': tensor(3.1318, device='cuda:0'), 'eval/top-1-acc': 0.663125, 'eval/top-5-acc': 0.943, 'eval/precision': 0.6927895789283196, 'eval/recall': 0.663125, 'eval/F1': 0.6655476107284932, 'eval/AUC': 0.8947738454861109}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 07:33:00,044 INFO] confusion matrix:
[[0.96125 0.0025  0.      0.      0.0025  0.      0.00625 0.005   0.0175
  0.005  ]
 [0.05875 0.8125  0.      0.00625 0.00125 0.01    0.05875 0.0525  0.
  0.     ]
 [0.00125 0.      0.80875 0.      0.      0.      0.13875 0.015   0.0025
  0.03375]
 [0.00125 0.0825  0.00125 0.27625 0.0075  0.1775  0.25    0.2     0.00375
  0.     ]
 [0.      0.0075  0.      0.00625 0.75375 0.005   0.19125 0.03625 0.
  0.     ]
 [0.00125 0.02    0.      0.31375 0.02125 0.4225  0.17375 0.0475  0.
  0.     ]
 [0.0025  0.00625 0.00375 0.00625 0.69    0.0075  0.2625  0.015   0.0025
  0.00375]
 [0.      0.23125 0.      0.00625 0.005   0.015   0.18625 0.55625 0.
  0.     ]
 [0.00625 0.      0.      0.      0.      0.      0.01625 0.      0.97
  0.0075 ]
 [0.0075  0.00125 0.09    0.      0.      0.      0.1025  0.005   0.01375
  0.78   ]]
[2023-08-05 07:33:00,055 INFO] 968000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.0265e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1575, device='cuda:0'), 'train/shrink_loss': tensor(0.0352, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0283, device='cuda:0'), 'train/removed_class_idx': 2.194804909765596, 'train/uncertainty_avg': 0.7790567025704618, 'train/certain_ratio_ema': 0.802669497187502, 'train/total_loss': tensor(0.1858, device='cuda:0'), 'train/mask_ratio': tensor(0.8281, device='cuda:0'), 'lr': 0.008921911981426561, 'train/prefecth_time': 0.030824928283691405, 'train/run_time': 0.5403164672851563, 'eval/loss': tensor(3.0940, device='cuda:0'), 'eval/top-1-acc': 0.660375, 'eval/top-5-acc': 0.949375, 'eval/precision': 0.6824157740948524, 'eval/recall': 0.6603749999999999, 'eval/F1': 0.6622067074813592, 'eval/AUC': 0.9009350694444443}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 07:43:06,619 INFO] confusion matrix:
[[0.96125 0.0025  0.      0.      0.0025  0.      0.0075  0.00375 0.01625
  0.00625]
 [0.05875 0.83375 0.      0.0125  0.0025  0.01    0.06    0.02    0.0025
  0.     ]
 [0.00125 0.0025  0.79625 0.      0.      0.00125 0.15625 0.00375 0.00375
  0.035  ]
 [0.0025  0.09375 0.      0.3575  0.01125 0.19125 0.25    0.0925  0.00125
  0.     ]
 [0.      0.00625 0.      0.0175  0.75    0.0075  0.1975  0.02    0.
  0.00125]
 [0.00125 0.02875 0.      0.35125 0.01625 0.4125  0.17    0.02    0.
  0.     ]
 [0.0025  0.0075  0.00375 0.00875 0.68875 0.00625 0.27    0.01    0.
  0.0025 ]
 [0.      0.38125 0.      0.03125 0.0075  0.01875 0.17375 0.3875  0.
  0.     ]
 [0.005   0.      0.      0.      0.      0.      0.02375 0.      0.96125
  0.01   ]
 [0.00625 0.0025  0.0875  0.      0.      0.      0.10875 0.00125 0.01375
  0.78   ]]
[2023-08-05 07:43:06,629 INFO] 969000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0013, device='cuda:0'), 'train/certain_loss': tensor(0.1367, device='cuda:0'), 'train/shrink_loss': tensor(0.0517, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0413, device='cuda:0'), 'train/removed_class_idx': 2.2941174221453506, 'train/uncertainty_avg': 0.7670207723772223, 'train/certain_ratio_ema': 0.7989792707184484, 'train/total_loss': tensor(0.1794, device='cuda:0'), 'train/mask_ratio': tensor(0.7723, device='cuda:0'), 'lr': 0.008884360313366577, 'train/prefecth_time': 0.02328528022766113, 'train/run_time': 0.5504987182617187, 'eval/loss': tensor(3.2231, device='cuda:0'), 'eval/top-1-acc': 0.651, 'eval/top-5-acc': 0.94825, 'eval/precision': 0.6820082727128279, 'eval/recall': 0.651, 'eval/F1': 0.6534052645424243, 'eval/AUC': 0.8928537065972222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 07:52:54,764 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 07:53:04,482 INFO] confusion matrix:
[[0.9525  0.0025  0.      0.      0.0025  0.      0.0125  0.00375 0.0175
  0.00875]
 [0.05625 0.83125 0.      0.005   0.00125 0.01375 0.06875 0.02125 0.0025
  0.     ]
 [0.00125 0.00375 0.80625 0.      0.      0.      0.13125 0.005   0.00375
  0.04875]
 [0.0025  0.105   0.      0.35625 0.015   0.19    0.23125 0.09875 0.00125
  0.     ]
 [0.      0.0075  0.      0.015   0.75875 0.0075  0.19375 0.0175  0.
  0.     ]
 [0.00125 0.02875 0.      0.37625 0.01625 0.40875 0.1525  0.015   0.00125
  0.     ]
 [0.00375 0.00625 0.0025  0.01    0.69    0.00625 0.26625 0.005   0.0025
  0.0075 ]
 [0.      0.3825  0.      0.02125 0.005   0.02375 0.1725  0.39375 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.025   0.00125 0.95875
  0.00875]
 [0.00875 0.0025  0.09125 0.      0.      0.      0.095   0.00125 0.01
  0.79125]]
[2023-08-05 07:53:04,488 INFO] 970000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.9784e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0907, device='cuda:0'), 'train/shrink_loss': tensor(0.0486, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0387, device='cuda:0'), 'train/removed_class_idx': 2.553191217745615, 'train/uncertainty_avg': 0.7877935858040214, 'train/certain_ratio_ema': 0.7966675857412221, 'train/total_loss': tensor(0.1295, device='cuda:0'), 'train/mask_ratio': tensor(0.7902, device='cuda:0'), 'lr': 0.008846793380822351, 'train/prefecth_time': 0.020147968292236328, 'train/run_time': 0.5491176147460938, 'eval/loss': tensor(3.1092, device='cuda:0'), 'eval/top-1-acc': 0.652375, 'eval/top-5-acc': 0.96125, 'eval/precision': 0.6790128478077456, 'eval/recall': 0.6523749999999999, 'eval/F1': 0.6530691561746467, 'eval/AUC': 0.8989710503472222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 08:02:55,687 INFO] confusion matrix:
[[0.9525  0.0025  0.      0.      0.0025  0.      0.01375 0.0025  0.01875
  0.0075 ]
 [0.05625 0.8225  0.      0.0125  0.0025  0.0125  0.06625 0.02375 0.00375
  0.     ]
 [0.      0.00125 0.83375 0.      0.      0.      0.11625 0.005   0.00375
  0.04   ]
 [0.0025  0.0875  0.00125 0.37875 0.01375 0.175   0.26625 0.07375 0.00125
  0.     ]
 [0.      0.0075  0.      0.01625 0.7575  0.00625 0.20375 0.00625 0.0025
  0.     ]
 [0.00125 0.02    0.      0.35125 0.02    0.4175  0.16875 0.01875 0.0025
  0.     ]
 [0.0025  0.00625 0.00375 0.01    0.665   0.0075  0.295   0.00125 0.00125
  0.0075 ]
 [0.      0.27    0.      0.04    0.00625 0.0175  0.2025  0.4625  0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.035   0.      0.9525
  0.00625]
 [0.0075  0.00125 0.11125 0.      0.      0.      0.09375 0.00125 0.01
  0.775  ]]
[2023-08-05 08:02:55,699 INFO] 971000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1040, device='cuda:0'), 'train/shrink_loss': tensor(0.0717, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0578, device='cuda:0'), 'train/removed_class_idx': 2.3586953957939785, 'train/uncertainty_avg': 0.7418353599962199, 'train/certain_ratio_ema': 0.8060759385297511, 'train/total_loss': tensor(0.1619, device='cuda:0'), 'train/mask_ratio': tensor(0.7946, device='cuda:0'), 'lr': 0.008809211248338748, 'train/prefecth_time': 0.02024511909484863, 'train/run_time': 0.5480807495117187, 'eval/loss': tensor(3.0066, device='cuda:0'), 'eval/top-1-acc': 0.66475, 'eval/top-5-acc': 0.96675, 'eval/precision': 0.6979723519173288, 'eval/recall': 0.66475, 'eval/F1': 0.669611059860417, 'eval/AUC': 0.9061339062500001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 08:13:00,994 INFO] confusion matrix:
[[0.95625 0.00375 0.00125 0.      0.0025  0.      0.00875 0.0025  0.01875
  0.00625]
 [0.0575  0.83875 0.00125 0.0125  0.00375 0.01    0.05375 0.0175  0.0025
  0.0025 ]
 [0.      0.00125 0.8275  0.      0.      0.      0.125   0.0025  0.00375
  0.04   ]
 [0.0025  0.07375 0.00125 0.36375 0.01125 0.24125 0.2725  0.0325  0.00125
  0.     ]
 [0.      0.00875 0.      0.02    0.77    0.005   0.18875 0.00625 0.
  0.00125]
 [0.00125 0.02125 0.      0.355   0.02    0.43    0.16625 0.005   0.00125
  0.     ]
 [0.00375 0.00625 0.00375 0.0075  0.65875 0.0075  0.30375 0.      0.0025
  0.00625]
 [0.      0.2475  0.      0.03875 0.00625 0.03    0.2075  0.46625 0.
  0.00375]
 [0.00625 0.      0.00125 0.      0.      0.      0.0225  0.      0.96375
  0.00625]
 [0.00625 0.00125 0.1     0.      0.      0.      0.11    0.00125 0.0125
  0.76875]]
[2023-08-05 08:13:01,008 INFO] 972000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1424, device='cuda:0'), 'train/shrink_loss': tensor(0.0593, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0478, device='cuda:0'), 'train/removed_class_idx': 2.4234232050970084, 'train/uncertainty_avg': 0.754570970344113, 'train/certain_ratio_ema': 0.8061187393659087, 'train/total_loss': tensor(0.1903, device='cuda:0'), 'train/mask_ratio': tensor(0.7522, device='cuda:0'), 'lr': 0.008771613980486762, 'train/prefecth_time': 0.021054527282714845, 'train/run_time': 0.5572738037109375, 'eval/loss': tensor(3.0170, device='cuda:0'), 'eval/top-1-acc': 0.668875, 'eval/top-5-acc': 0.959875, 'eval/precision': 0.7039726595685319, 'eval/recall': 0.668875, 'eval/F1': 0.6736939032393556, 'eval/AUC': 0.9039591319444445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 08:22:54,145 INFO] confusion matrix:
[[0.9625  0.00375 0.00125 0.      0.0025  0.      0.00625 0.0025  0.0175
  0.00375]
 [0.0575  0.8275  0.      0.00375 0.0025  0.01125 0.04125 0.05125 0.005
  0.     ]
 [0.      0.      0.8175  0.      0.      0.      0.14125 0.01125 0.005
  0.025  ]
 [0.00375 0.09125 0.00125 0.30875 0.01    0.17625 0.23375 0.1425  0.0325
  0.     ]
 [0.      0.0075  0.      0.0125  0.7975  0.005   0.1525  0.01875 0.005
  0.00125]
 [0.00125 0.03125 0.      0.38625 0.01625 0.385   0.14375 0.02875 0.0075
  0.     ]
 [0.00375 0.00625 0.00375 0.0075  0.7125  0.0075  0.245   0.005   0.00375
  0.005  ]
 [0.      0.2275  0.      0.0125  0.00625 0.01125 0.1675  0.55375 0.02
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02125 0.      0.96625
  0.00625]
 [0.005   0.00125 0.10625 0.      0.      0.      0.135   0.00375 0.01375
  0.735  ]]
[2023-08-05 08:22:54,155 INFO] 973000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.5506e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1103, device='cuda:0'), 'train/shrink_loss': tensor(0.0638, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0513, device='cuda:0'), 'train/removed_class_idx': 2.457142623129274, 'train/uncertainty_avg': 0.7525537250964051, 'train/certain_ratio_ema': 0.8049207690414116, 'train/total_loss': tensor(0.1617, device='cuda:0'), 'train/mask_ratio': tensor(0.7656, device='cuda:0'), 'lr': 0.008734001641863371, 'train/prefecth_time': 0.02304412841796875, 'train/run_time': 0.555217041015625, 'eval/loss': tensor(3.1445, device='cuda:0'), 'eval/top-1-acc': 0.659875, 'eval/top-5-acc': 0.950125, 'eval/precision': 0.6790322103522797, 'eval/recall': 0.659875, 'eval/F1': 0.6590828190103382, 'eval/AUC': 0.8987426909722223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 08:32:48,873 INFO] confusion matrix:
[[0.96    0.00375 0.00375 0.      0.00125 0.      0.00875 0.      0.01875
  0.00375]
 [0.06    0.85125 0.00125 0.0175  0.00125 0.0125  0.04125 0.01125 0.0025
  0.00125]
 [0.      0.0025  0.80625 0.      0.      0.      0.15875 0.      0.01
  0.0225 ]
 [0.005   0.10625 0.02    0.3525  0.01125 0.20375 0.2475  0.0225  0.03125
  0.     ]
 [0.      0.0075  0.      0.02    0.7825  0.00625 0.17125 0.00625 0.00625
  0.     ]
 [0.00125 0.03875 0.      0.3125  0.0225  0.44125 0.16125 0.01625 0.00625
  0.     ]
 [0.00375 0.00625 0.00375 0.0075  0.69125 0.01    0.265   0.00125 0.00625
  0.005  ]
 [0.      0.27625 0.0125  0.0325  0.00875 0.015   0.17375 0.4625  0.0175
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02625 0.      0.96
  0.0075 ]
 [0.00625 0.00125 0.11125 0.      0.      0.      0.115   0.00125 0.015
  0.75   ]]
[2023-08-05 08:32:48,888 INFO] 974000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.2382e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1443, device='cuda:0'), 'train/shrink_loss': tensor(0.0494, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0396, device='cuda:0'), 'train/removed_class_idx': 2.423529126643632, 'train/uncertainty_avg': 0.7419563787967848, 'train/certain_ratio_ema': 0.8008242416144826, 'train/total_loss': tensor(0.1839, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.008696374297091448, 'train/prefecth_time': 0.029888608932495116, 'train/run_time': 0.5663851318359375, 'eval/loss': tensor(3.0523, device='cuda:0'), 'eval/top-1-acc': 0.663125, 'eval/top-5-acc': 0.951375, 'eval/precision': 0.6973227852042811, 'eval/recall': 0.663125, 'eval/F1': 0.6649057126060824, 'eval/AUC': 0.9004882031249999}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 08:42:34,406 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 08:42:44,084 INFO] confusion matrix:
[[0.96    0.00375 0.005   0.      0.00125 0.      0.015   0.      0.0125
  0.0025 ]
 [0.06    0.82625 0.00125 0.0125  0.0025  0.01    0.055   0.03    0.0025
  0.     ]
 [0.      0.00125 0.8025  0.      0.      0.      0.16375 0.0025  0.005
  0.025  ]
 [0.005   0.08625 0.02125 0.3     0.0075  0.19375 0.25875 0.09625 0.03125
  0.     ]
 [0.      0.00875 0.      0.0075  0.77125 0.005   0.1825  0.02    0.005
  0.     ]
 [0.00125 0.0225  0.00125 0.27625 0.0175  0.4525  0.18    0.04375 0.00375
  0.00125]
 [0.00375 0.005   0.005   0.00625 0.70375 0.00875 0.255   0.0025  0.005
  0.005  ]
 [0.      0.18125 0.01125 0.01375 0.00625 0.0075  0.17125 0.59    0.0175
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.03375 0.      0.95375
  0.00625]
 [0.005   0.00125 0.0925  0.      0.      0.      0.1075  0.00375 0.0125
  0.7775 ]]
[2023-08-05 08:42:44,091 INFO] 975000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1477, device='cuda:0'), 'train/shrink_loss': tensor(0.0632, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0509, device='cuda:0'), 'train/removed_class_idx': 2.284090649535153, 'train/uncertainty_avg': 0.7454179267582732, 'train/certain_ratio_ema': 0.8047485763933433, 'train/total_loss': tensor(0.1990, device='cuda:0'), 'train/mask_ratio': tensor(0.8036, device='cuda:0'), 'lr': 0.008658732010819672, 'train/prefecth_time': 0.018999872207641603, 'train/run_time': 0.5443693237304688, 'eval/loss': tensor(3.1042, device='cuda:0'), 'eval/top-1-acc': 0.668875, 'eval/top-5-acc': 0.94, 'eval/precision': 0.6954653765589567, 'eval/recall': 0.668875, 'eval/F1': 0.6722979521198521, 'eval/AUC': 0.8968841319444445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 08:52:53,080 INFO] confusion matrix:
[[0.96125 0.0025  0.00125 0.      0.00125 0.      0.0125  0.      0.01625
  0.005  ]
 [0.06    0.84375 0.      0.01125 0.00375 0.01125 0.055   0.015   0.
  0.     ]
 [0.00125 0.00125 0.81    0.      0.      0.0025  0.155   0.00125 0.0025
  0.02625]
 [0.00375 0.1175  0.      0.33125 0.0325  0.2075  0.25625 0.03625 0.015
  0.     ]
 [0.      0.00875 0.      0.00875 0.76625 0.0075  0.195   0.0125  0.00125
  0.     ]
 [0.00125 0.0275  0.      0.3325  0.01625 0.4275  0.175   0.01875 0.00125
  0.     ]
 [0.00375 0.0075  0.0025  0.0075  0.57375 0.015   0.38    0.00125 0.0025
  0.00625]
 [0.      0.22875 0.      0.0275  0.015   0.0225  0.18625 0.5075  0.01125
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.02375 0.      0.96375
  0.0075 ]
 [0.0075  0.00125 0.0925  0.      0.      0.00125 0.09125 0.00125 0.01625
  0.78875]]
[2023-08-05 08:52:53,095 INFO] 976000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1602, device='cuda:0'), 'train/shrink_loss': tensor(0.0841, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0664, device='cuda:0'), 'train/removed_class_idx': 2.368931808841572, 'train/uncertainty_avg': 0.7699289494506115, 'train/certain_ratio_ema': 0.78974451174229, 'train/total_loss': tensor(0.2267, device='cuda:0'), 'train/mask_ratio': tensor(0.7701, device='cuda:0'), 'lr': 0.00862107484772236, 'train/prefecth_time': 0.01954761505126953, 'train/run_time': 0.5659907836914062, 'eval/loss': tensor(2.6938, device='cuda:0'), 'eval/top-1-acc': 0.678, 'eval/top-5-acc': 0.952875, 'eval/precision': 0.7099173999574444, 'eval/recall': 0.678, 'eval/F1': 0.6816817539487777, 'eval/AUC': 0.9119062586805556}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 09:02:50,248 INFO] confusion matrix:
[[0.9575  0.00125 0.      0.      0.00125 0.00125 0.0125  0.      0.02
  0.00625]
 [0.05875 0.84125 0.      0.01625 0.0025  0.01625 0.05625 0.005   0.00375
  0.     ]
 [0.      0.00125 0.82125 0.      0.      0.01    0.15    0.      0.0025
  0.015  ]
 [0.0025  0.13375 0.      0.38875 0.005   0.19875 0.25    0.02    0.00125
  0.     ]
 [0.      0.0125  0.      0.0175  0.76    0.01375 0.1875  0.00875 0.
  0.     ]
 [0.00125 0.04125 0.      0.415   0.015   0.3475  0.165   0.015   0.
  0.     ]
 [0.00375 0.00625 0.0025  0.0175  0.48    0.05625 0.38375 0.045   0.00125
  0.00375]
 [0.      0.29    0.      0.055   0.00375 0.05    0.17375 0.42625 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02625 0.      0.96
  0.0075 ]
 [0.005   0.00125 0.11125 0.00125 0.      0.0025  0.08375 0.00125 0.01125
  0.7825 ]]
[2023-08-05 09:02:50,265 INFO] 977000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.8988e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1228, device='cuda:0'), 'train/shrink_loss': tensor(0.0436, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0343, device='cuda:0'), 'train/removed_class_idx': 2.32142829506806, 'train/uncertainty_avg': 0.750947964696542, 'train/certain_ratio_ema': 0.7863152388796149, 'train/total_loss': tensor(0.1572, device='cuda:0'), 'train/mask_ratio': tensor(0.8125, device='cuda:0'), 'lr': 0.008583402872499422, 'train/prefecth_time': 0.019386560440063476, 'train/run_time': 0.543938232421875, 'eval/loss': tensor(2.8068, device='cuda:0'), 'eval/top-1-acc': 0.666875, 'eval/top-5-acc': 0.94075, 'eval/precision': 0.6956061261039964, 'eval/recall': 0.6668749999999999, 'eval/F1': 0.6689678390929279, 'eval/AUC': 0.9060941753472223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 09:12:47,756 INFO] confusion matrix:
[[0.955   0.0025  0.      0.      0.0025  0.0025  0.01125 0.00125 0.01875
  0.00625]
 [0.06    0.84    0.      0.01    0.00125 0.005   0.05875 0.0225  0.0025
  0.     ]
 [0.      0.00125 0.8225  0.      0.      0.00375 0.14875 0.0025  0.00375
  0.0175 ]
 [0.00125 0.12    0.      0.3825  0.01    0.0925  0.27    0.1225  0.00125
  0.     ]
 [0.      0.01125 0.      0.01875 0.76125 0.00375 0.1875  0.0175  0.
  0.     ]
 [0.00125 0.0425  0.      0.44375 0.01875 0.28375 0.18375 0.02625 0.
  0.     ]
 [0.00375 0.00625 0.0025  0.0175  0.6425  0.00625 0.295   0.02125 0.0025
  0.0025 ]
 [0.      0.36375 0.00125 0.06    0.0075  0.01    0.1725  0.38375 0.
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.0275  0.      0.96
  0.005  ]
 [0.005   0.0025  0.115   0.00125 0.      0.      0.08125 0.      0.01125
  0.78375]]
[2023-08-05 09:12:47,771 INFO] 978000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.0487e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1441, device='cuda:0'), 'train/shrink_loss': tensor(0.0495, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0389, device='cuda:0'), 'train/removed_class_idx': 2.3294114906574714, 'train/uncertainty_avg': 0.7863073973652261, 'train/certain_ratio_ema': 0.7854816791490923, 'train/total_loss': tensor(0.1830, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.008545716149876193, 'train/prefecth_time': 0.019662975311279297, 'train/run_time': 0.5463528442382812, 'eval/loss': tensor(3.0588, device='cuda:0'), 'eval/top-1-acc': 0.64675, 'eval/top-5-acc': 0.936, 'eval/precision': 0.6803004537035111, 'eval/recall': 0.6467499999999999, 'eval/F1': 0.6456980212304991, 'eval/AUC': 0.9010688368055556}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 09:22:42,804 INFO] confusion matrix:
[[0.96375 0.00125 0.      0.      0.00125 0.0025  0.00625 0.00125 0.01875
  0.005  ]
 [0.06125 0.84    0.00125 0.00875 0.      0.0075  0.05375 0.0225  0.005
  0.     ]
 [0.      0.      0.79625 0.      0.      0.00125 0.1625  0.00625 0.005
  0.02875]
 [0.00125 0.10875 0.      0.40875 0.00625 0.0775  0.265   0.13125 0.00125
  0.     ]
 [0.      0.01    0.      0.0175  0.7625  0.00375 0.19    0.01625 0.
  0.     ]
 [0.      0.04125 0.      0.4075  0.01875 0.325   0.17625 0.03125 0.
  0.     ]
 [0.0025  0.00625 0.0025  0.01375 0.63875 0.00375 0.30875 0.0175  0.0025
  0.00375]
 [0.00125 0.42125 0.00125 0.0575  0.00625 0.005   0.185   0.32125 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02375 0.      0.96375
  0.00625]
 [0.00625 0.0025  0.12    0.00125 0.      0.      0.0775  0.      0.01125
  0.78125]]
[2023-08-05 09:22:42,821 INFO] 979000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.0858e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1796, device='cuda:0'), 'train/shrink_loss': tensor(0.0422, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0333, device='cuda:0'), 'train/removed_class_idx': 2.354838456468983, 'train/uncertainty_avg': 0.751400356290122, 'train/certain_ratio_ema': 0.790144535258839, 'train/total_loss': tensor(0.2129, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.008508014744603349, 'train/prefecth_time': 0.01917840003967285, 'train/run_time': 0.5500894165039063, 'eval/loss': tensor(3.0812, device='cuda:0'), 'eval/top-1-acc': 0.647125, 'eval/top-5-acc': 0.95225, 'eval/precision': 0.6818667076371687, 'eval/recall': 0.6471250000000001, 'eval/F1': 0.6455908094733332, 'eval/AUC': 0.904218159722222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 09:32:28,862 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 09:32:38,691 INFO] confusion matrix:
[[0.965   0.00125 0.      0.      0.0025  0.      0.005   0.0025  0.01875
  0.005  ]
 [0.065   0.835   0.      0.0175  0.      0.0075  0.055   0.015   0.005
  0.     ]
 [0.      0.00125 0.8     0.      0.      0.      0.155   0.00375 0.00375
  0.03625]
 [0.00125 0.1075  0.      0.4275  0.0125  0.11375 0.26125 0.07375 0.0025
  0.     ]
 [0.      0.00875 0.      0.02375 0.75875 0.005   0.19375 0.0075  0.00125
  0.00125]
 [0.00125 0.0325  0.      0.34625 0.02125 0.415   0.17125 0.01125 0.00125
  0.     ]
 [0.00375 0.005   0.      0.01    0.66625 0.00625 0.29    0.00625 0.0025
  0.01   ]
 [0.00125 0.45375 0.      0.0725  0.0075  0.01    0.17625 0.27625 0.00125
  0.00125]
 [0.0075  0.      0.      0.      0.      0.      0.0225  0.      0.96375
  0.00625]
 [0.00625 0.0025  0.11125 0.00125 0.      0.      0.09    0.      0.01
  0.77875]]
[2023-08-05 09:32:38,698 INFO] 980000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.4721e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1190, device='cuda:0'), 'train/shrink_loss': tensor(0.0347, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0278, device='cuda:0'), 'train/removed_class_idx': 2.380952097505703, 'train/uncertainty_avg': 0.735992795669535, 'train/certain_ratio_ema': 0.7993909691195027, 'train/total_loss': tensor(0.1468, device='cuda:0'), 'train/mask_ratio': tensor(0.8125, device='cuda:0'), 'lr': 0.00847029872145681, 'train/prefecth_time': 0.027134464263916015, 'train/run_time': 0.5508048706054688, 'eval/loss': tensor(3.1245, device='cuda:0'), 'eval/top-1-acc': 0.651, 'eval/top-5-acc': 0.956, 'eval/precision': 0.6893436554203355, 'eval/recall': 0.651, 'eval/F1': 0.6499622408949961, 'eval/AUC': 0.9018602864583332}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 09:42:30,106 INFO] confusion matrix:
[[0.965   0.00125 0.      0.      0.0025  0.      0.00625 0.00375 0.01625
  0.005  ]
 [0.065   0.82375 0.      0.01125 0.00125 0.01    0.0575  0.0275  0.00375
  0.     ]
 [0.00125 0.      0.81125 0.      0.      0.      0.15    0.00625 0.00375
  0.0275 ]
 [0.0025  0.07625 0.      0.37125 0.015   0.19875 0.25875 0.07625 0.00125
  0.     ]
 [0.      0.0075  0.      0.01375 0.75125 0.005   0.20625 0.015   0.
  0.00125]
 [0.00125 0.03375 0.      0.36625 0.0175  0.3925  0.18    0.00875 0.
  0.     ]
 [0.00375 0.005   0.0025  0.01125 0.67    0.005   0.29125 0.005   0.0025
  0.00375]
 [0.00125 0.445   0.      0.05125 0.01    0.015   0.1825  0.29375 0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.0225  0.      0.96375
  0.0075 ]
 [0.00875 0.0025  0.1175  0.00125 0.      0.      0.11    0.      0.01
  0.75   ]]
[2023-08-05 09:42:30,122 INFO] 981000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1779, device='cuda:0'), 'train/shrink_loss': tensor(0.0461, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0371, device='cuda:0'), 'train/removed_class_idx': 2.3815786340028113, 'train/uncertainty_avg': 0.7643367297285292, 'train/certain_ratio_ema': 0.8057212501617448, 'train/total_loss': tensor(0.2151, device='cuda:0'), 'train/mask_ratio': tensor(0.8304, device='cuda:0'), 'lr': 0.008432568145237587, 'train/prefecth_time': 0.018236608505249025, 'train/run_time': 0.5545846557617188, 'eval/loss': tensor(3.3456, device='cuda:0'), 'eval/top-1-acc': 0.641375, 'eval/top-5-acc': 0.955875, 'eval/precision': 0.6740945378118454, 'eval/recall': 0.641375, 'eval/F1': 0.640896676627911, 'eval/AUC': 0.8927823263888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 09:52:30,535 INFO] confusion matrix:
[[0.95875 0.0025  0.      0.      0.0025  0.      0.01    0.00375 0.01625
  0.00625]
 [0.0625  0.825   0.      0.015   0.00125 0.01125 0.05625 0.025   0.00375
  0.     ]
 [0.      0.      0.83    0.      0.      0.      0.1275  0.01125 0.0025
  0.02875]
 [0.00125 0.08    0.      0.40875 0.01    0.20875 0.24875 0.04125 0.00125
  0.     ]
 [0.      0.0075  0.0025  0.02625 0.74375 0.0075  0.20625 0.00625 0.
  0.     ]
 [0.00125 0.0275  0.      0.3675  0.01875 0.38875 0.18625 0.01    0.
  0.     ]
 [0.00375 0.005   0.00375 0.01125 0.67125 0.0075  0.28875 0.005   0.00125
  0.0025 ]
 [0.00125 0.325   0.      0.0675  0.0075  0.01625 0.19375 0.3875  0.
  0.00125]
 [0.00625 0.      0.      0.      0.      0.      0.02375 0.      0.9625
  0.0075 ]
 [0.0075  0.00125 0.11375 0.00125 0.      0.      0.1     0.0025  0.0075
  0.76625]]
[2023-08-05 09:52:30,555 INFO] 982000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.6667e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1130, device='cuda:0'), 'train/shrink_loss': tensor(0.0441, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0356, device='cuda:0'), 'train/removed_class_idx': 2.4749996906250384, 'train/uncertainty_avg': 0.7456099803800903, 'train/certain_ratio_ema': 0.8070962648829525, 'train/total_loss': tensor(0.1486, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.008394823080771722, 'train/prefecth_time': 0.018563615798950196, 'train/run_time': 0.5436681518554688, 'eval/loss': tensor(3.2156, device='cuda:0'), 'eval/top-1-acc': 0.656, 'eval/top-5-acc': 0.96, 'eval/precision': 0.6912626869360248, 'eval/recall': 0.656, 'eval/F1': 0.659282935029253, 'eval/AUC': 0.8957350260416667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 10:02:20,674 INFO] confusion matrix:
[[0.96625 0.00125 0.      0.      0.0025  0.      0.005   0.00375 0.01625
  0.005  ]
 [0.0625  0.8325  0.      0.01625 0.00125 0.0125  0.055   0.01875 0.00125
  0.     ]
 [0.      0.00125 0.82625 0.      0.      0.      0.12375 0.0125  0.00375
  0.0325 ]
 [0.0025  0.06625 0.      0.42125 0.01    0.2175  0.24875 0.0325  0.00125
  0.     ]
 [0.      0.0075  0.      0.025   0.75375 0.00625 0.2025  0.005   0.
  0.     ]
 [0.00125 0.03125 0.      0.36875 0.02375 0.37    0.1975  0.00625 0.00125
  0.     ]
 [0.00375 0.00125 0.00625 0.01375 0.6675  0.00625 0.2925  0.00375 0.0025
  0.0025 ]
 [0.      0.3675  0.      0.0625  0.00875 0.0175  0.20125 0.34125 0.
  0.00125]
 [0.00625 0.      0.      0.00125 0.      0.      0.01375 0.      0.96875
  0.01   ]
 [0.00875 0.0025  0.0975  0.00125 0.      0.      0.07375 0.0025  0.00875
  0.805  ]]
[2023-08-05 10:02:20,690 INFO] 983000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.1581e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1943, device='cuda:0'), 'train/shrink_loss': tensor(0.0416, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0336, device='cuda:0'), 'train/removed_class_idx': 2.557894467590056, 'train/uncertainty_avg': 0.7528337735536548, 'train/certain_ratio_ema': 0.8090946358028056, 'train/total_loss': tensor(0.2280, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.008357063592910127, 'train/prefecth_time': 0.019516191482543944, 'train/run_time': 0.5496130981445313, 'eval/loss': tensor(3.2231, device='cuda:0'), 'eval/top-1-acc': 0.65775, 'eval/top-5-acc': 0.953625, 'eval/precision': 0.6919077210692122, 'eval/recall': 0.65775, 'eval/F1': 0.657991108102237, 'eval/AUC': 0.8968144184027776}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 10:12:10,530 INFO] confusion matrix:
[[0.96375 0.00125 0.      0.      0.0025  0.      0.00625 0.005   0.015
  0.00625]
 [0.0625  0.825   0.      0.01    0.      0.01125 0.05875 0.03    0.0025
  0.     ]
 [0.      0.      0.8825  0.00125 0.      0.      0.06875 0.0125  0.00625
  0.02875]
 [0.00375 0.065   0.00125 0.43125 0.01125 0.19    0.2525  0.04375 0.00125
  0.     ]
 [0.      0.00625 0.      0.01875 0.74625 0.00875 0.20875 0.01125 0.
  0.     ]
 [0.00125 0.02375 0.00125 0.3825  0.01875 0.375   0.19125 0.005   0.00125
  0.     ]
 [0.00375 0.00375 0.0075  0.0125  0.665   0.00875 0.2925  0.00125 0.0025
  0.0025 ]
 [0.      0.335   0.      0.05625 0.0125  0.025   0.1925  0.3775  0.
  0.00125]
 [0.005   0.      0.      0.00125 0.      0.00125 0.01625 0.      0.96875
  0.0075 ]
 [0.01125 0.0025  0.07625 0.00125 0.      0.      0.08625 0.      0.01125
  0.81125]]
[2023-08-05 10:12:10,537 INFO] 984000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0005, device='cuda:0'), 'train/certain_loss': tensor(0.1165, device='cuda:0'), 'train/shrink_loss': tensor(0.0402, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0327, device='cuda:0'), 'train/removed_class_idx': 2.4285711131725827, 'train/uncertainty_avg': 0.7421107779806866, 'train/certain_ratio_ema': 0.8136140519511317, 'train/total_loss': tensor(0.1497, device='cuda:0'), 'train/mask_ratio': tensor(0.8281, device='cuda:0'), 'lr': 0.008319289746528496, 'train/prefecth_time': 0.02029968070983887, 'train/run_time': 0.5418841552734375, 'eval/loss': tensor(3.1600, device='cuda:0'), 'eval/top-1-acc': 0.667375, 'eval/top-5-acc': 0.95, 'eval/precision': 0.6965476936068904, 'eval/recall': 0.667375, 'eval/F1': 0.6678900286158282, 'eval/AUC': 0.8996180555555554}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 10:21:54,942 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 10:22:04,589 INFO] confusion matrix:
[[0.96375 0.0025  0.00125 0.      0.0025  0.      0.0075  0.00125 0.015
  0.00625]
 [0.06375 0.83125 0.00125 0.0175  0.      0.01    0.0575  0.0175  0.00125
  0.     ]
 [0.      0.      0.9275  0.      0.      0.      0.045   0.00125 0.00375
  0.0225 ]
 [0.00125 0.06125 0.0025  0.43625 0.01    0.19875 0.26    0.02875 0.00125
  0.     ]
 [0.      0.00625 0.00125 0.0275  0.75125 0.0025  0.205   0.00625 0.
  0.     ]
 [0.      0.0225  0.00125 0.375   0.01875 0.3725  0.2075  0.0025  0.
  0.     ]
 [0.00375 0.00625 0.00625 0.01375 0.6875  0.00875 0.2675  0.      0.0025
  0.00375]
 [0.      0.36875 0.      0.0975  0.01125 0.02125 0.22    0.28    0.
  0.00125]
 [0.0075  0.      0.      0.00125 0.      0.      0.015   0.      0.96625
  0.01   ]
 [0.0075  0.00125 0.09375 0.0025  0.      0.      0.09    0.      0.00875
  0.79625]]
[2023-08-05 10:22:04,595 INFO] 985000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.1395, device='cuda:0'), 'train/shrink_loss': tensor(0.0443, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0357, device='cuda:0'), 'train/removed_class_idx': 2.463767758874238, 'train/uncertainty_avg': 0.735005343467054, 'train/certain_ratio_ema': 0.8070466510000006, 'train/total_loss': tensor(0.1755, device='cuda:0'), 'train/mask_ratio': tensor(0.8460, device='cuda:0'), 'lr': 0.008281501606527214, 'train/prefecth_time': 0.019191936492919923, 'train/run_time': 0.5541864624023437, 'eval/loss': tensor(3.2132, device='cuda:0'), 'eval/top-1-acc': 0.65925, 'eval/top-5-acc': 0.942625, 'eval/precision': 0.6958418238845964, 'eval/recall': 0.65925, 'eval/F1': 0.6561875847880725, 'eval/AUC': 0.8978487413194445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 10:31:55,211 INFO] confusion matrix:
[[0.96125 0.00125 0.00375 0.      0.00375 0.      0.0075  0.      0.015
  0.0075 ]
 [0.06375 0.82625 0.      0.02875 0.      0.01    0.065   0.005   0.00125
  0.     ]
 [0.      0.      0.86875 0.00125 0.      0.      0.1075  0.0025  0.00125
  0.01875]
 [0.00125 0.0975  0.00125 0.45625 0.00875 0.15875 0.27375 0.00125 0.00125
  0.     ]
 [0.      0.00625 0.      0.0275  0.75    0.00625 0.2075  0.0025  0.
  0.     ]
 [0.      0.0275  0.00125 0.3125  0.0225  0.42625 0.20625 0.0025  0.00125
  0.     ]
 [0.00375 0.005   0.005   0.01375 0.69875 0.00875 0.25875 0.      0.0025
  0.00375]
 [0.00125 0.28875 0.      0.1275  0.015   0.01375 0.225   0.3275  0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.015   0.      0.97
  0.01   ]
 [0.00625 0.00125 0.0875  0.0025  0.      0.      0.11625 0.      0.01125
  0.775  ]]
[2023-08-05 10:31:55,221 INFO] 986000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.7489e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1427, device='cuda:0'), 'train/shrink_loss': tensor(0.0381, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0310, device='cuda:0'), 'train/removed_class_idx': 2.5568178912706943, 'train/uncertainty_avg': 0.7534979585788601, 'train/certain_ratio_ema': 0.8127386582715692, 'train/total_loss': tensor(0.1737, device='cuda:0'), 'train/mask_ratio': tensor(0.8036, device='cuda:0'), 'lr': 0.008243699237831206, 'train/prefecth_time': 0.02044937515258789, 'train/run_time': 0.544231689453125, 'eval/loss': tensor(3.1303, device='cuda:0'), 'eval/top-1-acc': 0.662, 'eval/top-5-acc': 0.94925, 'eval/precision': 0.7183245988197082, 'eval/recall': 0.662, 'eval/F1': 0.6664489655824425, 'eval/AUC': 0.9007288541666666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 10:41:49,117 INFO] confusion matrix:
[[0.96125 0.00125 0.      0.      0.00375 0.      0.00625 0.00375 0.01875
  0.005  ]
 [0.06375 0.83375 0.      0.01    0.00125 0.0075  0.06    0.02125 0.0025
  0.     ]
 [0.      0.      0.86    0.      0.      0.      0.1     0.01625 0.00125
  0.0225 ]
 [0.00125 0.11125 0.00125 0.36875 0.015   0.22125 0.24875 0.03125 0.00125
  0.     ]
 [0.      0.0075  0.      0.02    0.755   0.0075  0.2025  0.0075  0.
  0.     ]
 [0.00125 0.02625 0.      0.3075  0.02125 0.4475  0.19125 0.005   0.
  0.     ]
 [0.00375 0.00625 0.0025  0.01125 0.7025  0.0075  0.255   0.00625 0.0025
  0.0025 ]
 [0.00125 0.265   0.      0.055   0.015   0.02625 0.19625 0.44    0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.015   0.      0.96875
  0.01125]
 [0.0075  0.00125 0.0675  0.00125 0.      0.      0.1175  0.0025  0.01
  0.7925 ]]
[2023-08-05 10:41:49,128 INFO] 987000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.1910e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1122, device='cuda:0'), 'train/shrink_loss': tensor(0.0477, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0385, device='cuda:0'), 'train/removed_class_idx': 2.4659088106921807, 'train/uncertainty_avg': 0.7622073195352009, 'train/certain_ratio_ema': 0.8068968588942371, 'train/total_loss': tensor(0.1506, device='cuda:0'), 'train/mask_ratio': tensor(0.8036, device='cuda:0'), 'lr': 0.00820588270538984, 'train/prefecth_time': 0.019752031326293946, 'train/run_time': 0.5518565673828125, 'eval/loss': tensor(3.1369, device='cuda:0'), 'eval/top-1-acc': 0.66825, 'eval/top-5-acc': 0.947625, 'eval/precision': 0.7028556904577753, 'eval/recall': 0.6682499999999999, 'eval/F1': 0.6725607107266709, 'eval/AUC': 0.8961899565972222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 10:51:40,202 INFO] confusion matrix:
[[0.96    0.00125 0.00375 0.      0.00375 0.      0.0075  0.00125 0.01625
  0.00625]
 [0.06375 0.83    0.00125 0.005   0.      0.00875 0.06    0.0275  0.00375
  0.     ]
 [0.      0.      0.90625 0.      0.      0.      0.06    0.005   0.00375
  0.025  ]
 [0.00125 0.09875 0.0025  0.355   0.01    0.185   0.24625 0.07625 0.025
  0.     ]
 [0.      0.00625 0.      0.01125 0.74125 0.0075  0.21125 0.01625 0.00625
  0.     ]
 [0.00125 0.025   0.00125 0.37625 0.01875 0.375   0.18125 0.015   0.00625
  0.     ]
 [0.00375 0.005   0.015   0.0075  0.6825  0.00875 0.26375 0.0025  0.0075
  0.00375]
 [0.00125 0.26625 0.00375 0.03125 0.00875 0.01875 0.19    0.46125 0.0175
  0.00125]
 [0.00625 0.      0.00125 0.      0.      0.      0.01125 0.      0.97125
  0.01   ]
 [0.00625 0.00125 0.07    0.      0.      0.      0.07625 0.00125 0.01125
  0.83375]]
[2023-08-05 10:51:40,213 INFO] 988000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.3725e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1464, device='cuda:0'), 'train/shrink_loss': tensor(0.0397, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0322, device='cuda:0'), 'train/removed_class_idx': 2.5294114671280625, 'train/uncertainty_avg': 0.7630656235209858, 'train/certain_ratio_ema': 0.8111643892124273, 'train/total_loss': tensor(0.1787, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.00816805207417684, 'train/prefecth_time': 0.01827027130126953, 'train/run_time': 0.5458052978515625, 'eval/loss': tensor(3.1600, device='cuda:0'), 'eval/top-1-acc': 0.66975, 'eval/top-5-acc': 0.943375, 'eval/precision': 0.6891609204338889, 'eval/recall': 0.66975, 'eval/F1': 0.6682001416478981, 'eval/AUC': 0.8941669965277779}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 11:01:42,779 INFO] confusion matrix:
[[0.96125 0.0025  0.00375 0.      0.0025  0.      0.00625 0.00125 0.01625
  0.00625]
 [0.06375 0.82875 0.00125 0.0075  0.      0.01    0.05625 0.03    0.0025
  0.     ]
 [0.      0.00125 0.8875  0.      0.      0.      0.0725  0.005   0.005
  0.02875]
 [0.00125 0.09625 0.      0.37125 0.00875 0.15    0.245   0.1     0.0275
  0.     ]
 [0.      0.00625 0.      0.0125  0.74    0.00625 0.21    0.01875 0.00625
  0.     ]
 [0.00125 0.02625 0.00125 0.41375 0.01625 0.345   0.1775  0.01125 0.0075
  0.     ]
 [0.0025  0.0075  0.00875 0.0075  0.67125 0.00625 0.2775  0.0025  0.01
  0.00625]
 [0.00125 0.29875 0.      0.01875 0.0075  0.02625 0.1925  0.4325  0.02125
  0.00125]
 [0.0075  0.      0.      0.      0.      0.      0.0125  0.      0.9725
  0.0075 ]
 [0.005   0.00125 0.0725  0.00125 0.      0.      0.06875 0.      0.0125
  0.83875]]
[2023-08-05 11:01:42,790 INFO] 989000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1098, device='cuda:0'), 'train/shrink_loss': tensor(0.0408, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0331, device='cuda:0'), 'train/removed_class_idx': 2.273683971191161, 'train/uncertainty_avg': 0.763719898693852, 'train/certain_ratio_ema': 0.8132127278695349, 'train/total_loss': tensor(0.1432, device='cuda:0'), 'train/mask_ratio': tensor(0.7879, device='cuda:0'), 'lr': 0.00813020740919013, 'train/prefecth_time': 0.019669408798217772, 'train/run_time': 0.5488648071289063, 'eval/loss': tensor(3.2060, device='cuda:0'), 'eval/top-1-acc': 0.6655, 'eval/top-5-acc': 0.93675, 'eval/precision': 0.6849437710773449, 'eval/recall': 0.6655, 'eval/F1': 0.6629385016056407, 'eval/AUC': 0.8933860763888889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 11:11:25,318 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 11:11:35,394 INFO] confusion matrix:
[[0.96375 0.0025  0.00375 0.      0.0025  0.      0.00625 0.00125 0.015
  0.005  ]
 [0.06125 0.82625 0.00125 0.0075  0.      0.0075  0.05875 0.0325  0.005
  0.     ]
 [0.      0.      0.8875  0.      0.      0.      0.06875 0.005   0.005
  0.03375]
 [0.0025  0.09375 0.      0.38    0.00875 0.14375 0.23875 0.10375 0.02875
  0.     ]
 [0.      0.0075  0.      0.01375 0.74625 0.005   0.2025  0.0175  0.0075
  0.     ]
 [0.00125 0.0275  0.00125 0.4675  0.01625 0.315   0.14875 0.015   0.0075
  0.     ]
 [0.00375 0.00625 0.005   0.00875 0.69375 0.00625 0.25625 0.0025  0.01
  0.0075 ]
 [0.00125 0.27875 0.      0.0275  0.00625 0.01875 0.18375 0.46125 0.02125
  0.00125]
 [0.0075  0.      0.      0.      0.      0.      0.015   0.      0.9675
  0.01   ]
 [0.00625 0.00125 0.06125 0.      0.      0.      0.06375 0.      0.01125
  0.85625]]
[2023-08-05 11:11:35,401 INFO] 990000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1367, device='cuda:0'), 'train/shrink_loss': tensor(0.0363, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0298, device='cuda:0'), 'train/removed_class_idx': 2.294117197231922, 'train/uncertainty_avg': 0.7317091889703611, 'train/certain_ratio_ema': 0.8195902818433287, 'train/total_loss': tensor(0.1666, device='cuda:0'), 'train/mask_ratio': tensor(0.8862, device='cuda:0'), 'lr': 0.008092348775451768, 'train/prefecth_time': 0.018074207305908203, 'train/run_time': 0.5285254516601563, 'eval/loss': tensor(3.3006, device='cuda:0'), 'eval/top-1-acc': 0.666, 'eval/top-5-acc': 0.932, 'eval/precision': 0.6832154848424539, 'eval/recall': 0.666, 'eval/F1': 0.6623988694812036, 'eval/AUC': 0.8907958506944443}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 11:21:24,751 INFO] confusion matrix:
[[0.96375 0.0025  0.00375 0.      0.00375 0.      0.00625 0.00125 0.015
  0.00375]
 [0.06125 0.8125  0.00125 0.005   0.      0.01    0.06375 0.03875 0.0075
  0.     ]
 [0.      0.00125 0.875   0.      0.      0.      0.07625 0.00625 0.0025
  0.03875]
 [0.0025  0.11    0.      0.4025  0.01    0.1225  0.23375 0.0825  0.03625
  0.     ]
 [0.      0.00625 0.      0.01625 0.74625 0.00375 0.2     0.01875 0.00875
  0.     ]
 [0.00125 0.0275  0.      0.515   0.0125  0.28    0.1425  0.0125  0.00875
  0.     ]
 [0.00375 0.005   0.0025  0.0075  0.6775  0.01    0.26875 0.00625 0.01125
  0.0075 ]
 [0.00125 0.2675  0.      0.025   0.00375 0.02    0.1875  0.47375 0.02
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.015   0.      0.9725
  0.0075 ]
 [0.005   0.00125 0.06125 0.      0.      0.      0.06625 0.00125 0.0125
  0.8525 ]]
[2023-08-05 11:21:24,762 INFO] 991000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.9418e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1585, device='cuda:0'), 'train/shrink_loss': tensor(0.0697, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0573, device='cuda:0'), 'train/removed_class_idx': 2.182926563057736, 'train/uncertainty_avg': 0.7817891286186687, 'train/certain_ratio_ema': 0.821320621742241, 'train/total_loss': tensor(0.2158, device='cuda:0'), 'train/mask_ratio': tensor(0.8170, device='cuda:0'), 'lr': 0.008054476238007795, 'train/prefecth_time': 0.020252479553222656, 'train/run_time': 0.5469603881835937, 'eval/loss': tensor(3.2906, device='cuda:0'), 'eval/top-1-acc': 0.66475, 'eval/top-5-acc': 0.94125, 'eval/precision': 0.6840000952381707, 'eval/recall': 0.66475, 'eval/F1': 0.6610371350015279, 'eval/AUC': 0.8952401388888885}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 11:31:14,542 INFO] confusion matrix:
[[0.95375 0.0025  0.00375 0.      0.00375 0.      0.0175  0.00125 0.0125
  0.005  ]
 [0.06    0.805   0.00125 0.01    0.      0.0125  0.07375 0.03375 0.00375
  0.     ]
 [0.      0.      0.845   0.      0.      0.      0.11125 0.005   0.00375
  0.035  ]
 [0.00125 0.11375 0.      0.35    0.01125 0.15375 0.24875 0.09    0.03125
  0.     ]
 [0.      0.00625 0.      0.015   0.73875 0.0075  0.2125  0.01375 0.00625
  0.     ]
 [0.00125 0.02125 0.      0.46125 0.01375 0.31125 0.17    0.01375 0.0075
  0.     ]
 [0.00375 0.005   0.00375 0.0075  0.68125 0.0075  0.27125 0.005   0.00625
  0.00875]
 [0.00125 0.2425  0.      0.01875 0.00625 0.01875 0.17625 0.51625 0.01875
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.0425  0.      0.945
  0.0075 ]
 [0.00625 0.00125 0.05625 0.      0.      0.      0.105   0.00125 0.00875
  0.82125]]
[2023-08-05 11:31:14,553 INFO] 992000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2904e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1582, device='cuda:0'), 'train/shrink_loss': tensor(0.0434, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0355, device='cuda:0'), 'train/removed_class_idx': 2.4109585738412913, 'train/uncertainty_avg': 0.7521566481696861, 'train/certain_ratio_ema': 0.8186213954945497, 'train/total_loss': tensor(0.1938, device='cuda:0'), 'train/mask_ratio': tensor(0.8371, device='cuda:0'), 'lr': 0.008016589861928138, 'train/prefecth_time': 0.019786048889160156, 'train/run_time': 0.5379978637695313, 'eval/loss': tensor(3.3824, device='cuda:0'), 'eval/top-1-acc': 0.65575, 'eval/top-5-acc': 0.931375, 'eval/precision': 0.6835862890503784, 'eval/recall': 0.65575, 'eval/F1': 0.65825208699539, 'eval/AUC': 0.8921850260416666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 11:41:05,866 INFO] confusion matrix:
[[0.95125 0.0025  0.0025  0.      0.00375 0.      0.01875 0.      0.0125
  0.00875]
 [0.06    0.8175  0.      0.00875 0.      0.0225  0.0725  0.01625 0.0025
  0.     ]
 [0.      0.00125 0.83375 0.      0.      0.00375 0.11875 0.00125 0.0025
  0.03875]
 [0.00125 0.055   0.      0.3775  0.01375 0.245   0.27875 0.015   0.01375
  0.     ]
 [0.      0.00625 0.      0.01625 0.74625 0.0125  0.21    0.005   0.00375
  0.     ]
 [0.00125 0.01875 0.      0.44375 0.02    0.29375 0.2175  0.005   0.
  0.     ]
 [0.00375 0.005   0.00375 0.0075  0.66375 0.01375 0.29    0.00125 0.00375
  0.0075 ]
 [0.00125 0.2     0.      0.02625 0.005   0.07125 0.18375 0.5025  0.0075
  0.0025 ]
 [0.00375 0.      0.      0.      0.      0.      0.03625 0.      0.9525
  0.0075 ]
 [0.00625 0.00125 0.085   0.      0.      0.00125 0.08625 0.00125 0.01
  0.80875]]
[2023-08-05 11:41:05,876 INFO] 993000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.9398e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1313, device='cuda:0'), 'train/shrink_loss': tensor(0.0472, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0383, device='cuda:0'), 'train/removed_class_idx': 2.204300838247222, 'train/uncertainty_avg': 0.7755654354132065, 'train/certain_ratio_ema': 0.8113130709711831, 'train/total_loss': tensor(0.1696, device='cuda:0'), 'train/mask_ratio': tensor(0.7924, device='cuda:0'), 'lr': 0.007978689712306527, 'train/prefecth_time': 0.018792831420898437, 'train/run_time': 0.5474169921875, 'eval/loss': tensor(3.2735, device='cuda:0'), 'eval/top-1-acc': 0.657375, 'eval/top-5-acc': 0.92575, 'eval/precision': 0.6928863719368106, 'eval/recall': 0.6573749999999999, 'eval/F1': 0.6634953901757703, 'eval/AUC': 0.893315842013889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 11:50:56,934 INFO] confusion matrix:
[[0.94125 0.00375 0.      0.      0.0025  0.0025  0.0325  0.      0.01125
  0.00625]
 [0.0575  0.82625 0.      0.005   0.      0.01125 0.08    0.0175  0.0025
  0.     ]
 [0.      0.00125 0.84125 0.      0.      0.0075  0.1125  0.00125 0.0025
  0.03375]
 [0.00125 0.135   0.      0.33375 0.015   0.21    0.2775  0.025   0.0025
  0.     ]
 [0.      0.01    0.      0.01    0.74875 0.01125 0.21125 0.0075  0.00125
  0.     ]
 [0.      0.02375 0.      0.425   0.015   0.295   0.22625 0.015   0.
  0.     ]
 [0.00375 0.00625 0.0025  0.0075  0.665   0.0175  0.2875  0.00125 0.00125
  0.0075 ]
 [0.00125 0.17625 0.      0.0175  0.00375 0.04375 0.1725  0.58375 0.
  0.00125]
 [0.00375 0.      0.00125 0.      0.      0.      0.04125 0.      0.945
  0.00875]
 [0.0075  0.00125 0.11625 0.      0.      0.00125 0.09625 0.0025  0.00875
  0.76625]]
[2023-08-05 11:50:56,945 INFO] 994000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1336, device='cuda:0'), 'train/shrink_loss': tensor(0.0521, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0422, device='cuda:0'), 'train/removed_class_idx': 2.2988503104769755, 'train/uncertainty_avg': 0.778082199110018, 'train/certain_ratio_ema': 0.8094361916206028, 'train/total_loss': tensor(0.1760, device='cuda:0'), 'train/mask_ratio': tensor(0.8058, device='cuda:0'), 'lr': 0.007940775854260326, 'train/prefecth_time': 0.022299488067626952, 'train/run_time': 0.5472523803710938, 'eval/loss': tensor(3.3445, device='cuda:0'), 'eval/top-1-acc': 0.656875, 'eval/top-5-acc': 0.925375, 'eval/precision': 0.6904587165506907, 'eval/recall': 0.6568750000000001, 'eval/F1': 0.6629162441019404, 'eval/AUC': 0.8882490104166665}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 12:00:47,139 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 12:01:07,436 INFO] confusion matrix:
[[0.9475  0.0025  0.00375 0.      0.0025  0.      0.0225  0.      0.015
  0.00625]
 [0.06    0.81625 0.      0.005   0.      0.01    0.0625  0.0425  0.00375
  0.     ]
 [0.00125 0.      0.8575  0.      0.      0.00375 0.10875 0.00375 0.00375
  0.02125]
 [0.0025  0.1175  0.      0.31    0.01875 0.15625 0.27625 0.11625 0.0025
  0.     ]
 [0.      0.0075  0.      0.005   0.775   0.01    0.18625 0.015   0.00125
  0.     ]
 [0.00125 0.0325  0.      0.35875 0.02625 0.24875 0.27375 0.0575  0.00125
  0.     ]
 [0.0025  0.00875 0.0025  0.005   0.6775  0.0125  0.28    0.00375 0.00125
  0.00625]
 [0.      0.15375 0.      0.0125  0.005   0.035   0.16125 0.6325  0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.      0.03375 0.      0.9525
  0.0075 ]
 [0.00625 0.00125 0.1225  0.      0.      0.00125 0.09875 0.00375 0.01
  0.75625]]
[2023-08-05 12:01:07,443 INFO] 995000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.7011e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1160, device='cuda:0'), 'train/shrink_loss': tensor(0.0490, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0390, device='cuda:0'), 'train/removed_class_idx': 2.38028135488995, 'train/uncertainty_avg': 0.7390384434897497, 'train/certain_ratio_ema': 0.7963605419109144, 'train/total_loss': tensor(0.1550, device='cuda:0'), 'train/mask_ratio': tensor(0.8415, device='cuda:0'), 'lr': 0.007902848352930461, 'train/prefecth_time': 0.02023526382446289, 'train/run_time': 0.5403334350585938, 'eval/loss': tensor(3.0638, device='cuda:0'), 'eval/top-1-acc': 0.657625, 'eval/top-5-acc': 0.94525, 'eval/precision': 0.6807004571650654, 'eval/recall': 0.6576249999999999, 'eval/F1': 0.6578423903389318, 'eval/AUC': 0.9023543489583332}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 12:10:58,625 INFO] confusion matrix:
[[0.94875 0.00125 0.      0.      0.00375 0.00625 0.01875 0.      0.01375
  0.0075 ]
 [0.06    0.835   0.      0.01    0.      0.01625 0.06625 0.00875 0.00375
  0.     ]
 [0.00125 0.0025  0.84375 0.      0.      0.01625 0.10375 0.      0.0025
  0.03   ]
 [0.0025  0.1075  0.      0.36875 0.01875 0.22375 0.26    0.01625 0.00125
  0.00125]
 [0.      0.0075  0.      0.01125 0.76875 0.01375 0.19125 0.00625 0.00125
  0.     ]
 [0.00125 0.02625 0.      0.46125 0.02125 0.27125 0.20625 0.0125  0.
  0.     ]
 [0.0025  0.0075  0.0025  0.00625 0.66875 0.01625 0.2875  0.00125 0.0025
  0.005  ]
 [0.      0.23375 0.      0.02125 0.01    0.055   0.165   0.51375 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.00125 0.025   0.      0.96125
  0.0075 ]
 [0.00625 0.00125 0.1     0.      0.      0.00125 0.085   0.00125 0.01
  0.795  ]]
[2023-08-05 12:10:58,635 INFO] 996000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1152, device='cuda:0'), 'train/shrink_loss': tensor(0.0399, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0320, device='cuda:0'), 'train/removed_class_idx': 2.3333330555555887, 'train/uncertainty_avg': 0.7465100875613165, 'train/certain_ratio_ema': 0.8024888973704415, 'train/total_loss': tensor(0.1474, device='cuda:0'), 'train/mask_ratio': tensor(0.8125, device='cuda:0'), 'lr': 0.007864907273481318, 'train/prefecth_time': 0.018409120559692384, 'train/run_time': 0.5428118896484375, 'eval/loss': tensor(3.0523, device='cuda:0'), 'eval/top-1-acc': 0.659375, 'eval/top-5-acc': 0.94975, 'eval/precision': 0.6894232624054778, 'eval/recall': 0.659375, 'eval/F1': 0.6619711435953554, 'eval/AUC': 0.9032063020833334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 12:20:49,443 INFO] confusion matrix:
[[0.9525  0.      0.      0.      0.0025  0.005   0.01875 0.      0.015
  0.00625]
 [0.06    0.83125 0.      0.005   0.00125 0.01125 0.0725  0.015   0.00375
  0.     ]
 [0.00125 0.00125 0.83875 0.      0.      0.0175  0.09625 0.00125 0.0025
  0.04125]
 [0.0025  0.1075  0.      0.39875 0.02    0.15625 0.2725  0.04    0.00125
  0.00125]
 [0.      0.0075  0.      0.01    0.7725  0.01125 0.1875  0.00875 0.00125
  0.00125]
 [0.      0.025   0.      0.5675  0.01625 0.16    0.2075  0.0225  0.00125
  0.     ]
 [0.00375 0.005   0.0025  0.01125 0.685   0.015   0.26375 0.0025  0.0025
  0.00875]
 [0.      0.18    0.      0.02    0.00625 0.04625 0.185   0.56125 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.0225  0.      0.965
  0.0075 ]
 [0.005   0.00125 0.105   0.      0.      0.00125 0.07375 0.00125 0.0075
  0.805  ]]
[2023-08-05 12:20:49,463 INFO] 997000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.1922e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1546, device='cuda:0'), 'train/shrink_loss': tensor(0.0672, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0543, device='cuda:0'), 'train/removed_class_idx': 2.5058820581315224, 'train/uncertainty_avg': 0.753392677168063, 'train/certain_ratio_ema': 0.8077123971026353, 'train/total_loss': tensor(0.2090, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.007826952681100579, 'train/prefecth_time': 0.020590879440307616, 'train/run_time': 0.5492255859375, 'eval/loss': tensor(3.2094, device='cuda:0'), 'eval/top-1-acc': 0.654875, 'eval/top-5-acc': 0.943, 'eval/precision': 0.6749825003185231, 'eval/recall': 0.654875, 'eval/F1': 0.6532443999321889, 'eval/AUC': 0.8953133940972222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 12:30:43,021 INFO] confusion matrix:
[[0.96875 0.      0.00125 0.      0.0025  0.0025  0.00625 0.      0.0125
  0.00625]
 [0.06    0.8325  0.      0.00625 0.00125 0.01375 0.05625 0.025   0.005
  0.     ]
 [0.00375 0.      0.87625 0.      0.      0.01125 0.07375 0.00125 0.00375
  0.03   ]
 [0.0025  0.10125 0.      0.37625 0.01125 0.1475  0.26375 0.095   0.00125
  0.00125]
 [0.00125 0.0075  0.      0.01125 0.8275  0.01125 0.12375 0.01625 0.00125
  0.     ]
 [0.00125 0.02125 0.      0.5825  0.015   0.16875 0.1725  0.03625 0.0025
  0.     ]
 [0.00375 0.005   0.0025  0.01125 0.70625 0.0125  0.24625 0.00375 0.00375
  0.005  ]
 [0.      0.16125 0.      0.01375 0.00375 0.03375 0.1975  0.58875 0.
  0.00125]
 [0.00375 0.      0.      0.      0.      0.00125 0.01375 0.      0.9725
  0.00875]
 [0.00625 0.00125 0.10375 0.      0.      0.0025  0.075   0.00125 0.00875
  0.80125]]
[2023-08-05 12:30:43,037 INFO] 998000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.6516e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1640, device='cuda:0'), 'train/shrink_loss': tensor(0.0787, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0631, device='cuda:0'), 'train/removed_class_idx': 2.2571425346939233, 'train/uncertainty_avg': 0.7850400339638657, 'train/certain_ratio_ema': 0.801596980633367, 'train/total_loss': tensor(0.2271, device='cuda:0'), 'train/mask_ratio': tensor(0.8438, device='cuda:0'), 'lr': 0.007788984640999175, 'train/prefecth_time': 0.018190431594848632, 'train/run_time': 0.54188525390625, 'eval/loss': tensor(3.0724, device='cuda:0'), 'eval/top-1-acc': 0.665875, 'eval/top-5-acc': 0.948125, 'eval/precision': 0.6737025128985191, 'eval/recall': 0.665875, 'eval/F1': 0.6589183709509039, 'eval/AUC': 0.8996120833333334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 12:40:36,223 INFO] confusion matrix:
[[0.95875 0.00125 0.0025  0.      0.00375 0.0025  0.01125 0.      0.015
  0.005  ]
 [0.0625  0.845   0.      0.005   0.      0.0075  0.06375 0.01125 0.005
  0.     ]
 [0.0025  0.00125 0.85375 0.      0.      0.01    0.09    0.00125 0.0025
  0.03875]
 [0.0025  0.18125 0.      0.37125 0.00875 0.10125 0.25625 0.07625 0.00125
  0.00125]
 [0.      0.01    0.      0.01125 0.80375 0.0125  0.1475  0.01375 0.00125
  0.     ]
 [0.00125 0.06375 0.      0.605   0.01625 0.11125 0.17    0.03    0.0025
  0.     ]
 [0.00375 0.00875 0.00125 0.01125 0.74375 0.01125 0.2075  0.0025  0.00375
  0.00625]
 [0.      0.22625 0.      0.01625 0.005   0.02875 0.185   0.5375  0.
  0.00125]
 [0.00375 0.      0.      0.      0.      0.00125 0.02    0.      0.9675
  0.0075 ]
 [0.00625 0.0025  0.06875 0.      0.      0.00125 0.0775  0.00125 0.0075
  0.835  ]]
[2023-08-05 12:40:36,233 INFO] 999000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0004, device='cuda:0'), 'train/certain_loss': tensor(0.1582, device='cuda:0'), 'train/shrink_loss': tensor(0.0498, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0401, device='cuda:0'), 'train/removed_class_idx': 2.417721212946682, 'train/uncertainty_avg': 0.7560701692047561, 'train/certain_ratio_ema': 0.8069199003262119, 'train/total_loss': tensor(0.1988, device='cuda:0'), 'train/mask_ratio': tensor(0.8237, device='cuda:0'), 'lr': 0.007751003218411119, 'train/prefecth_time': 0.02219718360900879, 'train/run_time': 0.5426646728515625, 'eval/loss': tensor(3.3697, device='cuda:0'), 'eval/top-1-acc': 0.649125, 'eval/top-5-acc': 0.927375, 'eval/precision': 0.6593416258554583, 'eval/recall': 0.649125, 'eval/F1': 0.6385410916927655, 'eval/AUC': 0.8859133593749997}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 12:50:19,174 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 12:50:29,053 INFO] confusion matrix:
[[0.95625 0.00125 0.      0.      0.00375 0.00625 0.01375 0.      0.01375
  0.005  ]
 [0.06    0.82    0.      0.00375 0.      0.01    0.075   0.0275  0.00375
  0.     ]
 [0.00125 0.      0.84125 0.      0.      0.0125  0.10375 0.00375 0.0025
  0.035  ]
 [0.0025  0.15875 0.      0.34875 0.01    0.09125 0.28125 0.10375 0.0025
  0.00125]
 [0.      0.0075  0.      0.01    0.775   0.0125  0.1775  0.01625 0.00125
  0.     ]
 [0.      0.04375 0.      0.5675  0.0175  0.1175  0.22    0.03125 0.0025
  0.     ]
 [0.00375 0.005   0.      0.01125 0.71625 0.01125 0.23875 0.0025  0.00375
  0.0075 ]
 [0.      0.2025  0.      0.0125  0.00875 0.025   0.21375 0.53625 0.
  0.00125]
 [0.00375 0.      0.      0.      0.      0.00125 0.0225  0.      0.9675
  0.005  ]
 [0.00625 0.00125 0.09875 0.      0.      0.00375 0.0925  0.00125 0.0075
  0.78875]]
[2023-08-05 12:50:29,060 INFO] 1000000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.4256e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1419, device='cuda:0'), 'train/shrink_loss': tensor(0.0582, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0472, device='cuda:0'), 'train/removed_class_idx': 2.354430081717711, 'train/uncertainty_avg': 0.7901293374604019, 'train/certain_ratio_ema': 0.8105399058953767, 'train/total_loss': tensor(0.1891, device='cuda:0'), 'train/mask_ratio': tensor(0.8237, device='cuda:0'), 'lr': 0.007713008478593422, 'train/prefecth_time': 0.021685184478759764, 'train/run_time': 0.5503757934570312, 'eval/loss': tensor(3.5596, device='cuda:0'), 'eval/top-1-acc': 0.639, 'eval/top-5-acc': 0.921125, 'eval/precision': 0.6562143720695243, 'eval/recall': 0.639, 'eval/F1': 0.6330256635411433, 'eval/AUC': 0.878684487847222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:00:21,558 INFO] confusion matrix:
[[0.95625 0.00125 0.      0.      0.00375 0.005   0.01375 0.00125 0.0125
  0.00625]
 [0.06    0.825   0.      0.005   0.      0.01    0.07375 0.0225  0.00375
  0.     ]
 [0.      0.      0.8375  0.      0.      0.01    0.1125  0.00375 0.0025
  0.03375]
 [0.00375 0.12    0.      0.38875 0.01    0.1     0.26875 0.1075  0.00125
  0.     ]
 [0.      0.0075  0.      0.01125 0.78625 0.00875 0.16875 0.0175  0.
  0.     ]
 [0.      0.03125 0.      0.565   0.0175  0.15125 0.205   0.02875 0.00125
  0.     ]
 [0.00375 0.0075  0.00125 0.01    0.725   0.01375 0.22625 0.0025  0.00375
  0.00625]
 [0.      0.26125 0.      0.0125  0.0125  0.025   0.2     0.4875  0.
  0.00125]
 [0.0025  0.      0.      0.      0.      0.00125 0.0225  0.      0.96625
  0.0075 ]
 [0.00625 0.00125 0.1325  0.      0.      0.00375 0.09375 0.00125 0.01
  0.75125]]
[2023-08-05 13:00:21,568 INFO] 1001000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2209e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1169, device='cuda:0'), 'train/shrink_loss': tensor(0.0475, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0384, device='cuda:0'), 'train/removed_class_idx': 2.422534870065511, 'train/uncertainty_avg': 0.7720652646321167, 'train/certain_ratio_ema': 0.8077034303587626, 'train/total_loss': tensor(0.1553, device='cuda:0'), 'train/mask_ratio': tensor(0.8415, device='cuda:0'), 'lr': 0.00767500048682599, 'train/prefecth_time': 0.021665664672851564, 'train/run_time': 0.5380260620117188, 'eval/loss': tensor(3.4669, device='cuda:0'), 'eval/top-1-acc': 0.637625, 'eval/top-5-acc': 0.944625, 'eval/precision': 0.6588293319025189, 'eval/recall': 0.637625, 'eval/F1': 0.6325879615656012, 'eval/AUC': 0.883041449652778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:10:20,946 INFO] confusion matrix:
[[0.9575  0.00125 0.      0.      0.00375 0.005   0.01375 0.00125 0.0125
  0.005  ]
 [0.0625  0.825   0.      0.0075  0.      0.01125 0.07625 0.01625 0.00125
  0.     ]
 [0.      0.      0.82    0.      0.      0.02125 0.1275  0.00125 0.0025
  0.0275 ]
 [0.00375 0.0975  0.      0.4025  0.01375 0.1475  0.2725  0.06125 0.00125
  0.     ]
 [0.00125 0.0075  0.      0.01    0.77625 0.01    0.1825  0.0125  0.
  0.     ]
 [0.00125 0.0275  0.      0.61    0.015   0.1225  0.2075  0.01625 0.
  0.     ]
 [0.00375 0.00625 0.0025  0.01125 0.705   0.015   0.245   0.0025  0.00375
  0.005  ]
 [0.      0.21625 0.      0.0175  0.00875 0.04    0.1975  0.51875 0.
  0.00125]
 [0.0025  0.      0.      0.      0.      0.00125 0.02375 0.      0.965
  0.0075 ]
 [0.005   0.00125 0.11125 0.      0.      0.005   0.11625 0.      0.00875
  0.7525 ]]
[2023-08-05 13:10:20,961 INFO] 1002000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1309, device='cuda:0'), 'train/shrink_loss': tensor(0.0429, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0351, device='cuda:0'), 'train/removed_class_idx': 2.345237816043117, 'train/uncertainty_avg': 0.7632443759049989, 'train/certain_ratio_ema': 0.8178122955997803, 'train/total_loss': tensor(0.1661, device='cuda:0'), 'train/mask_ratio': tensor(0.8125, device='cuda:0'), 'lr': 0.007636979308411474, 'train/prefecth_time': 0.019768287658691406, 'train/run_time': 0.5420873413085937, 'eval/loss': tensor(3.5713, device='cuda:0'), 'eval/top-1-acc': 0.6385, 'eval/top-5-acc': 0.935375, 'eval/precision': 0.6615075557081773, 'eval/recall': 0.6385, 'eval/F1': 0.6367754669050599, 'eval/AUC': 0.87694203125}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:20:12,112 INFO] confusion matrix:
[[0.9575  0.      0.      0.      0.00375 0.005   0.0125  0.      0.015
  0.00625]
 [0.06125 0.825   0.      0.005   0.      0.0125  0.075   0.01875 0.0025
  0.     ]
 [0.      0.      0.79125 0.      0.      0.03    0.145   0.00125 0.0025
  0.03   ]
 [0.0025  0.12625 0.      0.4075  0.0175  0.11375 0.26625 0.06625 0.
  0.     ]
 [0.      0.0075  0.      0.01125 0.76875 0.01    0.18625 0.01625 0.
  0.     ]
 [0.      0.0325  0.      0.635   0.015   0.10375 0.19625 0.0175  0.
  0.     ]
 [0.00375 0.005   0.00125 0.0075  0.695   0.0125  0.2625  0.0025  0.0025
  0.0075 ]
 [0.      0.21    0.      0.015   0.0025  0.0375  0.19875 0.53375 0.
  0.0025 ]
 [0.00375 0.      0.      0.      0.      0.      0.02625 0.      0.9625
  0.0075 ]
 [0.00625 0.00125 0.16125 0.      0.      0.00375 0.10875 0.00125 0.0075
  0.71   ]]
[2023-08-05 13:20:12,123 INFO] 1003000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.9120e-06, device='cuda:0'), 'train/certain_loss': tensor(0.1844, device='cuda:0'), 'train/shrink_loss': tensor(0.0449, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0365, device='cuda:0'), 'train/removed_class_idx': 2.3374997078125364, 'train/uncertainty_avg': 0.7244596849797917, 'train/certain_ratio_ema': 0.8126571171384253, 'train/total_loss': tensor(0.2209, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.0075989450086752066, 'train/prefecth_time': 0.018391136169433595, 'train/run_time': 0.5408993530273437, 'eval/loss': tensor(3.6239, device='cuda:0'), 'eval/top-1-acc': 0.63225, 'eval/top-5-acc': 0.9465, 'eval/precision': 0.653093464341132, 'eval/recall': 0.6322500000000001, 'eval/F1': 0.6287778749848851, 'eval/AUC': 0.8774715885416668}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:30:02,622 INFO] confusion matrix:
[[0.9525  0.      0.      0.      0.00375 0.00625 0.015   0.00125 0.015
  0.00625]
 [0.05875 0.82375 0.      0.00375 0.      0.015   0.08    0.01625 0.0025
  0.     ]
 [0.      0.      0.795   0.      0.      0.02    0.15375 0.00125 0.0025
  0.0275 ]
 [0.00125 0.10625 0.      0.41    0.00875 0.1625  0.25    0.05875 0.0025
  0.     ]
 [0.      0.00625 0.      0.015   0.7525  0.0125  0.1975  0.01625 0.
  0.     ]
 [0.      0.02875 0.      0.6125  0.01375 0.1475  0.18125 0.01625 0.
  0.     ]
 [0.00375 0.005   0.00125 0.00875 0.6775  0.01125 0.2775  0.00375 0.0025
  0.00875]
 [0.      0.2475  0.      0.0175  0.0025  0.04375 0.195   0.4925  0.
  0.00125]
 [0.00375 0.      0.      0.      0.      0.00125 0.02125 0.      0.9675
  0.00625]
 [0.005   0.00125 0.185   0.      0.      0.005   0.1125  0.      0.01
  0.68125]]
[2023-08-05 13:30:02,633 INFO] 1004000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1309, device='cuda:0'), 'train/shrink_loss': tensor(0.0489, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0397, device='cuda:0'), 'train/removed_class_idx': 2.2674415968091166, 'train/uncertainty_avg': 0.7769104614202739, 'train/certain_ratio_ema': 0.8108532427542734, 'train/total_loss': tensor(0.1708, device='cuda:0'), 'train/mask_ratio': tensor(0.8080, device='cuda:0'), 'lr': 0.0075608976529650445, 'train/prefecth_time': 0.019602367401123047, 'train/run_time': 0.5431588745117187, 'eval/loss': tensor(3.5700, device='cuda:0'), 'eval/top-1-acc': 0.63, 'eval/top-5-acc': 0.950625, 'eval/precision': 0.6558451653602841, 'eval/recall': 0.6300000000000001, 'eval/F1': 0.6291508825532074, 'eval/AUC': 0.8854667274305555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:39:44,004 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 13:39:53,752 INFO] confusion matrix:
[[0.96125 0.      0.      0.      0.005   0.00375 0.01    0.00125 0.01375
  0.005  ]
 [0.06125 0.8275  0.      0.00375 0.      0.015   0.0725  0.01875 0.00125
  0.     ]
 [0.      0.      0.805   0.      0.      0.02    0.15    0.0025  0.00375
  0.01875]
 [0.00125 0.11    0.      0.39875 0.0125  0.16125 0.27125 0.0425  0.00125
  0.00125]
 [0.00125 0.00625 0.      0.015   0.7725  0.01    0.185   0.01    0.
  0.     ]
 [0.      0.0275  0.      0.58375 0.01625 0.145   0.215   0.0125  0.
  0.     ]
 [0.00375 0.0075  0.0025  0.0075  0.69875 0.01125 0.2575  0.0025  0.0025
  0.00625]
 [0.00125 0.24375 0.      0.01625 0.00375 0.045   0.2     0.48875 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.00125 0.0175  0.      0.96875
  0.0075 ]
 [0.0075  0.00125 0.18625 0.      0.      0.00375 0.1125  0.00125 0.00875
  0.67875]]
[2023-08-05 13:39:53,759 INFO] 1005000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.2559e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1165, device='cuda:0'), 'train/shrink_loss': tensor(0.0414, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0337, device='cuda:0'), 'train/removed_class_idx': 2.4324321037253913, 'train/uncertainty_avg': 0.729310474800102, 'train/certain_ratio_ema': 0.8150904098464379, 'train/total_loss': tensor(0.1503, device='cuda:0'), 'train/mask_ratio': tensor(0.8348, device='cuda:0'), 'lr': 0.007522837306651277, 'train/prefecth_time': 0.01901919937133789, 'train/run_time': 0.5404225463867187, 'eval/loss': tensor(3.7037, device='cuda:0'), 'eval/top-1-acc': 0.630375, 'eval/top-5-acc': 0.930625, 'eval/precision': 0.6586155613236413, 'eval/recall': 0.630375, 'eval/F1': 0.6291410729653553, 'eval/AUC': 0.8753849479166665}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:49:41,551 INFO] confusion matrix:
[[0.96125 0.      0.      0.      0.005   0.00375 0.01    0.      0.01375
  0.00625]
 [0.06125 0.825   0.      0.00875 0.      0.015   0.07125 0.01625 0.0025
  0.     ]
 [0.      0.      0.7875  0.      0.      0.02875 0.16    0.0025  0.0025
  0.01875]
 [0.00875 0.1225  0.      0.3925  0.015   0.15625 0.27125 0.0325  0.00125
  0.     ]
 [0.00625 0.00625 0.      0.00875 0.76625 0.00875 0.19    0.0125  0.
  0.00125]
 [0.00375 0.02875 0.      0.5075  0.01375 0.1975  0.23125 0.0175  0.
  0.     ]
 [0.00375 0.005   0.0025  0.0075  0.71    0.015   0.24625 0.0025  0.0025
  0.005  ]
 [0.00125 0.2375  0.      0.0125  0.0025  0.05    0.20375 0.4925  0.
  0.     ]
 [0.00625 0.      0.      0.      0.      0.00125 0.02    0.      0.96625
  0.00625]
 [0.01    0.00125 0.19    0.      0.      0.00375 0.11375 0.00125 0.01
  0.67   ]]
[2023-08-05 13:49:41,562 INFO] 1006000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.9488e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1655, device='cuda:0'), 'train/shrink_loss': tensor(0.0379, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0309, device='cuda:0'), 'train/removed_class_idx': 2.324999709375036, 'train/uncertainty_avg': 0.7680185430853591, 'train/certain_ratio_ema': 0.8154347934055769, 'train/total_loss': tensor(0.1964, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.007484764035126533, 'train/prefecth_time': 0.01939436721801758, 'train/run_time': 0.556033447265625, 'eval/loss': tensor(3.6285, device='cuda:0'), 'eval/top-1-acc': 0.6305, 'eval/top-5-acc': 0.94075, 'eval/precision': 0.664733987530221, 'eval/recall': 0.6305, 'eval/F1': 0.6322399477197101, 'eval/AUC': 0.8761651302083333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 13:59:32,351 INFO] confusion matrix:
[[0.955   0.      0.00125 0.00125 0.00375 0.005   0.01375 0.      0.0125
  0.0075 ]
 [0.06125 0.82625 0.      0.00875 0.      0.01375 0.07875 0.01    0.00125
  0.     ]
 [0.      0.00125 0.78125 0.      0.      0.02875 0.16375 0.00125 0.005
  0.01875]
 [0.005   0.12625 0.      0.3975  0.01125 0.14125 0.28625 0.03125 0.00125
  0.     ]
 [0.00125 0.0075  0.      0.01    0.7575  0.01    0.2025  0.01125 0.
  0.     ]
 [0.      0.0275  0.      0.5325  0.015   0.1775  0.23375 0.01375 0.
  0.     ]
 [0.00375 0.005   0.0025  0.0075  0.69625 0.015   0.26    0.0025  0.0025
  0.005  ]
 [0.00125 0.235   0.      0.01    0.0025  0.04875 0.2025  0.5     0.
  0.     ]
 [0.00375 0.      0.      0.      0.      0.00125 0.02375 0.      0.96375
  0.0075 ]
 [0.00625 0.00125 0.1725  0.      0.      0.00375 0.1275  0.00125 0.01125
  0.67625]]
[2023-08-05 13:59:32,358 INFO] 1007000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0002, device='cuda:0'), 'train/certain_loss': tensor(0.1348, device='cuda:0'), 'train/shrink_loss': tensor(0.0555, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0451, device='cuda:0'), 'train/removed_class_idx': 2.3529408996540115, 'train/uncertainty_avg': 0.7452470312877933, 'train/certain_ratio_ema': 0.8128169515360577, 'train/total_loss': tensor(0.1801, device='cuda:0'), 'train/mask_ratio': tensor(0.8103, device='cuda:0'), 'lr': 0.00744667790380563, 'train/prefecth_time': 0.019352224349975584, 'train/run_time': 0.5440901489257812, 'eval/loss': tensor(3.6737, device='cuda:0'), 'eval/top-1-acc': 0.6295, 'eval/top-5-acc': 0.93825, 'eval/precision': 0.6678066337521653, 'eval/recall': 0.6295, 'eval/F1': 0.6326359438767002, 'eval/AUC': 0.8733277517361113}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 14:09:38,554 INFO] confusion matrix:
[[0.96    0.      0.00125 0.00125 0.00375 0.005   0.01    0.      0.01125
  0.0075 ]
 [0.06375 0.8225  0.      0.0075  0.      0.015   0.07375 0.01625 0.00125
  0.     ]
 [0.      0.      0.78875 0.      0.      0.02625 0.15875 0.0025  0.0025
  0.02125]
 [0.00625 0.115   0.      0.39375 0.0075  0.14125 0.28125 0.0525  0.
  0.0025 ]
 [0.0025  0.0075  0.      0.01125 0.75    0.00875 0.20125 0.01875 0.
  0.     ]
 [0.      0.03375 0.      0.54375 0.01375 0.15375 0.22875 0.025   0.
  0.00125]
 [0.00375 0.005   0.0025  0.0075  0.6975  0.015   0.2575  0.00375 0.0025
  0.005  ]
 [0.00125 0.18875 0.      0.01    0.0025  0.045   0.20375 0.54875 0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.00125 0.0225  0.      0.96375
  0.00625]
 [0.005   0.00125 0.1625  0.      0.      0.00375 0.12625 0.00125 0.01
  0.69   ]]
[2023-08-05 14:09:38,569 INFO] 1008000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.7873e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1264, device='cuda:0'), 'train/shrink_loss': tensor(0.0606, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0491, device='cuda:0'), 'train/removed_class_idx': 2.3734936899405192, 'train/uncertainty_avg': 0.7731423520095647, 'train/certain_ratio_ema': 0.8108403570027537, 'train/total_loss': tensor(0.1756, device='cuda:0'), 'train/mask_ratio': tensor(0.8147, device='cuda:0'), 'lr': 0.0074085789781254754, 'train/prefecth_time': 0.019725631713867188, 'train/run_time': 0.54400146484375, 'eval/loss': tensor(3.7496, device='cuda:0'), 'eval/top-1-acc': 0.632875, 'eval/top-5-acc': 0.924625, 'eval/precision': 0.6622713564523208, 'eval/recall': 0.632875, 'eval/F1': 0.6345487708145278, 'eval/AUC': 0.8681928906249999}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 14:19:30,797 INFO] confusion matrix:
[[0.96125 0.00125 0.      0.      0.00375 0.00375 0.0075  0.00125 0.0125
  0.00875]
 [0.06125 0.83625 0.      0.0075  0.00375 0.01    0.07    0.01    0.00125
  0.     ]
 [0.      0.      0.78875 0.      0.      0.03125 0.15125 0.00375 0.00625
  0.01875]
 [0.00375 0.12625 0.      0.41375 0.0175  0.0975  0.27375 0.06625 0.
  0.00125]
 [0.      0.00875 0.      0.01    0.75125 0.01125 0.205   0.01375 0.
  0.     ]
 [0.      0.0375  0.      0.5625  0.0175  0.145   0.2275  0.01    0.
  0.     ]
 [0.00375 0.00625 0.0025  0.0075  0.68625 0.01125 0.275   0.00125 0.00375
  0.0025 ]
 [0.      0.3225  0.      0.01125 0.01125 0.02875 0.20125 0.425   0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.00125 0.0225  0.      0.965
  0.005  ]
 [0.00625 0.0025  0.1575  0.      0.      0.00375 0.10875 0.      0.01125
  0.71   ]]
[2023-08-05 14:19:30,807 INFO] 1009000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.3028e-05, device='cuda:0'), 'train/certain_loss': tensor(0.2009, device='cuda:0'), 'train/shrink_loss': tensor(0.0603, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0485, device='cuda:0'), 'train/removed_class_idx': 2.404494111854594, 'train/uncertainty_avg': 0.7328846562058458, 'train/certain_ratio_ema': 0.8047315805254064, 'train/total_loss': tensor(0.2494, device='cuda:0'), 'train/mask_ratio': tensor(0.8013, device='cuda:0'), 'lr': 0.0073704673235449845, 'train/prefecth_time': 0.04940291213989258, 'train/run_time': 0.5576761474609375, 'eval/loss': tensor(3.6439, device='cuda:0'), 'eval/top-1-acc': 0.627125, 'eval/top-5-acc': 0.9325, 'eval/precision': 0.6605855935920687, 'eval/recall': 0.6271249999999999, 'eval/F1': 0.6244861812041435, 'eval/AUC': 0.8737072395833334}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 14:29:13,800 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 14:29:23,365 INFO] confusion matrix:
[[0.965   0.0025  0.      0.      0.00375 0.00125 0.0075  0.      0.0125
  0.0075 ]
 [0.06125 0.8375  0.      0.0075  0.      0.0175  0.06875 0.00625 0.00125
  0.     ]
 [0.00125 0.      0.81    0.      0.      0.01875 0.145   0.00125 0.00375
  0.02   ]
 [0.00125 0.1325  0.      0.41625 0.0125  0.14    0.2725  0.02375 0.
  0.00125]
 [0.      0.00875 0.      0.00875 0.75125 0.015   0.20375 0.0125  0.
  0.     ]
 [0.      0.04625 0.      0.51625 0.01875 0.1975  0.21375 0.0075  0.
  0.     ]
 [0.00375 0.00625 0.0025  0.00625 0.685   0.01375 0.2725  0.00125 0.00375
  0.005  ]
 [0.      0.28    0.00125 0.01375 0.0075  0.05    0.2025  0.445   0.
  0.     ]
 [0.0075  0.      0.      0.      0.      0.00125 0.01625 0.      0.96875
  0.00625]
 [0.0075  0.0025  0.15125 0.      0.      0.0025  0.08625 0.      0.01
  0.74   ]]
[2023-08-05 14:29:23,372 INFO] 1010000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1158e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1454, device='cuda:0'), 'train/shrink_loss': tensor(0.0724, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0587, device='cuda:0'), 'train/removed_class_idx': 2.3522724599690386, 'train/uncertainty_avg': 0.7705405532126718, 'train/certain_ratio_ema': 0.8100269472025652, 'train/total_loss': tensor(0.2041, device='cuda:0'), 'train/mask_ratio': tensor(0.8036, device='cuda:0'), 'lr': 0.007332343005544913, 'train/prefecth_time': 0.01838585662841797, 'train/run_time': 0.5441060180664062, 'eval/loss': tensor(3.4606, device='cuda:0'), 'eval/top-1-acc': 0.640375, 'eval/top-5-acc': 0.94625, 'eval/precision': 0.6761278204101935, 'eval/recall': 0.640375, 'eval/F1': 0.6403733495464171, 'eval/AUC': 0.8838967621527777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 14:39:14,725 INFO] confusion matrix:
[[0.96125 0.00375 0.      0.00125 0.0025  0.      0.01125 0.      0.0125
  0.0075 ]
 [0.05875 0.83    0.      0.00625 0.      0.01125 0.08    0.0125  0.00125
  0.     ]
 [0.00125 0.00125 0.79625 0.      0.      0.02125 0.14625 0.0075  0.00375
  0.0225 ]
 [0.01125 0.11375 0.00375 0.3925  0.01125 0.08    0.26125 0.125   0.00125
  0.     ]
 [0.      0.00625 0.      0.01125 0.75    0.0175  0.20625 0.00875 0.
  0.     ]
 [0.      0.03875 0.      0.5225  0.01875 0.13375 0.20625 0.08    0.
  0.     ]
 [0.0025  0.00875 0.0025  0.01    0.6775  0.0125  0.2775  0.0025  0.0025
  0.00375]
 [0.00375 0.2675  0.005   0.01125 0.00625 0.04875 0.1825  0.475   0.
  0.     ]
 [0.0075  0.      0.      0.      0.      0.      0.015   0.      0.97125
  0.00625]
 [0.00625 0.00125 0.1475  0.      0.      0.00375 0.09375 0.00125 0.01
  0.73625]]
[2023-08-05 14:39:14,736 INFO] 1011000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.7451e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1375, device='cuda:0'), 'train/shrink_loss': tensor(0.0420, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0338, device='cuda:0'), 'train/removed_class_idx': 2.5499996812500396, 'train/uncertainty_avg': 0.7432907322768184, 'train/certain_ratio_ema': 0.8048372477235407, 'train/total_loss': tensor(0.1714, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.007294206089627802, 'train/prefecth_time': 0.020104223251342774, 'train/run_time': 0.54245849609375, 'eval/loss': tensor(3.5086, device='cuda:0'), 'eval/top-1-acc': 0.632375, 'eval/top-5-acc': 0.93925, 'eval/precision': 0.6500784612964048, 'eval/recall': 0.632375, 'eval/F1': 0.6270744048793113, 'eval/AUC': 0.8800604253472224}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 14:49:03,497 INFO] confusion matrix:
[[0.96125 0.0025  0.      0.      0.00375 0.      0.01    0.      0.015
  0.0075 ]
 [0.06    0.83375 0.      0.01    0.      0.0125  0.08    0.0025  0.00125
  0.     ]
 [0.00125 0.0025  0.8025  0.      0.      0.02375 0.15125 0.00125 0.0025
  0.015  ]
 [0.00125 0.125   0.      0.46125 0.0125  0.07875 0.28125 0.03875 0.00125
  0.     ]
 [0.      0.00875 0.      0.015   0.745   0.01625 0.2125  0.00125 0.00125
  0.     ]
 [0.      0.0475  0.      0.5375  0.015   0.135   0.23875 0.02625 0.
  0.     ]
 [0.0025  0.00875 0.0025  0.01    0.68    0.00875 0.27625 0.00625 0.0025
  0.0025 ]
 [0.      0.3275  0.      0.0175  0.0075  0.06    0.22    0.36625 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.01625 0.      0.97125
  0.0075 ]
 [0.00625 0.0025  0.1525  0.      0.      0.0025  0.0925  0.      0.00875
  0.735  ]]
[2023-08-05 14:49:03,507 INFO] 1012000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.9614e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1604, device='cuda:0'), 'train/shrink_loss': tensor(0.0271, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0220, device='cuda:0'), 'train/removed_class_idx': 2.43999967466671, 'train/uncertainty_avg': 0.7419175525720036, 'train/certain_ratio_ema': 0.813088080950644, 'train/total_loss': tensor(0.1825, device='cuda:0'), 'train/mask_ratio': tensor(0.8326, device='cuda:0'), 'lr': 0.007256056641317815, 'train/prefecth_time': 0.019836639404296873, 'train/run_time': 0.5457012329101563, 'eval/loss': tensor(3.4468, device='cuda:0'), 'eval/top-1-acc': 0.62875, 'eval/top-5-acc': 0.947625, 'eval/precision': 0.66523544583115, 'eval/recall': 0.62875, 'eval/F1': 0.6249365750322472, 'eval/AUC': 0.8879092708333333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 14:59:08,402 INFO] confusion matrix:
[[0.95875 0.0025  0.      0.      0.005   0.      0.00875 0.      0.0175
  0.0075 ]
 [0.06125 0.85625 0.0025  0.01375 0.0025  0.02    0.0225  0.02    0.00125
  0.     ]
 [0.00125 0.00375 0.80375 0.      0.      0.02125 0.15125 0.      0.00375
  0.015  ]
 [0.0025  0.1225  0.02    0.41625 0.00875 0.1575  0.24625 0.025   0.
  0.00125]
 [0.      0.01625 0.      0.00875 0.7625  0.02125 0.19    0.00125 0.
  0.     ]
 [0.      0.04875 0.00625 0.44375 0.0175  0.26    0.2025  0.02    0.00125
  0.     ]
 [0.0025  0.01375 0.00375 0.0075  0.7025  0.01375 0.2525  0.00125 0.00125
  0.00125]
 [0.00125 0.175   0.      0.01125 0.0025  0.08625 0.1425  0.58125 0.
  0.     ]
 [0.00375 0.00125 0.00125 0.      0.      0.      0.015   0.      0.9725
  0.00625]
 [0.005   0.005   0.15625 0.      0.      0.00375 0.0925  0.      0.01
  0.7275 ]]
[2023-08-05 14:59:08,420 INFO] 1013000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1326, device='cuda:0'), 'train/shrink_loss': tensor(0.0460, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0367, device='cuda:0'), 'train/removed_class_idx': 2.5544551926281986, 'train/uncertainty_avg': 0.7264705900027374, 'train/certain_ratio_ema': 0.7974391455978707, 'train/total_loss': tensor(0.1694, device='cuda:0'), 'train/mask_ratio': tensor(0.7746, device='cuda:0'), 'lr': 0.007217894726160651, 'train/prefecth_time': 0.020201248168945314, 'train/run_time': 0.5513654174804687, 'eval/loss': tensor(2.7624, device='cuda:0'), 'eval/top-1-acc': 0.659125, 'eval/top-5-acc': 0.95075, 'eval/precision': 0.6847706011999581, 'eval/recall': 0.6591250000000001, 'eval/F1': 0.6605217072470391, 'eval/AUC': 0.9101995399305554}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 15:08:59,095 INFO] confusion matrix:
[[0.9575  0.00125 0.      0.00125 0.005   0.      0.0125  0.      0.01375
  0.00875]
 [0.06375 0.8225  0.00375 0.03125 0.00375 0.00875 0.045   0.02    0.00125
  0.     ]
 [0.00125 0.0025  0.81125 0.0025  0.      0.00875 0.1425  0.      0.00625
  0.025  ]
 [0.005   0.1125  0.00125 0.51125 0.0125  0.085   0.25375 0.0175  0.
  0.00125]
 [0.00125 0.00875 0.      0.0225  0.75625 0.00875 0.20125 0.00125 0.
  0.     ]
 [0.0025  0.0425  0.      0.36625 0.0175  0.3525  0.19875 0.01875 0.00125
  0.     ]
 [0.0025  0.00875 0.00375 0.00625 0.7375  0.00375 0.23125 0.00125 0.00125
  0.00375]
 [0.00125 0.18875 0.      0.0325  0.0025  0.02625 0.16    0.58875 0.
  0.     ]
 [0.00375 0.      0.00125 0.      0.      0.      0.03875 0.      0.95125
  0.005  ]
 [0.00375 0.00375 0.13625 0.00125 0.      0.0025  0.08875 0.00125 0.01125
  0.75125]]
[2023-08-05 15:08:59,111 INFO] 1014000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.6463e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1635, device='cuda:0'), 'train/shrink_loss': tensor(0.0607, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0487, device='cuda:0'), 'train/removed_class_idx': 2.57499967812504, 'train/uncertainty_avg': 0.7422176468942628, 'train/certain_ratio_ema': 0.8010764062274401, 'train/total_loss': tensor(0.2122, device='cuda:0'), 'train/mask_ratio': tensor(0.8214, device='cuda:0'), 'lr': 0.007179720409723446, 'train/prefecth_time': 0.018261375427246093, 'train/run_time': 0.541355224609375, 'eval/loss': tensor(2.7469, device='cuda:0'), 'eval/top-1-acc': 0.673375, 'eval/top-5-acc': 0.94875, 'eval/precision': 0.7169015565398702, 'eval/recall': 0.673375, 'eval/F1': 0.6806701237032634, 'eval/AUC': 0.9083976215277778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 15:18:42,908 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 15:18:53,221 INFO] confusion matrix:
[[0.95    0.      0.0025  0.00125 0.005   0.      0.0175  0.      0.015
  0.00875]
 [0.06375 0.83375 0.00125 0.0175  0.00375 0.0125  0.05375 0.01125 0.00125
  0.00125]
 [0.      0.00125 0.78625 0.      0.      0.0175  0.15375 0.00125 0.0025
  0.0375 ]
 [0.0025  0.10875 0.      0.36125 0.035   0.18125 0.26625 0.03125 0.
  0.01375]
 [0.00125 0.0075  0.      0.01375 0.75375 0.00875 0.20875 0.00625 0.
  0.     ]
 [0.005   0.035   0.      0.295   0.01875 0.42375 0.19875 0.0225  0.00125
  0.     ]
 [0.00375 0.00625 0.005   0.005   0.70875 0.005   0.255   0.0025  0.0025
  0.00625]
 [0.00125 0.17625 0.      0.01875 0.02    0.01375 0.165   0.59375 0.
  0.01125]
 [0.005   0.      0.      0.      0.      0.      0.0575  0.      0.9325
  0.005  ]
 [0.00375 0.00125 0.0875  0.00125 0.00125 0.00125 0.10625 0.00125 0.0125
  0.78375]]
[2023-08-05 15:18:53,228 INFO] 1015000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.3408e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1237, device='cuda:0'), 'train/shrink_loss': tensor(0.0551, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0442, device='cuda:0'), 'train/removed_class_idx': 2.439999756000024, 'train/uncertainty_avg': 0.7503483835532849, 'train/certain_ratio_ema': 0.8032768717173145, 'train/total_loss': tensor(0.1679, device='cuda:0'), 'train/mask_ratio': tensor(0.7768, device='cuda:0'), 'lr': 0.007141533757594618, 'train/prefecth_time': 0.020435327529907225, 'train/run_time': 0.5618936157226563, 'eval/loss': tensor(2.9962, device='cuda:0'), 'eval/top-1-acc': 0.667375, 'eval/top-5-acc': 0.93175, 'eval/precision': 0.7077809510074795, 'eval/recall': 0.667375, 'eval/F1': 0.6763651743465329, 'eval/AUC': 0.9021716406250001}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 15:28:43,401 INFO] confusion matrix:
[[0.945   0.00125 0.0025  0.00125 0.00375 0.      0.0225  0.      0.015
  0.00875]
 [0.06125 0.82    0.0025  0.0175  0.      0.0075  0.07125 0.01375 0.00375
  0.0025 ]
 [0.      0.      0.77375 0.      0.      0.01625 0.16625 0.00125 0.00625
  0.03625]
 [0.0025  0.1075  0.00625 0.39375 0.01125 0.14125 0.265   0.02625 0.
  0.04625]
 [0.      0.00875 0.      0.01625 0.74875 0.0075  0.21    0.005   0.
  0.00375]
 [0.00125 0.0325  0.00125 0.3075  0.01625 0.42    0.19875 0.01875 0.0025
  0.00125]
 [0.00375 0.005   0.00625 0.00375 0.67875 0.005   0.2825  0.00375 0.0025
  0.00875]
 [0.00125 0.16875 0.00125 0.02125 0.00375 0.01    0.185   0.5775  0.
  0.03125]
 [0.005   0.      0.      0.      0.      0.      0.04125 0.      0.9475
  0.00625]
 [0.00625 0.00125 0.10375 0.      0.      0.0025  0.1125  0.00125 0.0125
  0.76   ]]
[2023-08-05 15:28:43,411 INFO] 1016000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.6885e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1457, device='cuda:0'), 'train/shrink_loss': tensor(0.0580, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0470, device='cuda:0'), 'train/removed_class_idx': 2.402438731409911, 'train/uncertainty_avg': 0.7722404173522149, 'train/certain_ratio_ema': 0.8098199887412192, 'train/total_loss': tensor(0.1928, device='cuda:0'), 'train/mask_ratio': tensor(0.8170, device='cuda:0'), 'lr': 0.007103334835383806, 'train/prefecth_time': 0.020050336837768554, 'train/run_time': 0.5412410278320312, 'eval/loss': tensor(3.0610, device='cuda:0'), 'eval/top-1-acc': 0.666875, 'eval/top-5-acc': 0.941125, 'eval/precision': 0.7087247866756334, 'eval/recall': 0.6668749999999999, 'eval/F1': 0.6762218486386632, 'eval/AUC': 0.9019966579861113}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 15:38:33,047 INFO] confusion matrix:
[[0.955   0.      0.0025  0.      0.00375 0.      0.015   0.      0.015
  0.00875]
 [0.06375 0.81875 0.00125 0.01    0.00125 0.01125 0.065   0.015   0.005
  0.00875]
 [0.00125 0.      0.77    0.      0.      0.0175  0.1775  0.00125 0.00625
  0.02625]
 [0.0025  0.105   0.      0.38375 0.01    0.16125 0.25625 0.02875 0.
  0.0525 ]
 [0.00125 0.0075  0.      0.01125 0.74875 0.01125 0.20875 0.005   0.
  0.00625]
 [0.0025  0.02625 0.      0.32375 0.01625 0.42625 0.175   0.02625 0.0025
  0.00125]
 [0.00375 0.00625 0.00375 0.00375 0.68375 0.00375 0.27625 0.0075  0.0025
  0.00875]
 [0.00125 0.15375 0.      0.0125  0.00375 0.01375 0.19625 0.58375 0.
  0.035  ]
 [0.005   0.      0.      0.      0.      0.      0.02875 0.      0.95875
  0.0075 ]
 [0.00625 0.00125 0.10375 0.      0.      0.0025  0.11    0.00125 0.01375
  0.76125]]
[2023-08-05 15:38:33,057 INFO] 1017000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.7788e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1740, device='cuda:0'), 'train/shrink_loss': tensor(0.0374, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0303, device='cuda:0'), 'train/removed_class_idx': 2.3623184982147105, 'train/uncertainty_avg': 0.7428145679670792, 'train/certain_ratio_ema': 0.8088501565868975, 'train/total_loss': tensor(0.2042, device='cuda:0'), 'train/mask_ratio': tensor(0.8460, device='cuda:0'), 'lr': 0.0070651237087217085, 'train/prefecth_time': 0.019279840469360352, 'train/run_time': 0.5404879150390625, 'eval/loss': tensor(3.1168, device='cuda:0'), 'eval/top-1-acc': 0.66825, 'eval/top-5-acc': 0.942375, 'eval/precision': 0.7047288985284546, 'eval/recall': 0.6682500000000001, 'eval/F1': 0.6762093776450284, 'eval/AUC': 0.89715828125}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 15:48:31,620 INFO] confusion matrix:
[[0.94875 0.      0.      0.      0.00375 0.00375 0.02    0.      0.01625
  0.0075 ]
 [0.0625  0.8225  0.      0.00875 0.      0.01625 0.06875 0.01125 0.005
  0.005  ]
 [0.      0.00125 0.78625 0.      0.      0.0175  0.16875 0.00125 0.00625
  0.01875]
 [0.005   0.095   0.      0.41375 0.0125  0.13625 0.25125 0.0325  0.
  0.05375]
 [0.0025  0.0075  0.      0.01125 0.75125 0.00875 0.205   0.0075  0.
  0.00625]
 [0.005   0.0275  0.      0.46625 0.01875 0.26375 0.1875  0.0275  0.00125
  0.0025 ]
 [0.00375 0.00625 0.0025  0.005   0.685   0.005   0.26875 0.01    0.0025
  0.01125]
 [0.00125 0.155   0.      0.01125 0.005   0.00875 0.17875 0.60375 0.
  0.03625]
 [0.00375 0.      0.00125 0.      0.      0.      0.04    0.      0.9475
  0.0075 ]
 [0.00625 0.00125 0.1225  0.      0.      0.0025  0.11125 0.00125 0.015
  0.74   ]]
[2023-08-05 15:48:31,634 INFO] 1018000 iteration, USE_EMA: True, {'train/sup_loss': tensor(7.6843e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1163, device='cuda:0'), 'train/shrink_loss': tensor(0.0477, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0389, device='cuda:0'), 'train/removed_class_idx': 2.405796752783079, 'train/uncertainty_avg': 0.762068955488866, 'train/certain_ratio_ema': 0.8160602051947206, 'train/total_loss': tensor(0.1553, device='cuda:0'), 'train/mask_ratio': tensor(0.8460, device='cuda:0'), 'lr': 0.007026900443259996, 'train/prefecth_time': 0.01868207931518555, 'train/run_time': 0.5397418212890625, 'eval/loss': tensor(3.3544, device='cuda:0'), 'eval/top-1-acc': 0.654625, 'eval/top-5-acc': 0.943875, 'eval/precision': 0.6876534197945213, 'eval/recall': 0.654625, 'eval/F1': 0.6590985600056685, 'eval/AUC': 0.8898268489583333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 15:58:24,695 INFO] confusion matrix:
[[0.94625 0.00125 0.      0.00125 0.00375 0.0025  0.02125 0.      0.015
  0.00875]
 [0.0625  0.8225  0.      0.01    0.      0.01    0.0675  0.0225  0.00375
  0.00125]
 [0.      0.      0.8     0.      0.      0.02125 0.15625 0.0025  0.0025
  0.0175 ]
 [0.0025  0.09    0.      0.42875 0.0075  0.1025  0.2625  0.08125 0.
  0.025  ]
 [0.      0.0075  0.      0.01125 0.74    0.00875 0.2125  0.02    0.
  0.     ]
 [0.0025  0.02625 0.      0.46625 0.01375 0.2475  0.20625 0.035   0.00125
  0.00125]
 [0.00375 0.00375 0.0025  0.0075  0.595   0.00375 0.29    0.08875 0.00125
  0.00375]
 [0.00125 0.13625 0.      0.0075  0.0025  0.005   0.185   0.6475  0.
  0.015  ]
 [0.00375 0.      0.00125 0.      0.      0.      0.04625 0.      0.94375
  0.005  ]
 [0.0075  0.00125 0.17375 0.00125 0.      0.00375 0.1125  0.00375 0.01125
  0.685  ]]
[2023-08-05 15:58:24,706 INFO] 1019000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.3231e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1205, device='cuda:0'), 'train/shrink_loss': tensor(0.0447, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0361, device='cuda:0'), 'train/removed_class_idx': 2.3333330341880725, 'train/uncertainty_avg': 0.7568063235657095, 'train/certain_ratio_ema': 0.807175159704161, 'train/total_loss': tensor(0.1566, device='cuda:0'), 'train/mask_ratio': tensor(0.8259, device='cuda:0'), 'lr': 0.0069886651046712125, 'train/prefecth_time': 0.022834207534790037, 'train/run_time': 0.5413161010742188, 'eval/loss': tensor(3.2082, device='cuda:0'), 'eval/top-1-acc': 0.655125, 'eval/top-5-acc': 0.95075, 'eval/precision': 0.6872902330662211, 'eval/recall': 0.655125, 'eval/F1': 0.6590011211413948, 'eval/AUC': 0.8931737413194444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 16:08:04,457 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 16:08:14,308 INFO] confusion matrix:
[[0.94375 0.      0.0025  0.      0.00375 0.      0.0275  0.      0.01625
  0.00625]
 [0.06    0.82875 0.00125 0.01125 0.00125 0.01    0.0725  0.01125 0.00375
  0.     ]
 [0.      0.00125 0.81125 0.      0.      0.0175  0.1425  0.0025  0.00375
  0.02125]
 [0.00125 0.1025  0.      0.43    0.01625 0.11    0.26125 0.055   0.0025
  0.02125]
 [0.      0.0075  0.      0.01375 0.75    0.01    0.20375 0.015   0.
  0.     ]
 [0.      0.03125 0.      0.3825  0.0175  0.3475  0.1925  0.0275  0.00125
  0.     ]
 [0.0025  0.005   0.005   0.005   0.6825  0.0025  0.27625 0.0125  0.00375
  0.005  ]
 [0.00125 0.20625 0.      0.01375 0.00625 0.0075  0.18    0.57    0.
  0.015  ]
 [0.005   0.      0.00125 0.      0.      0.      0.0525  0.00125 0.935
  0.005  ]
 [0.0075  0.00125 0.15125 0.00125 0.      0.00375 0.11125 0.0025  0.01
  0.71125]]
[2023-08-05 16:08:14,315 INFO] 1020000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0003, device='cuda:0'), 'train/certain_loss': tensor(0.2429, device='cuda:0'), 'train/shrink_loss': tensor(0.0663, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0542, device='cuda:0'), 'train/removed_class_idx': 2.443181540547552, 'train/uncertainty_avg': 0.7216711182646302, 'train/certain_ratio_ema': 0.817269638158179, 'train/total_loss': tensor(0.2973, device='cuda:0'), 'train/mask_ratio': tensor(0.8036, device='cuda:0'), 'lr': 0.006950417758648626, 'train/prefecth_time': 0.01876927947998047, 'train/run_time': 0.5516575317382812, 'eval/loss': tensor(3.2185, device='cuda:0'), 'eval/top-1-acc': 0.660375, 'eval/top-5-acc': 0.95425, 'eval/precision': 0.7013272213689845, 'eval/recall': 0.6603749999999999, 'eval/F1': 0.667846409840607, 'eval/AUC': 0.8922992274305556}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 16:18:14,100 INFO] confusion matrix:
[[0.9425  0.      0.0025  0.00125 0.00375 0.00125 0.025   0.      0.01625
  0.0075 ]
 [0.0575  0.81625 0.00125 0.015   0.00125 0.01    0.0875  0.0075  0.00375
  0.     ]
 [0.      0.0025  0.81    0.      0.      0.0225  0.14125 0.0025  0.005
  0.01625]
 [0.0025  0.115   0.      0.44125 0.01625 0.095   0.26375 0.0425  0.00375
  0.02   ]
 [0.      0.0075  0.      0.01375 0.7475  0.00625 0.21125 0.01375 0.
  0.     ]
 [0.      0.02875 0.      0.3275  0.02125 0.40125 0.2     0.02    0.00125
  0.     ]
 [0.00375 0.00375 0.00625 0.00625 0.67625 0.005   0.2825  0.01125 0.0025
  0.0025 ]
 [0.00125 0.25875 0.      0.02125 0.005   0.0075  0.17375 0.51625 0.
  0.01625]
 [0.005   0.      0.      0.      0.      0.      0.07625 0.00125 0.9125
  0.005  ]
 [0.0075  0.00125 0.1575  0.00125 0.      0.005   0.11625 0.00375 0.0125
  0.695  ]]
[2023-08-05 16:18:14,116 INFO] 1021000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1436, device='cuda:0'), 'train/shrink_loss': tensor(0.0617, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0504, device='cuda:0'), 'train/removed_class_idx': 2.393258158060881, 'train/uncertainty_avg': 0.7640226174059043, 'train/certain_ratio_ema': 0.8169680392139298, 'train/total_loss': tensor(0.1941, device='cuda:0'), 'train/mask_ratio': tensor(0.8013, device='cuda:0'), 'lr': 0.006912158470906136, 'train/prefecth_time': 0.0184849910736084, 'train/run_time': 0.5456224365234374, 'eval/loss': tensor(3.2293, device='cuda:0'), 'eval/top-1-acc': 0.6565, 'eval/top-5-acc': 0.947, 'eval/precision': 0.7058076161316396, 'eval/recall': 0.6565, 'eval/F1': 0.6665574395855416, 'eval/AUC': 0.8934866753472223}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 16:28:01,686 INFO] confusion matrix:
[[0.93    0.      0.      0.      0.00375 0.005   0.03625 0.      0.0175
  0.0075 ]
 [0.05875 0.8275  0.      0.00875 0.00125 0.01    0.07875 0.01125 0.00375
  0.     ]
 [0.      0.0025  0.81125 0.      0.      0.02625 0.13125 0.00375 0.00375
  0.02125]
 [0.0025  0.10625 0.      0.42125 0.01625 0.1425  0.2525  0.04625 0.00375
  0.00875]
 [0.      0.0075  0.      0.01    0.7475  0.0125  0.20875 0.01375 0.
  0.     ]
 [0.      0.03125 0.      0.34    0.025   0.38625 0.195   0.02125 0.00125
  0.     ]
 [0.0025  0.005   0.0025  0.005   0.68375 0.00875 0.27375 0.0125  0.0025
  0.00375]
 [0.00125 0.2225  0.      0.0125  0.00875 0.015   0.1575  0.57    0.
  0.0125 ]
 [0.00625 0.      0.      0.      0.      0.      0.0875  0.00125 0.9
  0.005  ]
 [0.00625 0.00125 0.16375 0.      0.      0.00625 0.11    0.00375 0.01
  0.69875]]
[2023-08-05 16:28:01,702 INFO] 1022000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.4697e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1857, device='cuda:0'), 'train/shrink_loss': tensor(0.0644, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0527, device='cuda:0'), 'train/removed_class_idx': 2.3086416902911493, 'train/uncertainty_avg': 0.7450948696032161, 'train/certain_ratio_ema': 0.8190664810479859, 'train/total_loss': tensor(0.2384, device='cuda:0'), 'train/mask_ratio': tensor(0.8192, device='cuda:0'), 'lr': 0.006873887307178178, 'train/prefecth_time': 0.0222523193359375, 'train/run_time': 0.5370319213867187, 'eval/loss': tensor(3.2776, device='cuda:0'), 'eval/top-1-acc': 0.656625, 'eval/top-5-acc': 0.9505, 'eval/precision': 0.6991967298378947, 'eval/recall': 0.656625, 'eval/F1': 0.666224299506766, 'eval/AUC': 0.8908408072916667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 16:37:49,729 INFO] confusion matrix:
[[0.945   0.      0.      0.      0.00375 0.005   0.025   0.      0.01375
  0.0075 ]
 [0.0625  0.825   0.      0.00625 0.      0.00875 0.06875 0.025   0.00375
  0.     ]
 [0.      0.00125 0.81625 0.      0.      0.03    0.1125  0.005   0.00375
  0.03125]
 [0.005   0.10125 0.      0.42125 0.01    0.10375 0.2475  0.10875 0.0025
  0.     ]
 [0.      0.00625 0.      0.0075  0.7475  0.005   0.2025  0.03125 0.
  0.     ]
 [0.      0.02875 0.      0.48875 0.02125 0.23375 0.19875 0.0275  0.00125
  0.     ]
 [0.0025  0.005   0.0025  0.0075  0.685   0.005   0.27    0.015   0.0025
  0.005  ]
 [0.00125 0.2275  0.      0.00375 0.00625 0.00625 0.1675  0.5875  0.
  0.     ]
 [0.00625 0.      0.      0.      0.      0.      0.07875 0.      0.91
  0.005  ]
 [0.0075  0.00125 0.155   0.      0.      0.005   0.09875 0.00375 0.01125
  0.7175 ]]
[2023-08-05 16:37:49,747 INFO] 1023000 iteration, USE_EMA: True, {'train/sup_loss': tensor(5.4671e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1601, device='cuda:0'), 'train/shrink_loss': tensor(0.0439, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0361, device='cuda:0'), 'train/removed_class_idx': 2.2926826472338235, 'train/uncertainty_avg': 0.7514118275511662, 'train/certain_ratio_ema': 0.8224993026372992, 'train/total_loss': tensor(0.1963, device='cuda:0'), 'train/mask_ratio': tensor(0.8170, device='cuda:0'), 'lr': 0.006835604333219565, 'train/prefecth_time': 0.019627744674682618, 'train/run_time': 0.542505859375, 'eval/loss': tensor(3.3960, device='cuda:0'), 'eval/top-1-acc': 0.647375, 'eval/top-5-acc': 0.9465, 'eval/precision': 0.6794032072394594, 'eval/recall': 0.647375, 'eval/F1': 0.6498932225821749, 'eval/AUC': 0.8871211631944445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 16:47:38,968 INFO] confusion matrix:
[[0.9475  0.      0.      0.      0.00375 0.005   0.02375 0.      0.01375
  0.00625]
 [0.06375 0.825   0.      0.00625 0.00125 0.0125  0.08    0.01    0.00125
  0.     ]
 [0.      0.0025  0.80125 0.      0.      0.02    0.135   0.00125 0.0025
  0.0375 ]
 [0.0075  0.10375 0.      0.37875 0.01    0.12125 0.295   0.0825  0.00125
  0.     ]
 [0.0025  0.00625 0.      0.005   0.7275  0.01    0.22625 0.0225  0.
  0.     ]
 [0.00125 0.03    0.      0.38625 0.01625 0.305   0.2325  0.02625 0.0025
  0.     ]
 [0.00375 0.00625 0.0025  0.005   0.65875 0.0075  0.2975  0.01125 0.0025
  0.005  ]
 [0.      0.255   0.      0.00625 0.005   0.0125  0.2125  0.50875 0.
  0.     ]
 [0.005   0.      0.      0.      0.      0.      0.0725  0.      0.9175
  0.005  ]
 [0.00625 0.00125 0.13    0.00125 0.      0.00375 0.11625 0.0025  0.01
  0.72875]]
[2023-08-05 16:47:38,984 INFO] 1024000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.0672e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1231, device='cuda:0'), 'train/shrink_loss': tensor(0.0505, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0412, device='cuda:0'), 'train/removed_class_idx': 2.313953219307765, 'train/uncertainty_avg': 0.7701624280409659, 'train/certain_ratio_ema': 0.8148251798295041, 'train/total_loss': tensor(0.1643, device='cuda:0'), 'train/mask_ratio': tensor(0.8080, device='cuda:0'), 'lr': 0.006797309614805428, 'train/prefecth_time': 0.025143104553222655, 'train/run_time': 0.552308349609375, 'eval/loss': tensor(3.2756, device='cuda:0'), 'eval/top-1-acc': 0.64375, 'eval/top-5-acc': 0.958375, 'eval/precision': 0.6883536094823943, 'eval/recall': 0.64375, 'eval/F1': 0.6520409811323891, 'eval/AUC': 0.8901687673611112}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 16:57:19,879 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 16:57:40,937 INFO] confusion matrix:
[[0.94125 0.00125 0.      0.      0.00375 0.005   0.02875 0.      0.015
  0.005  ]
 [0.06375 0.8225  0.      0.00875 0.0025  0.01    0.08    0.00875 0.00375
  0.     ]
 [0.      0.0025  0.7925  0.      0.      0.025   0.14125 0.      0.00375
  0.035  ]
 [0.005   0.10125 0.      0.4175  0.01375 0.12625 0.28    0.05375 0.0025
  0.     ]
 [0.0025  0.00625 0.      0.01    0.74375 0.01    0.2125  0.01375 0.
  0.00125]
 [0.00125 0.03125 0.      0.37625 0.01875 0.3275  0.22875 0.01375 0.0025
  0.     ]
 [0.00375 0.00625 0.0025  0.005   0.66625 0.00875 0.285   0.01375 0.0025
  0.00625]
 [0.00125 0.25625 0.      0.01    0.00625 0.02125 0.19125 0.5125  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.06    0.      0.9275
  0.00625]
 [0.00625 0.00125 0.1375  0.00125 0.      0.005   0.11    0.0025  0.0125
  0.72375]]
[2023-08-05 16:57:40,944 INFO] 1025000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.7126e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1357, device='cuda:0'), 'train/shrink_loss': tensor(0.0704, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0577, device='cuda:0'), 'train/removed_class_idx': 2.345678722755713, 'train/uncertainty_avg': 0.7662113032599104, 'train/certain_ratio_ema': 0.8195959992945823, 'train/total_loss': tensor(0.1934, device='cuda:0'), 'train/mask_ratio': tensor(0.8192, device='cuda:0'), 'lr': 0.00675900321773106, 'train/prefecth_time': 0.021458175659179686, 'train/run_time': 0.54016845703125, 'eval/loss': tensor(3.3338, device='cuda:0'), 'eval/top-1-acc': 0.649375, 'eval/top-5-acc': 0.95175, 'eval/precision': 0.6944810631721017, 'eval/recall': 0.6493749999999999, 'eval/F1': 0.657961301843426, 'eval/AUC': 0.8901327083333335}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 17:07:27,950 INFO] confusion matrix:
[[0.93875 0.00125 0.      0.00125 0.005   0.005   0.03    0.      0.01375
  0.005  ]
 [0.06125 0.81125 0.      0.0125  0.00125 0.0175  0.0775  0.015   0.00375
  0.     ]
 [0.      0.00125 0.8     0.      0.      0.0225  0.13625 0.00125 0.00375
  0.035  ]
 [0.00125 0.09625 0.      0.3775  0.01125 0.16375 0.26875 0.07875 0.0025
  0.     ]
 [0.      0.0075  0.      0.01125 0.745   0.0075  0.2075  0.02    0.
  0.00125]
 [0.00125 0.0375  0.      0.32125 0.0225  0.3175  0.2125  0.085   0.00125
  0.00125]
 [0.00375 0.00375 0.00375 0.005   0.67125 0.01125 0.27875 0.01375 0.0025
  0.00625]
 [0.00125 0.21    0.      0.0075  0.00375 0.02375 0.175   0.57875 0.
  0.     ]
 [0.00375 0.      0.00125 0.      0.      0.      0.0675  0.00125 0.92125
  0.005  ]
 [0.00625 0.00125 0.15125 0.      0.      0.00375 0.10125 0.0025  0.01
  0.72375]]
[2023-08-05 17:07:27,965 INFO] 1026000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.0051e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1733, device='cuda:0'), 'train/shrink_loss': tensor(0.0416, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0341, device='cuda:0'), 'train/removed_class_idx': 2.4605259920360534, 'train/uncertainty_avg': 0.756160564828318, 'train/certain_ratio_ema': 0.8199053697787863, 'train/total_loss': tensor(0.2075, device='cuda:0'), 'train/mask_ratio': tensor(0.8304, device='cuda:0'), 'lr': 0.006720685207811815, 'train/prefecth_time': 0.018604288101196288, 'train/run_time': 0.5401144409179688, 'eval/loss': tensor(3.3758, device='cuda:0'), 'eval/top-1-acc': 0.64925, 'eval/top-5-acc': 0.941875, 'eval/precision': 0.6828034142537572, 'eval/recall': 0.64925, 'eval/F1': 0.6558140840031946, 'eval/AUC': 0.888028967013889}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 17:17:14,589 INFO] confusion matrix:
[[0.94375 0.      0.      0.00125 0.005   0.005   0.02625 0.      0.01375
  0.005  ]
 [0.06125 0.82375 0.      0.01375 0.00125 0.01375 0.075   0.01    0.00125
  0.     ]
 [0.      0.0025  0.81625 0.      0.      0.02125 0.1275  0.00125 0.00375
  0.0275 ]
 [0.00125 0.1     0.      0.40125 0.01    0.155   0.255   0.07625 0.00125
  0.     ]
 [0.      0.00875 0.      0.01    0.75375 0.0075  0.19875 0.02    0.
  0.00125]
 [0.00125 0.0375  0.      0.33125 0.0225  0.37375 0.18875 0.04375 0.00125
  0.     ]
 [0.00375 0.005   0.00375 0.005   0.67875 0.00875 0.2725  0.01375 0.0025
  0.00625]
 [0.00125 0.2675  0.      0.01375 0.00375 0.025   0.17125 0.5175  0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.      0.06    0.      0.92875
  0.005  ]
 [0.005   0.00125 0.165   0.      0.      0.005   0.0925  0.0025  0.01125
  0.7175 ]]
[2023-08-05 17:17:14,606 INFO] 1027000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.1278e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1278, device='cuda:0'), 'train/shrink_loss': tensor(0.0625, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0513, device='cuda:0'), 'train/removed_class_idx': 2.2268038941439285, 'train/uncertainty_avg': 0.7663225958226899, 'train/certain_ratio_ema': 0.8205848074856885, 'train/total_loss': tensor(0.1791, device='cuda:0'), 'train/mask_ratio': tensor(0.7835, device='cuda:0'), 'lr': 0.006682355650883021, 'train/prefecth_time': 0.022998624801635743, 'train/run_time': 0.5705409545898438, 'eval/loss': tensor(3.3648, device='cuda:0'), 'eval/top-1-acc': 0.654875, 'eval/top-5-acc': 0.951875, 'eval/precision': 0.6893076020051575, 'eval/recall': 0.654875, 'eval/F1': 0.6607523223293695, 'eval/AUC': 0.8895251215277779}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 17:27:01,442 INFO] confusion matrix:
[[0.94125 0.      0.      0.00125 0.00375 0.005   0.02625 0.      0.01625
  0.00625]
 [0.05875 0.82625 0.      0.01375 0.      0.0125  0.075   0.01125 0.0025
  0.     ]
 [0.      0.00125 0.81375 0.      0.      0.0275  0.12625 0.00125 0.005
  0.025  ]
 [0.00125 0.11125 0.      0.405   0.0125  0.13375 0.25125 0.08375 0.00125
  0.     ]
 [0.      0.00625 0.      0.0125  0.75625 0.00625 0.19625 0.02125 0.
  0.00125]
 [0.00125 0.0325  0.      0.38125 0.02625 0.29    0.20375 0.06375 0.00125
  0.     ]
 [0.0025  0.0075  0.0025  0.00375 0.68625 0.005   0.27375 0.01    0.00125
  0.0075 ]
 [0.00125 0.2575  0.      0.01625 0.00875 0.0275  0.17875 0.51    0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.      0.06625 0.      0.9225
  0.005  ]
 [0.005   0.00125 0.165   0.      0.      0.00375 0.08875 0.0025  0.01125
  0.7225 ]]
[2023-08-05 17:27:01,458 INFO] 1028000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0007, device='cuda:0'), 'train/certain_loss': tensor(0.1129, device='cuda:0'), 'train/shrink_loss': tensor(0.0511, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0420, device='cuda:0'), 'train/removed_class_idx': 2.207791921065984, 'train/uncertainty_avg': 0.7714429935645303, 'train/certain_ratio_ema': 0.82277033618055, 'train/total_loss': tensor(0.1557, device='cuda:0'), 'train/mask_ratio': tensor(0.8281, device='cuda:0'), 'lr': 0.00664401461279982, 'train/prefecth_time': 0.019211423873901366, 'train/run_time': 0.5385604248046875, 'eval/loss': tensor(3.4670, device='cuda:0'), 'eval/top-1-acc': 0.646125, 'eval/top-5-acc': 0.947375, 'eval/precision': 0.678796912406544, 'eval/recall': 0.6461250000000001, 'eval/F1': 0.6500265752231593, 'eval/AUC': 0.884217699652778}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 17:36:48,907 INFO] confusion matrix:
[[0.94125 0.00125 0.      0.00125 0.005   0.005   0.0275  0.      0.01375
  0.005  ]
 [0.05875 0.82    0.      0.015   0.      0.01375 0.07625 0.0125  0.00375
  0.     ]
 [0.      0.0025  0.80875 0.      0.      0.03125 0.13    0.      0.00375
  0.02375]
 [0.00125 0.14875 0.      0.4025  0.0125  0.11625 0.24875 0.06875 0.00125
  0.     ]
 [0.      0.0125  0.      0.00875 0.7525  0.005   0.20125 0.02    0.
  0.     ]
 [0.      0.07875 0.      0.385   0.025   0.265   0.20875 0.03625 0.00125
  0.     ]
 [0.0025  0.0075  0.00375 0.005   0.6775  0.005   0.28125 0.01    0.00125
  0.00625]
 [0.00125 0.23875 0.      0.0125  0.0075  0.0225  0.16875 0.54875 0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.      0.09    0.      0.89875
  0.005  ]
 [0.005   0.00375 0.17    0.      0.      0.005   0.09875 0.0025  0.0125
  0.7025 ]]
[2023-08-05 17:36:48,923 INFO] 1029000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.6137e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0829, device='cuda:0'), 'train/shrink_loss': tensor(0.0314, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0259, device='cuda:0'), 'train/removed_class_idx': 2.385713944898008, 'train/uncertainty_avg': 0.7348090556855691, 'train/certain_ratio_ema': 0.8233423014782973, 'train/total_loss': tensor(0.1088, device='cuda:0'), 'train/mask_ratio': tensor(0.8438, device='cuda:0'), 'lr': 0.006605662159437105, 'train/prefecth_time': 0.01891043281555176, 'train/run_time': 0.5366368408203125, 'eval/loss': tensor(3.4981, device='cuda:0'), 'eval/top-1-acc': 0.642125, 'eval/top-5-acc': 0.94625, 'eval/precision': 0.6807414634184162, 'eval/recall': 0.642125, 'eval/F1': 0.6468959899250412, 'eval/AUC': 0.8838110069444445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 17:46:36,600 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 17:46:46,529 INFO] confusion matrix:
[[0.94625 0.00125 0.      0.00125 0.00375 0.005   0.0225  0.      0.015
  0.005  ]
 [0.065   0.815   0.      0.0125  0.      0.0125  0.07125 0.02    0.00375
  0.     ]
 [0.      0.00125 0.81125 0.      0.      0.03875 0.12    0.0025  0.0025
  0.02375]
 [0.00125 0.1025  0.      0.39125 0.0125  0.1425  0.24625 0.1025  0.00125
  0.     ]
 [0.      0.00625 0.      0.00625 0.7425  0.0075  0.20625 0.03125 0.
  0.     ]
 [0.00125 0.0325  0.      0.3625  0.02625 0.30375 0.20875 0.06375 0.00125
  0.     ]
 [0.0025  0.00625 0.00375 0.00375 0.6825  0.00625 0.27625 0.01125 0.0025
  0.005  ]
 [0.00125 0.205   0.      0.0125  0.0075  0.02375 0.17    0.58    0.
  0.     ]
 [0.00375 0.      0.00125 0.      0.      0.      0.07375 0.      0.91625
  0.005  ]
 [0.005   0.00125 0.1625  0.      0.      0.00375 0.0975  0.0025  0.00875
  0.71875]]
[2023-08-05 17:46:46,535 INFO] 1030000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.6110e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1069, device='cuda:0'), 'train/shrink_loss': tensor(0.0380, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0316, device='cuda:0'), 'train/removed_class_idx': 2.395061432708465, 'train/uncertainty_avg': 0.7818571773032587, 'train/certain_ratio_ema': 0.8305984391541781, 'train/total_loss': tensor(0.1385, device='cuda:0'), 'train/mask_ratio': tensor(0.8192, device='cuda:0'), 'lr': 0.006567298356689362, 'train/prefecth_time': 0.023623424530029295, 'train/run_time': 0.5436617431640625, 'eval/loss': tensor(3.4320, device='cuda:0'), 'eval/top-1-acc': 0.650125, 'eval/top-5-acc': 0.9495, 'eval/precision': 0.6813904031250216, 'eval/recall': 0.650125, 'eval/F1': 0.6553634879505007, 'eval/AUC': 0.8861064409722221}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 17:56:28,058 INFO] confusion matrix:
[[0.94    0.00125 0.      0.00125 0.005   0.005   0.02875 0.      0.01375
  0.005  ]
 [0.05875 0.8175  0.      0.00625 0.      0.01625 0.07125 0.02625 0.00375
  0.     ]
 [0.      0.00125 0.80625 0.      0.      0.0325  0.13125 0.00125 0.005
  0.0225 ]
 [0.0025  0.085   0.      0.41125 0.01375 0.12375 0.25125 0.11125 0.00125
  0.     ]
 [0.      0.00625 0.      0.00625 0.735   0.00875 0.2175  0.02625 0.
  0.     ]
 [0.      0.02125 0.      0.435   0.025   0.23    0.2225  0.06375 0.0025
  0.     ]
 [0.0025  0.00625 0.00375 0.00375 0.66125 0.00625 0.29875 0.01125 0.00125
  0.005  ]
 [0.00125 0.19125 0.      0.0025  0.0075  0.02375 0.17625 0.5975  0.
  0.     ]
 [0.0025  0.      0.00125 0.      0.      0.      0.09    0.      0.9
  0.00625]
 [0.005   0.00125 0.155   0.      0.      0.00375 0.10875 0.0025  0.01125
  0.7125 ]]
[2023-08-05 17:56:28,070 INFO] 1031000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.2269e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1062, device='cuda:0'), 'train/shrink_loss': tensor(0.0428, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0357, device='cuda:0'), 'train/removed_class_idx': 2.2258060926119203, 'train/uncertainty_avg': 0.7649596383120447, 'train/certain_ratio_ema': 0.8341422608045527, 'train/total_loss': tensor(0.1420, device='cuda:0'), 'train/mask_ratio': tensor(0.8616, device='cuda:0'), 'lr': 0.006528923270470577, 'train/prefecth_time': 0.018811424255371093, 'train/run_time': 0.5365531005859375, 'eval/loss': tensor(3.5287, device='cuda:0'), 'eval/top-1-acc': 0.644875, 'eval/top-5-acc': 0.94, 'eval/precision': 0.678469691575637, 'eval/recall': 0.6448750000000001, 'eval/F1': 0.6501717454994301, 'eval/AUC': 0.8827045746527777}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 18:06:11,136 INFO] confusion matrix:
[[0.94125 0.      0.      0.00125 0.005   0.005   0.02875 0.      0.01375
  0.005  ]
 [0.05875 0.82875 0.      0.0125  0.      0.01875 0.06375 0.015   0.0025
  0.     ]
 [0.      0.00125 0.81    0.      0.      0.03875 0.11875 0.00125 0.00375
  0.02625]
 [0.0025  0.09875 0.      0.4275  0.01125 0.11625 0.245   0.0975  0.00125
  0.     ]
 [0.      0.00625 0.      0.01125 0.745   0.0075  0.205   0.025   0.
  0.     ]
 [0.00125 0.03125 0.      0.4875  0.02375 0.18375 0.21    0.06125 0.00125
  0.     ]
 [0.00375 0.00625 0.00375 0.00375 0.67375 0.0075  0.2825  0.0125  0.00125
  0.005  ]
 [0.00125 0.235   0.      0.015   0.00875 0.03375 0.16625 0.54    0.
  0.     ]
 [0.00375 0.      0.00125 0.      0.      0.      0.1     0.00125 0.8875
  0.00625]
 [0.005   0.00125 0.14    0.      0.      0.00375 0.10625 0.0025  0.01
  0.73125]]
[2023-08-05 18:06:11,148 INFO] 1032000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.5192e-06, device='cuda:0'), 'train/certain_loss': tensor(0.1198, device='cuda:0'), 'train/shrink_loss': tensor(0.0461, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0383, device='cuda:0'), 'train/removed_class_idx': 2.3506490453702535, 'train/uncertainty_avg': 0.7701957289914023, 'train/certain_ratio_ema': 0.8297413425169473, 'train/total_loss': tensor(0.1580, device='cuda:0'), 'train/mask_ratio': tensor(0.8281, device='cuda:0'), 'lr': 0.006490536966714144, 'train/prefecth_time': 0.018911584854125977, 'train/run_time': 0.5381160888671875, 'eval/loss': tensor(3.7097, device='cuda:0'), 'eval/top-1-acc': 0.63775, 'eval/top-5-acc': 0.935875, 'eval/precision': 0.6662766346749647, 'eval/recall': 0.63775, 'eval/F1': 0.6399224961738786, 'eval/AUC': 0.872212517361111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 18:15:52,489 INFO] confusion matrix:
[[0.9525  0.      0.      0.00125 0.00375 0.005   0.01625 0.00125 0.01375
  0.00625]
 [0.06125 0.82625 0.      0.0125  0.      0.0175  0.065   0.015   0.0025
  0.     ]
 [0.      0.0025  0.8125  0.      0.      0.03875 0.11875 0.0025  0.0025
  0.0225 ]
 [0.00125 0.1125  0.      0.45125 0.0125  0.12375 0.24375 0.05375 0.00125
  0.     ]
 [0.      0.0075  0.      0.01375 0.745   0.00875 0.20875 0.01625 0.
  0.     ]
 [0.00125 0.03875 0.      0.46    0.02375 0.235   0.205   0.03625 0.
  0.     ]
 [0.00375 0.0075  0.00375 0.00375 0.69    0.0075  0.26625 0.01125 0.00125
  0.005  ]
 [0.00125 0.24375 0.      0.02125 0.00875 0.03    0.1575  0.53625 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0575  0.00125 0.92875
  0.00625]
 [0.00625 0.00125 0.155   0.      0.      0.00625 0.10375 0.0025  0.00875
  0.71625]]
[2023-08-05 18:15:52,507 INFO] 1033000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.5272e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1935, device='cuda:0'), 'train/shrink_loss': tensor(0.0329, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0273, device='cuda:0'), 'train/removed_class_idx': 2.2567564517896685, 'train/uncertainty_avg': 0.7685565364985931, 'train/certain_ratio_ema': 0.8296820632202526, 'train/total_loss': tensor(0.2209, device='cuda:0'), 'train/mask_ratio': tensor(0.8348, device='cuda:0'), 'lr': 0.006452139511372708, 'train/prefecth_time': 0.018184032440185547, 'train/run_time': 0.5360787353515625, 'eval/loss': tensor(3.5682, device='cuda:0'), 'eval/top-1-acc': 0.647, 'eval/top-5-acc': 0.938, 'eval/precision': 0.6783813289259701, 'eval/recall': 0.647, 'eval/F1': 0.6498706972731212, 'eval/AUC': 0.8800127256944444}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 18:25:43,496 INFO] confusion matrix:
[[0.95625 0.      0.      0.      0.00375 0.005   0.01375 0.00125 0.01375
  0.00625]
 [0.06125 0.825   0.      0.00625 0.      0.01625 0.07    0.01875 0.0025
  0.     ]
 [0.      0.00375 0.81    0.      0.      0.0325  0.12375 0.00125 0.00375
  0.025  ]
 [0.0025  0.1225  0.      0.41625 0.0125  0.09375 0.25875 0.0925  0.00125
  0.     ]
 [0.      0.0075  0.      0.005   0.74    0.01    0.2125  0.02375 0.00125
  0.     ]
 [0.      0.03125 0.      0.4775  0.0225  0.20875 0.21875 0.04125 0.
  0.     ]
 [0.00375 0.00625 0.005   0.005   0.6725  0.0075  0.28125 0.01125 0.0025
  0.005  ]
 [0.00125 0.22125 0.      0.005   0.0075  0.02625 0.17    0.5675  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.06125 0.00125 0.925
  0.00625]
 [0.005   0.00125 0.15125 0.      0.      0.00375 0.11    0.0025  0.00875
  0.7175 ]]
[2023-08-05 18:25:43,513 INFO] 1034000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.3559e-06, device='cuda:0'), 'train/certain_loss': tensor(0.1450, device='cuda:0'), 'train/shrink_loss': tensor(0.0295, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0246, device='cuda:0'), 'train/removed_class_idx': 2.124999704861152, 'train/uncertainty_avg': 0.8102919786800646, 'train/certain_ratio_ema': 0.8339537531109427, 'train/total_loss': tensor(0.1696, device='cuda:0'), 'train/mask_ratio': tensor(0.8393, device='cuda:0'), 'lr': 0.006413730970418074, 'train/prefecth_time': 0.018821632385253906, 'train/run_time': 0.5386605224609375, 'eval/loss': tensor(3.6252, device='cuda:0'), 'eval/top-1-acc': 0.64475, 'eval/top-5-acc': 0.93475, 'eval/precision': 0.6755118897514835, 'eval/recall': 0.6447499999999999, 'eval/F1': 0.6467805790408644, 'eval/AUC': 0.878481015625}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 18:35:19,244 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 18:35:29,057 INFO] confusion matrix:
[[0.95    0.00125 0.      0.      0.00375 0.005   0.0225  0.      0.0125
  0.005  ]
 [0.0625  0.81625 0.      0.005   0.      0.02    0.08125 0.0125  0.0025
  0.     ]
 [0.      0.00125 0.7875  0.      0.      0.04    0.13875 0.      0.00375
  0.02875]
 [0.00125 0.1025  0.      0.41375 0.0125  0.12875 0.28625 0.05375 0.00125
  0.     ]
 [0.      0.0075  0.      0.00625 0.715   0.01    0.2425  0.01875 0.
  0.     ]
 [0.      0.0275  0.      0.46    0.02125 0.2175  0.2475  0.02625 0.
  0.     ]
 [0.00375 0.00625 0.0025  0.005   0.645   0.0075  0.3125  0.01    0.0025
  0.005  ]
 [0.00125 0.205   0.      0.00375 0.00875 0.03375 0.1975  0.54875 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0725  0.0025  0.9125
  0.00625]
 [0.005   0.00125 0.13375 0.      0.      0.005   0.11875 0.0025  0.00875
  0.725  ]]
[2023-08-05 18:35:29,063 INFO] 1035000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.5185e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1686, device='cuda:0'), 'train/shrink_loss': tensor(0.0300, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0249, device='cuda:0'), 'train/removed_class_idx': 2.329670073662629, 'train/uncertainty_avg': 0.7602306279864058, 'train/certain_ratio_ema': 0.8302515817171525, 'train/total_loss': tensor(0.1935, device='cuda:0'), 'train/mask_ratio': tensor(0.7969, device='cuda:0'), 'lr': 0.006375311409841116, 'train/prefecth_time': 0.030555679321289064, 'train/run_time': 0.5518412475585938, 'eval/loss': tensor(3.4717, device='cuda:0'), 'eval/top-1-acc': 0.639875, 'eval/top-5-acc': 0.951125, 'eval/precision': 0.6811388853766654, 'eval/recall': 0.6398749999999999, 'eval/F1': 0.6477669700017229, 'eval/AUC': 0.8797748524305555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 18:45:10,676 INFO] confusion matrix:
[[0.95125 0.      0.      0.      0.00375 0.005   0.01875 0.      0.015
  0.00625]
 [0.0625  0.82    0.      0.00875 0.      0.01625 0.0775  0.01375 0.00125
  0.     ]
 [0.      0.00125 0.7975  0.      0.      0.03125 0.14    0.      0.0025
  0.0275 ]
 [0.0025  0.13    0.      0.4125  0.0125  0.1175  0.26    0.06375 0.00125
  0.     ]
 [0.      0.00875 0.      0.01125 0.72125 0.01125 0.2325  0.015   0.
  0.     ]
 [0.      0.03125 0.      0.4525  0.0225  0.245   0.22125 0.02625 0.00125
  0.     ]
 [0.00375 0.00625 0.0025  0.005   0.68125 0.005   0.28    0.00875 0.00125
  0.00625]
 [0.00125 0.18375 0.      0.00375 0.0075  0.03    0.17    0.6025  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.0975  0.00125 0.88875
  0.00625]
 [0.005   0.00125 0.15125 0.      0.      0.005   0.12125 0.0025  0.01125
  0.7025 ]]
[2023-08-05 18:45:10,691 INFO] 1036000 iteration, USE_EMA: True, {'train/sup_loss': tensor(8.4372e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1604, device='cuda:0'), 'train/shrink_loss': tensor(0.0776, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0645, device='cuda:0'), 'train/removed_class_idx': 2.173333043555594, 'train/uncertainty_avg': 0.7671589003341152, 'train/certain_ratio_ema': 0.8311652359360674, 'train/total_loss': tensor(0.2250, device='cuda:0'), 'train/mask_ratio': tensor(0.8326, device='cuda:0'), 'lr': 0.006336880895651612, 'train/prefecth_time': 0.018542495727539063, 'train/run_time': 0.53814794921875, 'eval/loss': tensor(3.5768, device='cuda:0'), 'eval/top-1-acc': 0.642125, 'eval/top-5-acc': 0.944, 'eval/precision': 0.6832169905886125, 'eval/recall': 0.642125, 'eval/F1': 0.6500156341592122, 'eval/AUC': 0.8794323177083333}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 18:54:57,656 INFO] confusion matrix:
[[0.9475  0.      0.      0.      0.00375 0.005   0.02125 0.      0.01375
  0.00875]
 [0.06375 0.8075  0.      0.0125  0.00125 0.01125 0.08    0.02125 0.0025
  0.     ]
 [0.      0.      0.77625 0.      0.      0.03125 0.12625 0.0025  0.00125
  0.0625 ]
 [0.0025  0.13    0.      0.4025  0.0125  0.08375 0.265   0.1025  0.00125
  0.     ]
 [0.      0.00625 0.      0.00625 0.7175  0.01    0.23625 0.02375 0.
  0.     ]
 [0.      0.035   0.      0.44375 0.02125 0.195   0.225   0.0775  0.0025
  0.     ]
 [0.00375 0.005   0.00375 0.005   0.66875 0.005   0.28875 0.01125 0.00125
  0.0075 ]
 [0.00125 0.16    0.      0.0025  0.005   0.02125 0.1725  0.63625 0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.07625 0.      0.9125
  0.005  ]
 [0.00625 0.00125 0.15625 0.      0.      0.005   0.11    0.0025  0.0125
  0.70625]]
[2023-08-05 18:54:57,666 INFO] 1037000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.6103e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1346, device='cuda:0'), 'train/shrink_loss': tensor(0.0466, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0386, device='cuda:0'), 'train/removed_class_idx': 2.3291136292261228, 'train/uncertainty_avg': 0.7577500606417924, 'train/certain_ratio_ema': 0.8283339773080417, 'train/total_loss': tensor(0.1733, device='cuda:0'), 'train/mask_ratio': tensor(0.8237, device='cuda:0'), 'lr': 0.006298439493878187, 'train/prefecth_time': 0.026259616851806642, 'train/run_time': 0.5530167236328125, 'eval/loss': tensor(3.5968, device='cuda:0'), 'eval/top-1-acc': 0.639, 'eval/top-5-acc': 0.946375, 'eval/precision': 0.6707856454949976, 'eval/recall': 0.639, 'eval/F1': 0.6418761045112666, 'eval/AUC': 0.8759292708333332}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 19:04:51,795 INFO] confusion matrix:
[[0.94    0.      0.      0.      0.00375 0.005   0.02875 0.      0.01625
  0.00625]
 [0.06125 0.8075  0.      0.015   0.      0.01375 0.08125 0.0175  0.00375
  0.     ]
 [0.      0.      0.7875  0.      0.      0.03125 0.13125 0.0025  0.0025
  0.045  ]
 [0.0025  0.1025  0.      0.42375 0.01125 0.13125 0.2625  0.065   0.
  0.00125]
 [0.      0.0075  0.      0.0125  0.70875 0.00875 0.24625 0.01625 0.
  0.     ]
 [0.      0.0325  0.      0.445   0.01875 0.23375 0.23125 0.03625 0.0025
  0.     ]
 [0.00375 0.00625 0.00375 0.005   0.66375 0.00375 0.29125 0.01125 0.0025
  0.00875]
 [0.00125 0.175   0.      0.00625 0.00625 0.02625 0.17375 0.61    0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.07    0.00125 0.9175
  0.005  ]
 [0.00625 0.00125 0.1625  0.      0.      0.005   0.11625 0.0025  0.01125
  0.695  ]]
[2023-08-05 19:04:51,807 INFO] 1038000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.9241e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1210, device='cuda:0'), 'train/shrink_loss': tensor(0.0560, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0467, device='cuda:0'), 'train/removed_class_idx': 2.1971827891291844, 'train/uncertainty_avg': 0.7925179475105582, 'train/certain_ratio_ema': 0.8342790474679466, 'train/total_loss': tensor(0.1678, device='cuda:0'), 'train/mask_ratio': tensor(0.8415, device='cuda:0'), 'lr': 0.006259987270568151, 'train/prefecth_time': 0.018314783096313476, 'train/run_time': 0.5374000244140625, 'eval/loss': tensor(3.5757, device='cuda:0'), 'eval/top-1-acc': 0.6415, 'eval/top-5-acc': 0.9475, 'eval/precision': 0.6786808969568718, 'eval/recall': 0.6415000000000001, 'eval/F1': 0.6486132986609427, 'eval/AUC': 0.8767504166666665}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 19:14:34,235 INFO] confusion matrix:
[[0.94375 0.      0.      0.      0.005   0.005   0.0275  0.      0.01375
  0.005  ]
 [0.06375 0.81625 0.      0.0125  0.      0.01375 0.0775  0.01375 0.0025
  0.     ]
 [0.      0.0025  0.7975  0.      0.      0.0425  0.1275  0.      0.0025
  0.0275 ]
 [0.0025  0.115   0.      0.39125 0.01    0.15375 0.26375 0.0625  0.00125
  0.     ]
 [0.      0.0075  0.      0.01375 0.72    0.0075  0.2375  0.01375 0.
  0.     ]
 [0.      0.03875 0.      0.45125 0.02    0.23375 0.22875 0.02625 0.00125
  0.     ]
 [0.00375 0.0075  0.0025  0.00625 0.67    0.00375 0.28625 0.00875 0.00375
  0.0075 ]
 [0.00125 0.2     0.      0.01125 0.01    0.035   0.16875 0.5725  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.075   0.      0.9125
  0.00625]
 [0.005   0.00125 0.1575  0.      0.      0.005   0.11625 0.0025  0.01
  0.7025 ]]
[2023-08-05 19:14:34,246 INFO] 1039000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.0462e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1315, device='cuda:0'), 'train/shrink_loss': tensor(0.0515, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0432, device='cuda:0'), 'train/removed_class_idx': 2.2386361092458964, 'train/uncertainty_avg': 0.7755928462046878, 'train/certain_ratio_ema': 0.837437468430321, 'train/total_loss': tensor(0.1747, device='cuda:0'), 'train/mask_ratio': tensor(0.8036, device='cuda:0'), 'lr': 0.006221524291787411, 'train/prefecth_time': 0.01965216064453125, 'train/run_time': 0.5449256591796875, 'eval/loss': tensor(3.6706, device='cuda:0'), 'eval/top-1-acc': 0.637625, 'eval/top-5-acc': 0.943, 'eval/precision': 0.6745416287507121, 'eval/recall': 0.637625, 'eval/F1': 0.6443078970259877, 'eval/AUC': 0.8746051475694446}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 19:24:13,619 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 19:24:23,684 INFO] confusion matrix:
[[0.94    0.      0.      0.      0.005   0.005   0.03    0.      0.01375
  0.00625]
 [0.06    0.82625 0.      0.0075  0.00125 0.01625 0.0725  0.01375 0.0025
  0.     ]
 [0.      0.0025  0.7925  0.      0.      0.0325  0.1225  0.      0.0025
  0.0475 ]
 [0.005   0.12625 0.      0.37125 0.01875 0.14875 0.255   0.07375 0.00125
  0.     ]
 [0.      0.0075  0.      0.0025  0.74125 0.01    0.22    0.0175  0.
  0.00125]
 [0.      0.0475  0.      0.48625 0.02125 0.21    0.21375 0.02    0.00125
  0.     ]
 [0.00375 0.00875 0.0025  0.005   0.6775  0.005   0.27875 0.00875 0.0025
  0.0075 ]
 [0.00125 0.22125 0.      0.00375 0.01125 0.04875 0.17625 0.53625 0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.08875 0.      0.89875
  0.0075 ]
 [0.00625 0.00125 0.17    0.      0.      0.005   0.11625 0.0025  0.01
  0.68875]]
[2023-08-05 19:24:23,691 INFO] 1040000 iteration, USE_EMA: True, {'train/sup_loss': tensor(0.0001, device='cuda:0'), 'train/certain_loss': tensor(0.1311, device='cuda:0'), 'train/shrink_loss': tensor(0.0580, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0481, device='cuda:0'), 'train/removed_class_idx': 2.476922695858047, 'train/uncertainty_avg': 0.7375264349016748, 'train/certain_ratio_ema': 0.8298163426625216, 'train/total_loss': tensor(0.1793, device='cuda:0'), 'train/mask_ratio': tensor(0.8549, device='cuda:0'), 'lr': 0.006183050623620369, 'train/prefecth_time': 0.020118560791015625, 'train/run_time': 0.5607261352539062, 'eval/loss': tensor(3.7617, device='cuda:0'), 'eval/top-1-acc': 0.628375, 'eval/top-5-acc': 0.946375, 'eval/precision': 0.6614084162264265, 'eval/recall': 0.6283749999999999, 'eval/F1': 0.6322691424344083, 'eval/AUC': 0.8694666753472222}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 19:34:18,886 INFO] confusion matrix:
[[0.91875 0.00125 0.      0.      0.00375 0.005   0.04625 0.00125 0.0175
  0.00625]
 [0.0575  0.82875 0.      0.00875 0.      0.0075  0.075   0.02    0.0025
  0.     ]
 [0.      0.00125 0.81625 0.      0.      0.03125 0.12    0.      0.0025
  0.02875]
 [0.00375 0.1125  0.      0.4     0.015   0.11375 0.24625 0.1075  0.00125
  0.     ]
 [0.      0.0075  0.      0.0075  0.7275  0.00875 0.225   0.0225  0.
  0.00125]
 [0.      0.04875 0.      0.535   0.02125 0.16125 0.20375 0.02875 0.00125
  0.     ]
 [0.00375 0.00875 0.00375 0.005   0.6725  0.00375 0.2825  0.01    0.0025
  0.0075 ]
 [0.00125 0.25625 0.      0.00625 0.0125  0.03    0.18    0.5125  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.09875 0.00125 0.8875
  0.00625]
 [0.0075  0.00125 0.18625 0.      0.      0.00375 0.1125  0.0025  0.01125
  0.675  ]]
[2023-08-05 19:34:18,897 INFO] 1041000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.0057e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1515, device='cuda:0'), 'train/shrink_loss': tensor(0.0348, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0291, device='cuda:0'), 'train/removed_class_idx': 2.318181466942202, 'train/uncertainty_avg': 0.7603817617614246, 'train/certain_ratio_ema': 0.8362151645507687, 'train/total_loss': tensor(0.1807, device='cuda:0'), 'train/mask_ratio': tensor(0.8527, device='cuda:0'), 'lr': 0.006144566332169773, 'train/prefecth_time': 0.019198976516723632, 'train/run_time': 0.5379531860351563, 'eval/loss': tensor(3.8464, device='cuda:0'), 'eval/top-1-acc': 0.621, 'eval/top-5-acc': 0.94325, 'eval/precision': 0.6534877089565045, 'eval/recall': 0.621, 'eval/F1': 0.622406491442438, 'eval/AUC': 0.8675945225694446}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 19:44:02,365 INFO] confusion matrix:
[[0.935   0.00125 0.      0.      0.00375 0.005   0.03    0.      0.0175
  0.0075 ]
 [0.06125 0.82875 0.      0.0125  0.      0.00875 0.07375 0.01375 0.00125
  0.     ]
 [0.      0.0025  0.81125 0.      0.      0.03125 0.11    0.00125 0.00125
  0.0425 ]
 [0.0025  0.125   0.      0.44125 0.0175  0.1075  0.245   0.06    0.00125
  0.     ]
 [0.      0.01    0.      0.02125 0.73    0.00375 0.2175  0.01625 0.
  0.00125]
 [0.00125 0.05    0.      0.535   0.02125 0.17125 0.2     0.0175  0.0025
  0.00125]
 [0.00375 0.0075  0.00375 0.005   0.675   0.005   0.28125 0.01    0.00125
  0.0075 ]
 [0.00125 0.27125 0.      0.00875 0.015   0.025   0.18125 0.4975  0.
  0.     ]
 [0.00625 0.      0.00125 0.      0.      0.      0.09625 0.00125 0.88875
  0.00625]
 [0.00625 0.00125 0.185   0.      0.      0.005   0.08875 0.0025  0.01125
  0.7    ]]
[2023-08-05 19:44:02,376 INFO] 1042000 iteration, USE_EMA: True, {'train/sup_loss': tensor(4.9001e-05, device='cuda:0'), 'train/certain_loss': tensor(0.0918, device='cuda:0'), 'train/shrink_loss': tensor(0.0298, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0250, device='cuda:0'), 'train/removed_class_idx': 2.4347822558286585, 'train/uncertainty_avg': 0.7548043666238724, 'train/certain_ratio_ema': 0.8391800080799461, 'train/total_loss': tensor(0.1169, device='cuda:0'), 'train/mask_ratio': tensor(0.8460, device='cuda:0'), 'lr': 0.006106071483556627, 'train/prefecth_time': 0.018452543258666992, 'train/run_time': 0.536779296875, 'eval/loss': tensor(3.7314, device='cuda:0'), 'eval/top-1-acc': 0.6285, 'eval/top-5-acc': 0.946625, 'eval/precision': 0.6631804624958717, 'eval/recall': 0.6285000000000001, 'eval/F1': 0.6292507084191117, 'eval/AUC': 0.8753380729166667}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 19:53:41,687 INFO] confusion matrix:
[[0.9425  0.      0.      0.      0.00375 0.005   0.02625 0.      0.01625
  0.00625]
 [0.06125 0.82625 0.      0.00625 0.      0.01    0.06625 0.0275  0.0025
  0.     ]
 [0.      0.0025  0.7975  0.      0.      0.03125 0.1075  0.00125 0.00125
  0.05875]
 [0.0025  0.125   0.      0.37625 0.01625 0.1125  0.2525  0.11375 0.00125
  0.     ]
 [0.      0.00875 0.      0.00875 0.7225  0.00375 0.225   0.03    0.
  0.00125]
 [0.      0.035   0.      0.50125 0.0225  0.20125 0.205   0.0325  0.0025
  0.     ]
 [0.00375 0.0075  0.00375 0.00375 0.67625 0.005   0.28125 0.01    0.0025
  0.00625]
 [0.00125 0.22125 0.      0.00375 0.01    0.0275  0.1775  0.55875 0.
  0.     ]
 [0.00375 0.      0.00125 0.      0.      0.00125 0.1     0.00125 0.885
  0.0075 ]
 [0.0075  0.00125 0.175   0.      0.      0.005   0.1025  0.0025  0.01125
  0.695  ]]
[2023-08-05 19:53:41,698 INFO] 1043000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.4053e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1541, device='cuda:0'), 'train/shrink_loss': tensor(0.0280, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0236, device='cuda:0'), 'train/removed_class_idx': 2.3661968498314296, 'train/uncertainty_avg': 0.748241452655251, 'train/certain_ratio_ema': 0.8426416116682689, 'train/total_loss': tensor(0.1777, device='cuda:0'), 'train/mask_ratio': tensor(0.8415, device='cuda:0'), 'lr': 0.006067566143920089, 'train/prefecth_time': 0.019329824447631837, 'train/run_time': 0.5375482788085938, 'eval/loss': tensor(3.7601, device='cuda:0'), 'eval/top-1-acc': 0.628625, 'eval/top-5-acc': 0.93925, 'eval/precision': 0.6583595037300458, 'eval/recall': 0.628625, 'eval/F1': 0.6306584173396377, 'eval/AUC': 0.8728096180555555}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 20:03:24,121 INFO] confusion matrix:
[[0.9325  0.00125 0.      0.      0.00375 0.005   0.03625 0.      0.015
  0.00625]
 [0.06    0.83125 0.      0.00625 0.      0.01    0.0725  0.01875 0.00125
  0.     ]
 [0.      0.0025  0.8     0.      0.      0.0275  0.12375 0.00125 0.00125
  0.04375]
 [0.0025  0.1325  0.      0.43    0.015   0.08875 0.255   0.075   0.00125
  0.     ]
 [0.      0.0075  0.      0.01375 0.72625 0.00375 0.22375 0.02375 0.
  0.00125]
 [0.      0.03625 0.      0.47625 0.0225  0.225   0.2125  0.025   0.0025
  0.     ]
 [0.00375 0.00625 0.00375 0.005   0.675   0.00375 0.2825  0.00875 0.0025
  0.00875]
 [0.00125 0.25375 0.      0.00625 0.00875 0.0275  0.16875 0.53375 0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.00125 0.11375 0.0025  0.87
  0.00625]
 [0.00875 0.00125 0.18375 0.      0.      0.005   0.11375 0.0025  0.0125
  0.6725 ]]
[2023-08-05 20:03:24,136 INFO] 1044000 iteration, USE_EMA: True, {'train/sup_loss': tensor(6.5453e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1484, device='cuda:0'), 'train/shrink_loss': tensor(0.0501, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0422, device='cuda:0'), 'train/removed_class_idx': 2.306666359111152, 'train/uncertainty_avg': 0.7877889309970135, 'train/certain_ratio_ema': 0.8411221243489865, 'train/total_loss': tensor(0.1906, device='cuda:0'), 'train/mask_ratio': tensor(0.8326, device='cuda:0'), 'lr': 0.00602905037941732, 'train/prefecth_time': 0.02158403205871582, 'train/run_time': 0.5695150146484375, 'eval/loss': tensor(3.7031, device='cuda:0'), 'eval/top-1-acc': 0.630375, 'eval/top-5-acc': 0.944875, 'eval/precision': 0.672609159179774, 'eval/recall': 0.630375, 'eval/F1': 0.6355280803910016, 'eval/AUC': 0.8763033854166666}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 20:12:59,039 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
[2023-08-05 20:13:08,648 INFO] confusion matrix:
[[0.91375 0.      0.      0.      0.00375 0.00375 0.05875 0.      0.01375
  0.00625]
 [0.05875 0.8325  0.      0.00375 0.      0.00875 0.075   0.02    0.00125
  0.     ]
 [0.      0.00125 0.79375 0.      0.      0.01875 0.1275  0.      0.00375
  0.055  ]
 [0.0025  0.11375 0.      0.415   0.015   0.12125 0.24375 0.0875  0.00125
  0.     ]
 [0.      0.0075  0.      0.01375 0.73    0.005   0.225   0.0175  0.
  0.00125]
 [0.      0.035   0.      0.445   0.02375 0.265   0.21375 0.0175  0.
  0.     ]
 [0.00375 0.005   0.00375 0.005   0.67125 0.0025  0.29    0.00625 0.0025
  0.01   ]
 [0.00125 0.265   0.      0.0025  0.01    0.03125 0.16125 0.5275  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.1175  0.00125 0.86875
  0.00625]
 [0.0075  0.00125 0.165   0.      0.      0.0025  0.11125 0.00125 0.01
  0.70125]]
[2023-08-05 20:13:08,655 INFO] 1045000 iteration, USE_EMA: True, {'train/sup_loss': tensor(9.3473e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1265, device='cuda:0'), 'train/shrink_loss': tensor(0.0671, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0563, device='cuda:0'), 'train/removed_class_idx': 2.38028135488995, 'train/uncertainty_avg': 0.760767622618921, 'train/certain_ratio_ema': 0.8392837980375298, 'train/total_loss': tensor(0.1829, device='cuda:0'), 'train/mask_ratio': tensor(0.8415, device='cuda:0'), 'lr': 0.005990524256223413, 'train/prefecth_time': 0.023809471130371095, 'train/run_time': 0.5498040771484375, 'eval/loss': tensor(3.6711, device='cuda:0'), 'eval/top-1-acc': 0.63375, 'eval/top-5-acc': 0.9485, 'eval/precision': 0.6770354726152235, 'eval/recall': 0.63375, 'eval/F1': 0.6411303170537886, 'eval/AUC': 0.8782437152777779}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 20:23:00,286 INFO] confusion matrix:
[[0.92625 0.      0.      0.00125 0.00375 0.00375 0.045   0.      0.01375
  0.00625]
 [0.05875 0.82875 0.      0.01125 0.00125 0.015   0.0775  0.00625 0.00125
  0.     ]
 [0.      0.0025  0.80375 0.      0.      0.00625 0.13625 0.      0.0025
  0.04875]
 [0.0025  0.11    0.      0.4225  0.0175  0.1675  0.2525  0.02625 0.00125
  0.     ]
 [0.      0.00875 0.      0.02    0.71625 0.01    0.2375  0.00625 0.
  0.00125]
 [0.      0.0425  0.      0.49875 0.02125 0.22    0.2075  0.00875 0.00125
  0.     ]
 [0.00375 0.00625 0.00375 0.005   0.65875 0.005   0.3025  0.00375 0.00125
  0.01   ]
 [0.00125 0.22375 0.      0.00625 0.00875 0.05125 0.165   0.54375 0.
  0.     ]
 [0.005   0.      0.00125 0.      0.      0.      0.1225  0.      0.865
  0.00625]
 [0.00625 0.00125 0.1775  0.      0.      0.0025  0.10625 0.      0.01125
  0.695  ]]
[2023-08-05 20:23:00,297 INFO] 1046000 iteration, USE_EMA: True, {'train/sup_loss': tensor(1.9533e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1244, device='cuda:0'), 'train/shrink_loss': tensor(0.0425, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0357, device='cuda:0'), 'train/removed_class_idx': 2.3661968498314296, 'train/uncertainty_avg': 0.7536628368508295, 'train/certain_ratio_ema': 0.8414672567928198, 'train/total_loss': tensor(0.1601, device='cuda:0'), 'train/mask_ratio': tensor(0.8415, device='cuda:0'), 'lr': 0.005951987840531242, 'train/prefecth_time': 0.018351680755615236, 'train/run_time': 0.5387225341796875, 'eval/loss': tensor(3.7213, device='cuda:0'), 'eval/top-1-acc': 0.632375, 'eval/top-5-acc': 0.9285, 'eval/precision': 0.6777932120984979, 'eval/recall': 0.632375, 'eval/F1': 0.6404430619758001, 'eval/AUC': 0.8749073611111111}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 20:32:41,255 INFO] confusion matrix:
[[0.9325  0.      0.      0.      0.00375 0.005   0.0375  0.      0.015
  0.00625]
 [0.05875 0.82    0.      0.0075  0.      0.00875 0.08    0.02375 0.00125
  0.     ]
 [0.00125 0.      0.8175  0.      0.      0.00125 0.1275  0.00125 0.00375
  0.0475 ]
 [0.00125 0.11625 0.      0.3725  0.0175  0.13875 0.24875 0.10375 0.00125
  0.     ]
 [0.      0.00875 0.      0.0075  0.72    0.005   0.23625 0.02125 0.
  0.00125]
 [0.00125 0.03875 0.      0.465   0.02    0.22375 0.2     0.04875 0.0025
  0.     ]
 [0.00375 0.0075  0.0025  0.005   0.66875 0.00625 0.28875 0.00625 0.00125
  0.01   ]
 [0.00125 0.21125 0.      0.      0.00625 0.02375 0.15375 0.6025  0.
  0.00125]
 [0.005   0.      0.00125 0.      0.      0.      0.11375 0.      0.87375
  0.00625]
 [0.0075  0.00125 0.18875 0.      0.      0.      0.10875 0.0025  0.01125
  0.68   ]]
[2023-08-05 20:32:41,271 INFO] 1047000 iteration, USE_EMA: True, {'train/sup_loss': tensor(3.0104e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1345, device='cuda:0'), 'train/shrink_loss': tensor(0.0575, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0485, device='cuda:0'), 'train/removed_class_idx': 2.1599997120000385, 'train/uncertainty_avg': 0.76898415325949, 'train/certain_ratio_ema': 0.8422571770680398, 'train/total_loss': tensor(0.1830, device='cuda:0'), 'train/mask_ratio': tensor(0.8326, device='cuda:0'), 'lr': 0.0059134411985513665, 'train/prefecth_time': 0.018807680130004882, 'train/run_time': 0.5388419799804688, 'eval/loss': tensor(3.7358, device='cuda:0'), 'eval/top-1-acc': 0.633125, 'eval/top-5-acc': 0.93975, 'eval/precision': 0.6678411185251678, 'eval/recall': 0.6331249999999999, 'eval/F1': 0.637253508869497, 'eval/AUC': 0.8709513975694447}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 20:42:23,919 INFO] confusion matrix:
[[0.925   0.      0.      0.00125 0.00375 0.005   0.04125 0.00125 0.01625
  0.00625]
 [0.06    0.81625 0.      0.01    0.00125 0.00875 0.07875 0.02375 0.00125
  0.     ]
 [0.      0.00125 0.8275  0.      0.      0.0025  0.11875 0.0025  0.0025
  0.045  ]
 [0.00375 0.11875 0.      0.38875 0.01375 0.08375 0.24125 0.14875 0.00125
  0.     ]
 [0.      0.0075  0.      0.01    0.72875 0.0025  0.22625 0.02375 0.
  0.00125]
 [0.00125 0.03375 0.      0.435   0.01875 0.23875 0.1975  0.0725  0.0025
  0.     ]
 [0.00375 0.00875 0.0025  0.005   0.68625 0.005   0.26875 0.00875 0.0025
  0.00875]
 [0.00125 0.21    0.      0.005   0.005   0.00625 0.15375 0.6175  0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.11375 0.0025  0.8725
  0.00625]
 [0.00625 0.00125 0.185   0.      0.      0.      0.115   0.0025  0.0125
  0.6775 ]]
[2023-08-05 20:42:23,930 INFO] 1048000 iteration, USE_EMA: True, {'train/sup_loss': tensor(2.3205e-05, device='cuda:0'), 'train/certain_loss': tensor(0.1203, device='cuda:0'), 'train/shrink_loss': tensor(0.0380, device='cuda:0'), 'train/shrink_loss_reweighted': tensor(0.0319, device='cuda:0'), 'train/removed_class_idx': 2.363636005509696, 'train/uncertainty_avg': 0.7644718372848075, 'train/certain_ratio_ema': 0.8403378320639407, 'train/total_loss': tensor(0.1523, device='cuda:0'), 'train/mask_ratio': tensor(0.8527, device='cuda:0'), 'lr': 0.005874884396511934, 'train/prefecth_time': 0.032900672912597656, 'train/run_time': 0.5365884399414063, 'eval/loss': tensor(3.6661, device='cuda:0'), 'eval/top-1-acc': 0.636125, 'eval/top-5-acc': 0.9475, 'eval/precision': 0.6769579764306265, 'eval/recall': 0.636125, 'eval/F1': 0.6399672708225493, 'eval/AUC': 0.8758024913194445}, BEST_EVAL_ACC: 0.856375, at 540000 iters
[2023-08-05 20:48:17,317 INFO] confusion matrix:
[[0.925   0.      0.      0.00125 0.00375 0.005   0.0425  0.00125 0.015
  0.00625]
 [0.06    0.82375 0.      0.01125 0.00125 0.01    0.08    0.0125  0.00125
  0.     ]
 [0.00125 0.00125 0.81375 0.      0.      0.01125 0.1225  0.0025  0.0025
  0.045  ]
 [0.0025  0.11875 0.      0.40125 0.01375 0.10625 0.24375 0.1125  0.00125
  0.     ]
 [0.      0.0075  0.      0.01375 0.72875 0.0025  0.22375 0.0225  0.
  0.00125]
 [0.00125 0.0475  0.      0.455   0.02    0.22    0.2025  0.05125 0.00125
  0.00125]
 [0.00375 0.01    0.0025  0.005   0.6875  0.005   0.2675  0.0075  0.00125
  0.01   ]
 [0.00125 0.225   0.      0.00625 0.0075  0.0125  0.15125 0.595   0.
  0.00125]
 [0.005   0.      0.      0.      0.      0.      0.11875 0.0025  0.8675
  0.00625]
 [0.00625 0.00125 0.1825  0.      0.      0.00125 0.12125 0.0025  0.01125
  0.67375]]
[2023-08-05 20:48:20,452 INFO] model saved: ./exp/shrinkmatch_stl10_40labels_seed1/latest_model.pth
